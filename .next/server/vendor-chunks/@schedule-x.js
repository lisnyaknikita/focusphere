"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@schedule-x";
exports.ids = ["vendor-chunks/@schedule-x"];
exports.modules = {

/***/ "(ssr)/./node_modules/@schedule-x/calendar-controls/dist/core.js":
/*!*****************************************************************!*\
  !*** ./node_modules/@schedule-x/calendar-controls/dist/core.js ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createCalendarControlsPlugin: () => (/* binding */ createCalendarControlsPlugin)\n/* harmony export */ });\nvar PluginName;\n(function (PluginName) {\n    PluginName[\"DragAndDrop\"] = \"dragAndDrop\";\n    PluginName[\"EventModal\"] = \"eventModal\";\n    PluginName[\"ScrollController\"] = \"scrollController\";\n    PluginName[\"EventRecurrence\"] = \"eventRecurrence\";\n    PluginName[\"Resize\"] = \"resize\";\n    PluginName[\"CalendarControls\"] = \"calendarControls\";\n    PluginName[\"CurrentTime\"] = \"currentTime\";\n})(PluginName || (PluginName = {}));\n\nclass InvalidTimeStringError extends Error {\n    constructor(timeString) {\n        super(`Invalid time string: ${timeString}`);\n    }\n}\n\n// regex for strings between 00:00 and 23:59\nconst timeStringRegex = /^(0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]/;\n\nclass NumberRangeError extends Error {\n    constructor(min, max) {\n        super(`Number must be between ${min} and ${max}.`);\n        Object.defineProperty(this, \"min\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: min\n        });\n        Object.defineProperty(this, \"max\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: max\n        });\n    }\n}\n\nconst doubleDigit = (number) => {\n    if (number < 0 || number > 99)\n        throw new NumberRangeError(0, 99);\n    return String(number).padStart(2, '0');\n};\n\nconst minuteTimePointMultiplier = 1.6666666666666667; // 100 / 60\nconst timePointsFromString = (timeString) => {\n    if (!timeStringRegex.test(timeString) && timeString !== '24:00')\n        throw new InvalidTimeStringError(timeString);\n    const [hoursInt, minutesInt] = timeString\n        .split(':')\n        .map((time) => parseInt(time, 10));\n    let minutePoints = (minutesInt * minuteTimePointMultiplier).toString();\n    if (minutePoints.split('.')[0].length < 2)\n        minutePoints = `0${minutePoints}`;\n    return Number(hoursInt + minutePoints);\n};\nconst timeStringFromTimePoints = (timePoints) => {\n    const hours = Math.floor(timePoints / 100);\n    const minutes = Math.round((timePoints % 100) / minuteTimePointMultiplier);\n    return `${doubleDigit(hours)}:${doubleDigit(minutes)}`;\n};\n\nconst definePlugin = (name, definition) => {\n    definition.name = name;\n    return definition;\n};\n\nclass CalendarControlsPluginImpl {\n    constructor() {\n        Object.defineProperty(this, \"name\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: PluginName.CalendarControls\n        });\n        Object.defineProperty(this, \"$app\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"getDate\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: () => this.$app.datePickerState.selectedDate.value\n        });\n        Object.defineProperty(this, \"getView\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: () => this.$app.calendarState.view.value\n        });\n        Object.defineProperty(this, \"getFirstDayOfWeek\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: () => this.$app.config.firstDayOfWeek.value\n        });\n        Object.defineProperty(this, \"getLocale\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: () => this.$app.config.locale.value\n        });\n        Object.defineProperty(this, \"getViews\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: () => this.$app.config.views.value\n        });\n        Object.defineProperty(this, \"getDayBoundaries\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: () => ({\n                start: timeStringFromTimePoints(this.$app.config.dayBoundaries.value.start),\n                end: timeStringFromTimePoints(this.$app.config.dayBoundaries.value.end),\n            })\n        });\n        Object.defineProperty(this, \"getWeekOptions\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: () => this.$app.config.weekOptions.value\n        });\n        Object.defineProperty(this, \"getCalendars\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: () => this.$app.config.calendars.value\n        });\n        Object.defineProperty(this, \"getMinDate\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: () => this.$app.config.minDate.value\n        });\n        Object.defineProperty(this, \"getMaxDate\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: () => this.$app.config.maxDate.value\n        });\n        Object.defineProperty(this, \"getMonthGridOptions\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: () => this.$app.config.monthGridOptions.value\n        });\n        Object.defineProperty(this, \"getRange\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: () => this.$app.calendarState.range.value\n        });\n    }\n    beforeRender($app) {\n        this.$app = $app;\n    }\n    onRender($app) {\n        this.$app = $app;\n    }\n    setDate(date) {\n        this.$app.datePickerState.selectedDate.value = date;\n    }\n    setView(view) {\n        const viewToSet = this.$app.config.views.value.find((v) => v.name === view);\n        if (!viewToSet)\n            throw new Error(`Invalid view name. Expected one of ${this.$app.config.views.value.map((v) => v.name).join(', ')}`);\n        this.$app.calendarState.setView(view, this.$app.datePickerState.selectedDate.value);\n    }\n    setFirstDayOfWeek(firstDayOfWeek) {\n        this.$app.config.firstDayOfWeek.value = firstDayOfWeek;\n    }\n    setLocale(locale) {\n        this.$app.config.locale.value = locale;\n    }\n    setViews(views) {\n        const currentViewName = this.$app.calendarState.view.value;\n        const isCurrentViewInViews = views.some((view) => view.name === currentViewName);\n        if (!isCurrentViewInViews)\n            throw new Error(`Currently active view is not in given views. Expected to find ${currentViewName} in ${views.map((view) => view.name).join(',')}`);\n        this.$app.config.views.value = views;\n    }\n    setDayBoundaries(dayBoundaries) {\n        const newStart = timePointsFromString(dayBoundaries.start);\n        const newEnd = timePointsFromString(dayBoundaries.end);\n        this.$app.config.dayBoundaries.value = {\n            start: newStart,\n            end: newEnd,\n        };\n        Object.values(this.$app.config.plugins).forEach((plugin) => {\n            if (plugin === null || plugin === void 0 ? void 0 : plugin.onDayBoundariesChange) {\n                plugin.onDayBoundariesChange({\n                    start: newStart,\n                    end: newEnd,\n                });\n            }\n        });\n    }\n    setWeekOptions(weekOptions) {\n        this.$app.config.weekOptions.value = {\n            ...this.$app.config.weekOptions.value,\n            ...weekOptions,\n        };\n    }\n    setCalendars(calendars) {\n        this.$app.config.calendars.value = calendars;\n    }\n    setMinDate(minDate) {\n        this.$app.config.minDate.value = minDate;\n        if (minDate) {\n            this.$app.datePickerConfig.min = minDate;\n        }\n    }\n    setMaxDate(maxDate) {\n        this.$app.config.maxDate.value = maxDate;\n        if (maxDate) {\n            this.$app.datePickerConfig.max = maxDate;\n        }\n    }\n    setMonthGridOptions(monthGridOptions) {\n        this.$app.config.monthGridOptions.value = monthGridOptions;\n    }\n    setTimezone(timezone) {\n        this.$app.config.timezone.value = timezone;\n        Object.values(this.$app.config.plugins).forEach((plugin) => {\n            if (plugin === null || plugin === void 0 ? void 0 : plugin.onTimezoneChange) {\n                plugin.onTimezoneChange(timezone);\n            }\n        });\n    }\n}\nconst createCalendarControlsPlugin = () => {\n    return definePlugin('calendarControls', new CalendarControlsPluginImpl());\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNjaGVkdWxlLXgvY2FsZW5kYXItY29udHJvbHMvZGlzdC9jb3JlLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLGdDQUFnQzs7QUFFakM7QUFDQTtBQUNBLHNDQUFzQyxXQUFXO0FBQ2pEO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esd0NBQXdDLEtBQUssTUFBTSxJQUFJO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsc0RBQXNEO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsYUFBYTtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxtQkFBbUIsR0FBRyxxQkFBcUI7QUFDekQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0VBQWtFLDJEQUEyRDtBQUM3SDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2RkFBNkYsaUJBQWlCLEtBQUsseUNBQXlDO0FBQzVKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFd0MiLCJzb3VyY2VzIjpbIi9Vc2Vycy9uaWtpdGEvRGVza3RvcC9mb2N1c3BoZXJlL25vZGVfbW9kdWxlcy9Ac2NoZWR1bGUteC9jYWxlbmRhci1jb250cm9scy9kaXN0L2NvcmUuanMiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIFBsdWdpbk5hbWU7XG4oZnVuY3Rpb24gKFBsdWdpbk5hbWUpIHtcbiAgICBQbHVnaW5OYW1lW1wiRHJhZ0FuZERyb3BcIl0gPSBcImRyYWdBbmREcm9wXCI7XG4gICAgUGx1Z2luTmFtZVtcIkV2ZW50TW9kYWxcIl0gPSBcImV2ZW50TW9kYWxcIjtcbiAgICBQbHVnaW5OYW1lW1wiU2Nyb2xsQ29udHJvbGxlclwiXSA9IFwic2Nyb2xsQ29udHJvbGxlclwiO1xuICAgIFBsdWdpbk5hbWVbXCJFdmVudFJlY3VycmVuY2VcIl0gPSBcImV2ZW50UmVjdXJyZW5jZVwiO1xuICAgIFBsdWdpbk5hbWVbXCJSZXNpemVcIl0gPSBcInJlc2l6ZVwiO1xuICAgIFBsdWdpbk5hbWVbXCJDYWxlbmRhckNvbnRyb2xzXCJdID0gXCJjYWxlbmRhckNvbnRyb2xzXCI7XG4gICAgUGx1Z2luTmFtZVtcIkN1cnJlbnRUaW1lXCJdID0gXCJjdXJyZW50VGltZVwiO1xufSkoUGx1Z2luTmFtZSB8fCAoUGx1Z2luTmFtZSA9IHt9KSk7XG5cbmNsYXNzIEludmFsaWRUaW1lU3RyaW5nRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IodGltZVN0cmluZykge1xuICAgICAgICBzdXBlcihgSW52YWxpZCB0aW1lIHN0cmluZzogJHt0aW1lU3RyaW5nfWApO1xuICAgIH1cbn1cblxuLy8gcmVnZXggZm9yIHN0cmluZ3MgYmV0d2VlbiAwMDowMCBhbmQgMjM6NTlcbmNvbnN0IHRpbWVTdHJpbmdSZWdleCA9IC9eKDBbMC05XXwxWzAtOV18MlswLTNdKTpbMC01XVswLTldLztcblxuY2xhc3MgTnVtYmVyUmFuZ2VFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgICBjb25zdHJ1Y3RvcihtaW4sIG1heCkge1xuICAgICAgICBzdXBlcihgTnVtYmVyIG11c3QgYmUgYmV0d2VlbiAke21pbn0gYW5kICR7bWF4fS5gKTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwibWluXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBtaW5cbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm1heFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogbWF4XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuY29uc3QgZG91YmxlRGlnaXQgPSAobnVtYmVyKSA9PiB7XG4gICAgaWYgKG51bWJlciA8IDAgfHwgbnVtYmVyID4gOTkpXG4gICAgICAgIHRocm93IG5ldyBOdW1iZXJSYW5nZUVycm9yKDAsIDk5KTtcbiAgICByZXR1cm4gU3RyaW5nKG51bWJlcikucGFkU3RhcnQoMiwgJzAnKTtcbn07XG5cbmNvbnN0IG1pbnV0ZVRpbWVQb2ludE11bHRpcGxpZXIgPSAxLjY2NjY2NjY2NjY2NjY2Njc7IC8vIDEwMCAvIDYwXG5jb25zdCB0aW1lUG9pbnRzRnJvbVN0cmluZyA9ICh0aW1lU3RyaW5nKSA9PiB7XG4gICAgaWYgKCF0aW1lU3RyaW5nUmVnZXgudGVzdCh0aW1lU3RyaW5nKSAmJiB0aW1lU3RyaW5nICE9PSAnMjQ6MDAnKVxuICAgICAgICB0aHJvdyBuZXcgSW52YWxpZFRpbWVTdHJpbmdFcnJvcih0aW1lU3RyaW5nKTtcbiAgICBjb25zdCBbaG91cnNJbnQsIG1pbnV0ZXNJbnRdID0gdGltZVN0cmluZ1xuICAgICAgICAuc3BsaXQoJzonKVxuICAgICAgICAubWFwKCh0aW1lKSA9PiBwYXJzZUludCh0aW1lLCAxMCkpO1xuICAgIGxldCBtaW51dGVQb2ludHMgPSAobWludXRlc0ludCAqIG1pbnV0ZVRpbWVQb2ludE11bHRpcGxpZXIpLnRvU3RyaW5nKCk7XG4gICAgaWYgKG1pbnV0ZVBvaW50cy5zcGxpdCgnLicpWzBdLmxlbmd0aCA8IDIpXG4gICAgICAgIG1pbnV0ZVBvaW50cyA9IGAwJHttaW51dGVQb2ludHN9YDtcbiAgICByZXR1cm4gTnVtYmVyKGhvdXJzSW50ICsgbWludXRlUG9pbnRzKTtcbn07XG5jb25zdCB0aW1lU3RyaW5nRnJvbVRpbWVQb2ludHMgPSAodGltZVBvaW50cykgPT4ge1xuICAgIGNvbnN0IGhvdXJzID0gTWF0aC5mbG9vcih0aW1lUG9pbnRzIC8gMTAwKTtcbiAgICBjb25zdCBtaW51dGVzID0gTWF0aC5yb3VuZCgodGltZVBvaW50cyAlIDEwMCkgLyBtaW51dGVUaW1lUG9pbnRNdWx0aXBsaWVyKTtcbiAgICByZXR1cm4gYCR7ZG91YmxlRGlnaXQoaG91cnMpfToke2RvdWJsZURpZ2l0KG1pbnV0ZXMpfWA7XG59O1xuXG5jb25zdCBkZWZpbmVQbHVnaW4gPSAobmFtZSwgZGVmaW5pdGlvbikgPT4ge1xuICAgIGRlZmluaXRpb24ubmFtZSA9IG5hbWU7XG4gICAgcmV0dXJuIGRlZmluaXRpb247XG59O1xuXG5jbGFzcyBDYWxlbmRhckNvbnRyb2xzUGx1Z2luSW1wbCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm5hbWVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IFBsdWdpbk5hbWUuQ2FsZW5kYXJDb250cm9sc1xuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiJGFwcFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJnZXREYXRlXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiAoKSA9PiB0aGlzLiRhcHAuZGF0ZVBpY2tlclN0YXRlLnNlbGVjdGVkRGF0ZS52YWx1ZVxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiZ2V0Vmlld1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogKCkgPT4gdGhpcy4kYXBwLmNhbGVuZGFyU3RhdGUudmlldy52YWx1ZVxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiZ2V0Rmlyc3REYXlPZldlZWtcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6ICgpID0+IHRoaXMuJGFwcC5jb25maWcuZmlyc3REYXlPZldlZWsudmFsdWVcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImdldExvY2FsZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogKCkgPT4gdGhpcy4kYXBwLmNvbmZpZy5sb2NhbGUudmFsdWVcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImdldFZpZXdzXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiAoKSA9PiB0aGlzLiRhcHAuY29uZmlnLnZpZXdzLnZhbHVlXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJnZXREYXlCb3VuZGFyaWVzXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiAoKSA9PiAoe1xuICAgICAgICAgICAgICAgIHN0YXJ0OiB0aW1lU3RyaW5nRnJvbVRpbWVQb2ludHModGhpcy4kYXBwLmNvbmZpZy5kYXlCb3VuZGFyaWVzLnZhbHVlLnN0YXJ0KSxcbiAgICAgICAgICAgICAgICBlbmQ6IHRpbWVTdHJpbmdGcm9tVGltZVBvaW50cyh0aGlzLiRhcHAuY29uZmlnLmRheUJvdW5kYXJpZXMudmFsdWUuZW5kKSxcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJnZXRXZWVrT3B0aW9uc1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogKCkgPT4gdGhpcy4kYXBwLmNvbmZpZy53ZWVrT3B0aW9ucy52YWx1ZVxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiZ2V0Q2FsZW5kYXJzXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiAoKSA9PiB0aGlzLiRhcHAuY29uZmlnLmNhbGVuZGFycy52YWx1ZVxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiZ2V0TWluRGF0ZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogKCkgPT4gdGhpcy4kYXBwLmNvbmZpZy5taW5EYXRlLnZhbHVlXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJnZXRNYXhEYXRlXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiAoKSA9PiB0aGlzLiRhcHAuY29uZmlnLm1heERhdGUudmFsdWVcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImdldE1vbnRoR3JpZE9wdGlvbnNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6ICgpID0+IHRoaXMuJGFwcC5jb25maWcubW9udGhHcmlkT3B0aW9ucy52YWx1ZVxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiZ2V0UmFuZ2VcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6ICgpID0+IHRoaXMuJGFwcC5jYWxlbmRhclN0YXRlLnJhbmdlLnZhbHVlXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBiZWZvcmVSZW5kZXIoJGFwcCkge1xuICAgICAgICB0aGlzLiRhcHAgPSAkYXBwO1xuICAgIH1cbiAgICBvblJlbmRlcigkYXBwKSB7XG4gICAgICAgIHRoaXMuJGFwcCA9ICRhcHA7XG4gICAgfVxuICAgIHNldERhdGUoZGF0ZSkge1xuICAgICAgICB0aGlzLiRhcHAuZGF0ZVBpY2tlclN0YXRlLnNlbGVjdGVkRGF0ZS52YWx1ZSA9IGRhdGU7XG4gICAgfVxuICAgIHNldFZpZXcodmlldykge1xuICAgICAgICBjb25zdCB2aWV3VG9TZXQgPSB0aGlzLiRhcHAuY29uZmlnLnZpZXdzLnZhbHVlLmZpbmQoKHYpID0+IHYubmFtZSA9PT0gdmlldyk7XG4gICAgICAgIGlmICghdmlld1RvU2V0KVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIHZpZXcgbmFtZS4gRXhwZWN0ZWQgb25lIG9mICR7dGhpcy4kYXBwLmNvbmZpZy52aWV3cy52YWx1ZS5tYXAoKHYpID0+IHYubmFtZSkuam9pbignLCAnKX1gKTtcbiAgICAgICAgdGhpcy4kYXBwLmNhbGVuZGFyU3RhdGUuc2V0Vmlldyh2aWV3LCB0aGlzLiRhcHAuZGF0ZVBpY2tlclN0YXRlLnNlbGVjdGVkRGF0ZS52YWx1ZSk7XG4gICAgfVxuICAgIHNldEZpcnN0RGF5T2ZXZWVrKGZpcnN0RGF5T2ZXZWVrKSB7XG4gICAgICAgIHRoaXMuJGFwcC5jb25maWcuZmlyc3REYXlPZldlZWsudmFsdWUgPSBmaXJzdERheU9mV2VlaztcbiAgICB9XG4gICAgc2V0TG9jYWxlKGxvY2FsZSkge1xuICAgICAgICB0aGlzLiRhcHAuY29uZmlnLmxvY2FsZS52YWx1ZSA9IGxvY2FsZTtcbiAgICB9XG4gICAgc2V0Vmlld3Modmlld3MpIHtcbiAgICAgICAgY29uc3QgY3VycmVudFZpZXdOYW1lID0gdGhpcy4kYXBwLmNhbGVuZGFyU3RhdGUudmlldy52YWx1ZTtcbiAgICAgICAgY29uc3QgaXNDdXJyZW50Vmlld0luVmlld3MgPSB2aWV3cy5zb21lKCh2aWV3KSA9PiB2aWV3Lm5hbWUgPT09IGN1cnJlbnRWaWV3TmFtZSk7XG4gICAgICAgIGlmICghaXNDdXJyZW50Vmlld0luVmlld3MpXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEN1cnJlbnRseSBhY3RpdmUgdmlldyBpcyBub3QgaW4gZ2l2ZW4gdmlld3MuIEV4cGVjdGVkIHRvIGZpbmQgJHtjdXJyZW50Vmlld05hbWV9IGluICR7dmlld3MubWFwKCh2aWV3KSA9PiB2aWV3Lm5hbWUpLmpvaW4oJywnKX1gKTtcbiAgICAgICAgdGhpcy4kYXBwLmNvbmZpZy52aWV3cy52YWx1ZSA9IHZpZXdzO1xuICAgIH1cbiAgICBzZXREYXlCb3VuZGFyaWVzKGRheUJvdW5kYXJpZXMpIHtcbiAgICAgICAgY29uc3QgbmV3U3RhcnQgPSB0aW1lUG9pbnRzRnJvbVN0cmluZyhkYXlCb3VuZGFyaWVzLnN0YXJ0KTtcbiAgICAgICAgY29uc3QgbmV3RW5kID0gdGltZVBvaW50c0Zyb21TdHJpbmcoZGF5Qm91bmRhcmllcy5lbmQpO1xuICAgICAgICB0aGlzLiRhcHAuY29uZmlnLmRheUJvdW5kYXJpZXMudmFsdWUgPSB7XG4gICAgICAgICAgICBzdGFydDogbmV3U3RhcnQsXG4gICAgICAgICAgICBlbmQ6IG5ld0VuZCxcbiAgICAgICAgfTtcbiAgICAgICAgT2JqZWN0LnZhbHVlcyh0aGlzLiRhcHAuY29uZmlnLnBsdWdpbnMpLmZvckVhY2goKHBsdWdpbikgPT4ge1xuICAgICAgICAgICAgaWYgKHBsdWdpbiA9PT0gbnVsbCB8fCBwbHVnaW4gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHBsdWdpbi5vbkRheUJvdW5kYXJpZXNDaGFuZ2UpIHtcbiAgICAgICAgICAgICAgICBwbHVnaW4ub25EYXlCb3VuZGFyaWVzQ2hhbmdlKHtcbiAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IG5ld1N0YXJ0LFxuICAgICAgICAgICAgICAgICAgICBlbmQ6IG5ld0VuZCxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHNldFdlZWtPcHRpb25zKHdlZWtPcHRpb25zKSB7XG4gICAgICAgIHRoaXMuJGFwcC5jb25maWcud2Vla09wdGlvbnMudmFsdWUgPSB7XG4gICAgICAgICAgICAuLi50aGlzLiRhcHAuY29uZmlnLndlZWtPcHRpb25zLnZhbHVlLFxuICAgICAgICAgICAgLi4ud2Vla09wdGlvbnMsXG4gICAgICAgIH07XG4gICAgfVxuICAgIHNldENhbGVuZGFycyhjYWxlbmRhcnMpIHtcbiAgICAgICAgdGhpcy4kYXBwLmNvbmZpZy5jYWxlbmRhcnMudmFsdWUgPSBjYWxlbmRhcnM7XG4gICAgfVxuICAgIHNldE1pbkRhdGUobWluRGF0ZSkge1xuICAgICAgICB0aGlzLiRhcHAuY29uZmlnLm1pbkRhdGUudmFsdWUgPSBtaW5EYXRlO1xuICAgICAgICBpZiAobWluRGF0ZSkge1xuICAgICAgICAgICAgdGhpcy4kYXBwLmRhdGVQaWNrZXJDb25maWcubWluID0gbWluRGF0ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZXRNYXhEYXRlKG1heERhdGUpIHtcbiAgICAgICAgdGhpcy4kYXBwLmNvbmZpZy5tYXhEYXRlLnZhbHVlID0gbWF4RGF0ZTtcbiAgICAgICAgaWYgKG1heERhdGUpIHtcbiAgICAgICAgICAgIHRoaXMuJGFwcC5kYXRlUGlja2VyQ29uZmlnLm1heCA9IG1heERhdGU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2V0TW9udGhHcmlkT3B0aW9ucyhtb250aEdyaWRPcHRpb25zKSB7XG4gICAgICAgIHRoaXMuJGFwcC5jb25maWcubW9udGhHcmlkT3B0aW9ucy52YWx1ZSA9IG1vbnRoR3JpZE9wdGlvbnM7XG4gICAgfVxuICAgIHNldFRpbWV6b25lKHRpbWV6b25lKSB7XG4gICAgICAgIHRoaXMuJGFwcC5jb25maWcudGltZXpvbmUudmFsdWUgPSB0aW1lem9uZTtcbiAgICAgICAgT2JqZWN0LnZhbHVlcyh0aGlzLiRhcHAuY29uZmlnLnBsdWdpbnMpLmZvckVhY2goKHBsdWdpbikgPT4ge1xuICAgICAgICAgICAgaWYgKHBsdWdpbiA9PT0gbnVsbCB8fCBwbHVnaW4gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHBsdWdpbi5vblRpbWV6b25lQ2hhbmdlKSB7XG4gICAgICAgICAgICAgICAgcGx1Z2luLm9uVGltZXpvbmVDaGFuZ2UodGltZXpvbmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59XG5jb25zdCBjcmVhdGVDYWxlbmRhckNvbnRyb2xzUGx1Z2luID0gKCkgPT4ge1xuICAgIHJldHVybiBkZWZpbmVQbHVnaW4oJ2NhbGVuZGFyQ29udHJvbHMnLCBuZXcgQ2FsZW5kYXJDb250cm9sc1BsdWdpbkltcGwoKSk7XG59O1xuXG5leHBvcnQgeyBjcmVhdGVDYWxlbmRhckNvbnRyb2xzUGx1Z2luIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@schedule-x/calendar-controls/dist/core.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@schedule-x/calendar/dist/core.js":
/*!********************************************************!*\
  !*** ./node_modules/@schedule-x/calendar/dist/core.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AppContext: () => (/* binding */ AppContext),\n/* harmony export */   CalendarApp: () => (/* binding */ CalendarApp),\n/* harmony export */   DateGridDay: () => (/* binding */ DateGridDay),\n/* harmony export */   TimeAxis: () => (/* binding */ TimeAxis),\n/* harmony export */   TimeGridDay: () => (/* binding */ TimeGridDay),\n/* harmony export */   createCalendar: () => (/* binding */ createCalendar),\n/* harmony export */   createPreactView: () => (/* binding */ createPreactView),\n/* harmony export */   createViewDay: () => (/* binding */ createViewDay),\n/* harmony export */   createViewList: () => (/* binding */ createViewList),\n/* harmony export */   createViewMonthAgenda: () => (/* binding */ createViewMonthAgenda),\n/* harmony export */   createViewMonthGrid: () => (/* binding */ createViewMonthGrid),\n/* harmony export */   createViewWeek: () => (/* binding */ createViewWeek),\n/* harmony export */   externalEventToInternal: () => (/* binding */ externalEventToInternal),\n/* harmony export */   setRangeForDay: () => (/* binding */ setRangeForDay),\n/* harmony export */   setRangeForMonth: () => (/* binding */ setRangeForMonth),\n/* harmony export */   setRangeForWeek: () => (/* binding */ setRangeForWeek),\n/* harmony export */   sortEventsForWeekView: () => (/* binding */ sortEventsForWeekView),\n/* harmony export */   toDateString: () => (/* binding */ toDateString$1),\n/* harmony export */   toDateTimeString: () => (/* binding */ toDateTimeString),\n/* harmony export */   toJSDate: () => (/* binding */ toJSDate),\n/* harmony export */   toTimeString: () => (/* binding */ toTimeString),\n/* harmony export */   viewDay: () => (/* binding */ viewDay),\n/* harmony export */   viewList: () => (/* binding */ viewList),\n/* harmony export */   viewMonthAgenda: () => (/* binding */ viewMonthAgenda),\n/* harmony export */   viewMonthGrid: () => (/* binding */ viewMonthGrid),\n/* harmony export */   viewWeek: () => (/* binding */ viewWeek)\n/* harmony export */ });\n/* harmony import */ var preact__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! preact */ \"(ssr)/./node_modules/preact/dist/preact.mjs\");\n/* harmony import */ var preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! preact/jsx-runtime */ \"(ssr)/./node_modules/preact/jsx-runtime/dist/jsxRuntime.mjs\");\n/* harmony import */ var preact_hooks__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! preact/hooks */ \"(ssr)/./node_modules/preact/hooks/dist/hooks.mjs\");\n/* harmony import */ var preact_compat__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! preact/compat */ \"(ssr)/./node_modules/preact/compat/dist/compat.mjs\");\n/* harmony import */ var _preact_signals__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @preact/signals */ \"(ssr)/./node_modules/@preact/signals/dist/signals.mjs\");\n\n\n\n\n\n\nconst AppContext$1 = (0,preact__WEBPACK_IMPORTED_MODULE_0__.createContext)({});\n\nvar img = \"data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e%3c!-- Uploaded to: SVG Repo%2c www.svgrepo.com%2c Generator: SVG Repo Mixer Tools --%3e%3csvg width='800px' height='800px' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M6 9L12 15L18 9' stroke='%23B8B5B8' stroke-width='4' stroke-linecap='round' stroke-linejoin='round'/%3e%3c/svg%3e\";\n\n/**\n * Can be used for generating a random id for an entity\n * Should, however, never be used in potentially resource intense loops,\n * since the performance cost of this compared to new Date().getTime() is ca x4 in v8\n * */\nconst randomStringId = () => 's' + Math.random().toString(36).substring(2, 11);\n\nconst isKeyEnterOrSpace = (keyboardEvent) => keyboardEvent.key === 'Enter' || keyboardEvent.key === ' ';\n\nfunction AppInput() {\n    const datePickerInputId = randomStringId();\n    const datePickerLabelId = randomStringId();\n    const inputWrapperId = randomStringId();\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext$1);\n    const [wrapperClasses, setWrapperClasses] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)([]);\n    const setInputElement = () => {\n        const inputWrapperEl = document.getElementById(inputWrapperId);\n        $app.datePickerState.inputWrapperElement.value =\n            inputWrapperEl instanceof HTMLDivElement ? inputWrapperEl : undefined;\n    };\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        if ($app.config.teleportTo)\n            setInputElement();\n        const newClasses = ['sx__date-input-wrapper'];\n        if ($app.datePickerState.isOpen.value)\n            newClasses.push('sx__date-input--active');\n        setWrapperClasses(newClasses);\n    }, [$app.datePickerState.isOpen.value]);\n    const handleKeyUp = (event) => {\n        if (event.key === 'Enter')\n            handleInputValue(event);\n    };\n    const handleInputValue = (event) => {\n        event.stopPropagation(); // prevent date picker from closing\n        try {\n            $app.datePickerState.handleInput(event.target.value);\n            $app.datePickerState.close();\n        }\n        catch (e) {\n            console.log('Error setting input value:' + e);\n        }\n    };\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        const inputElement = typeof document !== 'undefined' &&\n            document.getElementById(datePickerInputId);\n        if (typeof HTMLElement === 'undefined' ||\n            !(inputElement instanceof HTMLElement))\n            return;\n        inputElement.addEventListener('change', handleInputValue); // Preact onChange triggers on every input\n        return () => inputElement.removeEventListener('change', handleInputValue);\n    });\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        if ($app.config.hasPlaceholder) {\n            $app.datePickerState.inputDisplayedValue.value =\n                $app.translate('MM/DD/YYYY');\n        }\n    }, []);\n    const handleClick = () => {\n        $app.datePickerState.open();\n    };\n    const handleButtonKeyDown = (keyboardEvent) => {\n        if (isKeyEnterOrSpace(keyboardEvent)) {\n            keyboardEvent.preventDefault();\n            $app.datePickerState.open();\n            setTimeout(() => {\n                const element = document.querySelector('[data-focus=\"true\"]');\n                if (element instanceof HTMLElement)\n                    element.focus();\n            }, 50);\n        }\n    };\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { className: wrapperClasses.join(' '), id: inputWrapperId, children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"label\", { for: datePickerInputId, id: datePickerLabelId, className: \"sx__date-input-label\", children: $app.config.label || $app.translate('Date') }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"input\", { id: datePickerInputId, tabIndex: $app.datePickerState.isDisabled.value ? -1 : 0, name: $app.config.name || 'date', \"aria-describedby\": datePickerLabelId, value: $app.datePickerState.inputDisplayedValue.value, \"data-testid\": \"date-picker-input\", className: \"sx__date-input\", onClick: handleClick, onKeyUp: handleKeyUp, type: \"text\" }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"button\", { type: \"button\", tabIndex: $app.datePickerState.isDisabled.value ? -1 : 0, \"aria-label\": $app.translate('Choose Date'), onKeyDown: handleButtonKeyDown, onClick: () => $app.datePickerState.open(), className: \"sx__button sx__date-input-chevron-wrapper\", children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"img\", { className: \"sx__date-input-chevron\", src: img, alt: \"\" }) })] }) }));\n}\n\nvar DatePickerView;\n(function (DatePickerView) {\n    DatePickerView[\"MONTH_DAYS\"] = \"month-days\";\n    DatePickerView[\"YEARS\"] = \"years\";\n})(DatePickerView || (DatePickerView = {}));\n\nconst YEARS_VIEW = 'years-view';\nconst MONTH_VIEW = 'months-view';\nconst DATE_PICKER_WEEK = 'date-picker-week';\n\nconst toLocalizedMonth = (date, locale) => {\n    return date.toLocaleString(locale, { month: 'long' });\n};\nconst toLocalizedDateString = (date, locale) => {\n    return date.toLocaleString(locale, {\n        month: 'numeric',\n        day: 'numeric',\n        year: 'numeric',\n    });\n};\nconst getOneLetterDayNames = (week, locale) => {\n    return week.map((date) => {\n        return date.toLocaleString(locale, { weekday: 'short' }).charAt(0);\n    });\n};\nconst getDayNameShort = (date, locale) => {\n    if (locale === 'he-IL') {\n        return date.toLocaleString(locale, { weekday: 'narrow' });\n    }\n    return date.toLocaleString(locale, { weekday: 'short' });\n};\nconst getDayNamesShort = (week, locale) => {\n    return week.map((date) => getDayNameShort(date, locale));\n};\nconst getOneLetterOrShortDayNames = (week, locale) => {\n    if (['zh-cn', 'zh-tw', 'ca-es', 'he-il'].includes(locale.toLowerCase())) {\n        return getDayNamesShort(week, locale);\n    }\n    return getOneLetterDayNames(week, locale);\n};\n\nconst DateFormats = {\n    DATE_STRING: /^\\d{4}-\\d{2}-\\d{2}$/,\n    DATE_TIME_STRING: /^\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}$/,\n};\n\nclass InvalidDateTimeError extends Error {\n    constructor(dateTimeSpecification) {\n        super(`Invalid date time specification: ${dateTimeSpecification}`);\n    }\n}\n\nconst toJSDate = (dateTimeSpecification) => {\n    if (!DateFormats.DATE_TIME_STRING.test(dateTimeSpecification) &&\n        !DateFormats.DATE_STRING.test(dateTimeSpecification))\n        throw new InvalidDateTimeError(dateTimeSpecification);\n    return new Date(Number(dateTimeSpecification.slice(0, 4)), Number(dateTimeSpecification.slice(5, 7)) - 1, Number(dateTimeSpecification.slice(8, 10)), Number(dateTimeSpecification.slice(11, 13)), // for date strings this will be 0\n    Number(dateTimeSpecification.slice(14, 16)) // for date strings this will be 0\n    );\n};\nconst toIntegers = (dateTimeSpecification) => {\n    const hours = dateTimeSpecification.slice(11, 13), minutes = dateTimeSpecification.slice(14, 16);\n    return {\n        year: Number(dateTimeSpecification.slice(0, 4)),\n        month: Number(dateTimeSpecification.slice(5, 7)) - 1,\n        date: Number(dateTimeSpecification.slice(8, 10)),\n        hours: hours !== '' ? Number(hours) : undefined,\n        minutes: minutes !== '' ? Number(minutes) : undefined,\n    };\n};\n\nclass NumberRangeError extends Error {\n    constructor(min, max) {\n        super(`Number must be between ${min} and ${max}.`);\n        Object.defineProperty(this, \"min\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: min\n        });\n        Object.defineProperty(this, \"max\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: max\n        });\n    }\n}\n\nconst doubleDigit = (number) => {\n    if (number < 0 || number > 99)\n        throw new NumberRangeError(0, 99);\n    return String(number).padStart(2, '0');\n};\n\nconst toDateString$1 = (date) => {\n    return `${date.year}-${doubleDigit(date.month)}-${doubleDigit(date.day)}`;\n};\nconst toTimeString = (date) => {\n    return `${doubleDigit(date.hour)}:${doubleDigit(date.minute)}`;\n};\nconst toDateTimeString = (date) => {\n    return `${toDateString$1(date)} ${toTimeString(date)}`;\n};\n\nconst addMonths = (to, nMonths) => {\n    if (nMonths < 0) {\n        return to.subtract({ months: -nMonths });\n    }\n    return to.add({ months: nMonths });\n};\nconst addDays = (to, nDays) => {\n    if (nDays < 0) {\n        return to.subtract({ days: -nDays });\n    }\n    return to.add({ days: nDays });\n};\n\nconst getFirstDayOPreviousMonth = (date) => {\n    return addMonths(date, -1).with({ day: 1 });\n};\nconst getFirstDayOfNextMonth = (date) => {\n    const nextMonth = addMonths(date, 1);\n    return nextMonth.with({ day: 1 });\n};\n\nfunction Chevron({ direction, onClick, buttonText, disabled = false, }) {\n    const handleKeyDown = (keyboardEvent) => {\n        if (isKeyEnterOrSpace(keyboardEvent))\n            onClick();\n    };\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"button\", { type: \"button\", disabled: disabled, className: \"sx__button sx__chevron-wrapper sx__ripple\", onMouseUp: onClick, onKeyDown: handleKeyDown, tabIndex: 0, children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"i\", { className: `sx__chevron sx__chevron--${direction}`, children: buttonText }) }));\n}\n\nfunction MonthViewHeader({ setYearsView }) {\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext$1);\n    const dateStringToLocalizedMonthName = (selectedDate) => {\n        return toLocalizedMonth(selectedDate, $app.config.locale.value);\n    };\n    const getYearFrom = (datePickerDate) => {\n        return datePickerDate.year;\n    };\n    const [selectedDateMonthName, setSelectedDateMonthName] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)(dateStringToLocalizedMonthName($app.datePickerState.datePickerDate.value));\n    const [datePickerYear, setDatePickerYear] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)(getYearFrom($app.datePickerState.datePickerDate.value));\n    const setPreviousMonth = () => {\n        $app.datePickerState.datePickerDate.value = getFirstDayOPreviousMonth($app.datePickerState.datePickerDate.value);\n    };\n    const setNextMonth = () => {\n        $app.datePickerState.datePickerDate.value = getFirstDayOfNextMonth($app.datePickerState.datePickerDate.value);\n    };\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        setSelectedDateMonthName(dateStringToLocalizedMonthName($app.datePickerState.datePickerDate.value));\n        setDatePickerYear(getYearFrom($app.datePickerState.datePickerDate.value));\n    }, [$app.datePickerState.datePickerDate.value]);\n    const handleOpenYearsView = (e) => {\n        e.stopPropagation();\n        setYearsView();\n    };\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"header\", { className: \"sx__date-picker__month-view-header\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(Chevron, { direction: 'previous', onClick: () => setPreviousMonth(), buttonText: $app.translate('Previous month') }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"button\", { type: \"button\", className: \"sx__button sx__date-picker__month-view-header__month-year\", onClick: (event) => handleOpenYearsView(event), children: selectedDateMonthName + ' ' + datePickerYear }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(Chevron, { direction: 'next', onClick: () => setNextMonth(), buttonText: $app.translate('Next month') })] }) }));\n}\n\nfunction DayNames() {\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext$1);\n    const aWeek = $app.timeUnitsImpl.getWeekFor($app.datePickerState.datePickerDate.value);\n    const dayNames = getOneLetterOrShortDayNames(aWeek, $app.config.locale.value);\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__date-picker__day-names\", children: dayNames.map((dayName) => ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"span\", { \"data-testid\": \"day-name\", className: \"sx__date-picker__day-name\", children: dayName }))) }));\n}\n\nconst isToday = (date, timezone) => {\n    const today = Temporal.Now.zonedDateTimeISO(timezone);\n    return (date.day === today.day &&\n        date.month === today.month &&\n        date.year === today.year);\n};\nconst isSameMonth = (date1, date2) => {\n    return date1.month === date2.month && date1.year === date2.year;\n};\nconst isSameDay = (date1, date2) => {\n    return (date1.day === date2.day &&\n        date1.month === date2.month &&\n        date1.year === date2.year);\n};\n\n/**\n * Origin of SVG: https://www.svgrepo.com/svg/506771/time\n * License: PD License\n * Author Salah Elimam\n * Author website: https://www.figma.com/@salahelimam\n * */\nfunction TimeIcon({ strokeColor }) {\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"svg\", { className: \"sx__event-icon\", viewBox: \"0 0 24 24\", fill: \"none\", xmlns: \"http://www.w3.org/2000/svg\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"g\", { id: \"SVGRepo_bgCarrier\", \"stroke-width\": \"0\" }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"g\", { id: \"SVGRepo_tracerCarrier\", \"stroke-linecap\": \"round\", \"stroke-linejoin\": \"round\" }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"g\", { id: \"SVGRepo_iconCarrier\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"path\", { d: \"M12 8V12L15 15\", stroke: strokeColor, \"stroke-width\": \"2\", \"stroke-linecap\": \"round\" }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"circle\", { cx: \"12\", cy: \"12\", r: \"9\", stroke: strokeColor, \"stroke-width\": \"2\" })] })] }) }));\n}\n\n/**\n * Origin of SVG: https://www.svgrepo.com/svg/506772/user\n * License: PD License\n * Author Salah Elimam\n * Author website: https://www.figma.com/@salahelimam\n * */\nfunction UserIcon({ strokeColor }) {\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"svg\", { className: \"sx__event-icon\", viewBox: \"0 0 24 24\", fill: \"none\", xmlns: \"http://www.w3.org/2000/svg\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"g\", { id: \"SVGRepo_bgCarrier\", \"stroke-width\": \"0\" }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"g\", { id: \"SVGRepo_tracerCarrier\", \"stroke-linecap\": \"round\", \"stroke-linejoin\": \"round\" }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"g\", { id: \"SVGRepo_iconCarrier\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"path\", { d: \"M15 7C15 8.65685 13.6569 10 12 10C10.3431 10 9 8.65685 9 7C9 5.34315 10.3431 4 12 4C13.6569 4 15 5.34315 15 7Z\", stroke: strokeColor, \"stroke-width\": \"2\" }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"path\", { d: \"M5 19.5C5 15.9101 7.91015 13 11.5 13H12.5C16.0899 13 19 15.9101 19 19.5V20C19 20.5523 18.5523 21 18 21H6C5.44772 21 5 20.5523 5 20V19.5Z\", stroke: strokeColor, \"stroke-width\": \"2\" })] })] }) }));\n}\n\n/**\n * Origin of SVG: https://www.svgrepo.com/svg/489502/location-pin\n * License: PD License\n * Author: Dariush Habibpour\n * Author website: https://redl.ink/dariush/links?ref=svgrepo.com\n * */\nfunction LocationPinIcon({ strokeColor }) {\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"svg\", { className: \"sx__event-icon\", viewBox: \"0 0 24 24\", fill: \"none\", xmlns: \"http://www.w3.org/2000/svg\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"g\", { id: \"SVGRepo_bgCarrier\", \"stroke-width\": \"0\" }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"g\", { id: \"SVGRepo_tracerCarrier\", \"stroke-linecap\": \"round\", \"stroke-linejoin\": \"round\" }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"g\", { id: \"SVGRepo_iconCarrier\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"g\", { \"clip-path\": \"url(#clip0_429_11046)\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"rect\", { x: \"12\", y: \"11\", width: \"0.01\", height: \"0.01\", stroke: strokeColor, \"stroke-width\": \"2\", \"stroke-linejoin\": \"round\" }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"path\", { d: \"M12 22L17.5 16.5C20.5376 13.4624 20.5376 8.53757 17.5 5.5C14.4624 2.46244 9.53757 2.46244 6.5 5.5C3.46244 8.53757 3.46244 13.4624 6.5 16.5L12 22Z\", stroke: strokeColor, \"stroke-width\": \"2\", \"stroke-linejoin\": \"round\" })] }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"defs\", { children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"clipPath\", { id: \"clip0_429_11046\", children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"rect\", { width: \"24\", height: \"24\", fill: \"white\" }) }) })] })] }) }));\n}\n\nclass InvalidTimeStringError extends Error {\n    constructor(timeString) {\n        super(`Invalid time string: ${timeString}`);\n    }\n}\n\n// regex for strings between 00:00 and 23:59\nconst timeStringRegex = /^(0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]/;\n\nconst minuteTimePointMultiplier = 1.6666666666666667; // 100 / 60\nconst timePointsFromString = (timeString) => {\n    if (!timeStringRegex.test(timeString) && timeString !== '24:00')\n        throw new InvalidTimeStringError(timeString);\n    const [hoursInt, minutesInt] = timeString\n        .split(':')\n        .map((time) => parseInt(time, 10));\n    let minutePoints = (minutesInt * minuteTimePointMultiplier).toString();\n    if (minutePoints.split('.')[0].length < 2)\n        minutePoints = `0${minutePoints}`;\n    return Number(hoursInt + minutePoints);\n};\nconst timeStringFromTimePoints = (timePoints) => {\n    const hours = Math.floor(timePoints / 100);\n    const minutes = Math.round((timePoints % 100) / minuteTimePointMultiplier);\n    return `${doubleDigit(hours)}:${doubleDigit(minutes)}`;\n};\nconst addTimePointsToDateTime = (dateTime, pointsToAdd) => {\n    const minutesToAdd = Math.round(pointsToAdd / minuteTimePointMultiplier);\n    const newDateTime = dateTime.add({ minutes: minutesToAdd });\n    return newDateTime;\n};\n\nconst dateFromDateTime = (dateTime) => {\n    return dateTime.slice(0, 10);\n};\nconst timeFromDateTime = (dateTime) => {\n    return dateTime.slice(11);\n};\n\nvar WeekDay;\n(function (WeekDay) {\n    WeekDay[WeekDay[\"MONDAY\"] = 1] = \"MONDAY\";\n    WeekDay[WeekDay[\"TUESDAY\"] = 2] = \"TUESDAY\";\n    WeekDay[WeekDay[\"WEDNESDAY\"] = 3] = \"WEDNESDAY\";\n    WeekDay[WeekDay[\"THURSDAY\"] = 4] = \"THURSDAY\";\n    WeekDay[WeekDay[\"FRIDAY\"] = 5] = \"FRIDAY\";\n    WeekDay[WeekDay[\"SATURDAY\"] = 6] = \"SATURDAY\";\n    WeekDay[WeekDay[\"SUNDAY\"] = 7] = \"SUNDAY\";\n})(WeekDay || (WeekDay = {}));\n\nconst DEFAULT_LOCALE = 'en-US';\nconst DEFAULT_FIRST_DAY_OF_WEEK = WeekDay.MONDAY;\nconst DEFAULT_EVENT_COLOR_NAME = 'primary';\n\nclass CalendarEventImpl {\n    constructor(_config, id, _start, _end, title, people, location, description, calendarId, _options = undefined, _customContent = {}, _foreignProperties = {}) {\n        Object.defineProperty(this, \"_config\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: _config\n        });\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: id\n        });\n        Object.defineProperty(this, \"_start\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: _start\n        });\n        Object.defineProperty(this, \"_end\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: _end\n        });\n        Object.defineProperty(this, \"title\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: title\n        });\n        Object.defineProperty(this, \"people\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: people\n        });\n        Object.defineProperty(this, \"location\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: location\n        });\n        Object.defineProperty(this, \"description\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: description\n        });\n        Object.defineProperty(this, \"calendarId\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: calendarId\n        });\n        Object.defineProperty(this, \"_options\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: _options\n        });\n        Object.defineProperty(this, \"_customContent\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: _customContent\n        });\n        Object.defineProperty(this, \"_foreignProperties\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: _foreignProperties\n        });\n        Object.defineProperty(this, \"_previousConcurrentEvents\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_totalConcurrentEvents\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_maxConcurrentEvents\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_nDaysInGrid\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_createdAt\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_originalTimezone\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_eventFragments\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: {}\n        });\n        this._originalTimezone =\n            this._start instanceof Temporal.ZonedDateTime\n                ? this._start.timeZoneId\n                : undefined;\n    }\n    get start() {\n        if (this._start instanceof Temporal.PlainDate) {\n            return this._start;\n        }\n        return this._start.withTimeZone(this._config.timezone.value);\n    }\n    set start(value) {\n        this._start =\n            value instanceof Temporal.ZonedDateTime\n                ? value.withTimeZone(this._originalTimezone)\n                : value;\n    }\n    get end() {\n        if (this._end instanceof Temporal.PlainDate) {\n            return this._end;\n        }\n        return this._end.withTimeZone(this._config.timezone.value);\n    }\n    set end(value) {\n        this._end =\n            value instanceof Temporal.ZonedDateTime\n                ? value.withTimeZone(this._originalTimezone)\n                : value;\n    }\n    get _isSingleDayTimed() {\n        if (this.start instanceof Temporal.PlainDate ||\n            this.end instanceof Temporal.PlainDate)\n            return false;\n        const localStartDate = dateFromDateTime(this.start.toString());\n        const localEndDate = dateFromDateTime(this.end.toString());\n        return localStartDate === localEndDate;\n    }\n    get _isSingleDayFullDay() {\n        const startDate = dateFromDateTime(this.start.toString());\n        const endDate = dateFromDateTime(this.end.toString());\n        return (startDate === endDate &&\n            this.start instanceof Temporal.PlainDate &&\n            this.end instanceof Temporal.PlainDate);\n    }\n    get _isMultiDayTimed() {\n        if (this.start instanceof Temporal.PlainDate ||\n            this.end instanceof Temporal.PlainDate)\n            return false;\n        const startDate = dateFromDateTime(this.start.toString());\n        const endDate = dateFromDateTime(this.end.toString());\n        return startDate !== endDate;\n    }\n    get _isMultiDayFullDay() {\n        const startDate = dateFromDateTime(this.start.toString());\n        const endDate = dateFromDateTime(this.end.toString());\n        return (this.start instanceof Temporal.PlainDate &&\n            this.end instanceof Temporal.PlainDate &&\n            startDate !== endDate);\n    }\n    get _isSingleHybridDayTimed() {\n        if (!this._config.isHybridDay)\n            return false;\n        if (this.start instanceof Temporal.PlainDate ||\n            this.end instanceof Temporal.PlainDate)\n            return false;\n        const startDate = dateFromDateTime(this.start.toString());\n        const endDate = dateFromDateTime(this.end.toString());\n        const endDateMinusOneDay = toDateString$1(Temporal.PlainDate.from(endDate).subtract({ days: 1 }));\n        if (startDate !== endDate && startDate !== endDateMinusOneDay)\n            return false;\n        const dayBoundaries = this._config.dayBoundaries.value;\n        const eventStartTimePoints = timePointsFromString(timeFromDateTime(this.start.toString()));\n        const eventEndTimePoints = timePointsFromString(timeFromDateTime(this.end.toString()));\n        const eventIsFullyInFirstDayOfBoundary = eventEndTimePoints > eventStartTimePoints && startDate === endDate;\n        return ((eventStartTimePoints >= dayBoundaries.start &&\n            (eventEndTimePoints <= dayBoundaries.end ||\n                eventIsFullyInFirstDayOfBoundary)) ||\n            (eventStartTimePoints < dayBoundaries.end &&\n                eventEndTimePoints <= dayBoundaries.end));\n    }\n    get _color() {\n        if (this.calendarId &&\n            this._config.calendars.value &&\n            this.calendarId in this._config.calendars.value) {\n            return this._config.calendars.value[this.calendarId].colorName;\n        }\n        return DEFAULT_EVENT_COLOR_NAME;\n    }\n    _getForeignProperties() {\n        return this._foreignProperties;\n    }\n    _getExternalEvent() {\n        return {\n            id: this.id,\n            start: this._start,\n            end: this._end,\n            title: this.title,\n            people: this.people,\n            location: this.location,\n            description: this.description,\n            calendarId: this.calendarId,\n            _options: this._options,\n            ...this._getForeignProperties(),\n        };\n    }\n}\n\nclass CalendarEventBuilder {\n    constructor(_config, id, start, end) {\n        Object.defineProperty(this, \"_config\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: _config\n        });\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: id\n        });\n        Object.defineProperty(this, \"start\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: start\n        });\n        Object.defineProperty(this, \"end\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: end\n        });\n        Object.defineProperty(this, \"people\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"location\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"description\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"title\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"calendarId\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_foreignProperties\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: {}\n        });\n        Object.defineProperty(this, \"_options\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: undefined\n        });\n        Object.defineProperty(this, \"_customContent\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: {}\n        });\n    }\n    build() {\n        return new CalendarEventImpl(this._config, this.id, this.start, this.end, this.title, this.people, this.location, this.description, this.calendarId, this._options, this._customContent, this._foreignProperties);\n    }\n    withTitle(title) {\n        this.title = title;\n        return this;\n    }\n    withPeople(people) {\n        this.people = people;\n        return this;\n    }\n    withLocation(location) {\n        this.location = location;\n        return this;\n    }\n    withDescription(description) {\n        this.description = description;\n        return this;\n    }\n    withForeignProperties(foreignProperties) {\n        this._foreignProperties = foreignProperties;\n        return this;\n    }\n    withCalendarId(calendarId) {\n        this.calendarId = calendarId;\n        return this;\n    }\n    withOptions(options) {\n        this._options = options;\n        return this;\n    }\n    withCustomContent(customContent) {\n        this._customContent = customContent;\n        return this;\n    }\n}\n\nconst deepCloneEvent = (calendarEvent, $app) => {\n    const calendarEventInternal = new CalendarEventBuilder($app.config, calendarEvent.id, calendarEvent._start, calendarEvent._end)\n        .withTitle(calendarEvent.title)\n        .withPeople(calendarEvent.people)\n        .withCalendarId(calendarEvent.calendarId)\n        .withForeignProperties(JSON.parse(JSON.stringify(calendarEvent._getForeignProperties())))\n        .withLocation(calendarEvent.location)\n        .withDescription(calendarEvent.description)\n        .withOptions(calendarEvent._options)\n        .withCustomContent(calendarEvent._customContent)\n        .build();\n    calendarEventInternal._nDaysInGrid = calendarEvent._nDaysInGrid;\n    return calendarEventInternal;\n};\n\nconst concatenatePeople = (people) => {\n    return people.reduce((acc, person, index) => {\n        if (index === 0)\n            return person;\n        if (index === people.length - 1)\n            return `${acc} & ${person}`;\n        return `${acc}, ${person}`;\n    }, '');\n};\n\nconst dateFn = (dateTime, locale) => {\n    return dateTime.toLocaleString(locale, {\n        day: 'numeric',\n        month: 'long',\n        year: 'numeric',\n    });\n};\nconst getLocalizedDate$1 = dateFn;\nconst timeFn = (dateTime, locale) => {\n    const dateTimeString = dateTime.toString();\n    const { year, month, date, hours, minutes } = toIntegers(dateTimeString);\n    return new Date(year, month, date, hours, minutes).toLocaleTimeString(locale, {\n        hour: 'numeric',\n        minute: 'numeric',\n    });\n};\nconst getTimeStamp = (calendarEvent, // to facilitate testing. In reality, we will always have a full CalendarEventInternal\nlocale, delimiter = '\\u2013') => {\n    var _a, _b, _c, _d;\n    const eventTime = { start: calendarEvent.start, end: calendarEvent.end };\n    if (calendarEvent._isSingleDayFullDay) {\n        return dateFn(eventTime.start, locale);\n    }\n    if (calendarEvent._isMultiDayFullDay) {\n        return `${dateFn(eventTime.start, locale)} ${delimiter} ${dateFn(eventTime.end, locale)}`;\n    }\n    if (calendarEvent._isSingleDayTimed &&\n        ((_a = eventTime.start) === null || _a === void 0 ? void 0 : _a.toString()) !== ((_b = eventTime.end) === null || _b === void 0 ? void 0 : _b.toString())) {\n        return `${dateFn(eventTime.start, locale)} <span aria-hidden=\"true\"></span> ${timeFn(eventTime.start, locale)} ${delimiter} ${timeFn(eventTime.end, locale)}`;\n    }\n    if (calendarEvent._isSingleDayTimed &&\n        ((_c = calendarEvent.start) === null || _c === void 0 ? void 0 : _c.toString()) === ((_d = calendarEvent.end) === null || _d === void 0 ? void 0 : _d.toString())) {\n        return `${dateFn(eventTime.start, locale)}, ${timeFn(eventTime.start, locale)}`;\n    }\n    return `${dateFn(eventTime.start, locale)}, ${timeFn(eventTime.start, locale)} ${delimiter} ${dateFn(eventTime.end, locale)}, ${timeFn(eventTime.end, locale)}`;\n};\n\nfunction MonthViewWeek({ week }) {\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext$1);\n    const weekDays = week.map((day) => {\n        const classes = ['sx__date-picker__day'];\n        if (isToday(day, $app.config.timezone.value))\n            classes.push('sx__date-picker__day--today');\n        if (isSameDay(day, $app.datePickerState.selectedDate.value))\n            classes.push('sx__date-picker__day--selected');\n        if (!isSameMonth(day, $app.datePickerState.datePickerDate.value))\n            classes.push('is-leading-or-trailing');\n        return {\n            day: day.toPlainDate(),\n            classes,\n        };\n    });\n    const isDateSelectable = (date) => {\n        return (date.toString() >= $app.config.min.toString() &&\n            date.toString() <= $app.config.max.toString());\n    };\n    const selectDate = (date) => {\n        $app.datePickerState.selectedDate.value = date;\n        $app.datePickerState.close();\n    };\n    const hasFocus = (weekDay) => isSameDay(weekDay.day, $app.datePickerState.datePickerDate.value);\n    const handleKeyDown = (event) => {\n        if (event.key === 'Enter') {\n            $app.datePickerState.selectedDate.value =\n                $app.datePickerState.datePickerDate.value;\n            $app.datePickerState.close();\n            return;\n        }\n        const keyMapDaysToAdd = new Map([\n            ['ArrowDown', 7],\n            ['ArrowUp', -7],\n            ['ArrowLeft', -1],\n            ['ArrowRight', 1],\n        ]);\n        $app.datePickerState.datePickerDate.value = addDays($app.datePickerState.datePickerDate.value, keyMapDaysToAdd.get(event.key) || 0);\n    };\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { \"data-testid\": DATE_PICKER_WEEK, className: \"sx__date-picker__week\", children: weekDays.map((weekDay) => ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"button\", { type: \"button\", tabIndex: hasFocus(weekDay) ? 0 : -1, disabled: !isDateSelectable(weekDay.day), \"aria-label\": getLocalizedDate$1($app.datePickerState.datePickerDate.value, $app.config.locale.value), className: `sx__button ${weekDay.classes.join(' ')}`, \"data-focus\": hasFocus(weekDay) ? 'true' : undefined, onClick: () => selectDate(weekDay.day), onKeyDown: handleKeyDown, children: weekDay.day.day }))) }) }));\n}\n\nfunction MonthView({ seatYearsView }) {\n    const elementId = randomStringId();\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext$1);\n    const [month, setMonth] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)([]);\n    const renderMonth = () => {\n        const newDatePickerDate = $app.datePickerState.datePickerDate.value;\n        setMonth($app.timeUnitsImpl.getMonthWithTrailingAndLeadingDays(newDatePickerDate.year, newDatePickerDate.month));\n    };\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        renderMonth();\n    }, [$app.datePickerState.datePickerDate.value]);\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        const observer = new MutationObserver((mutations) => {\n            mutations.forEach((mutation) => {\n                const mutatedElement = mutation.target;\n                if (mutatedElement.dataset.focus === 'true')\n                    mutatedElement.focus();\n            });\n        });\n        const monthViewElement = document.getElementById(elementId);\n        observer.observe(monthViewElement, {\n            childList: true,\n            subtree: true,\n            attributes: true,\n        });\n        return () => observer.disconnect();\n    }, []);\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { id: elementId, \"data-testid\": MONTH_VIEW, className: \"sx__date-picker__month-view\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(MonthViewHeader, { setYearsView: seatYearsView }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(DayNames, {}), month.map((week) => ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(MonthViewWeek, { week: week })))] }) }));\n}\n\nfunction YearsViewAccordion({ year, setYearAndMonth, isExpanded, expand, }) {\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext$1);\n    const yearWithDates = $app.timeUnitsImpl.getMonthsFor(year);\n    const handleClickOnMonth = (event, month) => {\n        event.stopPropagation();\n        setYearAndMonth(year, month.month);\n    };\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"li\", { className: isExpanded ? 'sx__is-expanded' : '', children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"button\", { type: \"button\", className: \"sx__button sx__date-picker__years-accordion__expand-button sx__ripple--wide\", onClick: () => expand(year), children: year }), isExpanded && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__date-picker__years-view-accordion__panel\", children: yearWithDates.map((month) => ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"button\", { type: \"button\", className: \"sx__button sx__date-picker__years-view-accordion__month\", onClick: (event) => handleClickOnMonth(event, month), children: toLocalizedMonth(month, $app.config.locale.value) }))) }))] }) }));\n}\n\nfunction YearsView({ setMonthView }) {\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext$1);\n    const minYear = $app.config.min.year;\n    const maxYear = $app.config.max.year;\n    const years = Array.from({ length: maxYear - minYear + 1 }, (_, i) => minYear + i);\n    const selectedYear = $app.datePickerState.selectedDate.value.year;\n    const [expandedYear, setExpandedYear] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)(selectedYear);\n    const setNewDatePickerDate = (year, month) => {\n        $app.datePickerState.datePickerDate.value = Temporal.PlainDate.from({\n            year,\n            month,\n            day: 1,\n        });\n        setMonthView();\n    };\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        var _a;\n        const initiallyExpandedYear = (_a = document\n            .querySelector('.sx__date-picker__years-view')) === null || _a === void 0 ? void 0 : _a.querySelector('.sx__is-expanded');\n        if (!initiallyExpandedYear)\n            return;\n        initiallyExpandedYear.scrollIntoView({\n            block: 'center',\n        });\n    }, []);\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"ul\", { className: \"sx__date-picker__years-view\", \"data-testid\": YEARS_VIEW, children: years.map((year) => ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(YearsViewAccordion, { year: year, setYearAndMonth: (year, month) => setNewDatePickerDate(year, month), isExpanded: expandedYear === year, expand: (year) => setExpandedYear(year) }))) }) }));\n}\n\nconst isScrollable = (el) => {\n    if (el) {\n        const hasScrollableContent = el.scrollHeight > el.clientHeight;\n        const overflowYStyle = window.getComputedStyle(el).overflowY;\n        const isOverflowHidden = overflowYStyle.indexOf('hidden') !== -1;\n        return hasScrollableContent && !isOverflowHidden;\n    }\n    return true;\n};\nconst getScrollableParents = (el, acc = []) => {\n    if (!el ||\n        el === document.body ||\n        el.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n        acc.push(window);\n        return acc;\n    }\n    if (isScrollable(el)) {\n        acc.push(el);\n    }\n    return getScrollableParents((el.assignedSlot\n        ? el.assignedSlot.parentNode\n        : el.parentNode), acc);\n};\n\nconst POPUP_CLASS_NAME = 'sx__date-picker-popup';\nfunction AppPopup({ wrapperEl }) {\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext$1);\n    const [datePickerView, setDatePickerView] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)(DatePickerView.MONTH_DAYS);\n    const classList = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useMemo)(() => {\n        const returnValue = [\n            POPUP_CLASS_NAME,\n            $app.datePickerState.isDark.value ? 'is-dark' : '',\n            $app.config.teleportTo ? 'is-teleported' : '',\n        ];\n        if ($app.config.placement && !$app.config.teleportTo && wrapperEl) {\n            const placement = $app.config.placement instanceof Function\n                ? $app.config.placement(wrapperEl)\n                : $app.config.placement;\n            returnValue.push(placement);\n        }\n        return returnValue;\n    }, [\n        $app.datePickerState.isDark.value,\n        $app.config.placement,\n        $app.config.teleportTo,\n    ]);\n    const clickOutsideListener = (event) => {\n        const target = event.target;\n        if (!target.closest(`.${POPUP_CLASS_NAME}`))\n            $app.datePickerState.close();\n    };\n    const escapeKeyListener = (e) => {\n        if (e.key === 'Escape') {\n            if ($app.config.listeners.onEscapeKeyDown)\n                $app.config.listeners.onEscapeKeyDown($app);\n            else\n                $app.datePickerState.close();\n        }\n    };\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        document.addEventListener('click', clickOutsideListener);\n        document.addEventListener('keydown', escapeKeyListener);\n        return () => {\n            document.removeEventListener('click', clickOutsideListener);\n            document.removeEventListener('keydown', escapeKeyListener);\n        };\n    }, []);\n    const remSize = Number(getComputedStyle(document.documentElement).fontSize.split('px')[0]);\n    const popupHeight = 362;\n    const popupWidth = 332;\n    const getFixedPositionStyles = () => {\n        const inputWrapperEl = $app.datePickerState.inputWrapperElement.value;\n        const inputRect = inputWrapperEl === null || inputWrapperEl === void 0 ? void 0 : inputWrapperEl.getBoundingClientRect();\n        if (inputWrapperEl === undefined || !(inputRect instanceof DOMRect))\n            return undefined;\n        const resolvedPlacement = typeof $app.config.placement === 'function'\n            ? wrapperEl\n                ? $app.config.placement(wrapperEl)\n                : 'bottom-end'\n            : $app.config.placement;\n        if (!resolvedPlacement)\n            return undefined;\n        return {\n            top: resolvedPlacement.includes('bottom')\n                ? inputRect.height + inputRect.y + 1 // 1px border\n                : inputRect.y - remSize - popupHeight, // subtract remsize to leave room for label text\n            left: resolvedPlacement.includes('start')\n                ? inputRect.x\n                : inputRect.x + inputRect.width - popupWidth,\n            width: popupWidth,\n            position: 'fixed',\n        };\n    };\n    const [fixedPositionStyle, setFixedPositionStyle] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)(getFixedPositionStyles());\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        const inputWrapper = $app.datePickerState.inputWrapperElement.value;\n        if (inputWrapper === undefined)\n            return;\n        const scrollableParents = getScrollableParents(inputWrapper);\n        const scrollListener = () => setFixedPositionStyle(getFixedPositionStyles());\n        scrollableParents.forEach((parent) => parent.addEventListener('scroll', scrollListener));\n        return () => scrollableParents.forEach((parent) => parent.removeEventListener('scroll', scrollListener));\n    }, []);\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { style: $app.config.teleportTo ? fixedPositionStyle : undefined, \"data-testid\": \"date-picker-popup\", className: classList.join(' '), children: datePickerView === DatePickerView.MONTH_DAYS ? ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(MonthView, { seatYearsView: () => setDatePickerView(DatePickerView.YEARS) })) : ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(YearsView, { setMonthView: () => setDatePickerView(DatePickerView.MONTH_DAYS) })) }) }));\n}\n\nfunction AppWrapper({ $app }) {\n    const initialClassList = ['sx__date-picker-wrapper'];\n    const [classList, setClassList] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)(initialClassList);\n    const elementRef = (0,preact_compat__WEBPACK_IMPORTED_MODULE_3__.useRef)(null);\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        if (elementRef && elementRef.current instanceof HTMLDivElement)\n            $app.elements = { DatePickerWrapper: elementRef.current };\n    }, []);\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        var _a;\n        const list = [...initialClassList];\n        if ($app.datePickerState.isDark.value)\n            list.push('is-dark');\n        if ((_a = $app.config.style) === null || _a === void 0 ? void 0 : _a.fullWidth)\n            list.push('has-full-width');\n        if ($app.datePickerState.isDisabled.value)\n            list.push('is-disabled');\n        setClassList(list);\n    }, [$app.datePickerState.isDark.value, $app.datePickerState.isDisabled.value]);\n    let appPopupJSX = (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(AppPopup, { wrapperEl: elementRef.current });\n    if ($app.config.teleportTo)\n        appPopupJSX = (0,preact_compat__WEBPACK_IMPORTED_MODULE_3__.createPortal)(appPopupJSX, $app.config.teleportTo);\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { ref: elementRef, className: classList.join(' '), children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(AppContext$1.Provider, { value: $app, children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(AppInput, {}), $app.datePickerState.isOpen.value && appPopupJSX] }) }) }));\n}\n\nconst AppContext = (0,preact__WEBPACK_IMPORTED_MODULE_0__.createContext)({});\n\nclass DatePickerAppSingletonImpl {\n    constructor(datePickerState, config, timeUnitsImpl, translate, elements = {}) {\n        Object.defineProperty(this, \"datePickerState\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: datePickerState\n        });\n        Object.defineProperty(this, \"config\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: config\n        });\n        Object.defineProperty(this, \"timeUnitsImpl\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: timeUnitsImpl\n        });\n        Object.defineProperty(this, \"translate\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: translate\n        });\n        Object.defineProperty(this, \"elements\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: elements\n        });\n    }\n}\n\nclass DatePickerAppSingletonBuilder {\n    constructor() {\n        Object.defineProperty(this, \"datePickerState\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"config\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"timeUnitsImpl\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"translate\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n    }\n    build() {\n        return new DatePickerAppSingletonImpl(this.datePickerState, this.config, this.timeUnitsImpl, this.translate);\n    }\n    withDatePickerState(datePickerState) {\n        this.datePickerState = datePickerState;\n        return this;\n    }\n    withConfig(config) {\n        this.config = config;\n        return this;\n    }\n    withTimeUnitsImpl(timeUnitsImpl) {\n        this.timeUnitsImpl = timeUnitsImpl;\n        return this;\n    }\n    withTranslate(translate) {\n        this.translate = translate;\n        return this;\n    }\n}\n\n// This enum is used to represent names of all internally built views of the calendar\nvar InternalViewName;\n(function (InternalViewName) {\n    InternalViewName[\"Day\"] = \"day\";\n    InternalViewName[\"Week\"] = \"week\";\n    InternalViewName[\"MonthGrid\"] = \"month-grid\";\n    InternalViewName[\"MonthAgenda\"] = \"month-agenda\";\n    InternalViewName[\"List\"] = \"list\";\n})(InternalViewName || (InternalViewName = {}));\n\nconst getLocaleStringMonthArgs = ($app) => {\n    return [$app.config.locale.value, { month: 'long' }];\n};\nconst getLocaleStringYearArgs = ($app) => {\n    return [$app.config.locale.value, { year: 'numeric' }];\n};\nconst getMonthAndYearForDateRange = ($app, rangeStart, rangeEnd) => {\n    const startDateMonth = rangeStart.toLocaleString(...getLocaleStringMonthArgs($app));\n    const startDateYear = rangeStart.toLocaleString(...getLocaleStringYearArgs($app));\n    const endDateMonth = rangeEnd.toLocaleString(...getLocaleStringMonthArgs($app));\n    const endDateYear = rangeEnd.toLocaleString(...getLocaleStringYearArgs($app));\n    if (startDateMonth === endDateMonth && startDateYear === endDateYear) {\n        return `${startDateMonth} ${startDateYear}`;\n    }\n    else if (startDateMonth !== endDateMonth && startDateYear === endDateYear) {\n        return `${startDateMonth}  ${endDateMonth} ${startDateYear}`;\n    }\n    return `${startDateMonth} ${startDateYear}  ${endDateMonth} ${endDateYear}`;\n};\nconst getMonthAndYearForSelectedDate = ($app) => {\n    const dateMonth = $app.datePickerState.selectedDate.value.toLocaleString(...getLocaleStringMonthArgs($app));\n    const dateYear = $app.datePickerState.selectedDate.value.toLocaleString(...getLocaleStringYearArgs($app));\n    return `${dateMonth} ${dateYear}`;\n};\n\nfunction RangeHeading() {\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext);\n    const [currentHeading, setCurrentHeading] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)('');\n    (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.useSignalEffect)(() => {\n        if ($app.calendarState.view.value === InternalViewName.Week) {\n            setCurrentHeading(getMonthAndYearForDateRange($app, $app.calendarState.range.value.start, $app.calendarState.range.value.end));\n        }\n        if ($app.calendarState.view.value === InternalViewName.MonthGrid ||\n            $app.calendarState.view.value === InternalViewName.Day ||\n            $app.calendarState.view.value === InternalViewName.MonthAgenda) {\n            setCurrentHeading(getMonthAndYearForSelectedDate($app));\n        }\n    });\n    return (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"span\", { className: 'sx__range-heading', children: currentHeading });\n}\n\nfunction TodayButton() {\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext);\n    const setToday = () => {\n        $app.datePickerState.selectedDate.value = Temporal.PlainDate.from(Temporal.Now.plainDateISO($app.config.timezone.value));\n    };\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"button\", { type: \"button\", className: 'sx__button sx__today-button sx__ripple', onClick: setToday, children: $app.translate('Today') }));\n}\n\nfunction ViewSelection() {\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext);\n    const viewSelectId = randomStringId();\n    const viewLabelId = randomStringId();\n    const [availableViews, setAvailableViews] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)([]);\n    (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.useSignalEffect)(() => {\n        if ($app.calendarState.isCalendarSmall.value) {\n            setAvailableViews($app.config.views.value.filter((view) => view.hasSmallScreenCompat));\n        }\n        else {\n            setAvailableViews($app.config.views.value.filter((view) => view.hasWideScreenCompat));\n        }\n    });\n    // Get initial selected view label to prevent layout shift\n    const getInitialSelectedViewLabel = () => {\n        const selectedView = $app.config.views.value.find((view) => view.name === $app.calendarState.view.value);\n        return selectedView ? $app.translate(selectedView.label) : '';\n    };\n    const [selectedViewLabel, setSelectedViewLabel] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)(getInitialSelectedViewLabel());\n    (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.useSignalEffect)(() => {\n        const selectedView = $app.config.views.value.find((view) => view.name === $app.calendarState.view.value);\n        if (!selectedView)\n            return;\n        setSelectedViewLabel($app.translate(selectedView.label));\n    });\n    const [isOpen, setIsOpen] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)(false);\n    const clickOutsideListener = (event) => {\n        const target = event.target;\n        if (target instanceof HTMLElement &&\n            !target.closest('.sx__view-selection')) {\n            setIsOpen(false);\n        }\n    };\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        document.addEventListener('click', clickOutsideListener);\n        return () => document.removeEventListener('click', clickOutsideListener);\n    }, []);\n    const handleClickOnSelectionItem = (viewName) => {\n        setIsOpen(false);\n        $app.calendarState.setView(viewName, $app.datePickerState.selectedDate.value);\n    };\n    const [viewSelectionItems, setViewSelectionItems] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)();\n    const [focusedViewIndex, setFocusedViewIndex] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)(0);\n    const handleSelectedViewKeyDown = (keyboardEvent) => {\n        if (isKeyEnterOrSpace(keyboardEvent)) {\n            setIsOpen(!isOpen);\n        }\n        setTimeout(() => {\n            var _a;\n            const allOptions = (_a = $app.elements.calendarWrapper) === null || _a === void 0 ? void 0 : _a.querySelectorAll('.sx__view-selection-item');\n            if (!allOptions)\n                return;\n            setViewSelectionItems(allOptions);\n            const firstOption = allOptions[0];\n            if (firstOption instanceof HTMLElement) {\n                setFocusedViewIndex(0);\n                firstOption.focus();\n            }\n        }, 50);\n    };\n    const navigateUpOrDown = (keyboardEvent, viewName) => {\n        if (!viewSelectionItems)\n            return;\n        if (keyboardEvent.key === 'ArrowDown') {\n            const nextOption = viewSelectionItems[focusedViewIndex + 1];\n            if (nextOption instanceof HTMLElement) {\n                setFocusedViewIndex(focusedViewIndex + 1);\n                nextOption.focus();\n            }\n        }\n        else if (keyboardEvent.key === 'ArrowUp') {\n            const prevOption = viewSelectionItems[focusedViewIndex - 1];\n            if (prevOption instanceof HTMLElement) {\n                setFocusedViewIndex(focusedViewIndex - 1);\n                prevOption.focus();\n            }\n        }\n        else if (isKeyEnterOrSpace(keyboardEvent)) {\n            handleClickOnSelectionItem(viewName);\n        }\n    };\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { className: `sx__view-selection ${isOpen ? 'is-open' : ''}`, children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"label\", { for: viewSelectId, id: viewLabelId, className: \"sx__view-selection-label\", children: $app.translate('View') }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { id: viewSelectId, tabIndex: 0, role: \"button\", \"aria-describedby\": viewLabelId, \"aria-label\": $app.translate('Select View'), className: \"sx__view-selection-selected-item sx__ripple\", onClick: () => setIsOpen(!isOpen), onKeyDown: handleSelectedViewKeyDown, children: [selectedViewLabel, (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"img\", { className: \"sx__view-selection-chevron\", src: img, alt: \"\" })] }), isOpen && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"ul\", { \"data-testid\": \"view-selection-items\", className: \"sx__view-selection-items\", children: availableViews.map((view) => ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"li\", { \"aria-label\": $app.translate('Select View') + ' ' + $app.translate(view.label), tabIndex: -1, role: \"button\", onKeyDown: (keyboardEvent) => navigateUpOrDown(keyboardEvent, view.name), onClick: () => handleClickOnSelectionItem(view.name), className: 'sx__view-selection-item' +\n                        (view.name === $app.calendarState.view.value\n                            ? ' is-selected'\n                            : ''), children: $app.translate(view.label) }))) }))] }));\n}\n\nfunction ForwardBackwardNavigation() {\n    var _a;\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext);\n    const navigate = (direction) => {\n        const currentView = $app.config.views.value.find((view) => view.name === $app.calendarState.view.value);\n        if (!currentView)\n            return;\n        $app.datePickerState.selectedDate.value = currentView.backwardForwardFn($app.datePickerState.selectedDate.value, direction === 'forwards'\n            ? currentView.backwardForwardUnits\n            : -currentView.backwardForwardUnits);\n    };\n    const [localizedRange, setLocalizedRange] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)('');\n    (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.useSignalEffect)(() => {\n        setLocalizedRange(`${getLocalizedDate$1($app.calendarState.range.value.start, $app.config.locale.value)} ${$app.translate('to')} ${getLocalizedDate$1($app.calendarState.range.value.end, $app.config.locale.value)}`);\n    });\n    const [rangeEndMinusOneRange, setRangeEndMinusOneRange] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)(null);\n    const [rangeStartPlusOneRange, setRangeStartPlusOneRange] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)(null);\n    (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.useSignalEffect)(() => {\n        const selectedView = $app.config.views.value.find((view) => view.name === $app.calendarState.view.value);\n        if (!selectedView)\n            return;\n        setRangeEndMinusOneRange(selectedView.setDateRange({\n            range: $app.calendarState.range,\n            calendarConfig: $app.config,\n            timeUnitsImpl: $app.timeUnitsImpl,\n            date: (() => {\n                const result = selectedView.backwardForwardFn($app.datePickerState.selectedDate.value, -selectedView.backwardForwardUnits);\n                return result instanceof Temporal.ZonedDateTime\n                    ? result.toPlainDate()\n                    : result;\n            })(),\n        }).end);\n        setRangeStartPlusOneRange(selectedView.setDateRange({\n            range: $app.calendarState.range,\n            calendarConfig: $app.config,\n            timeUnitsImpl: $app.timeUnitsImpl,\n            date: (() => {\n                const result = selectedView.backwardForwardFn($app.datePickerState.selectedDate.value, selectedView.backwardForwardUnits);\n                return result instanceof Temporal.ZonedDateTime\n                    ? result.toPlainDate()\n                    : result;\n            })(),\n        }).start);\n    });\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { className: \"sx__forward-backward-navigation\", \"aria-label\": localizedRange, \"aria-live\": \"polite\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(Chevron, { disabled: !!($app.config.minDate.value &&\n                        dateFromDateTime((_a = rangeEndMinusOneRange === null || rangeEndMinusOneRange === void 0 ? void 0 : rangeEndMinusOneRange.toString()) !== null && _a !== void 0 ? _a : '') <\n                            $app.config.minDate.value.toString()), onClick: () => navigate('backwards'), direction: 'previous', buttonText: $app.translate('Previous period') }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(Chevron, { disabled: !!($app.config.maxDate.value &&\n                        rangeStartPlusOneRange &&\n                        dateFromDateTime(rangeStartPlusOneRange.toString()) >\n                            $app.config.maxDate.value.toString()), onClick: () => navigate('forwards'), direction: 'next', buttonText: $app.translate('Next period') })] }) }));\n}\n\n/**\n * Get an element in the DOM by their custom component id\n * */\nconst getElementByCCID = (customComponentId) => document.querySelector(`[data-ccid=\"${customComponentId}\"]`);\n\nclass PreactView {\n    constructor(config) {\n        Object.defineProperty(this, \"randomId\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: randomStringId()\n        });\n        Object.defineProperty(this, \"name\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"label\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"Component\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"setDateRange\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"hasSmallScreenCompat\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"hasWideScreenCompat\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"backwardForwardFn\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"backwardForwardUnits\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.name = config.name;\n        this.label = config.label;\n        this.Component = config.Component;\n        this.setDateRange = config.setDateRange;\n        this.hasSmallScreenCompat = config.hasSmallScreenCompat;\n        this.hasWideScreenCompat = config.hasWideScreenCompat;\n        this.backwardForwardFn = config.backwardForwardFn;\n        this.backwardForwardUnits = config.backwardForwardUnits;\n    }\n    render(onElement, $app) {\n        (0,preact__WEBPACK_IMPORTED_MODULE_0__.render)((0,preact__WEBPACK_IMPORTED_MODULE_0__.createElement)(this.Component, { $app, id: this.randomId }), onElement);\n    }\n    destroy() {\n        const el = document.getElementById(this.randomId);\n        if (el) {\n            el.remove();\n        }\n    }\n}\nconst createPreactView = (config) => {\n    return new PreactView(config);\n};\n\nconst timePointToPercentage = (timePointsInDay, dayBoundaries, timePoint) => {\n    if (timePoint < dayBoundaries.start) {\n        const firstDayTimePoints = 2400 - dayBoundaries.start;\n        return ((timePoint + firstDayTimePoints) / timePointsInDay) * 100;\n    }\n    return ((timePoint - dayBoundaries.start) / timePointsInDay) * 100;\n};\n\nconst getEventHeight = (start, end, dayBoundaries, pointsPerDay) => {\n    if (start === end) {\n        return (timePointToPercentage(pointsPerDay, dayBoundaries, timePointsFromString(timeFromDateTime(addTimePointsToDateTime(end, 50).toString()))) -\n            timePointToPercentage(pointsPerDay, dayBoundaries, timePointsFromString(timeFromDateTime(start.toString()))));\n    }\n    return (timePointToPercentage(pointsPerDay, dayBoundaries, timePointsFromString(timeFromDateTime(end.toString()))) -\n        timePointToPercentage(pointsPerDay, dayBoundaries, timePointsFromString(timeFromDateTime(start.toString()))));\n};\nconst getInlineStartRule = (calendarEvent, eventWidth) => {\n    if (!calendarEvent._totalConcurrentEvents ||\n        !calendarEvent._previousConcurrentEvents)\n        return 0;\n    return (((calendarEvent._previousConcurrentEvents || 0) /\n        (calendarEvent._totalConcurrentEvents || 0)) *\n        eventWidth);\n};\nconst getWidthRule = (leftRule, eventWidth, maxConcurrentEvents, eventOverlap) => {\n    if (eventOverlap || !maxConcurrentEvents)\n        return eventWidth - leftRule;\n    return eventWidth / maxConcurrentEvents;\n};\nconst getBorderRule = (calendarEvent) => {\n    if (!calendarEvent._previousConcurrentEvents)\n        return 0;\n    return '1px solid #fff';\n};\n\nconst getTimeGridEventCopyElementId = (id) => {\n    return 'time-grid-event-copy-' + id;\n};\n\nconst isUIEventTouchEvent = (event) => {\n    return 'touches' in event && typeof event.touches === 'object';\n};\n\nfunction useEventInteractions($app) {\n    const [eventCopy, setEventCopy] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)();\n    const updateCopy = (newCopy) => {\n        if (!newCopy)\n            return setEventCopy(undefined);\n        setEventCopy(deepCloneEvent(newCopy, $app));\n    };\n    const [dragStartTimeout, setDragStartTimeout] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)();\n    const createDragStartTimeout = (callback, uiEvent) => {\n        setDragStartTimeout(setTimeout(() => callback(uiEvent), 150));\n    };\n    const setClickedEvent = (uiEvent, calendarEvent) => {\n        // For some reason, an event without touches is being triggered on touchend\n        if (isUIEventTouchEvent(uiEvent) &&\n            uiEvent.touches.length === 0)\n            return;\n        if (!$app.config.plugins.eventModal)\n            return;\n        const eventTarget = uiEvent.target;\n        if (!(eventTarget instanceof HTMLElement))\n            return;\n        const calendarEventElement = eventTarget.classList.contains('sx__event')\n            ? eventTarget\n            : eventTarget.closest('.sx__event');\n        if (calendarEventElement instanceof HTMLElement) {\n            $app.config.plugins.eventModal.calendarEventElement.value =\n                calendarEventElement;\n            $app.config.plugins.eventModal.setCalendarEvent(calendarEvent, calendarEventElement.getBoundingClientRect());\n        }\n    };\n    const setClickedEventIfNotDragging = (calendarEvent, uiEvent) => {\n        if (dragStartTimeout) {\n            clearTimeout(dragStartTimeout);\n            setClickedEvent(uiEvent, calendarEvent);\n        }\n        setDragStartTimeout(undefined);\n    };\n    return {\n        eventCopy,\n        updateCopy,\n        createDragStartTimeout,\n        setClickedEventIfNotDragging,\n        setClickedEvent,\n    };\n}\n\nconst getCCID = (customComponent, isCopy) => {\n    let customComponentId = customComponent\n        ? 'custom-time-grid-event-' + randomStringId() // needs a unique string to support event recurrence\n        : undefined;\n    if (customComponentId && isCopy)\n        customComponentId += '-' + 'copy';\n    return customComponentId;\n};\n\nconst invokeOnEventClickCallback = ($app, calendarEvent, e) => {\n    if ($app.config.callbacks.onEventClick) {\n        $app.config.callbacks.onEventClick(calendarEvent._getExternalEvent(), e);\n    }\n};\n\nconst invokeOnEventDoubleClickCallback = ($app, calendarEvent, e) => {\n    if ($app.config.callbacks.onDoubleClickEvent) {\n        $app.config.callbacks.onDoubleClickEvent(calendarEvent._getExternalEvent(), e);\n    }\n};\n\nconst getEventCoordinates = (uiEvent) => {\n    const actualEvent = isUIEventTouchEvent(uiEvent)\n        ? uiEvent.touches[0]\n        : uiEvent;\n    return {\n        clientX: actualEvent.clientX,\n        clientY: actualEvent.clientY,\n    };\n};\n\nconst getYCoordinateInTimeGrid = (dateTime, dayBoundaries, pointsPerDay) => {\n    return timePointToPercentage(pointsPerDay, dayBoundaries, timePointsFromString(timeFromDateTime(dateTime.toString())));\n};\n\n/**\n * Push a task to the end of the current call stack\n * */\nconst nextTick = (cb) => {\n    setTimeout(() => {\n        cb();\n    });\n};\n\nconst focusModal = ($app) => {\n    const calendarWrapper = $app.elements.calendarWrapper;\n    if (!(calendarWrapper instanceof HTMLElement))\n        return;\n    const eventModal = calendarWrapper.querySelector('.sx__event-modal');\n    if (!(eventModal instanceof HTMLElement))\n        return;\n    setTimeout(() => {\n        eventModal.focus();\n    }, 100);\n};\n\nconst wasEventAddedInLastSecond = (calendarEvent) => {\n    return (calendarEvent._createdAt &&\n        Date.now() - calendarEvent._createdAt.getTime() < 1000);\n};\n\nfunction TimeGridEvent({ calendarEvent, dayBoundariesDateTime, isCopy, setMouseDown, }) {\n    var _a, _b, _c, _d;\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext);\n    const eventRef = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useRef)(null);\n    const [isCompact, setIsCompact] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)(false);\n    const { eventCopy, updateCopy, createDragStartTimeout, setClickedEventIfNotDragging, setClickedEvent, } = useEventInteractions($app);\n    const localizeArgs = [\n        $app.config.locale.value,\n        { hour: 'numeric', minute: 'numeric' },\n    ];\n    const getEventTime = (start, end) => {\n        const localizedStartTime = start.toLocaleString(...localizeArgs);\n        if (start === end) {\n            return localizedStartTime;\n        }\n        const localizedEndTime = end.toLocaleString(...localizeArgs);\n        return `${localizedStartTime}  ${localizedEndTime}`;\n    };\n    const eventCSSVariables = {\n        borderInlineStart: `4px solid var(--sx-color-${calendarEvent._color})`,\n        textColor: `var(--sx-color-on-${calendarEvent._color}-container)`,\n        backgroundColor: `var(--sx-color-${calendarEvent._color}-container)`,\n        iconStroke: `var(--sx-color-on-${calendarEvent._color}-container)`,\n    };\n    const insetInlineStart = getInlineStartRule(calendarEvent, $app.config.weekOptions.value.eventWidth);\n    const handleStartDrag = (uiEvent) => {\n        var _a;\n        if (isUIEventTouchEvent(uiEvent))\n            uiEvent.preventDefault();\n        if (isCopy)\n            return;\n        if (!uiEvent.target)\n            return;\n        if (!$app.config.plugins.dragAndDrop)\n            return;\n        if ((_a = calendarEvent._options) === null || _a === void 0 ? void 0 : _a.disableDND)\n            return;\n        if (realStartIsBeforeDayBoundaryStart)\n            return; // Don't allow dragging events that start before the day boundary; it would require a bunch of adjustments in drag & drop plugin in order to look nice\n        const newEventCopy = deepCloneEvent(calendarEvent, $app);\n        updateCopy(newEventCopy);\n        $app.config.plugins.dragAndDrop.createTimeGridDragHandler({\n            $app,\n            eventCoordinates: getEventCoordinates(uiEvent),\n            updateCopy,\n            eventCopy: newEventCopy,\n        }, dayBoundariesDateTime);\n    };\n    const customComponent = $app.config._customComponentFns.timeGridEvent;\n    const customComponentId = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useRef)(getCCID(customComponent, isCopy));\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        if (!customComponent)\n            return;\n        customComponent(getElementByCCID(customComponentId.current), {\n            calendarEvent: calendarEvent._getExternalEvent(),\n        });\n        return () => {\n            var _a, _b;\n            (_b = (_a = $app.config)._destroyCustomComponentInstance) === null || _b === void 0 ? void 0 : _b.call(_a, customComponentId.current);\n        };\n    }, [calendarEvent, eventCopy]);\n    // ResizeObserver to detect when event height changes\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        if (!eventRef.current)\n            return;\n        const checkHeight = () => {\n            const element = eventRef.current;\n            if (!element)\n                return;\n            const height = element.offsetHeight;\n            const shouldBeCompact = height < 36;\n            setIsCompact(shouldBeCompact);\n        };\n        checkHeight();\n        const resizeObserver = new ResizeObserver(checkHeight);\n        resizeObserver.observe(eventRef.current);\n        return () => {\n            resizeObserver.disconnect();\n        };\n    }, [calendarEvent, eventCopy]);\n    const handleOnClick = (e) => {\n        e.stopPropagation();\n        invokeOnEventClickCallback($app, calendarEvent, e);\n    };\n    const handleOnDoubleClick = (e) => {\n        e.stopPropagation();\n        invokeOnEventDoubleClickCallback($app, calendarEvent, e);\n    };\n    const handleKeyDown = (e) => {\n        if (e.key === 'Enter' || e.key === ' ') {\n            e.stopPropagation();\n            setClickedEvent(e, calendarEvent);\n            invokeOnEventClickCallback($app, calendarEvent, e);\n            nextTick(() => {\n                focusModal($app);\n            });\n        }\n    };\n    const startResize = (e) => {\n        setMouseDown(true);\n        e.stopPropagation();\n        if (isCopy)\n            return;\n        if ($app.config.plugins.resize) {\n            const eventCopy = deepCloneEvent(calendarEvent, $app);\n            updateCopy(eventCopy);\n            $app.config.plugins.resize.createTimeGridEventResizer(eventCopy, updateCopy, e, dayBoundariesDateTime);\n        }\n    };\n    const borderRule = getBorderRule(calendarEvent);\n    const classNames = ['sx__time-grid-event', 'sx__event'];\n    if (wasEventAddedInLastSecond(calendarEvent))\n        classNames.push('is-event-new');\n    if (isCopy)\n        classNames.push('is-event-copy');\n    if (!$app.config.weekOptions.value.eventOverlap &&\n        calendarEvent._maxConcurrentEvents &&\n        calendarEvent._maxConcurrentEvents > 1)\n        classNames.push('is-event-overlap');\n    if ((_a = calendarEvent._options) === null || _a === void 0 ? void 0 : _a.additionalClasses)\n        classNames.push(...calendarEvent._options.additionalClasses);\n    const handlePointerDown = (e) => {\n        setMouseDown(true);\n        createDragStartTimeout(handleStartDrag, e);\n    };\n    const handlePointerUp = (e) => {\n        nextTick(() => setMouseDown(false));\n        setClickedEventIfNotDragging(calendarEvent, e);\n    };\n    const hasCustomContent = (_b = calendarEvent._customContent) === null || _b === void 0 ? void 0 : _b.timeGrid;\n    const realStartIsBeforeDayBoundaryStart = dayBoundariesDateTime &&\n        calendarEvent.start.toString() < dayBoundariesDateTime.start.toString() &&\n        calendarEvent.end.toString() >= dayBoundariesDateTime.start.toString();\n    const relativeStartWithinDayBoundary = realStartIsBeforeDayBoundaryStart\n        ? dayBoundariesDateTime === null || dayBoundariesDateTime === void 0 ? void 0 : dayBoundariesDateTime.start\n        : calendarEvent.start;\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { ref: eventRef, id: isCopy ? getTimeGridEventCopyElementId(calendarEvent.id) : undefined, \"data-event-id\": calendarEvent.id, onClick: handleOnClick, onDblClick: handleOnDoubleClick, onKeyDown: handleKeyDown, onMouseDown: handlePointerDown, onMouseUp: handlePointerUp, onTouchStart: handlePointerDown, onTouchEnd: handlePointerUp, className: classNames.join(' '), tabIndex: 0, role: \"button\", style: {\n                    top: `${getYCoordinateInTimeGrid(relativeStartWithinDayBoundary, $app.config.dayBoundaries.value, $app.config.timePointsPerDay)}%`,\n                    height: `${getEventHeight(relativeStartWithinDayBoundary, calendarEvent.end, $app.config.dayBoundaries.value, $app.config.timePointsPerDay)}%`,\n                    insetInlineStart: `${insetInlineStart}%`,\n                    width: `${getWidthRule(insetInlineStart, isCopy ? 100 : $app.config.weekOptions.value.eventWidth, calendarEvent._maxConcurrentEvents, $app.config.weekOptions.value.eventOverlap)}%`,\n                    backgroundColor: customComponent\n                        ? undefined\n                        : eventCSSVariables.backgroundColor,\n                    color: customComponent ? undefined : eventCSSVariables.textColor,\n                    borderTop: borderRule,\n                    borderInlineEnd: borderRule,\n                    borderBottom: borderRule,\n                    borderInlineStart: customComponent\n                        ? undefined\n                        : eventCSSVariables.borderInlineStart,\n                    padding: customComponent ? '0' : undefined,\n                }, children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { \"data-ccid\": customComponentId.current, className: \"sx__time-grid-event-inner\", children: [!customComponent && !hasCustomContent && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(preact__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: [isCompact && calendarEvent.title && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { className: \"sx__title-and-time-compact\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__time-grid-event-title\", children: calendarEvent.title }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__time-grid-event-time\", children: timeFn(calendarEvent.start, $app.config.locale.value) })] })), !isCompact && calendarEvent.title && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__time-grid-event-title\", children: calendarEvent.title })), (!isCompact || (isCompact && !calendarEvent.title)) && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { className: \"sx__time-grid-event-time\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(TimeIcon, { strokeColor: eventCSSVariables.iconStroke }), getEventTime(calendarEvent.start, calendarEvent.end)] })), calendarEvent.people && calendarEvent.people.length > 0 && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { className: \"sx__time-grid-event-people\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(UserIcon, { strokeColor: eventCSSVariables.iconStroke }), concatenatePeople(calendarEvent.people)] })), calendarEvent.location && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { className: \"sx__time-grid-event-location\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(LocationPinIcon, { strokeColor: eventCSSVariables.iconStroke }), calendarEvent.location] }))] })), hasCustomContent && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { dangerouslySetInnerHTML: {\n                                __html: ((_c = calendarEvent._customContent) === null || _c === void 0 ? void 0 : _c.timeGrid) || '',\n                            } })), $app.config.plugins.resize &&\n                            !((_d = calendarEvent._options) === null || _d === void 0 ? void 0 : _d.disableResize) && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: 'sx__time-grid-event-resize-handle', onMouseDown: startResize, onTouchStart: startResize }))] }) }), eventCopy && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(TimeGridEvent, { calendarEvent: eventCopy, isCopy: true, setMouseDown: setMouseDown, dayBoundariesDateTime: dayBoundariesDateTime }))] }));\n}\n\nconst sortEventsByStartAndEnd = (a, b) => {\n    if (a.start.toString() === b.start.toString()) {\n        if (a.end.toString() < b.end.toString())\n            return 1;\n        if (a.end.toString() > b.end.toString())\n            return -1;\n        return 0;\n    }\n    if (a.start.toString() < b.start.toString())\n        return -1;\n    if (a.start.toString() > b.start.toString())\n        return 1;\n    return 0;\n};\nconst sortEventsForMonthGrid = (a, b) => {\n    const aStartDate = dateFromDateTime(a.start.toString());\n    const bStartDate = dateFromDateTime(b.start.toString());\n    const aEndDate = dateFromDateTime(a.end.toString());\n    const bEndDate = dateFromDateTime(b.end.toString());\n    /**\n     * For events that start and end at the same day, sort them by their start time.\n     * If they only start on the same day but end on different days, the function needs to move on;\n     * an event that starts on 5am today, but ends in 5 days, needs to be placed before an event that starts\n     * today at 1am and ends later today. That way we avoid empty gaps in the grid.\n     * */\n    if (aStartDate === bStartDate && aEndDate === bEndDate) {\n        if (a.start.toString() < b.start.toString())\n            return -1;\n    }\n    if (aStartDate === bStartDate) {\n        if (aEndDate < bEndDate)\n            return 1;\n        if (aEndDate > bEndDate)\n            return -1;\n        return 0;\n    }\n    if (aStartDate < bStartDate)\n        return -1;\n    if (aStartDate > bStartDate)\n        return 1;\n    return 0;\n};\n\nconst areSameMinute = (start, end) => {\n    return (start.year === end.year &&\n        start.month === end.month &&\n        start.day === end.day &&\n        start.hour === end.hour &&\n        start.minute === end.minute);\n};\nconst isEvent0Minutes = (e) => {\n    return ((e === null || e === void 0 ? void 0 : e.start) instanceof Temporal.ZonedDateTime &&\n        (e === null || e === void 0 ? void 0 : e.end) instanceof Temporal.ZonedDateTime &&\n        areSameMinute(e.start, e.end));\n};\nconst areEvents0MinutesAndConcurrent = (e1, e2) => {\n    return (isEvent0Minutes(e1) &&\n        isEvent0Minutes(e2) &&\n        (e1 === null || e1 === void 0 ? void 0 : e1.start) instanceof Temporal.ZonedDateTime &&\n        (e2 === null || e2 === void 0 ? void 0 : e2.start) instanceof Temporal.ZonedDateTime &&\n        areSameMinute(e1.start, e2.start));\n};\n\nconst handleEventConcurrency = (sortedEvents, concurrentEventsCache = [], currentIndex = 0) => {\n    for (let i = currentIndex; i < sortedEvents.length; i++) {\n        const event = sortedEvents[i];\n        const nextEvent = sortedEvents[i + 1];\n        const areBothEventsZeroMinutes = areEvents0MinutesAndConcurrent(event, nextEvent);\n        if (concurrentEventsCache.length &&\n            (!nextEvent ||\n                (concurrentEventsCache.every((e) => e.end.epochNanoseconds <=\n                    nextEvent.start.epochNanoseconds) &&\n                    !areBothEventsZeroMinutes))) {\n            concurrentEventsCache.push(event);\n            for (let ii = 0; ii < concurrentEventsCache.length; ii++) {\n                const currentEvent = concurrentEventsCache[ii];\n                const NpreviousConcurrentEvents = concurrentEventsCache.filter((cachedEvent, index) => {\n                    if (cachedEvent === currentEvent || index > ii)\n                        return false;\n                    if (areEvents0MinutesAndConcurrent(cachedEvent, currentEvent))\n                        return true;\n                    return (cachedEvent.start.epochNanoseconds <=\n                        currentEvent.start\n                            .epochNanoseconds &&\n                        cachedEvent.end.epochNanoseconds >\n                            currentEvent.start.epochNanoseconds);\n                }).length;\n                const NupcomingConcurrentEvents = concurrentEventsCache.filter((cachedEvent, index) => {\n                    if (cachedEvent === currentEvent || index < ii)\n                        return false;\n                    if (areEvents0MinutesAndConcurrent(cachedEvent, currentEvent))\n                        return true;\n                    return (cachedEvent.start.epochNanoseconds <\n                        currentEvent.end.epochNanoseconds &&\n                        cachedEvent.end.epochNanoseconds >=\n                            currentEvent.start.epochNanoseconds);\n                }).length;\n                currentEvent._totalConcurrentEvents =\n                    NpreviousConcurrentEvents + NupcomingConcurrentEvents + 1;\n                currentEvent._previousConcurrentEvents = NpreviousConcurrentEvents;\n                // TODO v3: try to use _maxConcurrentEvents for both overlap/no overlap mode, and remove _totalConcurrentEvents\n                let maxOverlappingEvents = 0;\n                const timePoints = [];\n                concurrentEventsCache.forEach((cachedEvent) => {\n                    if ((cachedEvent.end.epochNanoseconds >\n                        currentEvent.start.epochNanoseconds &&\n                        cachedEvent.start.epochNanoseconds <\n                            currentEvent.end\n                                .epochNanoseconds) ||\n                        areEvents0MinutesAndConcurrent(cachedEvent, currentEvent)) {\n                        timePoints.push({\n                            time: cachedEvent.start.toString(),\n                            type: 'start',\n                        });\n                        timePoints.push({ time: cachedEvent.end.toString(), type: 'end' });\n                    }\n                });\n                timePoints.sort((a, b) => a.time.localeCompare(b.time) || (a.type === 'end' ? -1 : 1));\n                let currentOverlap = 0;\n                timePoints.forEach((point) => {\n                    if (point.type === 'start') {\n                        currentOverlap++;\n                        maxOverlappingEvents = Math.max(maxOverlappingEvents, currentOverlap);\n                    }\n                    else {\n                        currentOverlap--;\n                    }\n                });\n                currentEvent._maxConcurrentEvents = maxOverlappingEvents;\n            }\n            concurrentEventsCache = [];\n            return handleEventConcurrency(sortedEvents, concurrentEventsCache, i + 1);\n        }\n        if ((nextEvent &&\n            event.end.epochNanoseconds >\n                nextEvent.start.epochNanoseconds) ||\n            concurrentEventsCache.some((e) => e.end.epochNanoseconds >\n                event.start.epochNanoseconds) ||\n            areBothEventsZeroMinutes) {\n            concurrentEventsCache.push(event);\n            return handleEventConcurrency(sortedEvents, concurrentEventsCache, i + 1);\n        }\n        event._totalConcurrentEvents = 1;\n        event._previousConcurrentEvents = 0;\n        event._maxConcurrentEvents = 1;\n    }\n    return sortedEvents;\n};\n\nconst getClickDateTime = (e, $app, dayStartDateTime) => {\n    if (!(e.target instanceof HTMLElement))\n        return;\n    const DAY_GRID_CLASS_NAME = 'sx__time-grid-day';\n    const dayGridElement = e.target.classList.contains(DAY_GRID_CLASS_NAME)\n        ? e.target\n        : e.target.closest('.' + DAY_GRID_CLASS_NAME);\n    const clientY = e.clientY - dayGridElement.getBoundingClientRect().top;\n    const clickPercentageOfDay = (clientY / dayGridElement.getBoundingClientRect().height) * 100;\n    const clickTimePointsIntoDay = Math.round(($app.config.timePointsPerDay / 100) * clickPercentageOfDay);\n    return addTimePointsToDateTime(dayStartDateTime, clickTimePointsIntoDay);\n};\n\nconst getClassNameForWeekday = (weekday) => {\n    switch (weekday) {\n        case 1:\n            return 'sx__monday';\n        case 2:\n            return 'sx__tuesday';\n        case 3:\n            return 'sx__wednesday';\n        case 4:\n            return 'sx__thursday';\n        case 5:\n            return 'sx__friday';\n        case 6:\n            return 'sx__saturday';\n        case 7:\n            return 'sx__sunday';\n        default:\n            throw new Error(`Invalid weekday ${weekday}`);\n    }\n};\n\nfunction TimeGridBackgroundEvent({ backgroundEvent, date, }) {\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext);\n    let start = backgroundEvent.start;\n    let end = backgroundEvent.end;\n    const startIsAnotherDate = !isSameDay(start, Temporal.PlainDate.from(date));\n    const endIsAnotherDate = !isSameDay(end, Temporal.PlainDate.from(date));\n    // get YYYY-MM-DD from start and end and add 00:00 or 23:59, if the date is not the same as the date of the background event\n    // or if it's a full-day event\n    if (startIsAnotherDate || start instanceof Temporal.PlainDate) {\n        start = Temporal.ZonedDateTime.from({\n            year: Temporal.PlainDate.from(date).year,\n            month: Temporal.PlainDate.from(date).month,\n            day: Temporal.PlainDate.from(date).day,\n            hour: 0,\n            minute: 0,\n            second: 0,\n            timeZone: $app.config.timezone.value,\n        });\n    }\n    if (endIsAnotherDate || end instanceof Temporal.PlainDate) {\n        end = Temporal.ZonedDateTime.from({\n            year: Temporal.PlainDate.from(date).year,\n            month: Temporal.PlainDate.from(date).month,\n            day: Temporal.PlainDate.from(date).day,\n            hour: 23,\n            minute: 59,\n            second: 59,\n            timeZone: $app.config.timezone.value,\n        });\n    }\n    // adjust the start time according to the day boundaries\n    // otherwise the background event `top` is calculated incorrectly\n    const startHour = start.hour;\n    const startMinute = start.minute;\n    const formattedStart = `${startHour.toString().padStart(2, '0')}:${startMinute.toString().padStart(2, '0')}`;\n    const startTimePoints = timePointsFromString(formattedStart);\n    if (startTimePoints < $app.config.dayBoundaries.value.start) {\n        const updatedStart = timeStringFromTimePoints($app.config.dayBoundaries.value.start);\n        const updatedStartHour = updatedStart.split(':')[0];\n        const updatedStartMinute = updatedStart.split(':')[1];\n        start = Temporal.ZonedDateTime.from({\n            year: Temporal.PlainDate.from(date).year,\n            month: Temporal.PlainDate.from(date).month,\n            day: Temporal.PlainDate.from(date).day,\n            hour: +updatedStartHour,\n            minute: +updatedStartMinute,\n            second: 0,\n            timeZone: $app.config.timezone.value,\n        });\n    }\n    // when start and end datetimes are equal, the rendering of the background event can be skipped completely.\n    // otherwise, `height` is calculated as 5% (by `getEventHeight`) and this is misleading for a background event like \"out-of-office\" hours.\n    // This comparison is safe also for full-day background events, because earlier in code we add time (00:00 - 23:59) to full-day events, making start and end no longer equal in full-day event case.\n    if (start.toString() === end.toString()) {\n        return null;\n    }\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { class: \"sx__time-grid-background-event\", title: backgroundEvent.title, style: {\n                ...backgroundEvent.style,\n                position: 'absolute',\n                zIndex: 0,\n                top: `${getYCoordinateInTimeGrid(start, $app.config.dayBoundaries.value, $app.config.timePointsPerDay)}%`,\n                height: `${getEventHeight(start, end, $app.config.dayBoundaries.value, $app.config.timePointsPerDay)}%`,\n                width: '100%',\n            } }) }));\n}\n\nfunction TimeGridDay({ calendarEvents, date, backgroundEvents, }) {\n    /**\n     * The time grid day needs to keep track of whether the mousedown event happened on a calendar event, in order to prevent\n     * click events from firing when dragging an event.\n     * */\n    const [mouseDownOnChild, setMouseDownOnChild] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)(false);\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext);\n    const timeStringFromDayBoundary = timeStringFromTimePoints($app.config.dayBoundaries.value.start);\n    const timeStringFromDayBoundaryEnd = timeStringFromTimePoints($app.config.dayBoundaries.value.end);\n    const dayStartDateTime = date.with({\n        hour: +timeStringFromDayBoundary.split(':')[0],\n        minute: +timeStringFromDayBoundary.split(':')[1],\n    });\n    const endHour = +timeStringFromDayBoundaryEnd.split(':')[0];\n    const endWithAdjustedTime = date.with({\n        hour: endHour === 24 ? 23 : endHour,\n        minute: endHour === 24 ? 59 : +timeStringFromDayBoundaryEnd.split(':')[1],\n        second: endHour === 24 ? 59 : 0,\n    });\n    const dayEndDateTime = $app.config.isHybridDay\n        ? addDays(endWithAdjustedTime, 1)\n        : endWithAdjustedTime;\n    const dayBoundariesDateTime = {\n        start: dayStartDateTime,\n        end: dayEndDateTime,\n    };\n    const eventsWithConcurrency = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useMemo)(() => {\n        const sortedEvents = calendarEvents.sort(sortEventsByStartAndEnd);\n        return handleEventConcurrency(sortedEvents);\n    }, [calendarEvents]);\n    const handleOnClick = (e, callback) => {\n        if (!callback || mouseDownOnChild)\n            return;\n        const clickDateTime = getClickDateTime(e, $app, dayStartDateTime);\n        if (clickDateTime) {\n            callback(clickDateTime, e);\n        }\n    };\n    const handleMouseDown = (e) => {\n        const callback = $app.config.callbacks.onMouseDownDateTime;\n        if (!callback || mouseDownOnChild)\n            return;\n        const clickDateTime = getClickDateTime(e, $app, dayStartDateTime);\n        if (clickDateTime) {\n            callback(clickDateTime, e);\n        }\n    };\n    const handlePointerUp = () => {\n        const msWaitToEnsureThatClickEventWasDispatched = 10;\n        setTimeout(() => {\n            setMouseDownOnChild(false);\n        }, msWaitToEnsureThatClickEventWasDispatched);\n    };\n    const baseClasses = [\n        'sx__time-grid-day',\n        getClassNameForWeekday(date.dayOfWeek),\n    ];\n    const classNames = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.useComputed)(() => {\n        const newClassNames = [...baseClasses];\n        if (isSameDay($app.datePickerState.selectedDate.value, date))\n            newClassNames.push('is-selected');\n        return newClassNames;\n    });\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { className: classNames.value.join(' '), \"data-time-grid-date\": toDateString$1(date), onClick: (e) => handleOnClick(e, $app.config.callbacks.onClickDateTime), onDblClick: (e) => handleOnClick(e, $app.config.callbacks.onDoubleClickDateTime), \"aria-label\": getLocalizedDate$1(date, $app.config.locale.value), onMouseLeave: () => setMouseDownOnChild(false), onMouseUp: handlePointerUp, onTouchEnd: handlePointerUp, onMouseDown: handleMouseDown, children: [backgroundEvents.map((event) => ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(TimeGridBackgroundEvent, { backgroundEvent: event, date: date.toString() }) }))), eventsWithConcurrency.map((event) => ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(TimeGridEvent, { calendarEvent: event, dayBoundariesDateTime: dayBoundariesDateTime, setMouseDown: setMouseDownOnChild }, event.id)))] }));\n}\n\nconst getTimeAxisHours = ({ start, end }, isHybridDay) => {\n    const hours = [];\n    let hour = Math.floor(start / 100);\n    if (isHybridDay) {\n        while (hour < 24) {\n            hours.push(hour);\n            hour += 1;\n        }\n        hour = 0;\n    }\n    const lastHour = end === 0 ? 24 : Math.ceil(end / 100);\n    while (hour < lastHour) {\n        hours.push(hour);\n        hour += 1;\n    }\n    return hours;\n};\n\nfunction TimeAxis() {\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext);\n    const [gridSteps, setGridSteps] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)([]);\n    (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.useSignalEffect)(() => {\n        const hourSteps = getTimeAxisHours($app.config.dayBoundaries.value, $app.config.isHybridDay);\n        const result = [];\n        hourSteps.forEach((hour) => {\n            if ($app.config.weekOptions.value.gridStep === 60) {\n                result.push({ hour: hour, minute: 0 });\n            }\n            if ($app.config.weekOptions.value.gridStep === 30) {\n                result.push({ hour: hour, minute: 0 }, { hour: hour, minute: 30 });\n            }\n            if ($app.config.weekOptions.value.gridStep === 15) {\n                result.push({ hour: hour, minute: 0 }, { hour: hour, minute: 15 }, { hour: hour, minute: 30 }, { hour: hour, minute: 45 });\n            }\n        });\n        setGridSteps(result);\n        const pixelsPerGridStep = $app.config.weekOptions.value.gridHeight / result.length;\n        // TODO v4: rename --sx-week-grid-hour-height to --sx-week-grid-grid-step-height\n        document.documentElement.style.setProperty('--sx-week-grid-hour-height', `${pixelsPerGridStep}px`);\n    });\n    const formatter = new Intl.DateTimeFormat($app.config.locale.value, $app.config.weekOptions.value.timeAxisFormatOptions);\n    const hourCustomComponentFn = $app.config._customComponentFns.weekGridHour;\n    const hourCCIDs = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useMemo)(() => {\n        if (!hourCustomComponentFn)\n            return [];\n        return gridSteps.map(() => `custom-week-grid-hour-${randomStringId()}`);\n    }, [gridSteps]);\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        if (hourCustomComponentFn && hourCCIDs.length) {\n            gridSteps.forEach((gridStep, idx) => {\n                const el = document.querySelector(`[data-ccid=\"${hourCCIDs[idx]}\"]`);\n                if (!(el instanceof HTMLElement)) {\n                    return console.warn('Could not find element for custom component weekGridHour');\n                }\n                hourCustomComponentFn(el, { hour: gridStep.hour, gridStep });\n            });\n        }\n    }, [gridSteps, hourCCIDs]);\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__week-grid__time-axis\", children: gridSteps.map((gridStep, index) => ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { className: \"sx__week-grid__hour\", children: [hourCustomComponentFn && hourCCIDs.length && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { \"data-ccid\": hourCCIDs[index] })), !hourCustomComponentFn && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"span\", { className: \"sx__week-grid__hour-text\", children: formatter.format(new Date(0, 0, 0, gridStep.hour, gridStep.minute)) }))] }))) }) }));\n}\n\nfunction DateAxis({ week }) {\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext);\n    const getClassNames = (date) => {\n        const classNames = [\n            'sx__week-grid__date',\n            getClassNameForWeekday(date.dayOfWeek),\n        ];\n        if (isToday(date, $app.config.timezone.value)) {\n            classNames.push('sx__week-grid__date--is-today');\n        }\n        return classNames.join(' ');\n    };\n    const weekGridDateCustomComponentFn = $app.config._customComponentFns.weekGridDate;\n    const weekGridDateCCIDs = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)(() => Array.from({ length: 7 }, () => `custom-week-grid-date-${randomStringId()}`));\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        if (weekGridDateCustomComponentFn) {\n            week.forEach((date, idx) => {\n                const el = document.querySelector(`[data-ccid=\"${weekGridDateCCIDs[0][idx]}\"]`);\n                if (!(el instanceof HTMLElement)) {\n                    return console.warn('Could not find element for custom component weekGridDate');\n                }\n                weekGridDateCustomComponentFn(el, {\n                    date: toDateString$1(date),\n                });\n            });\n        }\n    }, [week]);\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__week-grid__date-axis\", children: week.map((date, idx) => ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { className: getClassNames(date), \"data-date\": toDateString$1(date), children: [weekGridDateCustomComponentFn && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { \"data-ccid\": weekGridDateCCIDs[0][idx] })), !weekGridDateCustomComponentFn && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__week-grid__day-name\", children: getDayNameShort(date, $app.config.locale.value) }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__week-grid__date-number\", children: date.day })] }))] }))) }) }));\n}\n\nconst sortEventsForWeekView = (allCalendarEvents) => {\n    const dateGridEvents = [];\n    const timeGridEvents = [];\n    for (const event of allCalendarEvents) {\n        if (event._isSingleDayTimed || event._isSingleHybridDayTimed) {\n            timeGridEvents.push(event);\n            continue;\n        }\n        if (event._isSingleDayFullDay ||\n            event._isMultiDayFullDay ||\n            event._isMultiDayTimed) {\n            dateGridEvents.push(event);\n        }\n    }\n    return { timeGridEvents, dateGridEvents };\n};\n\nconst createOneDay = (week, date) => {\n    const dateString = toDateString$1(date);\n    week[dateString] = {\n        date: dateString,\n        timeGridEvents: [],\n        dateGridEvents: {},\n        backgroundEvents: [],\n    };\n    return week;\n};\nconst createWeek = ($app) => {\n    if ($app.calendarState.view.value === InternalViewName.Day)\n        return createOneDay({}, $app.calendarState.range.value.start);\n    // Week mode\n    return $app.timeUnitsImpl\n        .getWeekFor($app.datePickerState.selectedDate.value)\n        .slice(0, $app.config.weekOptions.value.nDays)\n        .reduce(createOneDay, {});\n};\n\nconst positionInTimeGrid = (timeGridEvents, week, $app) => {\n    var _a;\n    for (const event of timeGridEvents) {\n        const range = $app.calendarState.range.value;\n        if (event.start.epochNanoseconds >=\n            range.start.epochNanoseconds &&\n            event.end.epochNanoseconds <=\n                range.end.epochNanoseconds) {\n            let date = dateFromDateTime(event.start.toString());\n            if ($app.config.isHybridDay) {\n                const { year, month, date: day } = toIntegers(date);\n                const previousDayStart = `${addDays(Temporal.PlainDate.from({ year, month: month + 1, day }), -1)} ${timeStringFromTimePoints($app.config.dayBoundaries.value.start)}`;\n                const previousDayEnd = `${date} ${timeStringFromTimePoints($app.config.dayBoundaries.value.end)}`;\n                const actualDayStart = `${date} ${timeStringFromTimePoints($app.config.dayBoundaries.value.start)}`;\n                const eventStartZDT = event.start;\n                const eventStartFloating = `${eventStartZDT.year}-${doubleDigit(eventStartZDT.month)}-${doubleDigit(eventStartZDT.day)} ${doubleDigit(eventStartZDT.hour)}:${doubleDigit(eventStartZDT.minute)}`;\n                if (eventStartFloating > previousDayStart &&\n                    eventStartFloating < previousDayEnd &&\n                    eventStartFloating < actualDayStart) {\n                    const { year, month, date: day } = toIntegers(date);\n                    date = dateFromDateTime(addDays(Temporal.PlainDate.from({ year, month: month + 1, day }), -1).toString());\n                }\n            }\n            (_a = week[date]) === null || _a === void 0 ? void 0 : _a.timeGridEvents.push(event);\n        }\n    }\n    return week;\n};\n\nInternalViewName.Week;\nconst DEFAULT_DAY_BOUNDARIES = {\n    start: 0,\n    end: 2400,\n};\nconst DEFAULT_WEEK_GRID_HEIGHT = 1600;\nconst DATE_GRID_BLOCKER = 'blocker';\n\n/**\n * Create a table-like representation of the week, where each cell can hold a full-day event or multiple-day-timed event.\n * If an event lasts more than one day, it creates blockers in the grid for its subsequent days, so that events don't collide.\n * For example:\n *\n * |  Mo    | Tue    |   We   |  Thu   |  Fri   | Sat    | Sun    |\n * | e1     | blocker| blocker| blocker| blocker| blocker| blocker|\n * |        |  e2    | blocker|        |  e4    |        |        |\n * |        |        |  e3    |        |        |        |        |\n * */\nconst positionInDateGrid = (sortedDateGridEvents, week) => {\n    const weekDates = Object.keys(week).sort();\n    const firstDateOfWeek = weekDates[0];\n    const lastDateOfWeek = weekDates[weekDates.length - 1];\n    const occupiedLevels = new Set();\n    for (const event of sortedDateGridEvents) {\n        const eventOriginalStartDate = dateFromDateTime(event.start.toString());\n        const eventOriginalEndDate = dateFromDateTime(event.end.toString());\n        const isEventStartInWeek = !!week[eventOriginalStartDate];\n        let isEventInWeek = isEventStartInWeek;\n        if (!isEventStartInWeek &&\n            eventOriginalStartDate < firstDateOfWeek &&\n            eventOriginalEndDate >= firstDateOfWeek) {\n            isEventInWeek = true;\n        }\n        if (!isEventInWeek)\n            continue;\n        const firstDateOfEvent = isEventStartInWeek\n            ? eventOriginalStartDate\n            : firstDateOfWeek;\n        const lastDateOfEvent = eventOriginalEndDate <= lastDateOfWeek\n            ? eventOriginalEndDate\n            : lastDateOfWeek;\n        const eventDays = Object.values(week).filter((day) => {\n            return day.date >= firstDateOfEvent && day.date <= lastDateOfEvent;\n        });\n        let levelInWeekForEvent;\n        let testLevel = 0;\n        while (levelInWeekForEvent === undefined) {\n            const isLevelFree = eventDays.every((day) => {\n                return !day.dateGridEvents[testLevel];\n            });\n            if (isLevelFree) {\n                levelInWeekForEvent = testLevel;\n                occupiedLevels.add(testLevel);\n            }\n            else\n                testLevel++;\n        }\n        for (const [eventDayIndex, eventDay] of eventDays.entries()) {\n            if (eventDayIndex === 0) {\n                event._nDaysInGrid = eventDays.length;\n                eventDay.dateGridEvents[levelInWeekForEvent] = event;\n            }\n            else {\n                eventDay.dateGridEvents[levelInWeekForEvent] = DATE_GRID_BLOCKER;\n            }\n        }\n    }\n    for (const level of Array.from(occupiedLevels)) {\n        for (const [, day] of Object.entries(week)) {\n            if (!day.dateGridEvents[level]) {\n                day.dateGridEvents[level] = undefined;\n            }\n        }\n    }\n    return week;\n};\n\nconst getWidthToSubtract = (hasOverflowLeft, hasOverflowRight, enableOverflowSubtraction) => {\n    let widthToSubtract = 2; // 2px for all events, to leave some space between them\n    const eventOverflowMargin = 10; // CORRELATION ID: 1\n    if (hasOverflowLeft && enableOverflowSubtraction)\n        widthToSubtract += eventOverflowMargin;\n    if (hasOverflowRight && enableOverflowSubtraction)\n        widthToSubtract += eventOverflowMargin;\n    return widthToSubtract;\n};\nconst getBorderRadius = (hasOverflowLeft, hasOverflowRight, forceZeroRule) => {\n    return {\n        borderBottomLeftRadius: hasOverflowLeft || forceZeroRule ? 0 : undefined,\n        borderTopLeftRadius: hasOverflowLeft || forceZeroRule ? 0 : undefined,\n        borderBottomRightRadius: hasOverflowRight || forceZeroRule ? 0 : undefined,\n        borderTopRightRadius: hasOverflowRight || forceZeroRule ? 0 : undefined,\n    };\n};\n\nfunction DateGridEvent({ calendarEvent, gridRow, isCopy, }) {\n    var _a, _b, _c, _d;\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext);\n    const { eventCopy, updateCopy, createDragStartTimeout, setClickedEventIfNotDragging, setClickedEvent, } = useEventInteractions($app);\n    const eventCSSVariables = {\n        borderInlineStart: `4px solid var(--sx-color-${calendarEvent._color})`,\n        color: `var(--sx-color-on-${calendarEvent._color}-container)`,\n        backgroundColor: `var(--sx-color-${calendarEvent._color}-container)`,\n    };\n    const handleStartDrag = (uiEvent) => {\n        var _a;\n        if (!$app.config.plugins.dragAndDrop)\n            return;\n        if ((_a = calendarEvent._options) === null || _a === void 0 ? void 0 : _a.disableDND)\n            return;\n        if (isUIEventTouchEvent(uiEvent))\n            uiEvent.preventDefault();\n        const newEventCopy = deepCloneEvent(calendarEvent, $app);\n        updateCopy(newEventCopy);\n        $app.config.plugins.dragAndDrop.createDateGridDragHandler({\n            eventCoordinates: getEventCoordinates(uiEvent),\n            eventCopy: newEventCopy,\n            updateCopy,\n            $app,\n        });\n    };\n    const rangeStartForComparison = calendarEvent.start instanceof Temporal.ZonedDateTime\n        ? $app.calendarState.range.value.start.toString()\n        : Temporal.PlainDate.from({\n            year: $app.calendarState.range.value.start.year,\n            month: $app.calendarState.range.value.start.month,\n            day: $app.calendarState.range.value.start.day,\n        }).toString();\n    const rangeEndForComparison = calendarEvent.end instanceof Temporal.ZonedDateTime\n        ? $app.calendarState.range.value.end.toString()\n        : Temporal.PlainDate.from({\n            year: $app.calendarState.range.value.end.year,\n            month: $app.calendarState.range.value.end.month,\n            day: $app.calendarState.range.value.end.day,\n        }).toString();\n    const startsBeforeWeek = calendarEvent.start.toString() < rangeStartForComparison;\n    const endsAfterWeek = calendarEvent.end.toString() > rangeEndForComparison;\n    const hasOverflowLeft = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useMemo)(() => {\n        if ($app.config.direction === 'ltr') {\n            return startsBeforeWeek;\n        }\n        return endsAfterWeek;\n    }, [startsBeforeWeek, endsAfterWeek]);\n    const hasOverflowRight = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useMemo)(() => {\n        if ($app.config.direction === 'ltr') {\n            return endsAfterWeek;\n        }\n        return startsBeforeWeek;\n    }, [startsBeforeWeek, endsAfterWeek]);\n    const overflowStyles = { backgroundColor: eventCSSVariables.backgroundColor };\n    const customComponent = $app.config._customComponentFns.dateGridEvent;\n    const customComponentId = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useRef)(customComponent\n        ? 'custom-date-grid-event-' + randomStringId() // needs a unique string to support event recurrence\n        : undefined);\n    if (isCopy && customComponentId.current)\n        customComponentId.current += '-copy';\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        if (!customComponent)\n            return;\n        customComponent(getElementByCCID(customComponentId.current), {\n            calendarEvent: calendarEvent._getExternalEvent(),\n        });\n        return () => {\n            var _a, _b;\n            (_b = (_a = $app.config)._destroyCustomComponentInstance) === null || _b === void 0 ? void 0 : _b.call(_a, customComponentId.current);\n        };\n    }, [calendarEvent, eventCopy]);\n    const startResize = (mouseEvent) => {\n        mouseEvent.stopPropagation();\n        const eventCopy = deepCloneEvent(calendarEvent, $app);\n        updateCopy(eventCopy);\n        $app.config.plugins.resize.createDateGridEventResizer(eventCopy, updateCopy, mouseEvent);\n    };\n    const handleKeyDown = (e) => {\n        if (e.key === 'Enter' || e.key === ' ') {\n            e.stopPropagation();\n            setClickedEvent(e, calendarEvent);\n            invokeOnEventClickCallback($app, calendarEvent, e);\n            nextTick(() => {\n                focusModal($app);\n            });\n        }\n    };\n    const eventClasses = [\n        'sx__event',\n        'sx__date-grid-event',\n        'sx__date-grid-cell',\n    ];\n    if (isCopy)\n        eventClasses.push('sx__date-grid-event--copy');\n    if (wasEventAddedInLastSecond(calendarEvent))\n        eventClasses.push('is-event-new');\n    if (hasOverflowLeft)\n        eventClasses.push('sx__date-grid-event--overflow-left');\n    if (hasOverflowRight)\n        eventClasses.push('sx__date-grid-event--overflow-right');\n    if ((_a = calendarEvent._options) === null || _a === void 0 ? void 0 : _a.additionalClasses)\n        eventClasses.push(...calendarEvent._options.additionalClasses);\n    const borderInlineStartNonCustom = startsBeforeWeek\n        ? 'none'\n        : eventCSSVariables.borderInlineStart;\n    const hasCustomContent = (_b = calendarEvent._customContent) === null || _b === void 0 ? void 0 : _b.dateGrid;\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { id: isCopy ? getTimeGridEventCopyElementId(calendarEvent.id) : undefined, tabIndex: 0, \"aria-label\": calendarEvent.title +\n                    ' ' +\n                    getTimeStamp(calendarEvent, $app.config.locale.value, $app.translate('to')), role: \"button\", \"data-ccid\": customComponentId.current, \"data-event-id\": calendarEvent.id, onMouseDown: (e) => createDragStartTimeout(handleStartDrag, e), onMouseUp: (e) => setClickedEventIfNotDragging(calendarEvent, e), onTouchStart: (e) => createDragStartTimeout(handleStartDrag, e), onTouchEnd: (e) => setClickedEventIfNotDragging(calendarEvent, e), onClick: (e) => invokeOnEventClickCallback($app, calendarEvent, e), onDblClick: (e) => invokeOnEventDoubleClickCallback($app, calendarEvent, e), onKeyDown: handleKeyDown, className: eventClasses.join(' '), style: {\n                    width: `calc(${calendarEvent._nDaysInGrid * 100}% - ${getWidthToSubtract(hasOverflowLeft, hasOverflowRight, !customComponent)}px)`,\n                    gridRow,\n                    display: eventCopy ? 'none' : 'flex',\n                    padding: customComponent ? '0px' : undefined,\n                    borderInlineStart: customComponent\n                        ? undefined\n                        : borderInlineStartNonCustom,\n                    color: customComponent ? undefined : eventCSSVariables.color,\n                    backgroundColor: customComponent\n                        ? undefined\n                        : eventCSSVariables.backgroundColor,\n                    ...getBorderRadius(hasOverflowLeft, hasOverflowRight, !!customComponent),\n                }, children: [!customComponent && !hasCustomContent && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(preact__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: [hasOverflowLeft && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: 'sx__date-grid-event--left-overflow', style: overflowStyles })), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"span\", { className: \"sx__date-grid-event-text\", children: [calendarEvent.title, \" \\u00A0\", calendarEvent.start instanceof Temporal.ZonedDateTime && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"span\", { className: \"sx__date-grid-event-time\", children: timeFn(calendarEvent.start, $app.config.locale.value) }))] }), hasOverflowRight && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: 'sx__date-grid-event--right-overflow', style: overflowStyles }))] })), hasCustomContent && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { dangerouslySetInnerHTML: {\n                            __html: ((_c = calendarEvent._customContent) === null || _c === void 0 ? void 0 : _c.dateGrid) || '',\n                        } })), $app.config.plugins.resize &&\n                        !((_d = calendarEvent._options) === null || _d === void 0 ? void 0 : _d.disableResize) &&\n                        !endsAfterWeek && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__date-grid-event-resize-handle\", onMouseDown: startResize, onTouchStart: startResize }))] }), eventCopy && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(DateGridEvent, { calendarEvent: eventCopy, gridRow: gridRow, isCopy: true }))] }));\n}\n\nfunction DateGridDay({ calendarEvents, date, backgroundEvents, }) {\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext);\n    const dateStart = Temporal.ZonedDateTime.from({\n        year: Temporal.PlainDate.from(date).year,\n        month: Temporal.PlainDate.from(date).month,\n        day: Temporal.PlainDate.from(date).day,\n        hour: $app.config.dayBoundaries.value.start === 0\n            ? 0\n            : $app.config.dayBoundaries.value.start / 100,\n        minute: 0,\n        second: 0,\n        timeZone: $app.config.timezone.value,\n    });\n    let dateEnd = Temporal.ZonedDateTime.from({\n        year: Temporal.PlainDate.from(date).year,\n        month: Temporal.PlainDate.from(date).month,\n        day: Temporal.PlainDate.from(date).day,\n        hour: $app.config.dayBoundaries.value.end === 2400\n            ? 23\n            : $app.config.dayBoundaries.value.end / 100,\n        minute: $app.config.dayBoundaries.value.end === 2400 ? 59 : 0,\n        second: $app.config.dayBoundaries.value.end === 2400 ? 59 : 0,\n        timeZone: $app.config.timezone.value,\n    });\n    if ($app.config.isHybridDay) {\n        dateEnd = dateEnd.add({ days: 1 });\n    }\n    const fullDayBackgroundEvent = backgroundEvents.find((event) => {\n        const eventStartWithTime = event.start instanceof Temporal.PlainDate\n            ? event.start.toZonedDateTime($app.config.timezone.value)\n            : event.start;\n        const eventEndWithTime = event.end instanceof Temporal.PlainDate\n            ? event.end.toZonedDateTime($app.config.timezone.value).with({\n                hour: 23,\n                minute: 59,\n                second: 59,\n            })\n            : event.end;\n        return (eventStartWithTime.toString() <= dateStart.toString() &&\n            eventEndWithTime.toString() >= dateEnd.toString());\n    });\n    const handleMouseDown = (e) => {\n        const callback = $app.config.callbacks.onMouseDownDateGridDate;\n        if (!callback)\n            return;\n        callback(Temporal.PlainDate.from(date), e);\n    };\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { className: \"sx__date-grid-day\", \"data-date-grid-date\": date, children: [fullDayBackgroundEvent && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__date-grid-background-event\", title: fullDayBackgroundEvent.title, style: {\n                    ...fullDayBackgroundEvent.style,\n                } })), Object.values(calendarEvents).map((event, index) => {\n                if (event === DATE_GRID_BLOCKER || !event)\n                    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__date-grid-cell\", style: { gridRow: index + 1 }, onMouseDown: handleMouseDown }));\n                return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(DateGridEvent, { calendarEvent: event, gridRow: index + 1 }, event.start.toString() + event.end.toString() + index));\n            }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: 'sx__spacer', onMouseDown: handleMouseDown })] }));\n}\n\nconst filterByRange = (events, range, timezone) => {\n    return events.filter((event) => {\n        const rangeStart = range.start;\n        const rangeEnd = range.end;\n        let eventStart = event.start;\n        let eventEnd = event.end;\n        // Convert PlainDate to ZonedDateTime with start time 00:00:00\n        if (eventStart instanceof Temporal.PlainDate) {\n            eventStart = eventStart.toZonedDateTime(timezone);\n        }\n        // Convert PlainDate to ZonedDateTime with end time 23:59:59\n        if (eventEnd instanceof Temporal.PlainDate) {\n            eventEnd = eventEnd.toZonedDateTime(timezone).with({\n                hour: 23,\n                minute: 59,\n                second: 59,\n                millisecond: 999,\n                microsecond: 999,\n                nanosecond: 999,\n            });\n        }\n        const eventStartsInRange = eventStart.epochNanoseconds >= rangeStart.epochNanoseconds &&\n            eventStart.epochNanoseconds <= rangeEnd.epochNanoseconds;\n        const eventEndInRange = eventEnd.epochNanoseconds >= rangeStart.epochNanoseconds &&\n            eventEnd.epochNanoseconds <= rangeEnd.epochNanoseconds;\n        const eventStartBeforeAndEventEndAfterRange = eventStart.epochNanoseconds < rangeStart.epochNanoseconds &&\n            eventEnd.epochNanoseconds > rangeEnd.epochNanoseconds;\n        return (eventStartsInRange ||\n            eventEndInRange ||\n            eventStartBeforeAndEventEndAfterRange);\n    });\n};\n\nconst WeekWrapper = ({ $app, id }) => {\n    document.documentElement.style.setProperty('--sx-week-grid-height', `${$app.config.weekOptions.value.gridHeight}px`);\n    const week = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.useComputed)(() => {\n        var _a, _b;\n        const rangeStart = (_a = $app.calendarState.range.value) === null || _a === void 0 ? void 0 : _a.start;\n        const rangeEnd = (_b = $app.calendarState.range.value) === null || _b === void 0 ? void 0 : _b.end;\n        if (!rangeStart || !rangeEnd)\n            return {};\n        let newWeek = createWeek($app);\n        const filteredEvents = $app.calendarEvents.filterPredicate.value\n            ? $app.calendarEvents.list.value.filter($app.calendarEvents.filterPredicate.value)\n            : $app.calendarEvents.list.value;\n        const { dateGridEvents, timeGridEvents } = sortEventsForWeekView(filteredEvents);\n        newWeek = positionInDateGrid(dateGridEvents.sort(sortEventsByStartAndEnd), newWeek);\n        Object.entries(newWeek).forEach(([date, day]) => {\n            const plainDate = Temporal.PlainDate.from(date);\n            const rangeStartDateTime = Temporal.ZonedDateTime.from({\n                year: plainDate.year,\n                month: plainDate.month,\n                day: plainDate.day,\n                hour: $app.config.dayBoundaries.value.start === 0\n                    ? 0\n                    : $app.config.dayBoundaries.value.start / 100,\n                minute: 0,\n                second: 0,\n                timeZone: $app.config.timezone.value,\n            });\n            let rangeEndDateTime = Temporal.ZonedDateTime.from({\n                year: plainDate.year,\n                month: plainDate.month,\n                day: plainDate.day,\n                hour: $app.config.dayBoundaries.value.end === 2400\n                    ? 23\n                    : $app.config.dayBoundaries.value.end / 100,\n                minute: $app.config.dayBoundaries.value.end === 2400 ? 59 : 0,\n                second: $app.config.dayBoundaries.value.end === 2400 ? 59 : 0,\n                timeZone: $app.config.timezone.value,\n            });\n            if ($app.config.isHybridDay) {\n                rangeEndDateTime = rangeEndDateTime.add({ days: 1 });\n            }\n            day.backgroundEvents = filterByRange($app.calendarEvents.backgroundEvents.value, {\n                start: rangeStartDateTime,\n                end: rangeEndDateTime,\n            }, $app.config.timezone.value);\n        });\n        newWeek = positionInTimeGrid(timeGridEvents, newWeek, $app);\n        return newWeek;\n    });\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(AppContext.Provider, { value: $app, children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { className: \"sx__week-wrapper\", id: id, children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__week-header\", children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { className: \"sx__week-header-content\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(DateAxis, { week: Object.values(week.value).map((day) => {\n                                        const plainDate = Temporal.PlainDate.from(day.date);\n                                        return Temporal.ZonedDateTime.from({\n                                            year: plainDate.year,\n                                            month: plainDate.month,\n                                            day: plainDate.day,\n                                            timeZone: $app.config.timezone.value,\n                                        });\n                                    }) }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__date-grid\", \"aria-label\": $app.translate('Full day- and multiple day events'), children: Object.values(week.value).map((day) => ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(DateGridDay, { date: day.date, calendarEvents: day.dateGridEvents, backgroundEvents: day.backgroundEvents }, day.date))) }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__week-header-border\" })] }) }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { className: \"sx__week-grid\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(TimeAxis, {}), Object.values(week.value).map((day) => {\n                                const { year, month, date } = toIntegers(day.date);\n                                const zonedDateTime = Temporal.ZonedDateTime.from({\n                                    year,\n                                    month: month + 1,\n                                    day: date,\n                                    timeZone: $app.config.timezone.value,\n                                });\n                                return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(TimeGridDay, { calendarEvents: day.timeGridEvents, backgroundEvents: day.backgroundEvents, date: zonedDateTime }, day.date));\n                            })] })] }) }) }));\n};\n\nconst getRangeStartGivenDayBoundaries = (calendarConfig, date) => {\n    const timeString = timeStringFromTimePoints(calendarConfig.dayBoundaries.value.start);\n    return Temporal.ZonedDateTime.from({\n        year: date.year,\n        month: date.month,\n        day: date.day,\n        hour: +timeString.split(':')[0],\n        minute: +timeString.split(':')[1],\n        timeZone: calendarConfig.timezone.value,\n    });\n};\nconst getRangeEndGivenDayBoundaries = (calendarConfig, date) => {\n    let dayEndTimeString = timeStringFromTimePoints(calendarConfig.dayBoundaries.value.end);\n    let newRangeEndDate = date;\n    if (calendarConfig.isHybridDay) {\n        newRangeEndDate = addDays(newRangeEndDate, 1);\n    }\n    if (calendarConfig.dayBoundaries.value.end === 2400) {\n        dayEndTimeString = '23:59';\n    }\n    return Temporal.ZonedDateTime.from({\n        year: newRangeEndDate.year,\n        month: newRangeEndDate.month,\n        day: newRangeEndDate.day,\n        hour: +dayEndTimeString.split(':')[0],\n        minute: +dayEndTimeString.split(':')[1],\n        timeZone: calendarConfig.timezone.value,\n    });\n};\nconst setRangeForWeek = (config) => {\n    const weekForDate = config.timeUnitsImpl\n        .getWeekFor(config.date)\n        .slice(0, config.calendarConfig.weekOptions.value.nDays);\n    return {\n        start: getRangeStartGivenDayBoundaries(config.calendarConfig, weekForDate[0]),\n        end: getRangeEndGivenDayBoundaries(config.calendarConfig, weekForDate[weekForDate.length - 1]),\n    };\n};\nconst setRangeForMonth = (config) => {\n    const monthForDate = config.timeUnitsImpl.getMonthWithTrailingAndLeadingDays(config.date.year, config.date.month);\n    return {\n        start: monthForDate[0][0],\n        end: monthForDate[monthForDate.length - 1][monthForDate[monthForDate.length - 1].length - 1].with({ hour: 23, minute: 59 }),\n    };\n};\nconst setRangeForDay = (config) => {\n    let date = config.date;\n    if (date instanceof Temporal.PlainDate) {\n        date = date.toZonedDateTime({\n            timeZone: config.calendarConfig.timezone.value,\n        });\n    }\n    return {\n        start: getRangeStartGivenDayBoundaries(config.calendarConfig, date),\n        end: getRangeEndGivenDayBoundaries(config.calendarConfig, date),\n    };\n};\n\nconst config$4 = {\n    name: InternalViewName.Week,\n    label: 'Week',\n    Component: WeekWrapper,\n    setDateRange: setRangeForWeek,\n    hasSmallScreenCompat: false,\n    hasWideScreenCompat: true,\n    backwardForwardFn: addDays,\n    backwardForwardUnits: 7,\n};\nconst viewWeek = createPreactView(config$4);\nconst createViewWeek = () => createPreactView(config$4);\n\nconst DayWrapper = ({ $app, id }) => {\n    return (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(WeekWrapper, { \"$app\": $app, id: id });\n};\n\nconst config$3 = {\n    name: InternalViewName.Day,\n    label: 'Day',\n    setDateRange: setRangeForDay,\n    hasWideScreenCompat: true,\n    hasSmallScreenCompat: true,\n    Component: DayWrapper,\n    backwardForwardFn: addDays,\n    backwardForwardUnits: 1,\n};\nconst viewDay = createPreactView(config$3);\nconst createViewDay = () => createPreactView(config$3);\n\nconst getWeekNumber = (d, firstDayOfWeek) => {\n    // Convert to ZonedDateTime if it's a PlainDate\n    const zonedDate = d instanceof Temporal.PlainDate\n        ? d.toZonedDateTime('UTC')\n        : d.toInstant().toZonedDateTimeISO('UTC');\n    // Adjust the date to the nearest desired first day of the week\n    const dayOffset = (zonedDate.dayOfWeek - firstDayOfWeek + 7) % 7;\n    const adjustedDate = zonedDate.subtract({ days: dayOffset - 3 });\n    // Get first day of year adjusted for firstDayOfWeek\n    const yearStart = Temporal.ZonedDateTime.from({\n        year: adjustedDate.year,\n        month: 1,\n        day: 1,\n        timeZone: 'UTC',\n    });\n    const yearStartOffset = (yearStart.dayOfWeek - firstDayOfWeek + 7) % 7;\n    const adjustedYearStart = yearStart.subtract({ days: yearStartOffset });\n    // Calculate full weeks from adjusted start of the year\n    const daysDiff = adjustedDate.until(adjustedYearStart, {\n        largestUnit: 'days',\n    }).days;\n    const weekNo = Math.ceil((Math.abs(daysDiff) + 1) / 7);\n    // Handle edge case for the last days of the year falling into week 53\n    const nextYearStart = Temporal.ZonedDateTime.from({\n        year: adjustedDate.year + 1,\n        month: 1,\n        day: 1,\n        timeZone: 'UTC',\n    });\n    const nextYearStartOffset = (nextYearStart.dayOfWeek - firstDayOfWeek + 7) % 7;\n    const adjustedNextYearStart = nextYearStart.subtract({\n        days: nextYearStartOffset,\n    });\n    if (Temporal.ZonedDateTime.compare(adjustedDate, adjustedNextYearStart) >= 0) {\n        return 1;\n    }\n    return weekNo;\n};\n\nfunction WeekNumber() {\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext);\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__calendar-header__week-number\", children: $app.translate('CW', {\n            week: getWeekNumber($app.datePickerState.selectedDate.value, $app.config.firstDayOfWeek.value),\n        }) }));\n}\n\nfunction CalendarHeader() {\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext);\n    const datePickerAppSingleton = new DatePickerAppSingletonBuilder()\n        .withDatePickerState($app.datePickerState)\n        .withConfig($app.datePickerConfig)\n        .withTranslate($app.translate)\n        .withTimeUnitsImpl($app.timeUnitsImpl)\n        .build();\n    const headerContent = $app.config._customComponentFns.headerContent;\n    const headerContentId = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)(headerContent ? randomStringId() : undefined)[0];\n    const headerContentLeftPrepend = $app.config._customComponentFns.headerContentLeftPrepend;\n    const headerContentLeftPrependId = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)(headerContentLeftPrepend ? randomStringId() : undefined)[0];\n    const headerContentLeftAppend = $app.config._customComponentFns.headerContentLeftAppend;\n    const headerContentLeftAppendId = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)(headerContentLeftAppend ? randomStringId() : undefined)[0];\n    const headerContentRightPrepend = $app.config._customComponentFns.headerContentRightPrepend;\n    const headerContentRightPrependId = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)(headerContentRightPrepend ? randomStringId() : undefined)[0];\n    const headerContentRightAppend = $app.config._customComponentFns.headerContentRightAppend;\n    const headerContentRightAppendId = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)(headerContentRightAppend ? randomStringId() : undefined)[0];\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        if (headerContent) {\n            headerContent(getElementByCCID(headerContentId), { $app });\n        }\n        if (headerContentLeftPrepend && headerContentLeftPrependId) {\n            headerContentLeftPrepend(getElementByCCID(headerContentLeftPrependId), {\n                $app,\n            });\n        }\n        if (headerContentLeftAppend) {\n            headerContentLeftAppend(getElementByCCID(headerContentLeftAppendId), {\n                $app,\n            });\n        }\n        if (headerContentRightPrepend) {\n            headerContentRightPrepend(getElementByCCID(headerContentRightPrependId), {\n                $app,\n            });\n        }\n        if (headerContentRightAppend) {\n            headerContentRightAppend(getElementByCCID(headerContentRightAppendId), {\n                $app,\n            });\n        }\n    }, [\n        $app.datePickerState.selectedDate.value,\n        $app.calendarState.range.value,\n        $app.calendarState.isDark.value,\n        $app.calendarState.isCalendarSmall.value,\n    ]);\n    const keyForRerenderingOnLocaleChange = $app.config.locale.value;\n    const isDayOrWeekView = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useMemo)(() => {\n        return [viewWeek.name, viewDay.name].includes($app.calendarState.view.value);\n    }, [$app.calendarState.view.value]);\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"header\", { className: 'sx__calendar-header', \"data-ccid\": headerContentId, children: !headerContent && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { className: 'sx__calendar-header-content', children: [headerContentLeftPrependId && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { \"data-ccid\": headerContentLeftPrependId })), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(TodayButton, {}), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(ForwardBackwardNavigation, {}), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(RangeHeading, {}, $app.config.locale.value), $app.config.showWeekNumbers.value && isDayOrWeekView && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(WeekNumber, {})), headerContentLeftAppendId && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { \"data-ccid\": headerContentLeftAppendId }))] }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { className: 'sx__calendar-header-content', children: [headerContentRightPrependId && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { \"data-ccid\": headerContentRightPrependId })), $app.config.plugins.timezoneSelect &&\n                            $app.config.plugins.timezoneSelect.isEnabled.value && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)($app.config.plugins.timezoneSelect.ComponentFn, { \"$app\": $app })), $app.config.views.value.length > 1 && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(ViewSelection, {}, keyForRerenderingOnLocaleChange + '-view-selection')), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(AppWrapper, { \"$app\": datePickerAppSingleton }), headerContentRightAppendId && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { \"data-ccid\": headerContentRightAppendId }))] })] })) }));\n}\n\nconst setWrapperElement = ($app, calendarId) => {\n    $app.elements.calendarWrapper = document.getElementById(calendarId);\n};\n\nconst setScreenSizeCompatibleView = ($app, isSmall) => {\n    const currentView = $app.config.views.value.find((view) => view.name === $app.calendarState.view.value);\n    if (isSmall) {\n        if (currentView.hasSmallScreenCompat)\n            return;\n        const smallScreenCompatibleView = $app.config.views.value.find((view) => view.hasSmallScreenCompat);\n        if (smallScreenCompatibleView) {\n            $app.calendarState.setView(smallScreenCompatibleView.name, $app.datePickerState.selectedDate.value);\n        }\n    }\n    else {\n        if (currentView.hasWideScreenCompat)\n            return;\n        const wideScreenCompatibleView = $app.config.views.value.find((view) => view.hasWideScreenCompat);\n        if (wideScreenCompatibleView) {\n            $app.calendarState.setView(wideScreenCompatibleView.name, $app.datePickerState.selectedDate.value);\n        }\n    }\n};\nconst handleWindowResize = ($app) => {\n    const documentRoot = document.documentElement;\n    const calendarRoot = $app.elements.calendarWrapper;\n    const documentFontSize = +window\n        .getComputedStyle(documentRoot)\n        .fontSize.split('p')[0];\n    const breakPointFor1RemEquals16px = 700;\n    const multiplier = 16 / documentFontSize;\n    const smallCalendarBreakpoint = breakPointFor1RemEquals16px / multiplier; // For 16px root font-size, break point is at 43.75rem\n    if (!calendarRoot)\n        return;\n    const isSmall = $app.config.callbacks.isCalendarSmall\n        ? $app.config.callbacks.isCalendarSmall($app)\n        : calendarRoot.clientWidth < smallCalendarBreakpoint;\n    const didIsSmallScreenChange = isSmall !== $app.calendarState.isCalendarSmall.value;\n    if (!didIsSmallScreenChange)\n        return;\n    $app.calendarState.isCalendarSmall.value = isSmall;\n    setScreenSizeCompatibleView($app, isSmall);\n};\n\nconst getClassForView = ($app) => {\n    return `is-${$app.calendarState.view.value}-view`;\n};\nfunction useWrapperClasses($app) {\n    const calendarWrapperClass = 'sx__calendar-wrapper';\n    const [wrapperClasses, setWrapperClasses] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)([\n        calendarWrapperClass,\n        getClassForView($app),\n    ]);\n    (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.useSignalEffect)(() => {\n        const classes = [calendarWrapperClass];\n        if ($app.calendarState.isCalendarSmall.value)\n            classes.push('sx__is-calendar-small');\n        if ($app.calendarState.isDark.value)\n            classes.push('is-dark');\n        if ($app.config.theme === 'shadcn')\n            classes.push('is-shadcn');\n        classes.push(getClassForView($app));\n        setWrapperClasses(classes);\n    });\n    return wrapperClasses;\n}\n\nconst initPlugins = ($app) => {\n    Object.values($app.config.plugins).forEach((plugin) => {\n        if (plugin === null || plugin === void 0 ? void 0 : plugin.onRender) {\n            plugin.onRender($app);\n        }\n    });\n};\nconst destroyPlugins = ($app) => {\n    Object.values($app.config.plugins).forEach((plugin) => {\n        if (plugin === null || plugin === void 0 ? void 0 : plugin.destroy)\n            plugin.destroy();\n    });\n};\nconst invokePluginsBeforeRender = ($app) => {\n    Object.values($app.config.plugins).forEach((plugin) => {\n        if (plugin === null || plugin === void 0 ? void 0 : plugin.beforeRender)\n            plugin.beforeRender($app);\n    });\n};\n\nfunction CalendarWrapper({ $app }) {\n    var _a;\n    const calendarId = randomStringId();\n    const viewContainerId = randomStringId();\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        var _a;\n        setWrapperElement($app, calendarId);\n        initPlugins($app);\n        if ((_a = $app.config.callbacks) === null || _a === void 0 ? void 0 : _a.onRender) {\n            $app.config.callbacks.onRender($app);\n        }\n        return () => destroyPlugins($app);\n    }, []);\n    const onResize = () => {\n        handleWindowResize($app);\n    };\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        if ($app.config.isResponsive) {\n            onResize();\n            window.addEventListener('resize', onResize);\n            return () => window.removeEventListener('resize', onResize);\n        }\n    }, []);\n    const wrapperClasses = useWrapperClasses($app);\n    const [currentView, setCurrentView] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)();\n    (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.useSignalEffect)(() => {\n        const newView = $app.config.views.value.find((view) => view.name === $app.calendarState.view.value);\n        const viewElement = document.getElementById(viewContainerId);\n        if (!newView || !viewElement || newView.name === (currentView === null || currentView === void 0 ? void 0 : currentView.name))\n            return;\n        if (currentView)\n            currentView.destroy();\n        setCurrentView(newView);\n        newView.render(viewElement, $app);\n    });\n    const [previousRangeStart, setPreviousRangeStart] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)('');\n    const [transitionClass, setTransitionClass] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)('');\n    (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.useSignalEffect)(() => {\n        var _a, _b;\n        // There is no reason to transition sideways, because the list view is expanded vertically, unlike the other views\n        if ($app.calendarState.view.value === InternalViewName.List)\n            return;\n        const newRangeStartIsLaterThanPrevious = (((_a = $app.calendarState.range.value) === null || _a === void 0 ? void 0 : _a.start.toString()) || '') >\n            previousRangeStart;\n        // Use requestAnimationFrame to ensure smooth animation timing\n        requestAnimationFrame(() => {\n            setTransitionClass(newRangeStartIsLaterThanPrevious ? 'sx__slide-left' : 'sx__slide-right');\n            setTimeout(() => {\n                setTransitionClass('');\n            }, 300); // CORRELATION ID: 3\n        });\n        setPreviousRangeStart(((_b = $app.calendarState.range.value) === null || _b === void 0 ? void 0 : _b.start.toString()) || '');\n    });\n    (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.useSignalEffect)(() => {\n        $app.datePickerConfig.locale.value = $app.config.locale.value;\n    });\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: wrapperClasses.join(' '), id: calendarId, children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: 'sx__calendar', children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(AppContext.Provider, { value: $app, children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(CalendarHeader, {}), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: ['sx__view-container', transitionClass].join(' '), id: viewContainerId }), $app.config.plugins.eventModal &&\n                            $app.config.plugins.eventModal.calendarEvent.value && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)($app.config.plugins.eventModal.ComponentFn, { \"$app\": $app }, (_a = $app.config.plugins.eventModal.calendarEvent.value) === null || _a === void 0 ? void 0 : _a.id))] }) }) }) }));\n}\n\nconst externalEventToInternal = (event, config) => {\n    const { id, start, end, title, description, location, people, _options, ...foreignProperties } = event;\n    return new CalendarEventBuilder(config, id, start, end)\n        .withTitle(title)\n        .withDescription(description)\n        .withLocation(location)\n        .withPeople(people)\n        .withCalendarId(event.calendarId)\n        .withOptions(_options)\n        .withForeignProperties(foreignProperties)\n        .withCustomContent(event._customContent)\n        .build();\n};\n\nclass EventsFacadeImpl {\n    constructor($app) {\n        Object.defineProperty(this, \"$app\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: $app\n        });\n    }\n    set(events) {\n        this.$app.calendarEvents.list.value = events.map((event) => externalEventToInternal(event, this.$app.config));\n    }\n    add(event) {\n        const newEvent = externalEventToInternal(event, this.$app.config);\n        newEvent._createdAt = new Date();\n        const copiedEvents = [...this.$app.calendarEvents.list.value];\n        copiedEvents.push(newEvent);\n        this.$app.calendarEvents.list.value = copiedEvents;\n    }\n    get(id) {\n        var _a;\n        return (_a = this.$app.calendarEvents.list.value\n            .find((event) => event.id === id)) === null || _a === void 0 ? void 0 : _a._getExternalEvent();\n    }\n    getAll() {\n        return this.$app.calendarEvents.list.value.map((event) => event._getExternalEvent());\n    }\n    remove(id) {\n        const index = this.$app.calendarEvents.list.value.findIndex((event) => event.id === id);\n        const copiedEvents = [...this.$app.calendarEvents.list.value];\n        copiedEvents.splice(index, 1);\n        this.$app.calendarEvents.list.value = copiedEvents;\n    }\n    update(event) {\n        const index = this.$app.calendarEvents.list.value.findIndex((e) => e.id === event.id);\n        const copiedEvents = [...this.$app.calendarEvents.list.value];\n        copiedEvents.splice(index, 1, externalEventToInternal(event, this.$app.config));\n        this.$app.calendarEvents.list.value = copiedEvents;\n    }\n}\n\nclass CalendarApp {\n    constructor($app) {\n        var _a;\n        Object.defineProperty(this, \"$app\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: $app\n        });\n        Object.defineProperty(this, \"events\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"calendarContainerEl\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.events = new EventsFacadeImpl(this.$app);\n        invokePluginsBeforeRender(this.$app);\n        Object.values(this.$app.config.plugins).forEach((plugin) => {\n            if (!(plugin === null || plugin === void 0 ? void 0 : plugin.name))\n                return;\n            // \"hack\" for enabling accessing plugins via calendarApp[pluginName]\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            this[plugin.name] = plugin;\n        });\n        if ((_a = $app.config.callbacks) === null || _a === void 0 ? void 0 : _a.beforeRender) {\n            $app.config.callbacks.beforeRender($app);\n        }\n    }\n    render(el) {\n        this.calendarContainerEl = el;\n        (0,preact__WEBPACK_IMPORTED_MODULE_0__.render)((0,preact__WEBPACK_IMPORTED_MODULE_0__.createElement)(CalendarWrapper, { $app: this.$app }), el);\n    }\n    destroy() {\n        Object.values(this.$app.config.plugins || {}).forEach((plugin) => {\n            if (!plugin || !plugin.destroy)\n                return;\n            plugin.destroy();\n        });\n        if (this.calendarContainerEl) {\n            (0,preact__WEBPACK_IMPORTED_MODULE_0__.render)(null, this.calendarContainerEl);\n        }\n    }\n    setTheme(theme) {\n        this.$app.calendarState.isDark.value = theme === 'dark';\n    }\n    getTheme() {\n        return this.$app.calendarState.isDark.value ? 'dark' : 'light';\n    }\n    /**\n     * @internal\n     * Purpose: To be consumed by framework adapters for custom component rendering.\n     * */\n    _setCustomComponentFn(fnId, fn) {\n        this.$app.config._customComponentFns[fnId] = fn;\n    }\n    _setDestroyCustomComponentInstance(cb) {\n        this.$app.config._destroyCustomComponentInstance = cb;\n    }\n}\n\nclass CalendarAppSingletonImpl {\n    constructor(config, timeUnitsImpl, calendarState, datePickerState, translate, datePickerConfig, calendarEvents, elements = { calendarWrapper: undefined }) {\n        Object.defineProperty(this, \"config\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: config\n        });\n        Object.defineProperty(this, \"timeUnitsImpl\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: timeUnitsImpl\n        });\n        Object.defineProperty(this, \"calendarState\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: calendarState\n        });\n        Object.defineProperty(this, \"datePickerState\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: datePickerState\n        });\n        Object.defineProperty(this, \"translate\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: translate\n        });\n        Object.defineProperty(this, \"datePickerConfig\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: datePickerConfig\n        });\n        Object.defineProperty(this, \"calendarEvents\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: calendarEvents\n        });\n        Object.defineProperty(this, \"elements\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: elements\n        });\n    }\n}\n\nclass CalendarAppSingletonBuilder {\n    constructor() {\n        Object.defineProperty(this, \"config\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"timeUnitsImpl\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"datePickerState\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"calendarState\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"translate\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"datePickerConfig\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"calendarEvents\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n    }\n    build() {\n        return new CalendarAppSingletonImpl(this.config, this.timeUnitsImpl, this.calendarState, this.datePickerState, this.translate, this.datePickerConfig, this.calendarEvents);\n    }\n    withConfig(config) {\n        this.config = config;\n        return this;\n    }\n    withTimeUnitsImpl(timeUnitsImpl) {\n        this.timeUnitsImpl = timeUnitsImpl;\n        return this;\n    }\n    withDatePickerState(datePickerState) {\n        this.datePickerState = datePickerState;\n        return this;\n    }\n    withCalendarState(calendarState) {\n        this.calendarState = calendarState;\n        return this;\n    }\n    withTranslate(translate) {\n        this.translate = translate;\n        return this;\n    }\n    withDatePickerConfig(datePickerConfig) {\n        this.datePickerConfig = datePickerConfig;\n        return this;\n    }\n    withCalendarEvents(calendarEvents) {\n        this.calendarEvents = calendarEvents;\n        return this;\n    }\n}\n\nvar DateFormatDelimiter;\n(function (DateFormatDelimiter) {\n    DateFormatDelimiter[\"SLASH\"] = \"/\";\n    DateFormatDelimiter[\"DASH\"] = \"-\";\n    DateFormatDelimiter[\"PERIOD\"] = \".\";\n})(DateFormatDelimiter || (DateFormatDelimiter = {}));\nvar DateFormatOrder;\n(function (DateFormatOrder) {\n    DateFormatOrder[\"DMY\"] = \"DMY\";\n    DateFormatOrder[\"MDY\"] = \"MDY\";\n    DateFormatOrder[\"YMD\"] = \"YMD\";\n})(DateFormatOrder || (DateFormatOrder = {}));\n\nconst formatRules = {\n    slashMDY: {\n        delimiter: DateFormatDelimiter.SLASH,\n        order: DateFormatOrder.MDY,\n    },\n    slashDMY: {\n        delimiter: DateFormatDelimiter.SLASH,\n        order: DateFormatOrder.DMY,\n    },\n    slashYMD: {\n        delimiter: DateFormatDelimiter.SLASH,\n        order: DateFormatOrder.YMD,\n    },\n    periodDMY: {\n        delimiter: DateFormatDelimiter.PERIOD,\n        order: DateFormatOrder.DMY,\n    },\n    dashYMD: {\n        delimiter: DateFormatDelimiter.DASH,\n        order: DateFormatOrder.YMD,\n    },\n    dashDMY: {\n        delimiter: DateFormatDelimiter.DASH,\n        order: DateFormatOrder.DMY,\n    },\n};\nconst dateFormatLocalizedRules = new Map([\n    ['ca-ES', formatRules.slashDMY],\n    ['cs-CZ', formatRules.periodDMY],\n    ['da-DK', formatRules.periodDMY],\n    ['de-DE', formatRules.periodDMY],\n    ['en-GB', formatRules.slashDMY],\n    ['en-US', formatRules.slashMDY],\n    ['es-ES', formatRules.slashDMY],\n    ['et-EE', formatRules.periodDMY],\n    ['fi-FI', formatRules.periodDMY],\n    ['fr-FR', formatRules.slashDMY],\n    ['fr-CH', formatRules.periodDMY],\n    ['hr-HR', formatRules.periodDMY],\n    ['id-ID', formatRules.slashDMY],\n    ['it-IT', formatRules.slashDMY],\n    ['ja-JP', formatRules.slashYMD],\n    ['ko-KR', formatRules.slashYMD],\n    ['ky-KG', formatRules.slashDMY],\n    ['lt-LT', formatRules.dashYMD],\n    ['mk-MK', formatRules.periodDMY],\n    ['nl-NL', formatRules.dashDMY],\n    ['pl-PL', formatRules.periodDMY],\n    ['pt-BR', formatRules.slashDMY],\n    ['ro-RO', formatRules.periodDMY],\n    ['ru-RU', formatRules.periodDMY],\n    ['sk-SK', formatRules.periodDMY],\n    ['sl-SI', formatRules.periodDMY],\n    ['sr-Latn-RS', formatRules.periodDMY],\n    ['sr-RS', formatRules.periodDMY],\n    ['sv-SE', formatRules.dashYMD],\n    ['tr-TR', formatRules.periodDMY],\n    ['uk-UA', formatRules.periodDMY],\n    ['zh-CN', formatRules.slashYMD],\n    ['zh-TW', formatRules.slashYMD],\n]);\n\nclass LocaleNotSupportedError extends Error {\n    constructor(locale) {\n        super(`Locale not supported: ${locale}`);\n    }\n}\n\nclass InvalidDateFormatError extends Error {\n    constructor(dateFormat, locale) {\n        super(`Invalid date format: ${dateFormat} for locale: ${locale}`);\n    }\n}\n\nconst _getMatchesOrThrow = (format, matcher, locale) => {\n    const matches = format.match(matcher);\n    if (!matches)\n        throw new InvalidDateFormatError(format, locale);\n    return matches;\n};\nconst toDateString = (format, locale) => {\n    const internationalFormat = /^\\d{4}-\\d{2}-\\d{2}$/;\n    if (internationalFormat.test(format))\n        return format; // allow international format regardless of locale\n    const localeDateFormatRule = dateFormatLocalizedRules.get(locale);\n    if (!localeDateFormatRule)\n        throw new LocaleNotSupportedError(locale);\n    const { order, delimiter } = localeDateFormatRule;\n    const pattern224Slashed = /^(\\d{1,2})\\/(\\d{1,2})\\/(\\d{4})$/;\n    const pattern224Dotted = /^(\\d{1,2})\\.(\\d{1,2})\\.(\\d{4})$/;\n    const pattern442Slashed = /^(\\d{4})\\/(\\d{1,2})\\/(\\d{1,2})$/;\n    if (order === DateFormatOrder.DMY && delimiter === DateFormatDelimiter.SLASH) {\n        const matches = _getMatchesOrThrow(format, pattern224Slashed, locale);\n        const [, day, month, year] = matches;\n        return `${year}-${doubleDigit(+month)}-${doubleDigit(+day)}`;\n    }\n    if (order === DateFormatOrder.MDY && delimiter === DateFormatDelimiter.SLASH) {\n        const matches = _getMatchesOrThrow(format, pattern224Slashed, locale);\n        const [, month, day, year] = matches;\n        return `${year}-${doubleDigit(+month)}-${doubleDigit(+day)}`;\n    }\n    if (order === DateFormatOrder.YMD && delimiter === DateFormatDelimiter.SLASH) {\n        const matches = _getMatchesOrThrow(format, pattern442Slashed, locale);\n        const [, year, month, day] = matches;\n        return `${year}-${doubleDigit(+month)}-${doubleDigit(+day)}`;\n    }\n    if (order === DateFormatOrder.DMY && delimiter === DateFormatDelimiter.PERIOD) {\n        const matches = _getMatchesOrThrow(format, pattern224Dotted, locale);\n        const [, day, month, year] = matches;\n        return `${year}-${doubleDigit(+month)}-${doubleDigit(+day)}`;\n    }\n    throw new InvalidDateFormatError(format, locale);\n};\n\nconst getLocalizedDate = (date, locale) => {\n    return toLocalizedDateString(date, locale);\n};\nconst createDatePickerState = (config, selectedDateParam) => {\n    var _a;\n    const initialSelectedDate = selectedDateParam instanceof Temporal.PlainDate\n        ? selectedDateParam\n        : Temporal.Now.plainDateISO();\n    const isOpen = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(false);\n    const isDisabled = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(config.disabled || false);\n    const datePickerView = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(DatePickerView.MONTH_DAYS);\n    const selectedDate = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(initialSelectedDate);\n    const datePickerDate = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(initialSelectedDate);\n    const isDark = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(((_a = config.style) === null || _a === void 0 ? void 0 : _a.dark) || false);\n    const inputDisplayedValue = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(toLocalizedDateString(initialSelectedDate, config.locale.value));\n    const lastValidDisplayedValue = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(inputDisplayedValue.value);\n    const handleInput = (newInputValue) => {\n        try {\n            const newValue = toDateString(newInputValue, config.locale.value);\n            if (newValue < config.min.toString() ||\n                newValue > config.max.toString()) {\n                inputDisplayedValue.value = lastValidDisplayedValue.value;\n                return;\n            }\n            const { year, month, date: day } = toIntegers(newValue);\n            const newPlainDate = Temporal.PlainDate.from({\n                year,\n                month: month + 1,\n                day,\n            });\n            selectedDate.value = newPlainDate;\n            datePickerDate.value = newPlainDate;\n            lastValidDisplayedValue.value = inputDisplayedValue.value;\n            // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        }\n        catch (_e) {\n            // Nothing to do here. We don't want to log errors when users are typing invalid formats\n        }\n    };\n    (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.effect)(() => {\n        inputDisplayedValue.value = getLocalizedDate(selectedDate.value, config.locale.value);\n    });\n    let wasInitialized = false;\n    const handleOnChange = (selectedDate) => {\n        if (!wasInitialized)\n            return (wasInitialized = true);\n        config.listeners.onChange(selectedDate);\n    };\n    (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.effect)(() => {\n        var _a;\n        if ((_a = config.listeners) === null || _a === void 0 ? void 0 : _a.onChange)\n            handleOnChange(selectedDate.value);\n    });\n    return {\n        inputWrapperElement: (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(undefined),\n        isOpen,\n        isDisabled,\n        datePickerView,\n        selectedDate,\n        datePickerDate,\n        inputDisplayedValue,\n        handleInput,\n        isDark,\n        open: () => (isOpen.value = true),\n        close: () => (isOpen.value = false),\n        toggle: () => (isOpen.value = !isOpen.value),\n        setView: (view) => (datePickerView.value = view),\n    };\n};\n\nconst datePickerArEG = {\n    Date: '',\n    'MM/DD/YYYY': 'DD/MM/YYYY', // Keep format unchanged unless you want to localize it\n    'Next month': ' ',\n    'Previous month': ' ',\n    'Choose Date': ' ',\n};\n\nconst timePickerArEG = {\n    Time: '',\n    AM: '',\n    PM: '',\n    Cancel: '',\n    OK: '',\n    'Select time': ' ',\n};\n\nconst calendarArEG = {\n    Today: '',\n    Month: '',\n    Week: '',\n    Day: '',\n    List: '',\n    'Select View': ' ',\n    '+ {{n}} events': '+ {{n}} ',\n    '+ 1 event': '+ 1 ',\n    'No events': '  ',\n    'Next period': ' ',\n    'Previous period': ' ',\n    to: '', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': '     ',\n    'Link to {{n}} more events on {{date}}': '  {{n}}    {{date}}',\n    'Link to 1 more event on {{date}}': '     {{date}}',\n    CW: ' {{week}}',\n    View: '',\n};\n\nconst arEG = {\n    ...calendarArEG,\n    ...datePickerArEG,\n    ...timePickerArEG,\n};\n\nconst datePickerDeDE = {\n    Date: 'Datum',\n    'MM/DD/YYYY': 'TT.MM.JJJJ',\n    'Next month': 'Nchster Monat',\n    'Previous month': 'Vorheriger Monat',\n    'Choose Date': 'Datum auswhlen',\n};\n\nconst calendarDeDE = {\n    Today: 'Heute',\n    Month: 'Monat',\n    Week: 'Woche',\n    Day: 'Tag',\n    List: 'Liste',\n    'Select View': 'Ansicht auswhlen',\n    View: 'Ansicht',\n    '+ {{n}} events': '+ {{n}} Ereignisse',\n    '+ 1 event': '+ 1 Ereignis',\n    'No events': 'Keine Ereignisse',\n    'Next period': 'Nchster Zeitraum',\n    'Previous period': 'Vorheriger Zeitraum',\n    to: 'bis', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': 'Ganztgige und mehrtgige Termine',\n    'Link to {{n}} more events on {{date}}': 'Link zu {{n}} weiteren Terminen am {{date}}',\n    'Link to 1 more event on {{date}}': 'Link zu 1 weiterem Termin am {{date}}',\n    CW: 'KW {{week}}',\n};\n\nconst timePickerDeDE = {\n    Time: 'Uhrzeit',\n    AM: 'AM',\n    PM: 'PM',\n    Cancel: 'Abbrechen',\n    OK: 'OK',\n    'Select time': 'Uhrzeit auswhlen',\n};\n\nconst deDE = {\n    ...datePickerDeDE,\n    ...calendarDeDE,\n    ...timePickerDeDE,\n};\n\nconst datePickerEnUS = {\n    Date: 'Date',\n    'MM/DD/YYYY': 'MM/DD/YYYY',\n    'Next month': 'Next month',\n    'Previous month': 'Previous month',\n    'Choose Date': 'Choose Date',\n};\n\nconst calendarEnUS = {\n    Today: 'Today',\n    Month: 'Month',\n    Week: 'Week',\n    Day: 'Day',\n    List: 'List',\n    'Select View': 'Select View',\n    View: 'View',\n    '+ {{n}} events': '+ {{n}} events',\n    '+ 1 event': '+ 1 event',\n    'No events': 'No events',\n    'Next period': 'Next period',\n    'Previous period': 'Previous period',\n    to: 'to', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': 'Full day- and multiple day events',\n    'Link to {{n}} more events on {{date}}': 'Link to {{n}} more events on {{date}}',\n    'Link to 1 more event on {{date}}': 'Link to 1 more event on {{date}}',\n    CW: 'Week {{week}}',\n};\n\nconst timePickerEnUS = {\n    Time: 'Time',\n    AM: 'AM',\n    PM: 'PM',\n    Cancel: 'Cancel',\n    OK: 'OK',\n    'Select time': 'Select time',\n};\n\nconst enUS = {\n    ...datePickerEnUS,\n    ...calendarEnUS,\n    ...timePickerEnUS,\n};\n\nconst datePickerItIT = {\n    Date: 'Data',\n    'MM/DD/YYYY': 'DD/MM/YYYY',\n    'Next month': 'Mese successivo',\n    'Previous month': 'Mese precedente',\n    'Choose Date': 'Scegli la data',\n};\n\nconst calendarItIT = {\n    Today: 'Oggi',\n    Month: 'Mese',\n    Week: 'Settimana',\n    Day: 'Giorno',\n    List: 'Lista',\n    'Select View': 'Seleziona la vista',\n    View: 'Vista',\n    '+ {{n}} events': '+ {{n}} eventi',\n    '+ 1 event': '+ 1 evento',\n    'No events': 'Nessun evento',\n    'Next period': 'Periodo successivo',\n    'Previous period': 'Periodo precedente',\n    to: 'a', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': 'Eventi della giornata e plurigiornalieri',\n    'Link to {{n}} more events on {{date}}': 'Link a {{n}} eventi in pi il {{date}}',\n    'Link to 1 more event on {{date}}': 'Link a 1 evento in pi il {{date}}',\n    CW: 'Settimana {{week}}',\n};\n\nconst timePickerItIT = {\n    Time: 'Ora',\n    AM: 'AM',\n    PM: 'PM',\n    Cancel: 'Annulla',\n    OK: 'OK',\n    'Select time': 'Seleziona ora',\n};\n\nconst itIT = {\n    ...datePickerItIT,\n    ...calendarItIT,\n    ...timePickerItIT,\n};\n\nconst datePickerEnGB = {\n    Date: 'Date',\n    'MM/DD/YYYY': 'DD/MM/YYYY',\n    'Next month': 'Next month',\n    'Previous month': 'Previous month',\n    'Choose Date': 'Choose Date',\n};\n\nconst calendarEnGB = {\n    Today: 'Today',\n    Month: 'Month',\n    Week: 'Week',\n    Day: 'Day',\n    List: 'List',\n    'Select View': 'Select View',\n    '+ {{n}} events': '+ {{n}} events',\n    '+ 1 event': '+ 1 event',\n    'No events': 'No events',\n    'Next period': 'Next period',\n    'Previous period': 'Previous period',\n    to: 'to', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': 'Full day- and multiple day events',\n    'Link to {{n}} more events on {{date}}': 'Link to {{n}} more events on {{date}}',\n    'Link to 1 more event on {{date}}': 'Link to 1 more event on {{date}}',\n    CW: 'Week {{week}}',\n    View: 'View',\n};\n\nconst timePickerEnGB = {\n    Time: 'Time',\n    AM: 'AM',\n    PM: 'PM',\n    Cancel: 'Cancel',\n    OK: 'OK',\n    'Select time': 'Select time',\n};\n\nconst enGB = {\n    ...datePickerEnGB,\n    ...calendarEnGB,\n    ...timePickerEnGB,\n};\n\nconst datePickerSvSE = {\n    Date: 'Datum',\n    'MM/DD/YYYY': '-MM-DD',\n    'Next month': 'Nsta mnad',\n    'Previous month': 'Fregende mnad',\n    'Choose Date': 'Vlj datum',\n};\n\nconst calendarSvSE = {\n    Today: 'Idag',\n    Month: 'Mnad',\n    Week: 'Vecka',\n    Day: 'Dag',\n    List: 'Lista',\n    'Select View': 'Vlj vy',\n    View: 'Vy',\n    '+ {{n}} events': '+ {{n}} hndelser',\n    '+ 1 event': '+ 1 hndelse',\n    'No events': 'Inga hndelser',\n    'Next period': 'Nsta period',\n    'Previous period': 'Fregende period',\n    to: 'till', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': 'Heldags- och flerdagshndelser',\n    'Link to {{n}} more events on {{date}}': 'Lnk till {{n}} fler hndelser den {{date}}',\n    'Link to 1 more event on {{date}}': 'Lnk till 1 hndelse till den {{date}}',\n    CW: 'Vecka {{week}}',\n};\n\nconst timePickerSvSE = {\n    Time: 'Tid',\n    AM: 'FM',\n    PM: 'EM',\n    Cancel: 'Avbryt',\n    OK: 'OK',\n    'Select time': 'Vlj tid',\n};\n\nconst svSE = {\n    ...datePickerSvSE,\n    ...calendarSvSE,\n    ...timePickerSvSE,\n};\n\nconst datePickerZhCN = {\n    Date: '',\n    'MM/DD/YYYY': '//',\n    'Next month': '',\n    'Previous month': '',\n    'Choose Date': '',\n};\n\nconst calendarZhCN = {\n    Today: '',\n    Month: '',\n    Week: '',\n    Day: '',\n    List: '',\n    'Select View': '',\n    View: '',\n    '+ {{n}} events': '+ {{n}} ',\n    '+ 1 event': '+ 1 ',\n    'No events': '',\n    'Next period': '',\n    'Previous period': '',\n    to: '', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': '',\n    'Link to {{n}} more events on {{date}}': '{{date}}{{n}}',\n    'Link to 1 more event on {{date}}': '{{date}}1',\n    CW: '{{week}}',\n};\n\nconst timePickerZhCN = {\n    Time: '',\n    AM: '',\n    PM: '',\n    Cancel: '',\n    OK: '',\n    'Select time': '',\n};\n\nconst zhCN = {\n    ...datePickerZhCN,\n    ...calendarZhCN,\n    ...timePickerZhCN,\n};\n\nconst datePickerZhTW = {\n    Date: '',\n    'MM/DD/YYYY': '//',\n    'Next month': '',\n    'Previous month': '',\n    'Choose Date': '',\n};\n\nconst calendarZhTW = {\n    Today: '',\n    Month: '',\n    Week: '',\n    Day: '',\n    List: '',\n    'Select View': '',\n    View: '',\n    '+ {{n}} events': '+ {{n}} ',\n    '+ 1 event': '+ 1 ',\n    'No events': '',\n    'Next period': '',\n    'Previous period': '',\n    to: '', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': '',\n    'Link to {{n}} more events on {{date}}': '{{date}}{{n}}',\n    'Link to 1 more event on {{date}}': '{{date}}1',\n    CW: '{{week}}',\n};\n\nconst timePickerZhTW = {\n    Time: '',\n    AM: '',\n    PM: '',\n    Cancel: '',\n    OK: '',\n    'Select time': '',\n};\n\nconst zhTW = {\n    ...datePickerZhTW,\n    ...calendarZhTW,\n    ...timePickerZhTW,\n};\n\nconst datePickerJaJP = {\n    Date: '',\n    'MM/DD/YYYY': '//',\n    'Next month': '',\n    'Previous month': '',\n    'Choose Date': '',\n};\n\nconst calendarJaJP = {\n    Today: '',\n    Month: '',\n    Week: '',\n    Day: '',\n    List: '',\n    'Select View': '',\n    View: '',\n    '+ {{n}} events': '+ {{n}} ',\n    '+ 1 event': '+ 1 ',\n    'No events': '',\n    'Next period': '',\n    'Previous period': '',\n    to: '', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': '',\n    'Link to {{n}} more events on {{date}}': '{{date}} {{n}}',\n    'Link to 1 more event on {{date}}': '{{date}} 1',\n    CW: ' {{week}}',\n};\n\nconst timePickerJaJP = {\n    Time: '',\n    AM: '',\n    PM: '',\n    Cancel: '',\n    OK: 'OK',\n    'Select time': '',\n};\n\nconst jaJP = {\n    ...datePickerJaJP,\n    ...calendarJaJP,\n    ...timePickerJaJP,\n};\n\nconst datePickerRuRU = {\n    Date: '',\n    'MM/DD/YYYY': '//',\n    'Next month': ' ',\n    'Previous month': ' ',\n    'Choose Date': ' ',\n};\n\nconst calendarRuRU = {\n    Today: '',\n    Month: '',\n    Week: '',\n    Day: '',\n    List: '',\n    'Select View': ' ',\n    '+ {{n}} events': '+ {{n}} ',\n    '+ 1 event': '+ 1 ',\n    'No events': ' ',\n    'Next period': ' ',\n    'Previous period': ' ',\n    to: '', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': '       ',\n    'Link to {{n}} more events on {{date}}': '  {{n}}    {{date}}',\n    'Link to 1 more event on {{date}}': '  1    {{date}}',\n    CW: ' {{week}}',\n    View: '',\n};\n\nconst timePickerRuRU = {\n    Time: '',\n    AM: 'AM',\n    PM: 'PM',\n    Cancel: '',\n    OK: '',\n    'Select time': ' ',\n};\n\nconst ruRU = {\n    ...datePickerRuRU,\n    ...calendarRuRU,\n    ...timePickerRuRU,\n};\n\nconst datePickerKoKR = {\n    Date: '',\n    'MM/DD/YYYY': '//',\n    'Next month': ' ',\n    'Previous month': ' ',\n    'Choose Date': ' ',\n};\n\nconst calendarKoKR = {\n    Today: '',\n    Month: '',\n    Week: '',\n    Day: '',\n    List: '',\n    'Select View': ' ',\n    '+ {{n}} events': '+ {{n}} ',\n    '+ 1 event': '+ 1 ',\n    'No events': ' ',\n    'Next period': '',\n    'Previous period': '',\n    to: '', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': '   ',\n    'Link to {{n}} more events on {{date}}': '{{date}} {{n}}   ',\n    'Link to 1 more event on {{date}}': '{{date}} 1   ',\n    CW: '{{week}}',\n    View: '',\n};\n\nconst timePickerKoKR = {\n    Time: '',\n    AM: '',\n    PM: '',\n    Cancel: '',\n    OK: '',\n    'Select time': ' ',\n};\n\nconst koKR = {\n    ...datePickerKoKR,\n    ...calendarKoKR,\n    ...timePickerKoKR,\n};\n\nconst datePickerFrFR = {\n    Date: 'Date',\n    'MM/DD/YYYY': 'JJ/MM/AAAA',\n    'Next month': 'Mois suivant',\n    'Previous month': 'Mois prcdent',\n    'Choose Date': 'Choisir une date',\n};\n\nconst calendarFrFR = {\n    Today: \"Aujourd'hui\",\n    Month: 'Mois',\n    Week: 'Semaine',\n    Day: 'Jour',\n    List: 'Liste',\n    'Select View': 'Slectionner la vue',\n    View: 'Vue',\n    '+ {{n}} events': '+ {{n}} vnements',\n    '+ 1 event': '+ 1 vnement',\n    'No events': 'Aucun vnement',\n    'Next period': 'Priode suivante',\n    'Previous period': 'Priode prcdente',\n    to: 'au', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': 'vnements sur une journe ou plusieurs jours',\n    'Link to {{n}} more events on {{date}}': 'Lien vers {{n}} vnements supplmentaires le {{date}}',\n    'Link to 1 more event on {{date}}': 'Lien vers 1 vnement supplmentaire le {{date}}',\n    CW: 'S{{week}}',\n};\n\nconst timePickerFrFR = {\n    Time: 'Heure',\n    AM: 'AM',\n    PM: 'PM',\n    Cancel: 'Annuler',\n    OK: 'OK',\n    'Select time': \"Slectionner l'heure\",\n};\n\nconst frFR = {\n    ...datePickerFrFR,\n    ...calendarFrFR,\n    ...timePickerFrFR,\n};\n\nconst datePickerDaDK = {\n    Date: 'Dato',\n    'MM/DD/YYYY': '-MM-DD',\n    'Next month': 'Nste mned',\n    'Previous month': 'Foregende mned',\n    'Choose Date': 'Vlg dato',\n};\n\nconst calendarDaDK = {\n    Today: 'I dag',\n    Month: 'Mned',\n    Week: 'Uge',\n    Day: 'Dag',\n    List: 'Liste',\n    'Select View': 'Vlg visning',\n    '+ {{n}} events': '+ {{n}} begivenheder',\n    '+ 1 event': '+ 1 begivenhed',\n    'No events': 'Ingen begivenheder',\n    'Next period': 'Nste periode',\n    'Previous period': 'Forgende periode',\n    to: 'til', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': 'Heldagsbegivenheder og flerdagsbegivenheder',\n    'Link to {{n}} more events on {{date}}': 'Link til {{n}} flere begivenheder den {{date}}',\n    'Link to 1 more event on {{date}}': 'Link til 1 mere begivenhed den {{date}}',\n    CW: 'Uge {{week}}',\n    View: 'Visning',\n};\n\nconst timePickerDaDK = {\n    Time: 'Tid',\n    AM: 'AM',\n    PM: 'PM',\n    Cancel: 'Annuller',\n    OK: 'OK',\n    'Select time': 'Vlg tid',\n};\n\nconst daDK = {\n    ...datePickerDaDK,\n    ...calendarDaDK,\n    ...timePickerDaDK,\n};\n\nconst datePickerPlPL = {\n    Date: 'Data',\n    'MM/DD/YYYY': 'DD/MM/YYYY',\n    'Next month': 'Nastpny miesic',\n    'Previous month': 'Poprzedni miesic',\n    'Choose Date': 'Wybiewrz dat',\n};\n\nconst calendarPlPL = {\n    Today: 'Dzisiaj',\n    Month: 'Miesic',\n    Week: 'Tydzie',\n    Day: 'Dzie',\n    List: 'Lista',\n    'Select View': 'Wybierz widok',\n    '+ {{n}} events': '+ {{n}} wydarzenia',\n    '+ 1 event': '+ 1 wydarzenie',\n    'No events': 'Brak wydarze',\n    'Next period': 'Nastpny okres',\n    'Previous period': 'Poprzedni okres',\n    to: 'do', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': 'Wydarzenia caodniowe i wielodniowe',\n    'Link to {{n}} more events on {{date}}': 'Link do {{n}} kolejnych wydarze w dniu {{date}}',\n    'Link to 1 more event on {{date}}': 'Link do 1 kolejnego wydarzenia w dniu {{date}}',\n    CW: 'Tydzie {{week}}',\n    View: 'Widok',\n};\n\nconst timePickerPlPL = {\n    Time: 'Godzina',\n    AM: 'AM',\n    PM: 'PM',\n    Cancel: 'Anuluj',\n    OK: 'OK',\n    'Select time': 'Wybierz godzin',\n};\n\nconst plPL = {\n    ...datePickerPlPL,\n    ...calendarPlPL,\n    ...timePickerPlPL,\n};\n\nconst datePickerEsES = {\n    Date: 'Fecha',\n    'MM/DD/YYYY': 'DD/MM/YYYY',\n    'Next month': 'Siguiente mes',\n    'Previous month': 'Mes anterior',\n    'Choose Date': 'Seleccione una fecha',\n};\n\nconst calendarEsES = {\n    Today: 'Hoy',\n    Month: 'Mes',\n    Week: 'Semana',\n    Day: 'Da',\n    List: 'Lista',\n    'Select View': 'Seleccionar vista',\n    View: 'Vista',\n    '+ {{n}} events': '+ {{n}} eventos',\n    '+ 1 event': '+ 1 evento',\n    'No events': 'No hay eventos',\n    'Next period': 'Siguiente perodo',\n    'Previous period': 'Perodo anterior',\n    to: 'a', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': 'Da completo y eventos de mltiples das',\n    'Link to {{n}} more events on {{date}}': 'Enlace a {{n}} eventos ms el {{date}}',\n    'Link to 1 more event on {{date}}': 'Enlace a 1 evento ms el {{date}}',\n    CW: 'Semana {{week}}',\n};\n\nconst timePickerEsES = {\n    Time: 'Hora',\n    AM: 'AM',\n    PM: 'PM',\n    Cancel: 'Cancelar',\n    OK: 'Aceptar',\n    'Select time': 'Seleccionar hora',\n};\n\nconst esES = {\n    ...datePickerEsES,\n    ...calendarEsES,\n    ...timePickerEsES,\n};\n\nconst calendarNlNL = {\n    Today: 'Vandaag',\n    Month: 'Maand',\n    Week: 'Week',\n    Day: 'Dag',\n    List: 'Lijst',\n    'Select View': 'Kies weergave',\n    '+ {{n}} events': '+ {{n}} gebeurtenissen',\n    '+ 1 event': '+ 1 gebeurtenis',\n    'No events': 'Geen gebeurtenissen',\n    'Next period': 'Volgende periode',\n    'Previous period': 'Vorige periode',\n    to: 'tot', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': 'Evenementen van een hele dag en meerdere dagen',\n    'Link to {{n}} more events on {{date}}': 'Link naar {{n}} meer evenementen op {{date}}',\n    'Link to 1 more event on {{date}}': 'Link naar 1 meer evenement op {{date}}',\n    CW: 'Week {{week}}',\n    View: 'Weergave',\n};\n\nconst datePickerNlNL = {\n    Date: 'Datum',\n    'MM/DD/YYYY': 'DD-MM-JJJJ',\n    'Next month': 'Volgende maand',\n    'Previous month': 'Vorige maand',\n    'Choose Date': 'Kies datum',\n};\n\nconst timePickerNlNL = {\n    Time: 'Tijd',\n    AM: 'AM',\n    PM: 'PM',\n    Cancel: 'Annuleren',\n    OK: 'OK',\n    'Select time': 'Selecteer tijd',\n};\n\nconst nlNL = {\n    ...datePickerNlNL,\n    ...calendarNlNL,\n    ...timePickerNlNL,\n};\n\nconst datePickerPtBR = {\n    Date: 'Data',\n    'MM/DD/YYYY': 'DD/MM/YYYY',\n    'Next month': 'Ms seguinte',\n    'Previous month': 'Ms anterior',\n    'Choose Date': 'Escolha uma data',\n};\n\nconst calendarPtBR = {\n    Today: 'Hoje',\n    Month: 'Ms',\n    Week: 'Semana',\n    Day: 'Dia',\n    List: 'Lista',\n    'Select View': 'Selecione uma visualizao',\n    '+ {{n}} events': '+ {{n}} eventos',\n    '+ 1 event': '+ 1 evento',\n    'No events': 'Sem eventos',\n    'Next period': 'Perodo seguinte',\n    'Previous period': 'Perodo anterior',\n    to: 'a', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': 'Dia inteiro e eventos de vrios dias',\n    'Link to {{n}} more events on {{date}}': 'Link para mais {{n}} eventos em {{date}}',\n    'Link to 1 more event on {{date}}': 'Link para mais 1 evento em {{date}}',\n    CW: 'Semana {{week}}',\n    View: 'Visualizao',\n};\n\nconst timePickerPtBR = {\n    Time: 'Hora',\n    AM: 'AM',\n    PM: 'PM',\n    Cancel: 'Cancelar',\n    OK: 'OK',\n    'Select time': 'Selecionar hora',\n};\n\nconst ptBR = {\n    ...datePickerPtBR,\n    ...calendarPtBR,\n    ...timePickerPtBR,\n};\n\nconst datePickerSkSK = {\n    Date: 'Dtum',\n    'MM/DD/YYYY': 'DD/MM/YYYY',\n    'Next month': 'al mesiac',\n    'Previous month': 'Predchdzajci mesiac',\n    'Choose Date': 'Vyberte dtum',\n};\n\nconst calendarSkSK = {\n    Today: 'Dnes',\n    Month: 'Mesiac',\n    Week: 'Tde',\n    Day: 'De',\n    List: 'Zoznam',\n    'Select View': 'Vyberte zobrazenie',\n    '+ {{n}} events': '+ {{n}} udalosti',\n    '+ 1 event': '+ 1 udalos',\n    'No events': 'iadne udalosti',\n    'Next period': 'alie obdobie',\n    'Previous period': 'Predchdzajce obdobie',\n    to: 'do', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': 'Celodenn a viacdov udalosti',\n    'Link to {{n}} more events on {{date}}': 'Odkaz na {{n}} alch udalost da {{date}}',\n    'Link to 1 more event on {{date}}': 'Odkaz na 1 aliu udalos da {{date}}',\n    CW: '{{week}}. tde',\n    View: 'Zobrazenie',\n};\n\nconst timePickerSkSK = {\n    Time: 'as',\n    AM: 'AM',\n    PM: 'PM',\n    Cancel: 'Zrui',\n    OK: 'OK',\n    'Select time': 'Vybra as',\n};\n\nconst skSK = {\n    ...datePickerSkSK,\n    ...calendarSkSK,\n    ...timePickerSkSK,\n};\n\nconst datePickerMkMK = {\n    Date: '',\n    'MM/DD/YYYY': 'DD/MM/YYYY',\n    'Next month': ' ',\n    'Previous month': ' ',\n    'Choose Date': ' ',\n};\n\nconst calendarMkMK = {\n    Today: '',\n    Month: '',\n    Week: '',\n    Day: '',\n    List: '',\n    'Select View': ' ',\n    '+ {{n}} events': '+ {{n}} ',\n    '+ 1 event': '+ 1 ',\n    'No events': ' ',\n    'Next period': ' ',\n    'Previous period': ' ',\n    to: '', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': '   ',\n    'Link to {{n}} more events on {{date}}': '  {{n}}    {{date}}',\n    'Link to 1 more event on {{date}}': '  1    {{date}}',\n    CW: ' {{week}}',\n    View: '',\n};\n\nconst timePickerMkMK = {\n    Time: '',\n    AM: 'AM',\n    PM: 'PM',\n    Cancel: '',\n    OK: ' ',\n    'Select time': ' ',\n};\n\nconst mkMK = {\n    ...datePickerMkMK,\n    ...calendarMkMK,\n    ...timePickerMkMK,\n};\n\nconst datePickerNbNO = {\n    Date: 'Dato',\n    'MM/DD/YYYY': 'DD.MM.YYYY',\n    'Next month': 'Neste mned',\n    'Previous month': 'Forrige mned',\n    'Choose Date': 'Velg dato',\n};\n\nconst calendarNbNO = {\n    Today: 'I dag',\n    Month: 'Mned',\n    Week: 'Uke',\n    Day: 'Dag',\n    List: 'Liste',\n    'Select View': 'Velg visning',\n    View: 'Visning',\n    '+ {{n}} events': '+ {{n}} hendelser',\n    '+ 1 event': '+ 1 hendelse',\n    'No events': 'Ingen hendelser',\n    'Next period': 'Neste periode',\n    'Previous period': 'Forrige periode',\n    to: 'til', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': 'Heldags- og flerdagshendelser',\n    'Link to {{n}} more events on {{date}}': 'Lenke til {{n}} flere hendelser p {{date}}',\n    'Link to 1 more event on {{date}}': 'Lenke til 1 hendelse til p {{date}}',\n    CW: 'Uke {{week}}',\n};\n\nconst timePickerNbNO = {\n    Time: 'Tid',\n    AM: 'AM',\n    PM: 'PM',\n    Cancel: 'Avbryt',\n    OK: 'OK',\n    'Select time': 'Velg tid',\n};\n\nconst nbNO = {\n    ...datePickerNbNO,\n    ...calendarNbNO,\n    ...timePickerNbNO,\n};\n\nconst datePickerTrTR = {\n    Date: 'Tarih',\n    'MM/DD/YYYY': 'GG/AA/YYYY',\n    'Next month': 'Sonraki ay',\n    'Previous month': 'nceki ay',\n    'Choose Date': 'Tarih Se',\n};\n\nconst calendarTrTR = {\n    Today: 'Bugn',\n    Month: 'Aylk',\n    Week: 'Haftalk',\n    Day: 'Gnlk',\n    List: 'Liste',\n    'Select View': 'Grnm Se',\n    '+ {{n}} events': '+ {{n}} etkinlikler',\n    '+ 1 event': '+ 1 etkinlik',\n    'No events': 'Etkinlik yok',\n    'Next period': 'Sonraki dnem',\n    'Previous period': 'nceki dnem',\n    to: 'dan', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': 'Tm gn ve oklu gn etkinlikleri',\n    'Link to {{n}} more events on {{date}}': '{{date}} tarihinde {{n}} etkinlie balant',\n    'Link to 1 more event on {{date}}': '{{date}} tarihinde 1 etkinlie balant',\n    CW: '{{week}}. Hafta',\n    View: 'Grnm',\n};\n\nconst timePickerTrTR = {\n    Time: 'Zaman',\n    AM: '',\n    PM: 'S',\n    Cancel: 'ptal',\n    OK: 'Tamam',\n    'Select time': 'Zaman se',\n};\n\nconst trTR = {\n    ...datePickerTrTR,\n    ...calendarTrTR,\n    ...timePickerTrTR,\n};\n\nconst datePickerKyKG = {\n    Date: '',\n    'MM/DD/YYYY': '//',\n    'Next month': ' ',\n    'Previous month': ' ',\n    'Choose Date': ' ',\n};\n\nconst calendarKyKG = {\n    Today: '',\n    Month: '',\n    Week: '',\n    Day: '',\n    List: '',\n    'Select View': ' ',\n    '+ {{n}} events': '+ {{n}} ',\n    '+ 1 event': '+ 1 ',\n    'No events': ' ',\n    'Next period': ' ',\n    'Previous period': ' ',\n    to: '', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': '         ',\n    'Link to {{n}} more events on {{date}}': '{{date}}  {{n}}  ',\n    'Link to 1 more event on {{date}}': '{{date}}  1  ',\n    CW: ' {{week}}',\n    View: '',\n};\n\nconst timePickerKyKG = {\n    Time: '',\n    AM: 'AM',\n    PM: 'PM',\n    Cancel: '',\n    OK: '',\n    'Select time': ' ',\n};\n\nconst kyKG = {\n    ...datePickerKyKG,\n    ...calendarKyKG,\n    ...timePickerKyKG,\n};\n\nconst datePickerIdID = {\n    Date: 'Tanggal',\n    'MM/DD/YYYY': 'DD.MM.YYYY',\n    'Next month': 'Bulan depan',\n    'Previous month': 'Bulan sebelumnya',\n    'Choose Date': 'Pilih tanggal',\n};\n\nconst calendarIdID = {\n    Today: 'Hari Ini',\n    Month: 'Bulan',\n    Week: 'Minggu',\n    Day: 'Hari',\n    List: 'Daftar',\n    'Select View': 'Pilih tampilan',\n    '+ {{n}} events': '+ {{n}} Acara',\n    '+ 1 event': '+ 1 Acara',\n    'No events': 'Tidak ada acara',\n    'Next period': 'Periode selanjutnya',\n    'Previous period': 'Periode sebelumnya',\n    to: 'sampai', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': 'Sepanjang hari dan acara beberapa hari ',\n    'Link to {{n}} more events on {{date}}': 'Tautan ke {{n}} acara lainnya pada {{date}}',\n    'Link to 1 more event on {{date}}': 'Tautan ke 1 acara lainnya pada {{date}}',\n    CW: 'Minggu {{week}}',\n    View: 'Tampilan',\n};\n\nconst timePickerIdID = {\n    Time: 'Waktu',\n    AM: 'AM',\n    PM: 'PM',\n    Cancel: 'Batalkan',\n    OK: 'OK',\n    'Select time': 'Pilih waktu',\n};\n\nconst idID = {\n    ...datePickerIdID,\n    ...calendarIdID,\n    ...timePickerIdID,\n};\n\nconst datePickerCsCZ = {\n    Date: 'Datum',\n    'MM/DD/YYYY': 'DD/MM/YYYY',\n    'Next month': 'Dal msc',\n    'Previous month': 'Pedchoz msc',\n    'Choose Date': 'Vyberte datum',\n};\n\nconst calendarCsCZ = {\n    Today: 'Dnes',\n    Month: 'Msc',\n    Week: 'Tden',\n    Day: 'Den',\n    List: 'Seznam',\n    'Select View': 'Vyberte zobrazen',\n    '+ {{n}} events': '+ {{n}} udlosti',\n    '+ 1 event': '+ 1 udlost',\n    'No events': 'dn udlosti',\n    'Next period': 'Pt obdob',\n    'Previous period': 'Pedchoz obdob',\n    to: 'do', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': 'Celodenn a vcedenn udlosti',\n    'Link to {{n}} more events on {{date}}': 'Odkaz na {{n}} dalch udlost dne {{date}}',\n    'Link to 1 more event on {{date}}': 'Odkaz na 1 dal udlost dne {{date}}',\n    CW: 'Tden {{week}}',\n    View: 'Zobrazen',\n};\n\nconst timePickerCsCZ = {\n    Time: 'as',\n    AM: 'Dopoledne',\n    PM: 'Odpoledne',\n    Cancel: 'Zruit',\n    OK: 'OK',\n    'Select time': 'Vyberte as',\n};\n\nconst csCZ = {\n    ...datePickerCsCZ,\n    ...calendarCsCZ,\n    ...timePickerCsCZ,\n};\n\nconst datePickerEtEE = {\n    Date: 'Kuupev',\n    'MM/DD/YYYY': 'PP.KK.AAAA',\n    'Next month': 'Jrgmine kuu',\n    'Previous month': 'Eelmine kuu',\n    'Choose Date': 'Vali kuupev',\n};\n\nconst calendarEtEE = {\n    Today: 'Tna',\n    Month: 'Kuu',\n    Week: 'Ndal',\n    Day: 'Pev',\n    List: 'Nimekiri',\n    'Select View': 'Vali vaade',\n    '+ {{n}} events': '+ {{n}} sndmused',\n    '+ 1 event': '+ 1 sndmus',\n    'No events': 'Pole sndmusi',\n    'Next period': 'Jrgmine periood',\n    'Previous period': 'Eelmine periood',\n    to: 'kuni',\n    'Full day- and multiple day events': 'Tispeva- ja mitmepevasndmused',\n    'Link to {{n}} more events on {{date}}': 'Link {{n}} rohkematele sndmustele kuupeval {{date}}',\n    'Link to 1 more event on {{date}}': 'Link hele lisasndmusele kuupeval {{date}}',\n    CW: 'Ndala number {{week}}',\n    View: 'Vaade',\n};\n\nconst timePickerEtEE = {\n    Time: 'Aeg',\n    AM: 'AM',\n    PM: 'PM',\n    Cancel: 'Loobu',\n    OK: 'OK',\n    'Select time': 'Vali aeg',\n};\n\nconst etEE = {\n    ...datePickerEtEE,\n    ...calendarEtEE,\n    ...timePickerEtEE,\n};\n\nconst datePickerUkUA = {\n    Date: '',\n    'MM/DD/YYYY': '//',\n    'Next month': ' ',\n    'Previous month': ' ',\n    'Choose Date': ' ',\n};\n\nconst calendarUkUA = {\n    Today: '',\n    Month: '',\n    Week: '',\n    Day: '',\n    List: '',\n    'Select View': ' ',\n    '+ {{n}} events': '+ {{n}} ',\n    '+ 1 event': '+ 1 ',\n    'No events': ' ',\n    'Next period': ' ',\n    'Previous period': ' ',\n    to: '', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': '       ',\n    'Link to {{n}} more events on {{date}}': '  {{n}}    {{date}}',\n    'Link to 1 more event on {{date}}': '  1    {{date}}',\n    CW: ' {{week}}',\n    View: '',\n};\n\nconst timePickerUkUA = {\n    Time: '',\n    AM: 'AM',\n    PM: 'PM',\n    Cancel: '',\n    OK: '',\n    'Select time': ' ',\n};\n\nconst ukUA = {\n    ...datePickerUkUA,\n    ...calendarUkUA,\n    ...timePickerUkUA,\n};\n\nconst datePickerSrLatnRS = {\n    Date: 'Datum',\n    'MM/DD/YYYY': 'DD/MM/YYYY',\n    'Next month': 'Sledei mesec',\n    'Previous month': 'Prethodni mesec',\n    'Choose Date': 'Izaberite datum',\n};\n\nconst calendarSrLatnRS = {\n    Today: 'Danas',\n    Month: 'Mesec',\n    Week: 'Nedelja',\n    Day: 'Dan',\n    List: 'Lista',\n    'Select View': 'Odaberite pregled',\n    '+ {{n}} events': '+ {{n}} Dogaaji',\n    '+ 1 event': '+ 1 Dogaaj',\n    'No events': 'Nema dogaaja',\n    'Next period': 'Naredni period',\n    'Previous period': 'Prethodni period',\n    to: 'do', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': 'Celodnevni i viednevni dogaaji',\n    'Link to {{n}} more events on {{date}}': 'Link do jo {{n}} dogaaja na {{date}}',\n    'Link to 1 more event on {{date}}': 'Link do jednog dogaaja na {{date}}',\n    CW: 'Nedelja {{week}}',\n    View: 'Pregled',\n};\n\nconst timePickerSrLatnRS = {\n    Time: 'Vrijeme',\n    AM: 'AM',\n    PM: 'PM',\n    Cancel: 'Otkai',\n    OK: 'U redu',\n    'Select time': 'Odaberi vrijeme',\n};\n\nconst srLatnRS = {\n    ...datePickerSrLatnRS,\n    ...calendarSrLatnRS,\n    ...timePickerSrLatnRS,\n};\n\nconst datePickerCaES = {\n    Date: 'Data',\n    'MM/DD/YYYY': 'DD/MM/YYYY',\n    'Next month': 'Segent mes',\n    'Previous month': 'Mes anterior',\n    'Choose Date': 'Selecciona una data',\n};\n\nconst calendarCaES = {\n    Today: 'Avui',\n    Month: 'Mes',\n    Week: 'Setmana',\n    Day: 'Dia',\n    List: 'Llista',\n    'Select View': 'Selecciona una vista',\n    '+ {{n}} events': '+ {{n}} Esdeveniments',\n    '+ 1 event': '+ 1 Esdeveniment',\n    'No events': 'Sense esdeveniments',\n    'Next period': 'Segent perode',\n    'Previous period': 'Perode anterior',\n    to: 'a', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': 'Esdeveniments de dia complet i de mltiples dies',\n    'Link to {{n}} more events on {{date}}': 'Enlla a {{n}} esdeveniments ms el {{date}}',\n    'Link to 1 more event on {{date}}': 'Enlla a 1 esdeveniment ms el {{date}}',\n    CW: 'Setmana {{week}}',\n    View: 'Vista',\n};\n\nconst timePickerCaES = {\n    Time: 'Hora',\n    AM: 'AM',\n    PM: 'PM',\n    Cancel: 'Cancellar',\n    OK: 'Acceptar',\n    'Select time': 'Selecciona una hora',\n};\n\nconst caES = {\n    ...datePickerCaES,\n    ...calendarCaES,\n    ...timePickerCaES,\n};\n\nconst datePickerSrRS = {\n    Date: '',\n    'MM/DD/YYYY': 'DD/MM/YYYY',\n    'Next month': ' ',\n    'Previous month': ' ',\n    'Choose Date': ' ',\n};\n\nconst calendarSrRS = {\n    Today: '',\n    Month: '',\n    Week: '',\n    Day: '',\n    List: '',\n    'Select View': ' ',\n    '+ {{n}} events': '+ {{n}} ',\n    '+ 1 event': '+ 1 ',\n    'No events': ' ',\n    'Next period': ' ',\n    'Previous period': ' ',\n    to: '', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': '   ',\n    'Link to {{n}} more events on {{date}}': '   {{n}}   {{date}}',\n    'Link to 1 more event on {{date}}': '   1  {{date}}',\n    CW: ' {{week}}',\n    View: '',\n};\n\nconst timePickerSrRS = {\n    Time: '',\n    AM: 'AM',\n    PM: 'PM',\n    Cancel: '',\n    OK: ' ',\n    'Select time': ' ',\n};\n\nconst srRS = {\n    ...datePickerSrRS,\n    ...calendarSrRS,\n    ...timePickerSrRS,\n};\n\nconst datePickerLtLT = {\n    Date: 'Data',\n    'MM/DD/YYYY': 'MMMM-MM-DD',\n    'Next month': 'Kitas mnuo',\n    'Previous month': 'Ankstesnis mnuo',\n    'Choose Date': 'Pasirinkite dat',\n};\n\nconst calendarLtLT = {\n    Today: 'iandien',\n    Month: 'Mnuo',\n    Week: 'Savait',\n    Day: 'Diena',\n    List: 'Sraas',\n    'Select View': 'Pasirinkite vaizd',\n    '+ {{n}} events': '+ {{n}} vykiai',\n    '+ 1 event': '+ 1 vykis',\n    'No events': 'vyki nra',\n    'Next period': 'Kitas laikotarpis',\n    'Previous period': 'Ankstesnis laikotarpis',\n    to: 'iki', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': 'Visos dienos ir keli dien vykiai',\n    'Link to {{n}} more events on {{date}}': 'Nuoroda  dar {{n}} vykius {{date}}',\n    'Link to 1 more event on {{date}}': 'Nuoroda  dar 1 vien vyk {{date}}',\n    CW: '{{week}} savait',\n    View: 'Vaizdas',\n};\n\nconst timePickerLtLT = {\n    Time: 'Laikas',\n    AM: 'AM',\n    PM: 'PM',\n    Cancel: 'Ataukti',\n    OK: 'Gerai',\n    'Select time': 'Pasirinkite laik',\n};\n\nconst ltLT = {\n    ...datePickerLtLT,\n    ...calendarLtLT,\n    ...timePickerLtLT,\n};\n\nconst datePickerHrHR = {\n    Date: 'Datum',\n    'MM/DD/YYYY': 'DD/MM/YYYY',\n    'Next month': 'Sljedei mjesec',\n    'Previous month': 'Prethodni mjesec',\n    'Choose Date': 'Izaberite datum',\n};\n\nconst calendarHrHR = {\n    Today: 'Danas',\n    Month: 'Mjesec',\n    Week: 'Nedjelja',\n    Day: 'Dan',\n    List: 'Lista',\n    'Select View': 'Odaberite pregled',\n    '+ {{n}} events': '+ {{n}} Dogaaji',\n    '+ 1 event': '+ 1 Dogaaj',\n    'No events': 'Nema dogaaja',\n    'Next period': 'Sljedei period',\n    'Previous period': 'Prethodni period',\n    to: 'do', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': 'Cjelodnevni i viednevni dogaaji',\n    'Link to {{n}} more events on {{date}}': 'Link do jo {{n}} dogaaja na {{date}}',\n    'Link to 1 more event on {{date}}': 'Link do jo jednog dogaaja na {{date}}',\n    CW: '{{week}}. tjedan',\n    View: 'Pregled',\n};\n\nconst timePickerHrHR = {\n    Time: 'Vrijeme',\n    AM: 'AM',\n    PM: 'PM',\n    Cancel: 'Otkai',\n    OK: 'U redu',\n    'Select time': 'Odaberi vrijeme',\n};\n\nconst hrHR = {\n    ...datePickerHrHR,\n    ...calendarHrHR,\n    ...timePickerHrHR,\n};\n\nconst datePickerSlSI = {\n    Date: 'Datum',\n    'MM/DD/YYYY': 'MM.DD.YYYY',\n    'Next month': 'Naslednji mesec',\n    'Previous month': 'Prejnji mesec',\n    'Choose Date': 'Izberi datum',\n};\n\nconst calendarSlSI = {\n    Today: 'Danes',\n    Month: 'Mesec',\n    Week: 'Teden',\n    Day: 'Dan',\n    List: 'Seznam',\n    'Select View': 'Izberi pogled',\n    '+ {{n}} events': '+ {{n}} dogodki',\n    '+ 1 event': '+ 1 dogodek',\n    'No events': 'Ni dogodkov',\n    'Next period': 'Naslednji dogodek',\n    'Previous period': 'Prejnji dogodek',\n    to: 'do', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': 'Celodnevni in vednevni dogodki',\n    'Link to {{n}} more events on {{date}}': 'Povezava do {{n}} drugih dogodkov dne {{date}}',\n    'Link to 1 more event on {{date}}': 'Povezava do e enega dogodka dne {{date}}',\n    CW: 'Teden {{week}}',\n    View: 'Pogled',\n};\n\nconst timePickerSlSI = {\n    Time: 'as',\n    AM: 'AM',\n    PM: 'PM',\n    Cancel: 'Preklii',\n    OK: 'V redu',\n    'Select time': 'Izberite as',\n};\n\nconst slSI = {\n    ...datePickerSlSI,\n    ...calendarSlSI,\n    ...timePickerSlSI,\n};\n\nconst datePickerFiFI = {\n    Date: 'Pivmr',\n    'MM/DD/YYYY': 'VVVV-KK-PP',\n    'Next month': 'Seuraava kuukausi',\n    'Previous month': 'Edellinen kuukausi',\n    'Choose Date': 'Valitse pivmr',\n};\n\nconst calendarFiFI = {\n    Today: 'Tnn',\n    Month: 'Kuukausi',\n    Week: 'Viikko',\n    Day: 'Piv',\n    List: 'Lista',\n    'Select View': 'Valitse nkym',\n    '+ {{n}} events': '+ {{n}} tapahtumaa',\n    '+ 1 event': '+ 1 tapahtuma',\n    'No events': 'Ei tapahtumia',\n    'Next period': 'Seuraava ajanjakso',\n    'Previous period': 'Edellinen ajanjakso',\n    to: '-', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': 'Koko ja usean pivn tapahtumat',\n    'Link to {{n}} more events on {{date}}': 'Linkki {{n}} listapahtumaan pivmrll {{date}}',\n    'Link to 1 more event on {{date}}': 'Linkki 1 listapahtumaan pivmrll {{date}}',\n    CW: 'Viikko {{week}}',\n    View: 'Nkym',\n};\n\nconst timePickerFiFI = {\n    Time: 'Aika',\n    AM: 'ap.',\n    PM: 'ip.',\n    Cancel: 'Peruuta',\n    OK: 'OK',\n    'Select time': 'Valitse aika',\n};\n\nconst fiFI = {\n    ...datePickerFiFI,\n    ...calendarFiFI,\n    ...timePickerFiFI,\n};\n\nconst datePickerRoRO = {\n    Date: 'Data',\n    'MM/DD/YYYY': 'LL/ZZ/AAAA',\n    'Next month': 'Luna urmtoare',\n    'Previous month': 'Luna anterioar',\n    'Choose Date': 'Alege data',\n};\n\nconst calendarRoRO = {\n    Today: 'Astzi',\n    Month: 'Lun',\n    Week: 'Sptmn',\n    Day: 'Zi',\n    List: 'List',\n    'Select View': 'Selecteaz vizualizarea',\n    '+ {{n}} events': '+ {{n}} evenimente',\n    '+ 1 event': '+ 1 eveniment',\n    'No events': 'Fr evenimente',\n    'Next period': 'Perioada urmtoare',\n    'Previous period': 'Perioada anterioar',\n    to: 'pn la', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': 'Evenimente pe durata ntregii zile i pe durata mai multor zile',\n    'Link to {{n}} more events on {{date}}': 'Link ctre {{n}} evenimente suplimentare pe {{date}}',\n    'Link to 1 more event on {{date}}': 'Link ctre 1 eveniment suplimentar pe {{date}}',\n    CW: 'Sptmna {{week}}',\n    View: 'Vizualizare',\n};\n\nconst timePickerRoRO = {\n    Time: 'Timp',\n    AM: 'AM',\n    PM: 'PM',\n    Cancel: 'Anuleaz',\n    OK: 'OK',\n    'Select time': 'Selectai ora',\n};\n\nconst roRO = {\n    ...datePickerRoRO,\n    ...calendarRoRO,\n    ...timePickerRoRO,\n};\n\nconst datePickerFaIR = {\n    Date: '',\n    'MM/DD/YYYY': 'MM/DD/YYYY',\n    'Next month': ' ',\n    'Previous month': ' ',\n    'Choose Date': ' ',\n};\n\nconst calendarFaIR = {\n    Today: '',\n    Month: '',\n    Week: '',\n    Day: '',\n    List: '',\n    'Select View': ' ',\n    '+ {{n}} events': '+ {{n}} ',\n    '+ 1 event': '+ 1 ',\n    'No events': '  ',\n    'Next period': ' ',\n    'Previous period': ' ',\n    to: '',\n    'Full day- and multiple day events': '     ',\n    'Link to {{n}} more events on {{date}}': '  {{n}}     {{date}}',\n    'Link to 1 more event on {{date}}': '  1     {{date}}',\n    CW: ' {{week}}',\n    View: '',\n};\n\nconst timePickerFaIR = {\n    Time: '',\n    AM: '.',\n    PM: '.',\n    Cancel: '',\n    OK: '',\n    'Select time': ' ',\n};\n\nconst faIR = {\n    ...datePickerFaIR,\n    ...calendarFaIR,\n    ...timePickerFaIR,\n};\n\nclass InvalidLocaleError extends Error {\n    constructor(locale) {\n        super(`Invalid locale: ${locale}`);\n    }\n}\n\nconst translate = (locale, languages) => (key, translationVariables) => {\n    if (!/^[a-z]{2}-[A-Z]{2}$/.test(locale.value) &&\n        'sr-Latn-RS' !== locale.value) {\n        throw new InvalidLocaleError(locale.value);\n    }\n    const deHyphenatedLocale = locale.value.replaceAll('-', '');\n    const language = languages.value[deHyphenatedLocale];\n    if (!language)\n        return key;\n    let translation = language[key] || key;\n    Object.keys(translationVariables || {}).forEach((variable) => {\n        const value = String(translationVariables === null || translationVariables === void 0 ? void 0 : translationVariables[variable]);\n        if (!value)\n            return;\n        translation = translation.replace(`{{${variable}}}`, value);\n    });\n    return translation;\n};\n\nconst datePickerHeIL = {\n    Date: '',\n    'MM/DD/YYYY': 'MM/DD/YYYY',\n    'Next month': ' ',\n    'Previous month': ' ',\n    'Choose Date': ' ',\n};\n\nconst calendarHeIL = {\n    Today: '',\n    Month: '',\n    Week: '',\n    Day: '',\n    List: '',\n    'Select View': ' ',\n    '+ {{n}} events': '+ {{n}} ',\n    '+ 1 event': '+ 1 ',\n    'No events': ' ',\n    'Next period': ' ',\n    'Previous period': ' ',\n    to: '', // as in 2/1/2020 to 2/2/2020\n    'Full day- and multiple day events': '    ',\n    'Link to {{n}} more events on {{date}}': '  {{n}}  -{{date}}',\n    'Link to 1 more event on {{date}}': '   -{{date}}',\n    CW: '{{week}} ',\n    View: '',\n};\n\nconst timePickerHeIL = {\n    Time: '',\n    AM: '\"',\n    PM: '\"',\n    Cancel: '',\n    OK: '',\n    'Select time': ' ',\n};\n\nconst heIL = {\n    ...datePickerHeIL,\n    ...calendarHeIL,\n    ...timePickerHeIL,\n};\n\nconst translations = {\n    deDE,\n    enUS,\n    itIT,\n    enGB,\n    svSE,\n    zhCN,\n    zhTW,\n    jaJP,\n    ruRU,\n    koKR,\n    frFR,\n    daDK,\n    mkMK,\n    nbNO,\n    plPL,\n    heIL,\n    esES,\n    nlNL,\n    ptBR,\n    skSK,\n    trTR,\n    kyKG,\n    idID,\n    csCZ,\n    etEE,\n    ukUA,\n    caES,\n    srLatnRS,\n    srRS,\n    ltLT,\n    hrHR,\n    slSI,\n    fiFI,\n    roRO,\n    faIR,\n    arEG,\n};\n\nclass EventColors {\n    constructor(config) {\n        Object.defineProperty(this, \"config\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: config\n        });\n    }\n    setLight() {\n        Object.entries(this.config.calendars.value || {}).forEach(([calendarName, calendar]) => {\n            if (!calendar.lightColors) {\n                console.warn(`No light colors defined for calendar ${calendarName}`);\n                return;\n            }\n            this.setColors(calendar.colorName, calendar.lightColors);\n        });\n    }\n    setDark() {\n        Object.entries(this.config.calendars.value || {}).forEach(([calendarName, calendar]) => {\n            if (!calendar.darkColors) {\n                console.warn(`No dark colors defined for calendar ${calendarName}`);\n                return;\n            }\n            this.setColors(calendar.colorName, calendar.darkColors);\n        });\n    }\n    setColors(colorName, colorDefinition) {\n        document.documentElement.style.setProperty(`--sx-color-${colorName}`, colorDefinition.main);\n        document.documentElement.style.setProperty(`--sx-color-${colorName}-container`, colorDefinition.container);\n        document.documentElement.style.setProperty(`--sx-color-on-${colorName}-container`, colorDefinition.onContainer);\n    }\n}\n\nconst createCalendarState = (calendarConfig, timeUnitsImpl, selectedDate) => {\n    var _a;\n    const _view = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(((_a = calendarConfig.views.value.find((view) => view.name === calendarConfig.defaultView)) === null || _a === void 0 ? void 0 : _a.name) || calendarConfig.views.value[0].name);\n    const view = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.computed)(() => {\n        return _view.value;\n    });\n    const range = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(null);\n    let wasInitialized = false;\n    let lastRangeEmitted__NEEDED_TO_PREVENT_RECURSION_IN_EVENT_RECURRENCE_PACKAGE_WHICH_CAUSES_RANGE_TO_UPDATE_AND_THUS_CAUSES_A_CYCLE = null;\n    const callOnRangeUpdate = (_range) => {\n        const lastRange = lastRangeEmitted__NEEDED_TO_PREVENT_RECURSION_IN_EVENT_RECURRENCE_PACKAGE_WHICH_CAUSES_RANGE_TO_UPDATE_AND_THUS_CAUSES_A_CYCLE;\n        if (!_range.value)\n            return;\n        if ((lastRange === null || lastRange === void 0 ? void 0 : lastRange.start.toString()) === _range.value.start.toString() &&\n            (lastRange === null || lastRange === void 0 ? void 0 : lastRange.end.toString()) === _range.value.end.toString())\n            return;\n        if (!wasInitialized)\n            return (wasInitialized = true);\n        if (calendarConfig.callbacks.onRangeUpdate && _range.value) {\n            calendarConfig.callbacks.onRangeUpdate(_range.value);\n        }\n        Object.values(calendarConfig.plugins || {}).forEach((plugin) => {\n            var _a;\n            (_a = plugin === null || plugin === void 0 ? void 0 : plugin.onRangeUpdate) === null || _a === void 0 ? void 0 : _a.call(plugin, _range.value);\n            lastRangeEmitted__NEEDED_TO_PREVENT_RECURSION_IN_EVENT_RECURRENCE_PACKAGE_WHICH_CAUSES_RANGE_TO_UPDATE_AND_THUS_CAUSES_A_CYCLE =\n                _range.value;\n        });\n    };\n    (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.effect)(() => {\n        if (range.value) {\n            callOnRangeUpdate(range);\n        }\n    });\n    const setRange = (date) => {\n        var _a, _b;\n        const selectedView = calendarConfig.views.value.find((availableView) => availableView.name === _view.value);\n        const newRange = selectedView.setDateRange({\n            calendarConfig,\n            date,\n            range,\n            timeUnitsImpl,\n        });\n        if (newRange.start.toString() === ((_a = range.value) === null || _a === void 0 ? void 0 : _a.start.toString()) &&\n            newRange.end.toString() === ((_b = range.value) === null || _b === void 0 ? void 0 : _b.end.toString()))\n            return;\n        range.value = newRange;\n    };\n    // one initial call for setting the range\n    setRange(selectedDate ||\n        Temporal.PlainDate.from(Temporal.Now.plainDateISO(calendarConfig.timezone.value)));\n    const isCalendarSmall = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(undefined);\n    const isDark = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(calendarConfig.isDark.value || false);\n    (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.effect)(() => {\n        const eventColors = new EventColors(calendarConfig);\n        if (isDark.value) {\n            eventColors.setDark();\n        }\n        else {\n            eventColors.setLight();\n        }\n    });\n    return {\n        view,\n        isDark,\n        setRange,\n        range,\n        isCalendarSmall,\n        setView: (newView, selectedDate) => {\n            (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.batch)(() => {\n                _view.value = newView;\n                setRange(selectedDate);\n            });\n        },\n    };\n};\n\nconst createCalendarEventsImpl = (events, backgroundEvents, config) => {\n    const list = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(events.map((event) => {\n        return externalEventToInternal(event, config);\n    }));\n    const filterPredicate = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(undefined);\n    return {\n        list,\n        filterPredicate,\n        backgroundEvents: (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(backgroundEvents),\n    };\n};\n\nconst timePointsPerDay = (dayStart, dayEnd, isHybridDay) => {\n    if (dayStart === dayEnd)\n        return 2400;\n    if (isHybridDay)\n        return 2400 - dayStart + dayEnd;\n    return dayEnd - dayStart;\n};\n\nconst getDirection = () => {\n    const html = document.querySelector('html');\n    if (!html) {\n        return 'ltr';\n    }\n    const direction = html.getAttribute('dir');\n    if (direction === 'rtl') {\n        return 'rtl';\n    }\n    return 'ltr';\n};\n\nclass CalendarConfigImpl {\n    constructor(locale = DEFAULT_LOCALE, firstDayOfWeek = DEFAULT_FIRST_DAY_OF_WEEK, defaultView = InternalViewName.Week, views = [], dayBoundaries = DEFAULT_DAY_BOUNDARIES, weekOptions, calendars = {}, plugins = {}, isDark = false, isResponsive = true, callbacks = {}, _customComponentFns = {}, minDate = undefined, maxDate = undefined, monthGridOptions = {\n        nEventsPerDay: 4,\n    }, theme = undefined, translations = {}, showWeekNumbers = false, timezone = 'UTC') {\n        Object.defineProperty(this, \"defaultView\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: defaultView\n        });\n        Object.defineProperty(this, \"plugins\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: plugins\n        });\n        Object.defineProperty(this, \"isResponsive\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: isResponsive\n        });\n        Object.defineProperty(this, \"callbacks\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: callbacks\n        });\n        Object.defineProperty(this, \"_customComponentFns\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: _customComponentFns\n        });\n        Object.defineProperty(this, \"firstDayOfWeek\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"views\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"dayBoundaries\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"weekOptions\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"calendars\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"isDark\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"minDate\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"maxDate\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"monthGridOptions\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"locale\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(DEFAULT_LOCALE)\n        });\n        Object.defineProperty(this, \"theme\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"translations\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"showWeekNumbers\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(false)\n        });\n        Object.defineProperty(this, \"direction\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 'ltr'\n        });\n        Object.defineProperty(this, \"timezone\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_destroyCustomComponentInstance\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.locale = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(locale);\n        this.firstDayOfWeek = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(firstDayOfWeek);\n        this.views = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(views);\n        this.dayBoundaries = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(dayBoundaries);\n        this.weekOptions = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(weekOptions);\n        this.calendars = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(calendars);\n        this.isDark = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(isDark);\n        this.minDate = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(minDate);\n        this.maxDate = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(maxDate);\n        this.monthGridOptions = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(monthGridOptions);\n        this.theme = theme;\n        this.translations = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(translations);\n        this.showWeekNumbers = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(showWeekNumbers);\n        this.direction = getDirection();\n        this.timezone = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(timezone);\n    }\n    get isHybridDay() {\n        return (this.dayBoundaries.value.start > this.dayBoundaries.value.end ||\n            (this.dayBoundaries.value.start !== 0 &&\n                this.dayBoundaries.value.start === this.dayBoundaries.value.end));\n    }\n    get timePointsPerDay() {\n        return timePointsPerDay(this.dayBoundaries.value.start, this.dayBoundaries.value.end, this.isHybridDay);\n    }\n}\n\nclass CalendarConfigBuilder {\n    constructor() {\n        Object.defineProperty(this, \"locale\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"firstDayOfWeek\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"defaultView\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"views\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"dayBoundaries\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"weekOptions\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: {\n                gridHeight: DEFAULT_WEEK_GRID_HEIGHT,\n                nDays: 7,\n                eventWidth: 100,\n                timeAxisFormatOptions: { hour: 'numeric' },\n                eventOverlap: true,\n                gridStep: 60,\n            }\n        });\n        Object.defineProperty(this, \"monthGridOptions\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"calendars\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"plugins\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: {}\n        });\n        Object.defineProperty(this, \"isDark\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: false\n        });\n        Object.defineProperty(this, \"isResponsive\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: true\n        });\n        Object.defineProperty(this, \"callbacks\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"minDate\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"maxDate\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"backgroundEvents\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"timezone\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"theme\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        // TODO: Change for V3. Should only be configured from outside\n        Object.defineProperty(this, \"translations\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"showWeekNumbers\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n    }\n    build() {\n        const minDate = this.minDate\n            ? Temporal.PlainDate.from(this.minDate)\n            : undefined;\n        const maxDate = this.maxDate\n            ? Temporal.PlainDate.from(this.maxDate)\n            : undefined;\n        return new CalendarConfigImpl(this.locale || DEFAULT_LOCALE, typeof this.firstDayOfWeek === 'number'\n            ? this.firstDayOfWeek\n            : DEFAULT_FIRST_DAY_OF_WEEK, this.defaultView || InternalViewName.Week, this.views || [], this.dayBoundaries || DEFAULT_DAY_BOUNDARIES, this.weekOptions, this.calendars, this.plugins, this.isDark, this.isResponsive, this.callbacks, {}, minDate, maxDate, this.monthGridOptions, this.theme, this.translations, this.showWeekNumbers, this.timezone);\n    }\n    withLocale(locale) {\n        this.locale = locale;\n        return this;\n    }\n    withTranslations(translation) {\n        this.translations = translation;\n        return this;\n    }\n    withFirstDayOfWeek(firstDayOfWeek) {\n        this.firstDayOfWeek = firstDayOfWeek;\n        return this;\n    }\n    withDefaultView(defaultView) {\n        this.defaultView = defaultView;\n        return this;\n    }\n    withViews(views) {\n        this.views = views;\n        return this;\n    }\n    withDayBoundaries(dayBoundaries) {\n        if (!dayBoundaries)\n            return this;\n        this.dayBoundaries = {\n            start: timePointsFromString(dayBoundaries.start),\n            end: timePointsFromString(dayBoundaries.end),\n        };\n        return this;\n    }\n    withWeekOptions(userDefinedWeekOptions) {\n        this.weekOptions = {\n            ...this.weekOptions,\n            ...userDefinedWeekOptions,\n        };\n        if (this.weekOptions.gridStep !== 60 &&\n            (userDefinedWeekOptions === null || userDefinedWeekOptions === void 0 ? void 0 : userDefinedWeekOptions.timeAxisFormatOptions) === undefined) {\n            this.weekOptions.timeAxisFormatOptions = {\n                hour: 'numeric',\n                minute: 'numeric',\n            };\n        }\n        return this;\n    }\n    withCalendars(calendars) {\n        this.calendars = calendars;\n        return this;\n    }\n    withPlugins(plugins) {\n        if (!plugins)\n            return this;\n        plugins.forEach((plugin) => {\n            this.plugins[plugin.name] = plugin;\n        });\n        return this;\n    }\n    withIsDark(isDark) {\n        this.isDark = isDark;\n        return this;\n    }\n    withIsResponsive(isResponsive) {\n        this.isResponsive = isResponsive;\n        return this;\n    }\n    withCallbacks(listeners) {\n        this.callbacks = listeners;\n        return this;\n    }\n    withMinDate(minDate) {\n        this.minDate = minDate;\n        return this;\n    }\n    withMaxDate(maxDate) {\n        this.maxDate = maxDate;\n        return this;\n    }\n    withMonthGridOptions(monthOptions) {\n        this.monthGridOptions = monthOptions;\n        return this;\n    }\n    withBackgroundEvents(backgroundEvents) {\n        this.backgroundEvents = backgroundEvents;\n        return this;\n    }\n    withTheme(theme) {\n        this.theme = theme;\n        return this;\n    }\n    withWeekNumbers(showWeekNumbers) {\n        this.showWeekNumbers = showWeekNumbers;\n        return this;\n    }\n    withTimezone(timezone) {\n        this.timezone = timezone;\n        return this;\n    }\n}\n\nconst createInternalConfig = (config, plugins) => {\n    return new CalendarConfigBuilder()\n        .withLocale(config.locale)\n        .withFirstDayOfWeek(config.firstDayOfWeek)\n        .withDefaultView(config.defaultView)\n        .withViews(config.views)\n        .withDayBoundaries(config.dayBoundaries)\n        .withWeekOptions(config.weekOptions)\n        .withCalendars(config.calendars)\n        .withPlugins(plugins)\n        .withIsDark(config.isDark)\n        .withIsResponsive(config.isResponsive)\n        .withCallbacks(config.callbacks)\n        .withMinDate(config.minDate ? config.minDate.toString() : undefined)\n        .withMaxDate(config.maxDate ? config.maxDate.toString() : undefined)\n        .withMonthGridOptions(config.monthGridOptions)\n        .withBackgroundEvents(config.backgroundEvents)\n        .withTheme(config.theme)\n        .withTranslations(config.translations || translations)\n        .withWeekNumbers(config.showWeekNumbers)\n        .withTimezone(config.timezone)\n        .build();\n};\n\nvar Month;\n(function (Month) {\n    Month[Month[\"JANUARY\"] = 1] = \"JANUARY\";\n    Month[Month[\"FEBRUARY\"] = 2] = \"FEBRUARY\";\n    Month[Month[\"MARCH\"] = 3] = \"MARCH\";\n    Month[Month[\"APRIL\"] = 4] = \"APRIL\";\n    Month[Month[\"MAY\"] = 5] = \"MAY\";\n    Month[Month[\"JUNE\"] = 6] = \"JUNE\";\n    Month[Month[\"JULY\"] = 7] = \"JULY\";\n    Month[Month[\"AUGUST\"] = 8] = \"AUGUST\";\n    Month[Month[\"SEPTEMBER\"] = 9] = \"SEPTEMBER\";\n    Month[Month[\"OCTOBER\"] = 10] = \"OCTOBER\";\n    Month[Month[\"NOVEMBER\"] = 11] = \"NOVEMBER\";\n    Month[Month[\"DECEMBER\"] = 12] = \"DECEMBER\";\n})(Month || (Month = {}));\n\nclass NoYearZeroError extends Error {\n    constructor() {\n        super('Year zero does not exist in the Gregorian calendar.');\n    }\n}\n\nclass TimeUnitsImpl {\n    constructor(config) {\n        Object.defineProperty(this, \"config\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: config\n        });\n    }\n    get firstDayOfWeek() {\n        return this.config.firstDayOfWeek.value;\n    }\n    set firstDayOfWeek(firstDayOfWeek) {\n        this.config.firstDayOfWeek.value = firstDayOfWeek;\n    }\n    getMonth(year, month) {\n        if (year === 0)\n            throw new NoYearZeroError();\n        const firstDateOfMonth = Temporal.PlainDate.from({\n            year,\n            month: month,\n            day: 1,\n        });\n        const lastDateOfMonth = firstDateOfMonth\n            .toPlainYearMonth()\n            .toPlainDate({ day: firstDateOfMonth.toPlainYearMonth().daysInMonth });\n        const dates = [];\n        let currentDate = firstDateOfMonth;\n        while (Temporal.PlainDate.compare(currentDate, lastDateOfMonth) <= 0) {\n            dates.push(currentDate.toZonedDateTime(this.config.timezone.value));\n            currentDate = currentDate.add({ days: 1 });\n        }\n        return dates;\n    }\n    getMonthWithTrailingAndLeadingDays(year, month) {\n        if (year === 0)\n            throw new NoYearZeroError();\n        const firstDateOfMonth = Temporal.PlainDate.from({\n            year,\n            month: month,\n            day: 1,\n        });\n        const monthWithDates = [this.getWeekForTemporal(firstDateOfMonth)];\n        let isInMonth = true;\n        let currentWeekStart = monthWithDates[0][0]; // first day of first week of month\n        while (isInMonth) {\n            const nextWeekStart = currentWeekStart.add({ days: 7 });\n            // Check if the next week contains any dates from the target month\n            const nextWeekDates = this.getWeekForTemporal(nextWeekStart);\n            const hasDatesInTargetMonth = nextWeekDates.some((date) => date.month === month);\n            if (hasDatesInTargetMonth) {\n                monthWithDates.push(nextWeekDates);\n                currentWeekStart = nextWeekStart;\n            }\n            else {\n                isInMonth = false;\n            }\n        }\n        // Convert Temporal.PlainDate arrays to Temporal.ZonedDateTime arrays\n        return monthWithDates.map((week) => week.map((plainDate) => plainDate.toZonedDateTime(this.config.timezone.value)));\n    }\n    getWeekFor(date) {\n        const plainDate = date instanceof Temporal.PlainDate ? date : date.toPlainDate();\n        const week = [\n            this.getFirstDateOfWeekTemporal(plainDate).toZonedDateTime(this.config.timezone.value),\n        ];\n        while (week.length < 7) {\n            const lastDateOfWeek = week[week.length - 1];\n            const nextDateOfWeek = lastDateOfWeek.add({ days: 1 });\n            week.push(nextDateOfWeek);\n        }\n        return week;\n    }\n    getMonthsFor(year) {\n        if (year === 0)\n            throw new NoYearZeroError();\n        return Object.values(Month)\n            .filter((month) => !isNaN(Number(month)))\n            .map((month) => Temporal.PlainDate.from({ year, month: Number(month), day: 1 }));\n    }\n    getWeekForTemporal(date) {\n        const week = [this.getFirstDateOfWeekTemporal(date)];\n        while (week.length < 7) {\n            const lastDateOfWeek = week[week.length - 1];\n            const nextDateOfWeek = lastDateOfWeek.add({ days: 1 });\n            week.push(nextDateOfWeek);\n        }\n        return week;\n    }\n    getFirstDateOfWeekTemporal(date) {\n        const dateIsNthDayOfWeek = date.dayOfWeek - this.firstDayOfWeek;\n        if (dateIsNthDayOfWeek === 0) {\n            return date;\n        }\n        else if (dateIsNthDayOfWeek > 0) {\n            return date.subtract({ days: dateIsNthDayOfWeek });\n        }\n        else {\n            return date.subtract({ days: 7 + dateIsNthDayOfWeek });\n        }\n    }\n}\n\nclass TimeUnitsBuilder {\n    constructor() {\n        Object.defineProperty(this, \"config\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n    }\n    build() {\n        return new TimeUnitsImpl(this.config);\n    }\n    withConfig(config) {\n        this.config = config;\n        return this;\n    }\n}\n\nconst createTimeUnitsImpl = (internalConfig) => {\n    return new TimeUnitsBuilder().withConfig(internalConfig).build();\n};\n\nvar Placement;\n(function (Placement) {\n    Placement[\"TOP_START\"] = \"top-start\";\n    Placement[\"TOP_END\"] = \"top-end\";\n    Placement[\"BOTTOM_START\"] = \"bottom-start\";\n    Placement[\"BOTTOM_END\"] = \"bottom-end\";\n})(Placement || (Placement = {}));\n\nclass ConfigImpl {\n    constructor(locale = DEFAULT_LOCALE, firstDayOfWeek = DEFAULT_FIRST_DAY_OF_WEEK, timezone = 'UTC', min = Temporal.PlainDate.from({\n        year: 1970,\n        month: 1,\n        day: 1,\n    }), max = Temporal.PlainDate.from({\n        year: new Date().getFullYear() + 50,\n        month: 11,\n        day: 31,\n    }), placement = Placement.BOTTOM_START, listeners = {}, style = {}, teleportTo, label, name, disabled, hasPlaceholder) {\n        Object.defineProperty(this, \"min\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: min\n        });\n        Object.defineProperty(this, \"max\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: max\n        });\n        Object.defineProperty(this, \"placement\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: placement\n        });\n        Object.defineProperty(this, \"listeners\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: listeners\n        });\n        Object.defineProperty(this, \"style\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: style\n        });\n        Object.defineProperty(this, \"teleportTo\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: teleportTo\n        });\n        Object.defineProperty(this, \"label\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: label\n        });\n        Object.defineProperty(this, \"name\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: name\n        });\n        Object.defineProperty(this, \"disabled\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: disabled\n        });\n        Object.defineProperty(this, \"hasPlaceholder\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: hasPlaceholder\n        });\n        Object.defineProperty(this, \"locale\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"firstDayOfWeek\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"timezone\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.locale = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(locale);\n        this.firstDayOfWeek = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(firstDayOfWeek);\n        this.timezone = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.signal)(timezone);\n    }\n}\n\nclass ConfigBuilder {\n    constructor() {\n        Object.defineProperty(this, \"locale\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"firstDayOfWeek\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"timezone\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"min\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"max\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"placement\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"listeners\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"style\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"teleportTo\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"label\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"name\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"disabled\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"hasPlaceholder\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n    }\n    build() {\n        return new ConfigImpl(this.locale, this.firstDayOfWeek, this.timezone, this.min, this.max, this.placement, this.listeners, this.style, this.teleportTo, this.label, this.name, this.disabled, this.hasPlaceholder);\n    }\n    withLocale(locale) {\n        this.locale = locale;\n        return this;\n    }\n    withFirstDayOfWeek(firstDayOfWeek) {\n        this.firstDayOfWeek = firstDayOfWeek;\n        return this;\n    }\n    withTimezone(timezone) {\n        this.timezone = timezone;\n        return this;\n    }\n    withMin(min) {\n        this.min = min;\n        return this;\n    }\n    withMax(max) {\n        this.max = max;\n        return this;\n    }\n    withPlacement(placement) {\n        this.placement = placement;\n        return this;\n    }\n    withListeners(listeners) {\n        this.listeners = listeners;\n        return this;\n    }\n    withStyle(style) {\n        this.style = style;\n        return this;\n    }\n    withTeleportTo(teleportTo) {\n        this.teleportTo = teleportTo;\n        return this;\n    }\n    withLabel(label) {\n        this.label = label;\n        return this;\n    }\n    withName(name) {\n        this.name = name;\n        return this;\n    }\n    withDisabled(disabled) {\n        this.disabled = disabled;\n        return this;\n    }\n    withHasPlaceholder(hasPlaceholder) {\n        this.hasPlaceholder = hasPlaceholder;\n        return this;\n    }\n}\n\nconst createDatePickerConfig = (config, dateSelectionCallback) => {\n    var _a, _b;\n    let teleportTo;\n    if ((_a = config.datePicker) === null || _a === void 0 ? void 0 : _a.teleportTo) {\n        teleportTo = config.datePicker.teleportTo;\n    }\n    const dynamicPlacement = (datePickerWrapper) => {\n        if (datePickerWrapper) {\n            const rect = datePickerWrapper.getBoundingClientRect();\n            const viewportCenterX = window.innerWidth / 2;\n            const isMoreOnLeftSide = rect.x + rect.width / 2 <= viewportCenterX;\n            return isMoreOnLeftSide ? Placement.BOTTOM_START : Placement.BOTTOM_END;\n        }\n        return Placement.BOTTOM_END;\n    };\n    return new ConfigBuilder()\n        .withLocale(config.locale)\n        .withFirstDayOfWeek(config.firstDayOfWeek)\n        .withTimezone(config.timezone)\n        .withMin(config.minDate)\n        .withMax(config.maxDate)\n        .withTeleportTo(teleportTo)\n        .withStyle((_b = config.datePicker) === null || _b === void 0 ? void 0 : _b.style)\n        .withPlacement(dynamicPlacement)\n        .withListeners({ onChange: dateSelectionCallback })\n        .build();\n};\n\nconst createDateSelectionCallback = (calendarState, config) => {\n    let lastEmittedDate = null;\n    return (date) => {\n        var _a;\n        calendarState.setRange(date);\n        if (((_a = config.callbacks) === null || _a === void 0 ? void 0 : _a.onSelectedDateUpdate) &&\n            date.toString() !== (lastEmittedDate === null || lastEmittedDate === void 0 ? void 0 : lastEmittedDate.toString())) {\n            lastEmittedDate = date;\n            config.callbacks.onSelectedDateUpdate(date);\n        }\n    };\n};\n\n/**\n * TODO v3: remove this when removing plugin over the config object\n * */\nconst validatePlugins = (configPlugins, pluginArg) => {\n    if (configPlugins && pluginArg) {\n        throw new Error('You cannot provide plugins over the config object and as an argument to createCalendar.');\n    }\n};\n\nconst validateConfig = (config) => {\n    var _a, _b, _c, _d;\n    if (config.selectedDate &&\n        !(config.selectedDate instanceof Temporal.PlainDate)) {\n        throw new Error('[Schedule-X error]: selectedDate must have the format YYYY-MM-DD');\n    }\n    if (config.minDate && !(config.minDate instanceof Temporal.PlainDate)) {\n        throw new Error('[Schedule-X error]: minDate must be a temporal plain date');\n    }\n    if (config.maxDate && !(config.maxDate instanceof Temporal.PlainDate)) {\n        throw new Error('[Schedule-X error]: maxDate must be a temporal plain date');\n    }\n    if (typeof config.firstDayOfWeek !== 'undefined' &&\n        (config.firstDayOfWeek < 1 || config.firstDayOfWeek > 7)) {\n        throw new Error('[Schedule-X error]: firstDayOfWeek must be a number between 1 and 7');\n    }\n    if (typeof ((_a = config.weekOptions) === null || _a === void 0 ? void 0 : _a.gridHeight) !== 'undefined' &&\n        config.weekOptions.gridHeight < 0) {\n        throw new Error('[Schedule-X error]: weekOptions.gridHeight must be a positive number');\n    }\n    if (typeof ((_b = config.weekOptions) === null || _b === void 0 ? void 0 : _b.nDays) !== 'undefined' &&\n        (config.weekOptions.nDays < 1 || config.weekOptions.nDays > 7)) {\n        throw new Error('[Schedule-X error]: weekOptions.nDays must be a number between 1 and 7');\n    }\n    if (typeof ((_c = config.weekOptions) === null || _c === void 0 ? void 0 : _c.eventWidth) !== 'undefined' &&\n        (config.weekOptions.eventWidth < 1 || config.weekOptions.eventWidth > 100)) {\n        throw new Error('[Schedule-X error]: weekOptions.eventWidth must be an integer between 1 and 100');\n    }\n    if (typeof ((_d = config.monthGridOptions) === null || _d === void 0 ? void 0 : _d.nEventsPerDay) !== 'undefined' &&\n        config.monthGridOptions.nEventsPerDay < 0) {\n        throw new Error('[Schedule-X error]: monthGridOptions.nEventsPerDay must be a positive number');\n    }\n    const dayBoundaryPattern = /^\\d{2}:00$/;\n    if (typeof config.dayBoundaries !== 'undefined') {\n        const startFormatIsInvalid = !dayBoundaryPattern.test(config.dayBoundaries.start);\n        const endFormatIsInvalid = !dayBoundaryPattern.test(config.dayBoundaries.end);\n        if (startFormatIsInvalid || endFormatIsInvalid) {\n            throw new Error('[Schedule-X error]: dayBoundaries must be an object with \"start\"- and \"end\" properties, each with the format HH:mm');\n        }\n    }\n};\n\nconst validateEvents = (events = []) => {\n    events === null || events === void 0 ? void 0 : events.forEach((event) => {\n        if (!(event.start instanceof Temporal.ZonedDateTime) &&\n            !(event.start instanceof Temporal.PlainDate)) {\n            throw new Error(`[Schedule-X error]: Event start time needs to be a Temporal.ZonedDateTime or Temporal.PlainDate.`);\n        }\n        if (!(event.end instanceof Temporal.ZonedDateTime) &&\n            !(event.end instanceof Temporal.PlainDate)) {\n            throw new Error(`[Schedule-X error]: Event end time needs to be a Temporal.ZonedDateTime or Temporal.PlainDate.`);\n        }\n        const isIdDecimalNumber = typeof event.id === 'number' && event.id % 1 !== 0;\n        if (isIdDecimalNumber) {\n            throw new Error(`[Schedule-X error]: Event id ${event.id} is not a valid id. Only non-unicode characters that can be used by document.querySelector is allowed, see: https://developer.mozilla.org/en-US/docs/Web/CSS/ident. We recommend using uuids or integers.`);\n        }\n        // only allow non-unicode characters that can be used by document.querySelector: https://developer.mozilla.org/en-US/docs/Web/CSS/ident\n        if (typeof event.id === 'string' && !/^[a-zA-Z0-9_-]*$/.test(event.id)) {\n            throw new Error(`[Schedule-X error]: Event id ${event.id} is not a valid id. Only non-unicode characters that can be used by document.querySelector is allowed, see: https://developer.mozilla.org/en-US/docs/Web/CSS/ident. We recommend using uuids or integers.`);\n        }\n        if (typeof event.id !== 'string' && typeof event.id !== 'number') {\n            throw new Error(`[Schedule-X error]: Event id ${event.id} is not a valid id. Only non-unicode characters that can be used by document.querySelector is allowed, see: https://developer.mozilla.org/en-US/docs/Web/CSS/ident. We recommend using uuids or integers.`);\n        }\n    });\n};\n\nconst createCalendarAppSingleton = (config, plugins) => {\n    var _a;\n    const internalConfig = createInternalConfig(config, plugins);\n    const timeUnitsImpl = createTimeUnitsImpl(internalConfig);\n    const calendarState = createCalendarState(internalConfig, timeUnitsImpl, config.selectedDate);\n    const dateSelectionCallback = createDateSelectionCallback(calendarState, config);\n    const datePickerConfig = createDatePickerConfig(config, (date) => dateSelectionCallback(date));\n    const datePickerState = createDatePickerState(datePickerConfig, config.selectedDate || ((_a = config.datePicker) === null || _a === void 0 ? void 0 : _a.selectedDate));\n    const calendarEvents = createCalendarEventsImpl(config.events || [], config.backgroundEvents || [], internalConfig);\n    return new CalendarAppSingletonBuilder()\n        .withConfig(internalConfig)\n        .withTimeUnitsImpl(timeUnitsImpl)\n        .withDatePickerState(datePickerState)\n        .withCalendarEvents(calendarEvents)\n        .withDatePickerConfig(datePickerConfig)\n        .withCalendarState(calendarState)\n        .withTranslate(translate(internalConfig.locale, internalConfig.translations))\n        .build();\n};\nconst createCalendar = (config, plugins) => {\n    validatePlugins(config.plugins, plugins);\n    if (config.skipValidation !== true) {\n        validateEvents(config.events);\n        validateConfig(config);\n    }\n    return new CalendarApp(createCalendarAppSingleton(config, plugins || config.plugins || []));\n};\n\nconst createWeekForMonth = (week, day) => {\n    week.push({\n        date: Temporal.ZonedDateTime.from(day.toString()).toPlainDate(),\n        events: {},\n        backgroundEvents: [],\n    });\n    return week;\n};\nconst createMonth = (date, timeUnitsImpl) => {\n    const monthWithDates = timeUnitsImpl.getMonthWithTrailingAndLeadingDays(date.year, date.month);\n    const month = [];\n    for (const week of monthWithDates) {\n        month.push(week.reduce(createWeekForMonth, []));\n    }\n    return month;\n};\n\nfunction MonthGridEvent({ gridRow, calendarEvent, date, isFirstWeek, isLastWeek, }) {\n    var _a, _b, _c, _d, _e;\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext);\n    const hasOverflowLeft = isFirstWeek &&\n        ((_a = $app.calendarState.range.value) === null || _a === void 0 ? void 0 : _a.start) &&\n        calendarEvent.start.toString() <\n            $app.calendarState.range.value.start.toString();\n    const hasOverflowRight = isLastWeek &&\n        ((_b = $app.calendarState.range.value) === null || _b === void 0 ? void 0 : _b.end) &&\n        calendarEvent.end.toString() > $app.calendarState.range.value.end.toString();\n    const { createDragStartTimeout, setClickedEventIfNotDragging, setClickedEvent, } = useEventInteractions($app);\n    const plainDate = Temporal.PlainDate.from(date).toString();\n    const hasStartDate = dateFromDateTime(calendarEvent.start.toString()) === plainDate;\n    const nDays = calendarEvent._eventFragments[date];\n    const eventCSSVariables = {\n        borderInlineStart: hasStartDate\n            ? `4px solid var(--sx-color-${calendarEvent._color})`\n            : undefined,\n        color: `var(--sx-color-on-${calendarEvent._color}-container)`,\n        backgroundColor: `var(--sx-color-${calendarEvent._color}-container)`,\n        // CORRELATION ID: 2 (10px subtracted from width)\n        // nDays * 100% for the width of each day + 1px for border - 10 px for horizontal gap between events\n        width: `calc(${nDays * 100 + '%'} + ${nDays}px - 10px)`,\n    };\n    const handleStartDrag = (uiEvent) => {\n        var _a;\n        if (isUIEventTouchEvent(uiEvent))\n            uiEvent.preventDefault();\n        if (!uiEvent.target)\n            return;\n        if (!$app.config.plugins.dragAndDrop || ((_a = calendarEvent._options) === null || _a === void 0 ? void 0 : _a.disableDND))\n            return;\n        $app.config.plugins.dragAndDrop.createMonthGridDragHandler(calendarEvent, $app);\n    };\n    const customComponent = $app.config._customComponentFns.monthGridEvent;\n    const customComponentId = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useRef)(customComponent\n        ? 'custom-month-grid-event-' + randomStringId() // needs a unique string to support event recurrence\n        : undefined);\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        if (!customComponent)\n            return;\n        customComponent(getElementByCCID(customComponentId.current), {\n            calendarEvent: calendarEvent._getExternalEvent(),\n            hasStartDate,\n        });\n        return () => {\n            var _a, _b;\n            (_b = (_a = $app.config)._destroyCustomComponentInstance) === null || _b === void 0 ? void 0 : _b.call(_a, customComponentId.current);\n        };\n    }, [calendarEvent]);\n    const handleOnClick = (e) => {\n        e.stopPropagation(); // prevent the click from bubbling up to the day element\n        invokeOnEventClickCallback($app, calendarEvent, e);\n    };\n    const handleOnDoubleClick = (e) => {\n        e.stopPropagation(); // prevent the click from bubbling up to the day element\n        invokeOnEventDoubleClickCallback($app, calendarEvent, e);\n    };\n    const handleKeyDown = (e) => {\n        if (e.key === 'Enter' || e.key === ' ') {\n            e.stopPropagation();\n            setClickedEvent(e, calendarEvent);\n            invokeOnEventClickCallback($app, calendarEvent, e);\n            nextTick(() => {\n                focusModal($app);\n            });\n        }\n    };\n    const classNames = [\n        'sx__event',\n        'sx__month-grid-event',\n        'sx__month-grid-cell',\n    ];\n    if ((_c = calendarEvent._options) === null || _c === void 0 ? void 0 : _c.additionalClasses) {\n        classNames.push(...calendarEvent._options.additionalClasses);\n    }\n    if (wasEventAddedInLastSecond(calendarEvent))\n        classNames.push('is-event-new');\n    if (hasOverflowLeft)\n        classNames.push('sx__month-grid-event--overflow-left');\n    if (hasOverflowRight)\n        classNames.push('sx__month-grid-event--overflow-right');\n    const hasCustomContent = (_d = calendarEvent._customContent) === null || _d === void 0 ? void 0 : _d.monthGrid;\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { draggable: !!$app.config.plugins.dragAndDrop, \"data-event-id\": calendarEvent.id, \"data-ccid\": customComponentId.current, onMouseDown: (e) => createDragStartTimeout(handleStartDrag, e), onMouseUp: (e) => setClickedEventIfNotDragging(calendarEvent, e), onTouchStart: (e) => createDragStartTimeout(handleStartDrag, e), onTouchEnd: (e) => setClickedEventIfNotDragging(calendarEvent, e), onClick: handleOnClick, onDblClick: handleOnDoubleClick, onKeyDown: handleKeyDown, className: classNames.join(' '), style: {\n            gridRow,\n            width: eventCSSVariables.width,\n            padding: customComponent ? '0px' : undefined,\n            borderInlineStart: customComponent\n                ? undefined\n                : eventCSSVariables.borderInlineStart,\n            color: customComponent ? undefined : eventCSSVariables.color,\n            backgroundColor: customComponent\n                ? undefined\n                : eventCSSVariables.backgroundColor,\n        }, tabIndex: 0, role: \"button\", children: [!customComponent && !hasCustomContent && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: [calendarEvent.start instanceof Temporal.ZonedDateTime && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__month-grid-event-time\", children: timeFn(calendarEvent.start, $app.config.locale.value) })), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__month-grid-event-title\", children: calendarEvent.title })] })), hasCustomContent && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { dangerouslySetInnerHTML: {\n                    __html: ((_e = calendarEvent._customContent) === null || _e === void 0 ? void 0 : _e.monthGrid) || '',\n                } }))] }));\n}\n\nfunction MonthGridDay({ day, isFirstWeek, isLastWeek }) {\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext);\n    const nEventsInDay = Object.values(day.events).filter((event) => typeof event === 'object' || event === DATE_GRID_BLOCKER).length;\n    const getEventTranslationSingularOrPlural = (nOfAdditionalEvents) => {\n        if (nOfAdditionalEvents === 1)\n            return $app.translate('+ 1 event');\n        return $app.translate('+ {{n}} events', { n: nOfAdditionalEvents });\n    };\n    const getAriaLabelSingularOrPlural = (nOfAdditionalEvents) => {\n        if (nOfAdditionalEvents === 1) {\n            return $app.translate('Link to 1 more event on {{date}}', {\n                date: getLocalizedDate$1(day.date, $app.config.locale.value),\n            });\n        }\n        return $app.translate('Link to {{n}} more events on {{date}}', {\n            date: getLocalizedDate$1(day.date, $app.config.locale.value),\n            n: nEventsInDay - $app.config.monthGridOptions.value.nEventsPerDay,\n        });\n    };\n    const handleClickAdditionalEvents = (e) => {\n        e.stopPropagation();\n        if ($app.config.callbacks.onClickPlusEvents)\n            $app.config.callbacks.onClickPlusEvents(day.date, e);\n        if (!$app.config.views.value.find((view) => view.name === InternalViewName.Day))\n            return;\n        // Timeout to display the ripple effect\n        setTimeout(() => {\n            $app.datePickerState.selectedDate.value = day.date;\n            $app.calendarState.setView(InternalViewName.Day, day.date);\n        }, 250);\n    };\n    const dateClassNames = ['sx__month-grid-day__header-date'];\n    const dayDate = day.date;\n    if (isToday(dayDate.toZonedDateTime($app.config.timezone.value), $app.config.timezone.value))\n        dateClassNames.push('sx__is-today');\n    const selectedDateMonth = $app.datePickerState.selectedDate.value.month;\n    const dayMonth = day.date.month;\n    const baseClasses = [\n        'sx__month-grid-day',\n        getClassNameForWeekday(dayDate.dayOfWeek),\n    ];\n    const [wrapperClasses, setWrapperClasses] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)(baseClasses);\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        const classes = [...baseClasses];\n        if (dayMonth !== selectedDateMonth)\n            classes.push('is-leading-or-trailing');\n        if (isSameDay($app.datePickerState.selectedDate.value, day.date))\n            classes.push('is-selected');\n        setWrapperClasses(classes);\n    }, [$app.datePickerState.selectedDate.value]);\n    const getNumberOfNonDisplayedEvents = () => {\n        return Object.values(day.events)\n            .slice($app.config.monthGridOptions.value.nEventsPerDay)\n            .filter((event) => event === DATE_GRID_BLOCKER || typeof event === 'object').length;\n    };\n    const numberOfNonDisplayedEvents = getNumberOfNonDisplayedEvents();\n    const dayStartDateTime = Temporal.ZonedDateTime.from({\n        year: day.date.year,\n        month: day.date.month,\n        day: day.date.day,\n        hour: 0,\n        minute: 0,\n        second: 0,\n        timeZone: $app.config.timezone.value,\n    });\n    const dayEndDateTime = Temporal.ZonedDateTime.from({\n        year: day.date.year,\n        month: day.date.month,\n        day: day.date.day,\n        hour: 23,\n        minute: 59,\n        second: 59,\n        timeZone: $app.config.timezone.value,\n    });\n    const fullDayBackgroundEvent = day.backgroundEvents.find((event) => {\n        const eventStartWithTime = event.start instanceof Temporal.PlainDate\n            ? event.start.toZonedDateTime($app.config.timezone.value)\n            : event.start;\n        const eventEndWithTime = event.end instanceof Temporal.PlainDate\n            ? event.end.toZonedDateTime($app.config.timezone.value).with({\n                hour: 23,\n                minute: 59,\n                second: 59,\n            })\n            : event.end;\n        return (eventStartWithTime.toString() <= dayStartDateTime.toString() &&\n            eventEndWithTime.toString() >= dayEndDateTime.toString());\n    });\n    const handleMouseDown = (e) => {\n        const target = e.target;\n        if (!target.classList.contains('sx__month-grid-day'))\n            return;\n        const callback = $app.config.callbacks.onMouseDownMonthGridDate;\n        if (callback)\n            callback(day.date, e);\n    };\n    const monthGridDayNameCustomComponent = $app.config._customComponentFns.monthGridDayName;\n    const monthGridDayNameCCID = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)(monthGridDayNameCustomComponent ? randomStringId() : '')[0];\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        if (!monthGridDayNameCustomComponent)\n            return;\n        const dayNameEl = document.querySelector(`[data-ccid=\"${monthGridDayNameCCID}\"]`);\n        if (!(dayNameEl instanceof HTMLElement)) {\n            return;\n        }\n        monthGridDayNameCustomComponent(dayNameEl, {\n            day: toJSDate(day.date.toString()).getDay(),\n        });\n    }, [day]);\n    const monthGridDateCustomComponent = $app.config._customComponentFns.monthGridDate;\n    const monthGridDateCCID = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)(monthGridDateCustomComponent ? randomStringId() : '')[0];\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        if (!monthGridDateCustomComponent)\n            return;\n        const dateEl = document.querySelector(`[data-ccid=\"${monthGridDateCCID}\"]`);\n        if (!(dateEl instanceof HTMLElement))\n            return;\n        monthGridDateCustomComponent(dateEl, {\n            date: toJSDate(day.date.toString()).getDate(),\n            jsDate: toJSDate(day.date.toString()),\n        });\n    }, [day]);\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { className: wrapperClasses.join(' '), \"data-date\": toDateString$1(day.date), onClick: (e) => $app.config.callbacks.onClickDate &&\n            $app.config.callbacks.onClickDate(day.date, e), \"aria-label\": getLocalizedDate$1(day.date, $app.config.locale.value), onDblClick: (e) => { var _a, _b; return (_b = (_a = $app.config.callbacks).onDoubleClickDate) === null || _b === void 0 ? void 0 : _b.call(_a, day.date, e); }, onMouseDown: handleMouseDown, children: [fullDayBackgroundEvent && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__month-grid-background-event\", title: fullDayBackgroundEvent.title, style: {\n                        ...fullDayBackgroundEvent.style,\n                    } }) })), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { className: \"sx__month-grid-day__header\", children: [isFirstWeek ? ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: monthGridDayNameCustomComponent ? ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { \"data-ccid\": monthGridDayNameCCID })) : ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__month-grid-day__header-day-name\", children: getDayNameShort(dayDate, $app.config.locale.value) })) })) : null, monthGridDateCCID ? ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { \"data-ccid\": monthGridDateCCID })) : ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: dateClassNames.join(' '), children: dayDate.day }))] }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__month-grid-day__events\", children: Object.values(day.events)\n                    .slice(0, $app.config.monthGridOptions.value.nEventsPerDay)\n                    .map((event, index) => {\n                    if (typeof event !== 'object')\n                        return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__month-grid-blocker sx__month-grid-cell\", style: { gridRow: index + 1 } }));\n                    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(MonthGridEvent, { gridRow: index + 1, calendarEvent: event, date: day.date.toString(), isFirstWeek: isFirstWeek, isLastWeek: isLastWeek }));\n                }) }), numberOfNonDisplayedEvents > 0 ? ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"button\", { type: \"button\", className: \"sx__button sx__month-grid-day__events-more sx__ripple--wide\", \"aria-label\": getAriaLabelSingularOrPlural(numberOfNonDisplayedEvents), onClick: handleClickAdditionalEvents, children: getEventTranslationSingularOrPlural(numberOfNonDisplayedEvents) })) : null] }));\n}\n\nfunction MonthGridWeek({ week, isFirstWeek, isLastWeek, }) {\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext);\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { className: \"sx__month-grid-week\", children: [$app.config.showWeekNumbers.value && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__month-grid-week__week-number\", children: getWeekNumber(week[0].date, $app.config.firstDayOfWeek.value) })), week.map((day) => {\n                /**\n                 * The day component keeps internal state, and needs to be thrown away once the day changes.\n                 * */\n                return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(MonthGridDay, { day: day, isFirstWeek: isFirstWeek, isLastWeek: isLastWeek }, toDateString$1(day.date)));\n            })] }));\n}\n\nconst positionInMonthWeek = (sortedEvents, week) => {\n    const weekDates = Object.keys(week).sort();\n    const firstDateOfWeek = weekDates[0];\n    const lastDateOfWeek = weekDates[weekDates.length - 1];\n    const occupiedLevels = new Set();\n    for (const event of sortedEvents) {\n        const eventOriginalStartDate = dateFromDateTime(event.start.toString());\n        const eventOriginalEndDate = dateFromDateTime(event.end.toString());\n        const isEventStartInWeek = !!week[eventOriginalStartDate];\n        let isEventInWeek = isEventStartInWeek;\n        if (!isEventStartInWeek &&\n            eventOriginalStartDate < firstDateOfWeek &&\n            eventOriginalEndDate >= firstDateOfWeek) {\n            isEventInWeek = true;\n        }\n        if (!isEventInWeek)\n            continue;\n        const firstDateOfEvent = isEventStartInWeek\n            ? eventOriginalStartDate\n            : firstDateOfWeek;\n        const lastDateOfEvent = eventOriginalEndDate <= lastDateOfWeek\n            ? eventOriginalEndDate\n            : lastDateOfWeek;\n        const eventDays = Object.values(week).filter((day) => {\n            const plainDate = Temporal.PlainDate.from(day.date).toString();\n            return plainDate >= firstDateOfEvent && plainDate <= lastDateOfEvent;\n        });\n        let levelInWeekForEvent;\n        let testLevel = 0;\n        while (levelInWeekForEvent === undefined) {\n            const isLevelFree = eventDays.every((day) => {\n                return !day.events[testLevel];\n            });\n            if (isLevelFree) {\n                levelInWeekForEvent = testLevel;\n                occupiedLevels.add(testLevel);\n            }\n            else\n                testLevel++;\n        }\n        for (const [eventDayIndex, eventDay] of eventDays.entries()) {\n            if (eventDayIndex === 0) {\n                event._eventFragments[firstDateOfEvent] = eventDays.length;\n                eventDay.events[levelInWeekForEvent] = event;\n            }\n            else {\n                eventDay.events[levelInWeekForEvent] = DATE_GRID_BLOCKER;\n            }\n        }\n    }\n    for (const level of Array.from(occupiedLevels)) {\n        for (const [, day] of Object.entries(week)) {\n            if (!day.events[level]) {\n                day.events[level] = undefined;\n            }\n        }\n    }\n    return week;\n};\nconst positionInMonth = (month, sortedEvents) => {\n    const weeks = [];\n    month.forEach((week) => {\n        const weekMap = {};\n        week.forEach((day) => {\n            const plainDate = Temporal.PlainDate.from(day.date);\n            weekMap[plainDate.toString()] = day;\n        });\n        weeks.push(weekMap);\n    });\n    weeks.forEach((week) => positionInMonthWeek(sortedEvents, week));\n    return month;\n};\n\nconst MonthGridWrapper = ({ $app, id }) => {\n    const [month, setMonth] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)([]);\n    (0,_preact_signals__WEBPACK_IMPORTED_MODULE_4__.useSignalEffect)(() => {\n        $app.calendarEvents.list.value.forEach((event) => {\n            event._eventFragments = {};\n        });\n        const newMonth = createMonth(Temporal.PlainDate.from($app.datePickerState.selectedDate.value), $app.timeUnitsImpl);\n        newMonth.forEach((week) => {\n            week.forEach((day) => {\n                const plainDate = Temporal.PlainDate.from(day.date);\n                const rangeStartDateTime = Temporal.ZonedDateTime.from({\n                    year: plainDate.year,\n                    month: plainDate.month,\n                    day: plainDate.day,\n                    hour: 0,\n                    minute: 0,\n                    second: 0,\n                    timeZone: $app.config.timezone.value,\n                });\n                const rangeEndDateTime = Temporal.ZonedDateTime.from({\n                    year: plainDate.year,\n                    month: plainDate.month,\n                    day: plainDate.day,\n                    hour: 23,\n                    minute: 59,\n                    second: 59,\n                    timeZone: $app.config.timezone.value,\n                });\n                day.backgroundEvents = filterByRange($app.calendarEvents.backgroundEvents.value, {\n                    start: rangeStartDateTime,\n                    end: rangeEndDateTime,\n                }, $app.config.timezone.value);\n            });\n        });\n        const filteredEvents = $app.calendarEvents.filterPredicate.value\n            ? $app.calendarEvents.list.value.filter($app.calendarEvents.filterPredicate.value)\n            : $app.calendarEvents.list.value;\n        setMonth(positionInMonth(newMonth, filteredEvents.sort(sortEventsForMonthGrid)));\n    });\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(AppContext.Provider, { value: $app, children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { id: id, className: \"sx__month-grid-wrapper\", children: month.map((week, index) => ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(MonthGridWeek, { week: week, isFirstWeek: index === 0, isLastWeek: index === month.length - 1 }, index))) }) }));\n};\n\nconst config$2 = {\n    name: InternalViewName.MonthGrid,\n    label: 'Month',\n    setDateRange: setRangeForMonth,\n    Component: MonthGridWrapper,\n    hasWideScreenCompat: true,\n    hasSmallScreenCompat: false,\n    backwardForwardFn: addMonths,\n    backwardForwardUnits: 1,\n};\nconst viewMonthGrid = createPreactView(config$2);\nconst createViewMonthGrid = () => createPreactView(config$2);\n\nconst createAgendaMonth = (date, timeUnitsImpl) => {\n    const monthWithDates = timeUnitsImpl.getMonthWithTrailingAndLeadingDays(date.year, date.month);\n    return {\n        weeks: monthWithDates.map((week) => {\n            return week.map((date) => {\n                return {\n                    date: Temporal.PlainDate.from(date),\n                    events: [],\n                };\n            });\n        }),\n    };\n};\n\nfunction MonthAgendaDay({ day, isActive, setActiveDate, }) {\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext);\n    const monthSelected = $app.datePickerState.selectedDate.value.month;\n    const monthOfDay = day.date.month;\n    const dayClasses = [\n        'sx__month-agenda-day',\n        getClassNameForWeekday(day.date.dayOfWeek),\n    ];\n    if (isActive)\n        dayClasses.push('sx__month-agenda-day--active');\n    if (monthOfDay !== monthSelected)\n        dayClasses.push('is-leading-or-trailing');\n    const handleClick = (e, callback) => {\n        setActiveDate(day.date);\n        if (!callback)\n            return;\n        callback(day.date, e);\n    };\n    const hasFocus = (weekDay) => weekDay.date.toString() ===\n        $app.datePickerState.selectedDate.value.toString();\n    const handleKeyDown = (event) => {\n        const keyMapDaysToAdd = new Map([\n            ['ArrowDown', 7],\n            ['ArrowUp', -7],\n            ['ArrowLeft', -1],\n            ['ArrowRight', 1],\n        ]);\n        $app.datePickerState.selectedDate.value = Temporal.PlainDate.from(addDays($app.datePickerState.selectedDate.value, keyMapDaysToAdd.get(event.key) || 0));\n    };\n    const isBeforeMinDate = !!($app.config.minDate.value &&\n        day.date.toString() < $app.config.minDate.value.toString());\n    const isPastMaxDate = !!($app.config.maxDate.value &&\n        day.date.toString() > $app.config.maxDate.value.toString());\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"button\", { type: \"button\", className: `sx__button ${dayClasses.join(' ')}`, onClick: (e) => handleClick(e, $app.config.callbacks.onClickAgendaDate), onDblClick: (e) => handleClick(e, $app.config.callbacks.onDoubleClickAgendaDate), disabled: isBeforeMinDate || isPastMaxDate, \"aria-label\": getLocalizedDate$1(day.date, $app.config.locale.value), tabIndex: hasFocus(day) ? 0 : -1, \"data-agenda-focus\": hasFocus(day) ? 'true' : undefined, onKeyDown: handleKeyDown, children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { children: day.date.day }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__month-agenda-day__event-icons\", children: day.events.slice(0, 3).map((event) => ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { style: { backgroundColor: `var(--sx-color-${event._color})` }, className: \"sx__month-agenda-day__event-icon\" }))) })] }));\n}\n\nfunction MonthAgendaWeek({ week, setActiveDate, activeDate, }) {\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext);\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { className: \"sx__month-agenda-week\", children: [$app.config.showWeekNumbers.value && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__month-agenda-week__week-number\", children: getWeekNumber(Temporal.PlainDate.from(week[0].date), $app.config.firstDayOfWeek.value) })), week.map((day, index) => ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(MonthAgendaDay, { setActiveDate: setActiveDate, day: day, isActive: isSameDay(activeDate, day.date) }, index + day.date.toString())))] }));\n}\n\nfunction MonthAgendaDayNames({ week }) {\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext);\n    const localizedShortDayNames = getOneLetterOrShortDayNames(week.map((day) => day.date), $app.config.locale.value);\n    const classNames = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useMemo)(() => {\n        const ret = ['sx__month-agenda-day-names'];\n        if ($app.config.showWeekNumbers.value) {\n            ret.push('sx__has-week-numbers');\n        }\n        return ret.join(' ');\n    }, [$app.config.showWeekNumbers.value]);\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: classNames, children: localizedShortDayNames.map((oneLetterDayName) => ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__month-agenda-day-name\", children: oneLetterDayName }))) }));\n}\n\nconst getAllEventDates = (startDate, endDate) => {\n    let currentDate = startDate;\n    const dates = [currentDate];\n    while (currentDate < endDate) {\n        currentDate = addDays(Temporal.PlainDate.from(currentDate), 1).toString();\n        dates.push(currentDate);\n    }\n    return dates;\n};\nconst placeEventInDay = (allDaysMap) => (event) => {\n    getAllEventDates(dateFromDateTime(event.start.toString()), dateFromDateTime(event.end.toString())).forEach((date) => {\n        if (allDaysMap[date]) {\n            allDaysMap[date].events.push(event);\n        }\n    });\n};\nconst positionEventsInAgenda = (agendaMonth, eventsSortedByStart) => {\n    const allDaysMap = agendaMonth.weeks.reduce((acc, week) => {\n        week.forEach((day) => {\n            acc[day.date.toString()] = day;\n        });\n        return acc;\n    }, {});\n    eventsSortedByStart.forEach(placeEventInDay(allDaysMap));\n    return agendaMonth;\n};\n\nfunction MonthAgendaEvent({ calendarEvent }) {\n    var _a, _b;\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext);\n    const { setClickedEvent } = useEventInteractions($app);\n    const eventCSSVariables = {\n        backgroundColor: `var(--sx-color-${calendarEvent._color}-container)`,\n        color: `var(--sx-color-on-${calendarEvent._color}-container)`,\n        borderInlineStart: `4px solid var(--sx-color-${calendarEvent._color})`,\n    };\n    const customComponent = $app.config._customComponentFns.monthAgendaEvent;\n    const customComponentId = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useRef)(customComponent\n        ? 'custom-month-agenda-event-' + randomStringId()\n        : undefined);\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        if (!customComponent)\n            return;\n        customComponent(getElementByCCID(customComponentId.current), {\n            calendarEvent: calendarEvent._getExternalEvent(),\n        });\n        return () => {\n            var _a, _b;\n            (_b = (_a = $app.config)._destroyCustomComponentInstance) === null || _b === void 0 ? void 0 : _b.call(_a, customComponentId.current);\n        };\n    }, [calendarEvent]);\n    const onClick = (e) => {\n        setClickedEvent(e, calendarEvent);\n        invokeOnEventClickCallback($app, calendarEvent, e);\n    };\n    const onDoubleClick = (e) => {\n        setClickedEvent(e, calendarEvent);\n        invokeOnEventDoubleClickCallback($app, calendarEvent, e);\n    };\n    const onKeyDown = (e) => {\n        if (e.key === 'Enter' || e.key === ' ') {\n            e.stopPropagation();\n            setClickedEvent(e, calendarEvent);\n            invokeOnEventClickCallback($app, calendarEvent, e);\n            nextTick(() => {\n                focusModal($app);\n            });\n        }\n    };\n    const hasCustomContent = (_a = calendarEvent._customContent) === null || _a === void 0 ? void 0 : _a.monthAgenda;\n    const classNames = ['sx__event', 'sx__month-agenda-event'];\n    if (wasEventAddedInLastSecond(calendarEvent))\n        classNames.push('is-event-new');\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { className: classNames.join(' '), \"data-ccid\": customComponentId.current, \"data-event-id\": calendarEvent.id, style: {\n            backgroundColor: customComponent\n                ? undefined\n                : eventCSSVariables.backgroundColor,\n            color: customComponent ? undefined : eventCSSVariables.color,\n            borderInlineStart: customComponent\n                ? undefined\n                : eventCSSVariables.borderInlineStart,\n            padding: customComponent ? '0px' : undefined,\n        }, onClick: (e) => onClick(e), onDblClick: (e) => onDoubleClick(e), onKeyDown: onKeyDown, tabIndex: 0, role: \"button\", children: [!customComponent && !hasCustomContent && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(preact__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__month-agenda-event__title\", children: calendarEvent.title }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { className: \"sx__month-agenda-event__time sx__month-agenda-event__has-icon\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(TimeIcon, { strokeColor: `var(--sx-color-on-${calendarEvent._color}-container)` }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { dangerouslySetInnerHTML: {\n                                    __html: getTimeStamp(calendarEvent, $app.config.locale.value),\n                                } })] })] })), hasCustomContent && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { dangerouslySetInnerHTML: {\n                    __html: ((_b = calendarEvent._customContent) === null || _b === void 0 ? void 0 : _b.monthAgenda) || '',\n                } }))] }));\n}\n\nfunction MonthAgendaEvents({ events }) {\n    const $app = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useContext)(AppContext);\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__month-agenda-events\", children: events.length ? (events.map((event) => ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(MonthAgendaEvent, { calendarEvent: event }, event.id)))) : ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__month-agenda-events__empty\", children: $app.translate('No events') })) }));\n}\n\nconst MonthAgendaWrapper = ({ $app, id }) => {\n    var _a;\n    const getMonth = () => {\n        const filteredEvents = $app.calendarEvents.filterPredicate.value\n            ? $app.calendarEvents.list.value.filter($app.calendarEvents.filterPredicate.value)\n            : $app.calendarEvents.list.value;\n        return positionEventsInAgenda(createAgendaMonth($app.datePickerState.selectedDate.value.toZonedDateTime($app.config.timezone.value), $app.timeUnitsImpl), filteredEvents.sort(sortEventsByStartAndEnd));\n    };\n    const [agendaMonth, setAgendaMonth] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)(getMonth());\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        setAgendaMonth(getMonth());\n    }, [\n        $app.datePickerState.selectedDate.value,\n        $app.calendarEvents.list.value,\n        $app.calendarEvents.filterPredicate.value,\n    ]);\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        const observer = new MutationObserver((mutations) => {\n            mutations.forEach((mutation) => {\n                const mutatedElement = mutation.target;\n                if (mutatedElement.dataset.agendaFocus === 'true')\n                    mutatedElement.focus();\n            });\n        });\n        const monthViewElement = document.getElementById(id);\n        observer.observe(monthViewElement, {\n            childList: true,\n            subtree: true,\n            attributes: true,\n        });\n        return () => observer.disconnect();\n    }, []);\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(AppContext.Provider, { value: $app, children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { id: id, className: \"sx__month-agenda-wrapper\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(MonthAgendaDayNames, { week: agendaMonth.weeks[0] }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__month-agenda-weeks\", children: agendaMonth.weeks.map((week, index) => ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(MonthAgendaWeek, { week: week, setActiveDate: (date) => ($app.datePickerState.selectedDate.value = date), activeDate: $app.datePickerState.selectedDate.value }, index))) }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(MonthAgendaEvents, { events: ((_a = agendaMonth.weeks\n                        .flat()\n                        .find((day) => isSameDay(day.date, $app.datePickerState.selectedDate.value))) === null || _a === void 0 ? void 0 : _a.events) || [] }, $app.datePickerState.selectedDate.value)] }) }));\n};\n\nconst config$1 = {\n    name: InternalViewName.MonthAgenda,\n    label: 'Month',\n    setDateRange: setRangeForMonth,\n    Component: MonthAgendaWrapper,\n    hasSmallScreenCompat: true,\n    hasWideScreenCompat: false,\n    backwardForwardFn: addMonths,\n    backwardForwardUnits: 1,\n};\nconst viewMonthAgenda = createPreactView(config$1);\nconst createViewMonthAgenda = () => createPreactView(config$1);\n\nconst scrollOnDateSelection = ($app, wrapperRef) => {\n    if (!wrapperRef.current)\n        return;\n    const selectedDate = $app.datePickerState.selectedDate.value;\n    const selectedDayElement = wrapperRef.current.querySelector(`.sx__list-day[data-date=\"${selectedDate}\"]`);\n    if (selectedDayElement instanceof HTMLElement) {\n        requestAnimationFrame(() => {\n            selectedDayElement.scrollIntoView({\n                behavior: 'instant',\n                block: 'start',\n            });\n        });\n    }\n};\n\nconst ListWrapper = ({ $app, id, }) => {\n    const [daysWithEvents, setDaysWithEvents] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)([]);\n    const wrapperRef = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useRef)(null);\n    const { setClickedEvent } = useEventInteractions($app);\n    /**\n     * \"hack\" for preventing the onScrollDayIntoView callback from being called just after events have changed\n     * any ideas for how to improve this are welcome\n     * */\n    const blockOnScrollDayIntoViewCallback = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useRef)(false);\n    const blockTimeoutRef = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useRef)(null);\n    const minDate = $app.config.minDate.value\n        ? dateFromDateTime($app.config.minDate.value.toString())\n        : null;\n    const maxDate = $app.config.maxDate.value\n        ? dateFromDateTime($app.config.maxDate.value.toString())\n        : null;\n    const updateDaysWithEvents = (events) => {\n        const daysWithEventsMap = events.reduce((acc, event) => {\n            const startDate = dateFromDateTime(event.start.toString());\n            const endDate = dateFromDateTime(event.end.toString());\n            let currentDate = startDate;\n            while (currentDate <= endDate) {\n                if (!acc[currentDate]) {\n                    acc[currentDate] = [];\n                }\n                acc[currentDate].push(event);\n                currentDate = addDays(Temporal.PlainDate.from(currentDate), 1).toString();\n            }\n            return acc;\n        }, {});\n        const sortedDays = Object.entries(daysWithEventsMap)\n            .map(([date, events]) => ({\n            date,\n            events: events.sort((a, b) => a.start.toString().localeCompare(b.start.toString())),\n        }))\n            .sort((a, b) => a.date.localeCompare(b.date));\n        setDaysWithEvents(sortedDays);\n        if (blockTimeoutRef.current) {\n            clearTimeout(blockTimeoutRef.current);\n        }\n        blockTimeoutRef.current = setTimeout(() => {\n            blockOnScrollDayIntoViewCallback.current = false;\n            blockTimeoutRef.current = null;\n        }, 100);\n    };\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        /**\n         * onScrollDayIntoView can never be allowed to be called as a side effect of events changing.\n         * Otherwise, implementers will have to write custom logic to prevent infinite recursion.\n         *\n         * Open to any ideas for how to improve this and make do without a timeout.\n         * */\n        const filteredEvents = $app.calendarEvents.list.value.filter((event) => {\n            const startDate = dateFromDateTime(event.start.toString());\n            const endDate = dateFromDateTime(event.end.toString());\n            if (minDate && endDate < minDate)\n                return false;\n            if (maxDate && startDate > maxDate)\n                return false;\n            return true;\n        });\n        blockOnScrollDayIntoViewCallback.current = true;\n        updateDaysWithEvents(filteredEvents);\n    }, [$app.calendarEvents.list.value]);\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        const handleScroll = () => {\n            if (blockTimeoutRef.current) {\n                clearTimeout(blockTimeoutRef.current);\n                blockTimeoutRef.current = null;\n                blockOnScrollDayIntoViewCallback.current = false;\n            }\n        };\n        const wrapper = wrapperRef.current;\n        if (wrapper) {\n            wrapper.addEventListener('scroll', handleScroll);\n            return () => {\n                wrapper.removeEventListener('scroll', handleScroll);\n            };\n        }\n    }, []);\n    const [interSectionObserver, setIntersectionObserver] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useState)(null);\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        if (!wrapperRef.current || !$app.config.callbacks.onScrollDayIntoView)\n            return;\n        const _observer = interSectionObserver ||\n            new IntersectionObserver((entries) => {\n                entries.forEach((entry) => {\n                    if (entry.isIntersecting) {\n                        const date = entry.target.getAttribute('data-date');\n                        if (date &&\n                            $app.config.callbacks.onScrollDayIntoView &&\n                            !blockOnScrollDayIntoViewCallback.current) {\n                            $app.config.callbacks.onScrollDayIntoView(Temporal.PlainDate.from(date));\n                        }\n                    }\n                });\n            }, {\n                root: wrapperRef.current,\n                rootMargin: '0px',\n                threshold: 0.1,\n            });\n        const dayElements = wrapperRef.current.querySelectorAll('.sx__list-day');\n        dayElements.forEach((dayElement) => {\n            _observer.observe(dayElement);\n        });\n        setIntersectionObserver(_observer);\n        return () => {\n            _observer.disconnect();\n        };\n    }, [daysWithEvents]);\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n        scrollOnDateSelection($app, wrapperRef);\n    }, [daysWithEvents, $app.datePickerState.selectedDate.value]);\n    const renderEventTimes = (event, dayDate) => {\n        const eventStartDate = dateFromDateTime(event.start.toString());\n        const eventEndDate = dateFromDateTime(event.end.toString());\n        const isFirstDay = eventStartDate === dayDate;\n        const isLastDay = eventEndDate === dayDate;\n        const isMultiDay = eventStartDate !== eventEndDate;\n        const timeOptions = {\n            hour: 'numeric',\n            minute: 'numeric',\n            hour12: $app.config.locale.value === 'en-US',\n        };\n        const startZDT = Temporal.ZonedDateTime.from({\n            year: event.start.year,\n            month: event.start.month,\n            day: event.start.day,\n            hour: event.start instanceof Temporal.ZonedDateTime ? event.start.hour : 0,\n            minute: event.start instanceof Temporal.ZonedDateTime ? event.start.minute : 0,\n            timeZone: $app.config.timezone.value,\n        });\n        const endZDT = Temporal.ZonedDateTime.from({\n            year: event.end.year,\n            month: event.end.month,\n            day: event.end.day,\n            hour: event.end instanceof Temporal.ZonedDateTime ? event.end.hour : 0,\n            minute: event.end instanceof Temporal.ZonedDateTime ? event.end.minute : 0,\n            timeZone: $app.config.timezone.value,\n        });\n        if (!isMultiDay) {\n            return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__list-event-start-time\", children: startZDT.toLocaleString($app.config.locale.value, timeOptions) }), event.end && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__list-event-end-time\", children: endZDT.toLocaleString($app.config.locale.value, timeOptions) }))] }));\n        }\n        if (isFirstDay) {\n            return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__list-event-start-time\", children: startZDT.toLocaleString($app.config.locale.value, timeOptions) }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__list-event-arrow\", children: \"\\u2192\" })] }));\n        }\n        if (isLastDay) {\n            return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__list-event-arrow\", children: \"\\u2190\" }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__list-event-end-time\", children: endZDT.toLocaleString($app.config.locale.value, timeOptions) })] }));\n        }\n        return (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__list-event-arrow\", children: \"\\u2194\" });\n    };\n    const handleEventClick = (e, event) => {\n        setClickedEvent(e, event);\n        invokeOnEventClickCallback($app, event, e);\n    };\n    const handleEventDoubleClick = (e, event) => {\n        setClickedEvent(e, event);\n        invokeOnEventDoubleClickCallback($app, event, e);\n    };\n    const handleEventKeyDown = (e, event) => {\n        if (e.key === 'Enter' || e.key === ' ') {\n            e.stopPropagation();\n            setClickedEvent(e, event);\n            invokeOnEventClickCallback($app, event, e);\n            nextTick(() => {\n                focusModal($app);\n            });\n        }\n    };\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(AppContext.Provider, { value: $app, children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { id: id, className: \"sx__list-wrapper\", ref: wrapperRef, children: daysWithEvents.length === 0 ? ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__list-no-events\", children: $app.translate('No events') })) : (daysWithEvents.map((day) => ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { className: \"sx__list-day\", \"data-date\": day.date, children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__list-day-header\", children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__list-day-date\", children: toJSDate(day.date).toLocaleDateString($app.config.locale.value, {\n                                weekday: 'long',\n                                year: 'numeric',\n                                month: 'long',\n                                day: 'numeric',\n                            }) }) }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__list-day-events\", children: day.events.map((event) => ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { className: \"sx__event sx__list-event\", onClick: (e) => handleEventClick(e, event), onDblClick: (e) => handleEventDoubleClick(e, event), onKeyDown: (e) => handleEventKeyDown(e, event), tabIndex: 0, role: \"button\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: `sx__list-event-color-line`, style: {\n                                        backgroundColor: `var(--sx-color-${event._color})`,\n                                    } }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(\"div\", { className: \"sx__list-event-content\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__list-event-title\", children: event.title }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__list-event-times\", children: renderEventTimes(event, day.date) })] })] }, event.id))) }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { className: \"sx__list-day-margin\" })] }, day.date)))) }) }));\n};\n\nconst config = {\n    name: InternalViewName.List,\n    label: 'List',\n    setDateRange: setRangeForMonth,\n    Component: ListWrapper,\n    hasSmallScreenCompat: true,\n    hasWideScreenCompat: true,\n    backwardForwardFn: addMonths,\n    backwardForwardUnits: 1,\n};\nconst viewList = createPreactView(config);\nconst createViewList = () => createPreactView(config);\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNjaGVkdWxlLXgvY2FsZW5kYXIvZGlzdC9jb3JlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBc0Y7QUFDN0I7QUFDbUM7QUFDdkM7QUFDMkM7O0FBRWhHLHFCQUFxQixxREFBYSxHQUFHOztBQUVyQzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsd0RBQVU7QUFDM0IsZ0RBQWdELHNEQUFRO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJLHVEQUFTO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksdURBQVM7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUVBQW1FO0FBQ25FO0FBQ0EsS0FBSztBQUNMLElBQUksdURBQVM7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxZQUFZLHVEQUFHLENBQUMsd0RBQVEsSUFBSSxVQUFVLHdEQUFJLFVBQVUsb0VBQW9FLHVEQUFHLFlBQVkseUlBQXlJLEdBQUcsdURBQUcsWUFBWSw0VUFBNFUsR0FBRyx1REFBRyxhQUFhLHFRQUFxUSx1REFBRyxVQUFVLHdEQUF3RCxHQUFHLElBQUksR0FBRztBQUNyOUI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLHdDQUF3Qzs7QUFFekM7QUFDQTtBQUNBOztBQUVBO0FBQ0EseUNBQXlDLGVBQWU7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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U0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4RkFBOEYsU0FBUztBQUN2RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVB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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsa0RBQWtEO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLDBDQUEwQzs7QUFFM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtB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O0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzUEFBc1A7QUFDdFA7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLHNCQUFzQjs7QUFFdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSwyQkFBMkIsc0RBQXNEO0FBQ2pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDLFNBQVM7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLHFEQUFxRDtBQUNyRDtBQUNBLHlEQUF5RCxTQUFTO0FBQ2xFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdEQUF3RCxTQUFTO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRCxvQ0FBb0M7QUFDMUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdEQUF3RCxTQUFTO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLDBCQUEwQjtBQUM3RDtBQUNBO0FBQ0EsbUNBQW1DLDhCQUE4QjtBQUNqRTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLDhCQUE4Qjs7QUFFL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLLHFEQUFxRCxZQUFZO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Qsc0JBQXNCLHVEQUFNO0FBQzVCLDhCQUE4Qix1REFBTTtBQUNwQyx3QkFBd0IsdURBQU07QUFDOUI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLGlDQUFpQztBQUMxRDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsRUFBRTtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDREQUE0RCxVQUFVO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBLDREQUE0RCxVQUFVO0FBQ3RFO0FBQ0E7QUFDQSw0REFBNEQsVUFBVTtBQUN0RTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLDBCQUEwQix3REFBd0Q7QUFDbEY7QUFDQSxpQkFBaUIsd0RBQVU7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHlFQUF5RTtBQUNyRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDLHFCQUFxQjtBQUMvRDtBQUNBLG9DQUFvQyxxQkFBcUI7QUFDekQsMkNBQTJDLHFCQUFxQjtBQUNoRTtBQUNBO0FBQ0EsdUJBQXVCLG1CQUFtQixJQUFJLE1BQU07QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLG9EQUFRO0FBQ3RDO0FBQ0E7QUFDQSxJQUFJLHVEQUFTO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHdEQUFJLFVBQVU7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLG9GQUFvRix3REFBSSxDQUFDLHdEQUFRLElBQUkscUVBQXFFLHVEQUFHLFVBQVUseUdBQXlHLElBQUksdURBQUcsVUFBVSx3RUFBd0UsSUFBSSx5QkFBeUIsdURBQUcsVUFBVTtBQUM1YTtBQUNBLG1CQUFtQixLQUFLO0FBQ3hCOztBQUVBLHdCQUF3Qiw4QkFBOEI7QUFDdEQsaUJBQWlCLHdEQUFVO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLElBQUksV0FBVyx3QkFBd0I7QUFDMUU7QUFDQTtBQUNBO0FBQ0EsNkRBQTZELE1BQU07QUFDbkU7QUFDQSxhQUFhO0FBQ2I7QUFDQSx5Q0FBeUMsSUFBSSxpQkFBaUIsTUFBTTtBQUNwRTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRCxzREFBUTtBQUN4RCxJQUFJLHVEQUFTO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxzREFBUTtBQUN6QyxJQUFJLHVEQUFTO0FBQ2I7QUFDQTtBQUNBLGdFQUFnRSxxQkFBcUI7QUFDckY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQSw4QkFBOEIsc0RBQVE7QUFDdEMsSUFBSSx1REFBUztBQUNiO0FBQ0E7QUFDQSw2REFBNkQsa0JBQWtCO0FBQy9FO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsS0FBSztBQUNMLFlBQVksd0RBQUksVUFBVTtBQUMxQix1SkFBdUosWUFBWSw2SEFBNkgsc0VBQXNFLHVEQUFHLENBQUMsd0RBQVEsSUFBSSxVQUFVLHVEQUFHLFVBQVU7QUFDN1k7QUFDQSx1QkFBdUIsR0FBRyxJQUFJLHdEQUFJLFVBQVUsbUVBQW1FLHVEQUFHLENBQUMsd0RBQVEsSUFBSSw2Q0FBNkMsdURBQUcsVUFBVSxtQ0FBbUMsTUFBTSx1REFBRyxVQUFVLGdIQUFnSCxJQUFJLGdDQUFnQyx1REFBRyxVQUFVLGdDQUFnQyxNQUFNLHVEQUFHLFVBQVUsNERBQTRELEtBQUssR0FBRyx1REFBRyxVQUFVO0FBQ3BoQjtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MsdURBQUcsVUFBVSxrRUFBa0Usc0JBQXNCO0FBQ3JJLDRCQUE0Qix1REFBRyxtQkFBbUIsdUhBQXVIO0FBQ3pLLGlCQUFpQixHQUFHLHFDQUFxQyx1REFBRyxhQUFhLG1SQUFtUixZQUFZO0FBQ3hXOztBQUVBLHlCQUF5QixnQ0FBZ0M7QUFDekQsaUJBQWlCLHdEQUFVO0FBQzNCLFlBQVksd0RBQUksVUFBVSxtRkFBbUYsdURBQUcsVUFBVSx3SEFBd0g7QUFDbFA7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVEQUFHLGlCQUFpQiw0REFBNEQ7QUFDeEcsYUFBYSxJQUFJO0FBQ2pCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBLDRCQUE0QixVQUFVO0FBQ3RDLDhCQUE4QixzREFBUTtBQUN0QyxJQUFJLGdFQUFlO0FBQ25CO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWSx1REFBRyx3QkFBd0IsdUJBQXVCLHVEQUFHLFVBQVUsbUZBQW1GLHVEQUFHLGtCQUFrQiw4RUFBOEUsWUFBWSxHQUFHO0FBQ2hSOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7O0FBRUEsMEJBQTBCLCtCQUErQjtBQUN6RCxpQkFBaUIsd0RBQVU7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHdEQUFJLGFBQWEseUNBQXlDLHFCQUFxQixnWkFBZ1osdURBQUcsVUFBVSx3QkFBd0IsR0FBRyx1REFBRyxVQUFVLGlHQUFpRyx1REFBRyxVQUFVLFNBQVMsbUNBQW1DLGFBQWEsSUFBSSxpREFBaUQsS0FBSyxJQUFJO0FBQ3J3Qjs7QUFFQSwyQkFBMkIsa0NBQWtDO0FBQzdELGlCQUFpQix3REFBVTtBQUMzQixZQUFZLHdEQUFJLFVBQVUscUZBQXFGLHVEQUFHLFVBQVUsbUpBQW1KLDhCQUE4Qix1REFBRyxtQkFBbUIsbUZBQW1GLG1DQUFtQztBQUN6Yjs7QUFFQSwrQkFBK0IsTUFBTTtBQUNyQyxpQkFBaUIsd0RBQVU7QUFDM0I7QUFDQSx1QkFBdUIscURBQU87QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZLHVEQUFHLFVBQVUsbUZBQW1GLHVEQUFHLFVBQVUsb0VBQW9FLEtBQUs7QUFDbE07O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsS0FBSyxJQUFJO0FBQ1Q7QUFDQTtBQUNBOztBQUVBLDRCQUE0QixlQUFlO0FBQzNDO0FBQ0EsaUJBQWlCLHdEQUFVO0FBQzNCLFlBQVksa0JBQWtCO0FBQzlCO0FBQ0EsMkNBQTJDLHFCQUFxQjtBQUNoRSxvQ0FBb0MscUJBQXFCO0FBQ3pELHVEQUF1RCxxQkFBcUI7QUFDNUU7QUFDQTtBQUNBLDhCQUE4QixvREFBUTtBQUN0QztBQUNBO0FBQ0EsSUFBSSx1REFBUztBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHdEQUFJLFVBQVU7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsMktBQTJLLHdEQUFJLENBQUMsNENBQVUsSUFBSSxXQUFXLHVEQUFHLFVBQVUsMkVBQTJFLEdBQUcsd0RBQUksVUFBVSx1RkFBdUYsdURBQUcsYUFBYSxrQ0FBa0MscUJBQXFCLGNBQWMsR0FBRyx1REFBRyxVQUFVO0FBQ3ZmO0FBQ0EsbUNBQW1DLElBQUksSUFBSSx5QkFBeUIsdURBQUcsVUFBVTtBQUNqRjtBQUNBLG1CQUFtQixLQUFLO0FBQ3hCOztBQUVBLDZCQUE2QixRQUFRO0FBQ3JDLGlCQUFpQix3REFBVTtBQUMzQixZQUFZLHVEQUFHLFVBQVUsd0ZBQXdGLHVEQUFHLHFCQUFxQixzQkFBc0Isa0JBQWtCLHVEQUFHLFVBQVUsb0ZBQW9GLElBQUk7QUFDdFI7O0FBRUEsOEJBQThCLFVBQVU7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsc0RBQVE7QUFDbEQsSUFBSSx1REFBUztBQUNiO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSx1REFBUztBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxLQUFLO0FBQ0wsWUFBWSx1REFBRyx3QkFBd0IsdUJBQXVCLHdEQUFJLFVBQVUsMERBQTBELHVEQUFHLHdCQUF3Qiw0QkFBNEIsR0FBRyx1REFBRyxVQUFVLHVGQUF1Rix1REFBRyxvQkFBb0IsNElBQTRJLFlBQVksR0FBRyx1REFBRyxzQkFBc0I7QUFDL2U7QUFDQSw2SkFBNkosNkNBQTZDLEdBQUc7QUFDN007O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEZBQTRGLGFBQWE7QUFDekc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTs7QUFFQSx1QkFBdUIsV0FBVztBQUNsQyxnREFBZ0Qsc0RBQVE7QUFDeEQsdUJBQXVCLG9EQUFRO0FBQy9CLFlBQVksa0JBQWtCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDLG9EQUFRO0FBQ3JELDRCQUE0QixvREFBUTtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsSUFBSTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxJQUFJLHVEQUFTO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMLElBQUksdURBQVM7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLDREQUE0RCxzREFBUTtBQUNwRSxJQUFJLHVEQUFTO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsSUFBSSx1REFBUztBQUNiO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLG9CQUFvQix3REFBSSxDQUFDLHdEQUFRLElBQUksV0FBVyx1REFBRyxVQUFVLGtIQUFrSCxpQkFBaUIsdURBQUcsVUFBVSw4R0FBOEcsS0FBSztBQUNoVTtBQUNBO0FBQ0Esb0JBQW9CLHdEQUFJLENBQUMsd0RBQVEsSUFBSSxXQUFXLHVEQUFHLFVBQVUsa0hBQWtILEdBQUcsdURBQUcsVUFBVSx1REFBdUQsSUFBSTtBQUMxUDtBQUNBO0FBQ0Esb0JBQW9CLHdEQUFJLENBQUMsd0RBQVEsSUFBSSxXQUFXLHVEQUFHLFVBQVUsdURBQXVELEdBQUcsdURBQUcsVUFBVSw4R0FBOEcsSUFBSTtBQUN0UDtBQUNBLGVBQWUsdURBQUcsVUFBVSx1REFBdUQ7QUFDbkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLFlBQVksdURBQUcsd0JBQXdCLHVCQUF1Qix1REFBRyxVQUFVLGlHQUFpRyx1REFBRyxVQUFVLHdFQUF3RSxtQ0FBbUMsd0RBQUksVUFBVSw2REFBNkQsdURBQUcsVUFBVSw0Q0FBNEMsdURBQUcsVUFBVTtBQUNyYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixHQUFHLEdBQUcsR0FBRyx1REFBRyxVQUFVLHVFQUF1RSx3REFBSSxVQUFVLGdPQUFnTyx1REFBRyxVQUFVO0FBQ3JYLDJFQUEyRSxhQUFhO0FBQ3hGLHVDQUF1QyxHQUFHLHdEQUFJLFVBQVUsZ0RBQWdELHVEQUFHLFVBQVUsMERBQTBELEdBQUcsdURBQUcsVUFBVSxnRkFBZ0YsSUFBSSxJQUFJLGVBQWUsR0FBRyx1REFBRyxVQUFVLGtDQUFrQyxJQUFJLGdCQUFnQixHQUFHO0FBQy9XOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFOGEiLCJzb3VyY2VzIjpbIi9Vc2Vycy9uaWtpdGEvRGVza3RvcC9mb2N1c3BoZXJlL25vZGVfbW9kdWxlcy9Ac2NoZWR1bGUteC9jYWxlbmRhci9kaXN0L2NvcmUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQ29udGV4dCwgcmVuZGVyLCBjcmVhdGVFbGVtZW50LCBGcmFnbWVudCBhcyBGcmFnbWVudCQxIH0gZnJvbSAncHJlYWN0JztcbmltcG9ydCB7IGpzeCwgRnJhZ21lbnQsIGpzeHMgfSBmcm9tICdwcmVhY3QvanN4LXJ1bnRpbWUnO1xuaW1wb3J0IHsgdXNlQ29udGV4dCwgdXNlU3RhdGUsIHVzZUVmZmVjdCwgdXNlTWVtbywgdXNlUmVmIGFzIHVzZVJlZiQxIH0gZnJvbSAncHJlYWN0L2hvb2tzJztcbmltcG9ydCB7IHVzZVJlZiwgY3JlYXRlUG9ydGFsIH0gZnJvbSAncHJlYWN0L2NvbXBhdCc7XG5pbXBvcnQgeyB1c2VTaWduYWxFZmZlY3QsIHVzZUNvbXB1dGVkLCBzaWduYWwsIGVmZmVjdCwgY29tcHV0ZWQsIGJhdGNoIH0gZnJvbSAnQHByZWFjdC9zaWduYWxzJztcblxuY29uc3QgQXBwQ29udGV4dCQxID0gY3JlYXRlQ29udGV4dCh7fSk7XG5cbnZhciBpbWcgPSBcImRhdGE6aW1hZ2Uvc3ZnK3htbCwlM2MlM2Z4bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0ndXRmLTgnJTNmJTNlJTNjIS0tIFVwbG9hZGVkIHRvOiBTVkcgUmVwbyUyYyB3d3cuc3ZncmVwby5jb20lMmMgR2VuZXJhdG9yOiBTVkcgUmVwbyBNaXhlciBUb29scyAtLSUzZSUzY3N2ZyB3aWR0aD0nODAwcHgnIGhlaWdodD0nODAwcHgnIHZpZXdCb3g9JzAgMCAyNCAyNCcgZmlsbD0nbm9uZScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyUzZSUzY3BhdGggZD0nTTYgOUwxMiAxNUwxOCA5JyBzdHJva2U9JyUyM0I4QjVCOCcgc3Ryb2tlLXdpZHRoPSc0JyBzdHJva2UtbGluZWNhcD0ncm91bmQnIHN0cm9rZS1saW5lam9pbj0ncm91bmQnLyUzZSUzYy9zdmclM2VcIjtcblxuLyoqXG4gKiBDYW4gYmUgdXNlZCBmb3IgZ2VuZXJhdGluZyBhIHJhbmRvbSBpZCBmb3IgYW4gZW50aXR5XG4gKiBTaG91bGQsIGhvd2V2ZXIsIG5ldmVyIGJlIHVzZWQgaW4gcG90ZW50aWFsbHkgcmVzb3VyY2UgaW50ZW5zZSBsb29wcyxcbiAqIHNpbmNlIHRoZSBwZXJmb3JtYW5jZSBjb3N0IG9mIHRoaXMgY29tcGFyZWQgdG8gbmV3IERhdGUoKS5nZXRUaW1lKCkgaXMgY2EgeDQgaW4gdjhcbiAqICovXG5jb25zdCByYW5kb21TdHJpbmdJZCA9ICgpID0+ICdzJyArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZygyLCAxMSk7XG5cbmNvbnN0IGlzS2V5RW50ZXJPclNwYWNlID0gKGtleWJvYXJkRXZlbnQpID0+IGtleWJvYXJkRXZlbnQua2V5ID09PSAnRW50ZXInIHx8IGtleWJvYXJkRXZlbnQua2V5ID09PSAnICc7XG5cbmZ1bmN0aW9uIEFwcElucHV0KCkge1xuICAgIGNvbnN0IGRhdGVQaWNrZXJJbnB1dElkID0gcmFuZG9tU3RyaW5nSWQoKTtcbiAgICBjb25zdCBkYXRlUGlja2VyTGFiZWxJZCA9IHJhbmRvbVN0cmluZ0lkKCk7XG4gICAgY29uc3QgaW5wdXRXcmFwcGVySWQgPSByYW5kb21TdHJpbmdJZCgpO1xuICAgIGNvbnN0ICRhcHAgPSB1c2VDb250ZXh0KEFwcENvbnRleHQkMSk7XG4gICAgY29uc3QgW3dyYXBwZXJDbGFzc2VzLCBzZXRXcmFwcGVyQ2xhc3Nlc10gPSB1c2VTdGF0ZShbXSk7XG4gICAgY29uc3Qgc2V0SW5wdXRFbGVtZW50ID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBpbnB1dFdyYXBwZXJFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlucHV0V3JhcHBlcklkKTtcbiAgICAgICAgJGFwcC5kYXRlUGlja2VyU3RhdGUuaW5wdXRXcmFwcGVyRWxlbWVudC52YWx1ZSA9XG4gICAgICAgICAgICBpbnB1dFdyYXBwZXJFbCBpbnN0YW5jZW9mIEhUTUxEaXZFbGVtZW50ID8gaW5wdXRXcmFwcGVyRWwgOiB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAoJGFwcC5jb25maWcudGVsZXBvcnRUbylcbiAgICAgICAgICAgIHNldElucHV0RWxlbWVudCgpO1xuICAgICAgICBjb25zdCBuZXdDbGFzc2VzID0gWydzeF9fZGF0ZS1pbnB1dC13cmFwcGVyJ107XG4gICAgICAgIGlmICgkYXBwLmRhdGVQaWNrZXJTdGF0ZS5pc09wZW4udmFsdWUpXG4gICAgICAgICAgICBuZXdDbGFzc2VzLnB1c2goJ3N4X19kYXRlLWlucHV0LS1hY3RpdmUnKTtcbiAgICAgICAgc2V0V3JhcHBlckNsYXNzZXMobmV3Q2xhc3Nlcyk7XG4gICAgfSwgWyRhcHAuZGF0ZVBpY2tlclN0YXRlLmlzT3Blbi52YWx1ZV0pO1xuICAgIGNvbnN0IGhhbmRsZUtleVVwID0gKGV2ZW50KSA9PiB7XG4gICAgICAgIGlmIChldmVudC5rZXkgPT09ICdFbnRlcicpXG4gICAgICAgICAgICBoYW5kbGVJbnB1dFZhbHVlKGV2ZW50KTtcbiAgICB9O1xuICAgIGNvbnN0IGhhbmRsZUlucHV0VmFsdWUgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7IC8vIHByZXZlbnQgZGF0ZSBwaWNrZXIgZnJvbSBjbG9zaW5nXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAkYXBwLmRhdGVQaWNrZXJTdGF0ZS5oYW5kbGVJbnB1dChldmVudC50YXJnZXQudmFsdWUpO1xuICAgICAgICAgICAgJGFwcC5kYXRlUGlja2VyU3RhdGUuY2xvc2UoKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yIHNldHRpbmcgaW5wdXQgdmFsdWU6JyArIGUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBjb25zdCBpbnB1dEVsZW1lbnQgPSB0eXBlb2YgZG9jdW1lbnQgIT09ICd1bmRlZmluZWQnICYmXG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChkYXRlUGlja2VySW5wdXRJZCk7XG4gICAgICAgIGlmICh0eXBlb2YgSFRNTEVsZW1lbnQgPT09ICd1bmRlZmluZWQnIHx8XG4gICAgICAgICAgICAhKGlucHV0RWxlbWVudCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGhhbmRsZUlucHV0VmFsdWUpOyAvLyBQcmVhY3Qgb25DaGFuZ2UgdHJpZ2dlcnMgb24gZXZlcnkgaW5wdXRcbiAgICAgICAgcmV0dXJuICgpID0+IGlucHV0RWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBoYW5kbGVJbnB1dFZhbHVlKTtcbiAgICB9KTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAoJGFwcC5jb25maWcuaGFzUGxhY2Vob2xkZXIpIHtcbiAgICAgICAgICAgICRhcHAuZGF0ZVBpY2tlclN0YXRlLmlucHV0RGlzcGxheWVkVmFsdWUudmFsdWUgPVxuICAgICAgICAgICAgICAgICRhcHAudHJhbnNsYXRlKCdNTS9ERC9ZWVlZJyk7XG4gICAgICAgIH1cbiAgICB9LCBbXSk7XG4gICAgY29uc3QgaGFuZGxlQ2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICRhcHAuZGF0ZVBpY2tlclN0YXRlLm9wZW4oKTtcbiAgICB9O1xuICAgIGNvbnN0IGhhbmRsZUJ1dHRvbktleURvd24gPSAoa2V5Ym9hcmRFdmVudCkgPT4ge1xuICAgICAgICBpZiAoaXNLZXlFbnRlck9yU3BhY2Uoa2V5Ym9hcmRFdmVudCkpIHtcbiAgICAgICAgICAgIGtleWJvYXJkRXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICRhcHAuZGF0ZVBpY2tlclN0YXRlLm9wZW4oKTtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1mb2N1cz1cInRydWVcIl0nKTtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KVxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmZvY3VzKCk7XG4gICAgICAgICAgICB9LCA1MCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiAoanN4KEZyYWdtZW50LCB7IGNoaWxkcmVuOiBqc3hzKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB3cmFwcGVyQ2xhc3Nlcy5qb2luKCcgJyksIGlkOiBpbnB1dFdyYXBwZXJJZCwgY2hpbGRyZW46IFtqc3goXCJsYWJlbFwiLCB7IGZvcjogZGF0ZVBpY2tlcklucHV0SWQsIGlkOiBkYXRlUGlja2VyTGFiZWxJZCwgY2xhc3NOYW1lOiBcInN4X19kYXRlLWlucHV0LWxhYmVsXCIsIGNoaWxkcmVuOiAkYXBwLmNvbmZpZy5sYWJlbCB8fCAkYXBwLnRyYW5zbGF0ZSgnRGF0ZScpIH0pLCBqc3goXCJpbnB1dFwiLCB7IGlkOiBkYXRlUGlja2VySW5wdXRJZCwgdGFiSW5kZXg6ICRhcHAuZGF0ZVBpY2tlclN0YXRlLmlzRGlzYWJsZWQudmFsdWUgPyAtMSA6IDAsIG5hbWU6ICRhcHAuY29uZmlnLm5hbWUgfHwgJ2RhdGUnLCBcImFyaWEtZGVzY3JpYmVkYnlcIjogZGF0ZVBpY2tlckxhYmVsSWQsIHZhbHVlOiAkYXBwLmRhdGVQaWNrZXJTdGF0ZS5pbnB1dERpc3BsYXllZFZhbHVlLnZhbHVlLCBcImRhdGEtdGVzdGlkXCI6IFwiZGF0ZS1waWNrZXItaW5wdXRcIiwgY2xhc3NOYW1lOiBcInN4X19kYXRlLWlucHV0XCIsIG9uQ2xpY2s6IGhhbmRsZUNsaWNrLCBvbktleVVwOiBoYW5kbGVLZXlVcCwgdHlwZTogXCJ0ZXh0XCIgfSksIGpzeChcImJ1dHRvblwiLCB7IHR5cGU6IFwiYnV0dG9uXCIsIHRhYkluZGV4OiAkYXBwLmRhdGVQaWNrZXJTdGF0ZS5pc0Rpc2FibGVkLnZhbHVlID8gLTEgOiAwLCBcImFyaWEtbGFiZWxcIjogJGFwcC50cmFuc2xhdGUoJ0Nob29zZSBEYXRlJyksIG9uS2V5RG93bjogaGFuZGxlQnV0dG9uS2V5RG93biwgb25DbGljazogKCkgPT4gJGFwcC5kYXRlUGlja2VyU3RhdGUub3BlbigpLCBjbGFzc05hbWU6IFwic3hfX2J1dHRvbiBzeF9fZGF0ZS1pbnB1dC1jaGV2cm9uLXdyYXBwZXJcIiwgY2hpbGRyZW46IGpzeChcImltZ1wiLCB7IGNsYXNzTmFtZTogXCJzeF9fZGF0ZS1pbnB1dC1jaGV2cm9uXCIsIHNyYzogaW1nLCBhbHQ6IFwiXCIgfSkgfSldIH0pIH0pKTtcbn1cblxudmFyIERhdGVQaWNrZXJWaWV3O1xuKGZ1bmN0aW9uIChEYXRlUGlja2VyVmlldykge1xuICAgIERhdGVQaWNrZXJWaWV3W1wiTU9OVEhfREFZU1wiXSA9IFwibW9udGgtZGF5c1wiO1xuICAgIERhdGVQaWNrZXJWaWV3W1wiWUVBUlNcIl0gPSBcInllYXJzXCI7XG59KShEYXRlUGlja2VyVmlldyB8fCAoRGF0ZVBpY2tlclZpZXcgPSB7fSkpO1xuXG5jb25zdCBZRUFSU19WSUVXID0gJ3llYXJzLXZpZXcnO1xuY29uc3QgTU9OVEhfVklFVyA9ICdtb250aHMtdmlldyc7XG5jb25zdCBEQVRFX1BJQ0tFUl9XRUVLID0gJ2RhdGUtcGlja2VyLXdlZWsnO1xuXG5jb25zdCB0b0xvY2FsaXplZE1vbnRoID0gKGRhdGUsIGxvY2FsZSkgPT4ge1xuICAgIHJldHVybiBkYXRlLnRvTG9jYWxlU3RyaW5nKGxvY2FsZSwgeyBtb250aDogJ2xvbmcnIH0pO1xufTtcbmNvbnN0IHRvTG9jYWxpemVkRGF0ZVN0cmluZyA9IChkYXRlLCBsb2NhbGUpID0+IHtcbiAgICByZXR1cm4gZGF0ZS50b0xvY2FsZVN0cmluZyhsb2NhbGUsIHtcbiAgICAgICAgbW9udGg6ICdudW1lcmljJyxcbiAgICAgICAgZGF5OiAnbnVtZXJpYycsXG4gICAgICAgIHllYXI6ICdudW1lcmljJyxcbiAgICB9KTtcbn07XG5jb25zdCBnZXRPbmVMZXR0ZXJEYXlOYW1lcyA9ICh3ZWVrLCBsb2NhbGUpID0+IHtcbiAgICByZXR1cm4gd2Vlay5tYXAoKGRhdGUpID0+IHtcbiAgICAgICAgcmV0dXJuIGRhdGUudG9Mb2NhbGVTdHJpbmcobG9jYWxlLCB7IHdlZWtkYXk6ICdzaG9ydCcgfSkuY2hhckF0KDApO1xuICAgIH0pO1xufTtcbmNvbnN0IGdldERheU5hbWVTaG9ydCA9IChkYXRlLCBsb2NhbGUpID0+IHtcbiAgICBpZiAobG9jYWxlID09PSAnaGUtSUwnKSB7XG4gICAgICAgIHJldHVybiBkYXRlLnRvTG9jYWxlU3RyaW5nKGxvY2FsZSwgeyB3ZWVrZGF5OiAnbmFycm93JyB9KTtcbiAgICB9XG4gICAgcmV0dXJuIGRhdGUudG9Mb2NhbGVTdHJpbmcobG9jYWxlLCB7IHdlZWtkYXk6ICdzaG9ydCcgfSk7XG59O1xuY29uc3QgZ2V0RGF5TmFtZXNTaG9ydCA9ICh3ZWVrLCBsb2NhbGUpID0+IHtcbiAgICByZXR1cm4gd2Vlay5tYXAoKGRhdGUpID0+IGdldERheU5hbWVTaG9ydChkYXRlLCBsb2NhbGUpKTtcbn07XG5jb25zdCBnZXRPbmVMZXR0ZXJPclNob3J0RGF5TmFtZXMgPSAod2VlaywgbG9jYWxlKSA9PiB7XG4gICAgaWYgKFsnemgtY24nLCAnemgtdHcnLCAnY2EtZXMnLCAnaGUtaWwnXS5pbmNsdWRlcyhsb2NhbGUudG9Mb3dlckNhc2UoKSkpIHtcbiAgICAgICAgcmV0dXJuIGdldERheU5hbWVzU2hvcnQod2VlaywgbG9jYWxlKTtcbiAgICB9XG4gICAgcmV0dXJuIGdldE9uZUxldHRlckRheU5hbWVzKHdlZWssIGxvY2FsZSk7XG59O1xuXG5jb25zdCBEYXRlRm9ybWF0cyA9IHtcbiAgICBEQVRFX1NUUklORzogL15cXGR7NH0tXFxkezJ9LVxcZHsyfSQvLFxuICAgIERBVEVfVElNRV9TVFJJTkc6IC9eXFxkezR9LVxcZHsyfS1cXGR7Mn0gXFxkezJ9OlxcZHsyfSQvLFxufTtcblxuY2xhc3MgSW52YWxpZERhdGVUaW1lRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IoZGF0ZVRpbWVTcGVjaWZpY2F0aW9uKSB7XG4gICAgICAgIHN1cGVyKGBJbnZhbGlkIGRhdGUgdGltZSBzcGVjaWZpY2F0aW9uOiAke2RhdGVUaW1lU3BlY2lmaWNhdGlvbn1gKTtcbiAgICB9XG59XG5cbmNvbnN0IHRvSlNEYXRlID0gKGRhdGVUaW1lU3BlY2lmaWNhdGlvbikgPT4ge1xuICAgIGlmICghRGF0ZUZvcm1hdHMuREFURV9USU1FX1NUUklORy50ZXN0KGRhdGVUaW1lU3BlY2lmaWNhdGlvbikgJiZcbiAgICAgICAgIURhdGVGb3JtYXRzLkRBVEVfU1RSSU5HLnRlc3QoZGF0ZVRpbWVTcGVjaWZpY2F0aW9uKSlcbiAgICAgICAgdGhyb3cgbmV3IEludmFsaWREYXRlVGltZUVycm9yKGRhdGVUaW1lU3BlY2lmaWNhdGlvbik7XG4gICAgcmV0dXJuIG5ldyBEYXRlKE51bWJlcihkYXRlVGltZVNwZWNpZmljYXRpb24uc2xpY2UoMCwgNCkpLCBOdW1iZXIoZGF0ZVRpbWVTcGVjaWZpY2F0aW9uLnNsaWNlKDUsIDcpKSAtIDEsIE51bWJlcihkYXRlVGltZVNwZWNpZmljYXRpb24uc2xpY2UoOCwgMTApKSwgTnVtYmVyKGRhdGVUaW1lU3BlY2lmaWNhdGlvbi5zbGljZSgxMSwgMTMpKSwgLy8gZm9yIGRhdGUgc3RyaW5ncyB0aGlzIHdpbGwgYmUgMFxuICAgIE51bWJlcihkYXRlVGltZVNwZWNpZmljYXRpb24uc2xpY2UoMTQsIDE2KSkgLy8gZm9yIGRhdGUgc3RyaW5ncyB0aGlzIHdpbGwgYmUgMFxuICAgICk7XG59O1xuY29uc3QgdG9JbnRlZ2VycyA9IChkYXRlVGltZVNwZWNpZmljYXRpb24pID0+IHtcbiAgICBjb25zdCBob3VycyA9IGRhdGVUaW1lU3BlY2lmaWNhdGlvbi5zbGljZSgxMSwgMTMpLCBtaW51dGVzID0gZGF0ZVRpbWVTcGVjaWZpY2F0aW9uLnNsaWNlKDE0LCAxNik7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgeWVhcjogTnVtYmVyKGRhdGVUaW1lU3BlY2lmaWNhdGlvbi5zbGljZSgwLCA0KSksXG4gICAgICAgIG1vbnRoOiBOdW1iZXIoZGF0ZVRpbWVTcGVjaWZpY2F0aW9uLnNsaWNlKDUsIDcpKSAtIDEsXG4gICAgICAgIGRhdGU6IE51bWJlcihkYXRlVGltZVNwZWNpZmljYXRpb24uc2xpY2UoOCwgMTApKSxcbiAgICAgICAgaG91cnM6IGhvdXJzICE9PSAnJyA/IE51bWJlcihob3VycykgOiB1bmRlZmluZWQsXG4gICAgICAgIG1pbnV0ZXM6IG1pbnV0ZXMgIT09ICcnID8gTnVtYmVyKG1pbnV0ZXMpIDogdW5kZWZpbmVkLFxuICAgIH07XG59O1xuXG5jbGFzcyBOdW1iZXJSYW5nZUVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICAgIGNvbnN0cnVjdG9yKG1pbiwgbWF4KSB7XG4gICAgICAgIHN1cGVyKGBOdW1iZXIgbXVzdCBiZSBiZXR3ZWVuICR7bWlufSBhbmQgJHttYXh9LmApO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJtaW5cIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IG1pblxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwibWF4XCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBtYXhcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG5jb25zdCBkb3VibGVEaWdpdCA9IChudW1iZXIpID0+IHtcbiAgICBpZiAobnVtYmVyIDwgMCB8fCBudW1iZXIgPiA5OSlcbiAgICAgICAgdGhyb3cgbmV3IE51bWJlclJhbmdlRXJyb3IoMCwgOTkpO1xuICAgIHJldHVybiBTdHJpbmcobnVtYmVyKS5wYWRTdGFydCgyLCAnMCcpO1xufTtcblxuY29uc3QgdG9EYXRlU3RyaW5nJDEgPSAoZGF0ZSkgPT4ge1xuICAgIHJldHVybiBgJHtkYXRlLnllYXJ9LSR7ZG91YmxlRGlnaXQoZGF0ZS5tb250aCl9LSR7ZG91YmxlRGlnaXQoZGF0ZS5kYXkpfWA7XG59O1xuY29uc3QgdG9UaW1lU3RyaW5nID0gKGRhdGUpID0+IHtcbiAgICByZXR1cm4gYCR7ZG91YmxlRGlnaXQoZGF0ZS5ob3VyKX06JHtkb3VibGVEaWdpdChkYXRlLm1pbnV0ZSl9YDtcbn07XG5jb25zdCB0b0RhdGVUaW1lU3RyaW5nID0gKGRhdGUpID0+IHtcbiAgICByZXR1cm4gYCR7dG9EYXRlU3RyaW5nJDEoZGF0ZSl9ICR7dG9UaW1lU3RyaW5nKGRhdGUpfWA7XG59O1xuXG5jb25zdCBhZGRNb250aHMgPSAodG8sIG5Nb250aHMpID0+IHtcbiAgICBpZiAobk1vbnRocyA8IDApIHtcbiAgICAgICAgcmV0dXJuIHRvLnN1YnRyYWN0KHsgbW9udGhzOiAtbk1vbnRocyB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHRvLmFkZCh7IG1vbnRoczogbk1vbnRocyB9KTtcbn07XG5jb25zdCBhZGREYXlzID0gKHRvLCBuRGF5cykgPT4ge1xuICAgIGlmIChuRGF5cyA8IDApIHtcbiAgICAgICAgcmV0dXJuIHRvLnN1YnRyYWN0KHsgZGF5czogLW5EYXlzIH0pO1xuICAgIH1cbiAgICByZXR1cm4gdG8uYWRkKHsgZGF5czogbkRheXMgfSk7XG59O1xuXG5jb25zdCBnZXRGaXJzdERheU9QcmV2aW91c01vbnRoID0gKGRhdGUpID0+IHtcbiAgICByZXR1cm4gYWRkTW9udGhzKGRhdGUsIC0xKS53aXRoKHsgZGF5OiAxIH0pO1xufTtcbmNvbnN0IGdldEZpcnN0RGF5T2ZOZXh0TW9udGggPSAoZGF0ZSkgPT4ge1xuICAgIGNvbnN0IG5leHRNb250aCA9IGFkZE1vbnRocyhkYXRlLCAxKTtcbiAgICByZXR1cm4gbmV4dE1vbnRoLndpdGgoeyBkYXk6IDEgfSk7XG59O1xuXG5mdW5jdGlvbiBDaGV2cm9uKHsgZGlyZWN0aW9uLCBvbkNsaWNrLCBidXR0b25UZXh0LCBkaXNhYmxlZCA9IGZhbHNlLCB9KSB7XG4gICAgY29uc3QgaGFuZGxlS2V5RG93biA9IChrZXlib2FyZEV2ZW50KSA9PiB7XG4gICAgICAgIGlmIChpc0tleUVudGVyT3JTcGFjZShrZXlib2FyZEV2ZW50KSlcbiAgICAgICAgICAgIG9uQ2xpY2soKTtcbiAgICB9O1xuICAgIHJldHVybiAoanN4KFwiYnV0dG9uXCIsIHsgdHlwZTogXCJidXR0b25cIiwgZGlzYWJsZWQ6IGRpc2FibGVkLCBjbGFzc05hbWU6IFwic3hfX2J1dHRvbiBzeF9fY2hldnJvbi13cmFwcGVyIHN4X19yaXBwbGVcIiwgb25Nb3VzZVVwOiBvbkNsaWNrLCBvbktleURvd246IGhhbmRsZUtleURvd24sIHRhYkluZGV4OiAwLCBjaGlsZHJlbjoganN4KFwiaVwiLCB7IGNsYXNzTmFtZTogYHN4X19jaGV2cm9uIHN4X19jaGV2cm9uLS0ke2RpcmVjdGlvbn1gLCBjaGlsZHJlbjogYnV0dG9uVGV4dCB9KSB9KSk7XG59XG5cbmZ1bmN0aW9uIE1vbnRoVmlld0hlYWRlcih7IHNldFllYXJzVmlldyB9KSB7XG4gICAgY29uc3QgJGFwcCA9IHVzZUNvbnRleHQoQXBwQ29udGV4dCQxKTtcbiAgICBjb25zdCBkYXRlU3RyaW5nVG9Mb2NhbGl6ZWRNb250aE5hbWUgPSAoc2VsZWN0ZWREYXRlKSA9PiB7XG4gICAgICAgIHJldHVybiB0b0xvY2FsaXplZE1vbnRoKHNlbGVjdGVkRGF0ZSwgJGFwcC5jb25maWcubG9jYWxlLnZhbHVlKTtcbiAgICB9O1xuICAgIGNvbnN0IGdldFllYXJGcm9tID0gKGRhdGVQaWNrZXJEYXRlKSA9PiB7XG4gICAgICAgIHJldHVybiBkYXRlUGlja2VyRGF0ZS55ZWFyO1xuICAgIH07XG4gICAgY29uc3QgW3NlbGVjdGVkRGF0ZU1vbnRoTmFtZSwgc2V0U2VsZWN0ZWREYXRlTW9udGhOYW1lXSA9IHVzZVN0YXRlKGRhdGVTdHJpbmdUb0xvY2FsaXplZE1vbnRoTmFtZSgkYXBwLmRhdGVQaWNrZXJTdGF0ZS5kYXRlUGlja2VyRGF0ZS52YWx1ZSkpO1xuICAgIGNvbnN0IFtkYXRlUGlja2VyWWVhciwgc2V0RGF0ZVBpY2tlclllYXJdID0gdXNlU3RhdGUoZ2V0WWVhckZyb20oJGFwcC5kYXRlUGlja2VyU3RhdGUuZGF0ZVBpY2tlckRhdGUudmFsdWUpKTtcbiAgICBjb25zdCBzZXRQcmV2aW91c01vbnRoID0gKCkgPT4ge1xuICAgICAgICAkYXBwLmRhdGVQaWNrZXJTdGF0ZS5kYXRlUGlja2VyRGF0ZS52YWx1ZSA9IGdldEZpcnN0RGF5T1ByZXZpb3VzTW9udGgoJGFwcC5kYXRlUGlja2VyU3RhdGUuZGF0ZVBpY2tlckRhdGUudmFsdWUpO1xuICAgIH07XG4gICAgY29uc3Qgc2V0TmV4dE1vbnRoID0gKCkgPT4ge1xuICAgICAgICAkYXBwLmRhdGVQaWNrZXJTdGF0ZS5kYXRlUGlja2VyRGF0ZS52YWx1ZSA9IGdldEZpcnN0RGF5T2ZOZXh0TW9udGgoJGFwcC5kYXRlUGlja2VyU3RhdGUuZGF0ZVBpY2tlckRhdGUudmFsdWUpO1xuICAgIH07XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgc2V0U2VsZWN0ZWREYXRlTW9udGhOYW1lKGRhdGVTdHJpbmdUb0xvY2FsaXplZE1vbnRoTmFtZSgkYXBwLmRhdGVQaWNrZXJTdGF0ZS5kYXRlUGlja2VyRGF0ZS52YWx1ZSkpO1xuICAgICAgICBzZXREYXRlUGlja2VyWWVhcihnZXRZZWFyRnJvbSgkYXBwLmRhdGVQaWNrZXJTdGF0ZS5kYXRlUGlja2VyRGF0ZS52YWx1ZSkpO1xuICAgIH0sIFskYXBwLmRhdGVQaWNrZXJTdGF0ZS5kYXRlUGlja2VyRGF0ZS52YWx1ZV0pO1xuICAgIGNvbnN0IGhhbmRsZU9wZW5ZZWFyc1ZpZXcgPSAoZSkgPT4ge1xuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBzZXRZZWFyc1ZpZXcoKTtcbiAgICB9O1xuICAgIHJldHVybiAoanN4KEZyYWdtZW50LCB7IGNoaWxkcmVuOiBqc3hzKFwiaGVhZGVyXCIsIHsgY2xhc3NOYW1lOiBcInN4X19kYXRlLXBpY2tlcl9fbW9udGgtdmlldy1oZWFkZXJcIiwgY2hpbGRyZW46IFtqc3goQ2hldnJvbiwgeyBkaXJlY3Rpb246ICdwcmV2aW91cycsIG9uQ2xpY2s6ICgpID0+IHNldFByZXZpb3VzTW9udGgoKSwgYnV0dG9uVGV4dDogJGFwcC50cmFuc2xhdGUoJ1ByZXZpb3VzIG1vbnRoJykgfSksIGpzeChcImJ1dHRvblwiLCB7IHR5cGU6IFwiYnV0dG9uXCIsIGNsYXNzTmFtZTogXCJzeF9fYnV0dG9uIHN4X19kYXRlLXBpY2tlcl9fbW9udGgtdmlldy1oZWFkZXJfX21vbnRoLXllYXJcIiwgb25DbGljazogKGV2ZW50KSA9PiBoYW5kbGVPcGVuWWVhcnNWaWV3KGV2ZW50KSwgY2hpbGRyZW46IHNlbGVjdGVkRGF0ZU1vbnRoTmFtZSArICcgJyArIGRhdGVQaWNrZXJZZWFyIH0pLCBqc3goQ2hldnJvbiwgeyBkaXJlY3Rpb246ICduZXh0Jywgb25DbGljazogKCkgPT4gc2V0TmV4dE1vbnRoKCksIGJ1dHRvblRleHQ6ICRhcHAudHJhbnNsYXRlKCdOZXh0IG1vbnRoJykgfSldIH0pIH0pKTtcbn1cblxuZnVuY3Rpb24gRGF5TmFtZXMoKSB7XG4gICAgY29uc3QgJGFwcCA9IHVzZUNvbnRleHQoQXBwQ29udGV4dCQxKTtcbiAgICBjb25zdCBhV2VlayA9ICRhcHAudGltZVVuaXRzSW1wbC5nZXRXZWVrRm9yKCRhcHAuZGF0ZVBpY2tlclN0YXRlLmRhdGVQaWNrZXJEYXRlLnZhbHVlKTtcbiAgICBjb25zdCBkYXlOYW1lcyA9IGdldE9uZUxldHRlck9yU2hvcnREYXlOYW1lcyhhV2VlaywgJGFwcC5jb25maWcubG9jYWxlLnZhbHVlKTtcbiAgICByZXR1cm4gKGpzeChcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJzeF9fZGF0ZS1waWNrZXJfX2RheS1uYW1lc1wiLCBjaGlsZHJlbjogZGF5TmFtZXMubWFwKChkYXlOYW1lKSA9PiAoanN4KFwic3BhblwiLCB7IFwiZGF0YS10ZXN0aWRcIjogXCJkYXktbmFtZVwiLCBjbGFzc05hbWU6IFwic3hfX2RhdGUtcGlja2VyX19kYXktbmFtZVwiLCBjaGlsZHJlbjogZGF5TmFtZSB9KSkpIH0pKTtcbn1cblxuY29uc3QgaXNUb2RheSA9IChkYXRlLCB0aW1lem9uZSkgPT4ge1xuICAgIGNvbnN0IHRvZGF5ID0gVGVtcG9yYWwuTm93LnpvbmVkRGF0ZVRpbWVJU08odGltZXpvbmUpO1xuICAgIHJldHVybiAoZGF0ZS5kYXkgPT09IHRvZGF5LmRheSAmJlxuICAgICAgICBkYXRlLm1vbnRoID09PSB0b2RheS5tb250aCAmJlxuICAgICAgICBkYXRlLnllYXIgPT09IHRvZGF5LnllYXIpO1xufTtcbmNvbnN0IGlzU2FtZU1vbnRoID0gKGRhdGUxLCBkYXRlMikgPT4ge1xuICAgIHJldHVybiBkYXRlMS5tb250aCA9PT0gZGF0ZTIubW9udGggJiYgZGF0ZTEueWVhciA9PT0gZGF0ZTIueWVhcjtcbn07XG5jb25zdCBpc1NhbWVEYXkgPSAoZGF0ZTEsIGRhdGUyKSA9PiB7XG4gICAgcmV0dXJuIChkYXRlMS5kYXkgPT09IGRhdGUyLmRheSAmJlxuICAgICAgICBkYXRlMS5tb250aCA9PT0gZGF0ZTIubW9udGggJiZcbiAgICAgICAgZGF0ZTEueWVhciA9PT0gZGF0ZTIueWVhcik7XG59O1xuXG4vKipcbiAqIE9yaWdpbiBvZiBTVkc6IGh0dHBzOi8vd3d3LnN2Z3JlcG8uY29tL3N2Zy81MDY3NzEvdGltZVxuICogTGljZW5zZTogUEQgTGljZW5zZVxuICogQXV0aG9yIFNhbGFoIEVsaW1hbVxuICogQXV0aG9yIHdlYnNpdGU6IGh0dHBzOi8vd3d3LmZpZ21hLmNvbS9Ac2FsYWhlbGltYW1cbiAqICovXG5mdW5jdGlvbiBUaW1lSWNvbih7IHN0cm9rZUNvbG9yIH0pIHtcbiAgICByZXR1cm4gKGpzeChGcmFnbWVudCwgeyBjaGlsZHJlbjoganN4cyhcInN2Z1wiLCB7IGNsYXNzTmFtZTogXCJzeF9fZXZlbnQtaWNvblwiLCB2aWV3Qm94OiBcIjAgMCAyNCAyNFwiLCBmaWxsOiBcIm5vbmVcIiwgeG1sbnM6IFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiwgY2hpbGRyZW46IFtqc3goXCJnXCIsIHsgaWQ6IFwiU1ZHUmVwb19iZ0NhcnJpZXJcIiwgXCJzdHJva2Utd2lkdGhcIjogXCIwXCIgfSksIGpzeChcImdcIiwgeyBpZDogXCJTVkdSZXBvX3RyYWNlckNhcnJpZXJcIiwgXCJzdHJva2UtbGluZWNhcFwiOiBcInJvdW5kXCIsIFwic3Ryb2tlLWxpbmVqb2luXCI6IFwicm91bmRcIiB9KSwganN4cyhcImdcIiwgeyBpZDogXCJTVkdSZXBvX2ljb25DYXJyaWVyXCIsIGNoaWxkcmVuOiBbanN4KFwicGF0aFwiLCB7IGQ6IFwiTTEyIDhWMTJMMTUgMTVcIiwgc3Ryb2tlOiBzdHJva2VDb2xvciwgXCJzdHJva2Utd2lkdGhcIjogXCIyXCIsIFwic3Ryb2tlLWxpbmVjYXBcIjogXCJyb3VuZFwiIH0pLCBqc3goXCJjaXJjbGVcIiwgeyBjeDogXCIxMlwiLCBjeTogXCIxMlwiLCByOiBcIjlcIiwgc3Ryb2tlOiBzdHJva2VDb2xvciwgXCJzdHJva2Utd2lkdGhcIjogXCIyXCIgfSldIH0pXSB9KSB9KSk7XG59XG5cbi8qKlxuICogT3JpZ2luIG9mIFNWRzogaHR0cHM6Ly93d3cuc3ZncmVwby5jb20vc3ZnLzUwNjc3Mi91c2VyXG4gKiBMaWNlbnNlOiBQRCBMaWNlbnNlXG4gKiBBdXRob3IgU2FsYWggRWxpbWFtXG4gKiBBdXRob3Igd2Vic2l0ZTogaHR0cHM6Ly93d3cuZmlnbWEuY29tL0BzYWxhaGVsaW1hbVxuICogKi9cbmZ1bmN0aW9uIFVzZXJJY29uKHsgc3Ryb2tlQ29sb3IgfSkge1xuICAgIHJldHVybiAoanN4KEZyYWdtZW50LCB7IGNoaWxkcmVuOiBqc3hzKFwic3ZnXCIsIHsgY2xhc3NOYW1lOiBcInN4X19ldmVudC1pY29uXCIsIHZpZXdCb3g6IFwiMCAwIDI0IDI0XCIsIGZpbGw6IFwibm9uZVwiLCB4bWxuczogXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiLCBjaGlsZHJlbjogW2pzeChcImdcIiwgeyBpZDogXCJTVkdSZXBvX2JnQ2FycmllclwiLCBcInN0cm9rZS13aWR0aFwiOiBcIjBcIiB9KSwganN4KFwiZ1wiLCB7IGlkOiBcIlNWR1JlcG9fdHJhY2VyQ2FycmllclwiLCBcInN0cm9rZS1saW5lY2FwXCI6IFwicm91bmRcIiwgXCJzdHJva2UtbGluZWpvaW5cIjogXCJyb3VuZFwiIH0pLCBqc3hzKFwiZ1wiLCB7IGlkOiBcIlNWR1JlcG9faWNvbkNhcnJpZXJcIiwgY2hpbGRyZW46IFtqc3goXCJwYXRoXCIsIHsgZDogXCJNMTUgN0MxNSA4LjY1Njg1IDEzLjY1NjkgMTAgMTIgMTBDMTAuMzQzMSAxMCA5IDguNjU2ODUgOSA3QzkgNS4zNDMxNSAxMC4zNDMxIDQgMTIgNEMxMy42NTY5IDQgMTUgNS4zNDMxNSAxNSA3WlwiLCBzdHJva2U6IHN0cm9rZUNvbG9yLCBcInN0cm9rZS13aWR0aFwiOiBcIjJcIiB9KSwganN4KFwicGF0aFwiLCB7IGQ6IFwiTTUgMTkuNUM1IDE1LjkxMDEgNy45MTAxNSAxMyAxMS41IDEzSDEyLjVDMTYuMDg5OSAxMyAxOSAxNS45MTAxIDE5IDE5LjVWMjBDMTkgMjAuNTUyMyAxOC41NTIzIDIxIDE4IDIxSDZDNS40NDc3MiAyMSA1IDIwLjU1MjMgNSAyMFYxOS41WlwiLCBzdHJva2U6IHN0cm9rZUNvbG9yLCBcInN0cm9rZS13aWR0aFwiOiBcIjJcIiB9KV0gfSldIH0pIH0pKTtcbn1cblxuLyoqXG4gKiBPcmlnaW4gb2YgU1ZHOiBodHRwczovL3d3dy5zdmdyZXBvLmNvbS9zdmcvNDg5NTAyL2xvY2F0aW9uLXBpblxuICogTGljZW5zZTogUEQgTGljZW5zZVxuICogQXV0aG9yOiBEYXJpdXNoIEhhYmlicG91clxuICogQXV0aG9yIHdlYnNpdGU6IGh0dHBzOi8vcmVkbC5pbmsvZGFyaXVzaC9saW5rcz9yZWY9c3ZncmVwby5jb21cbiAqICovXG5mdW5jdGlvbiBMb2NhdGlvblBpbkljb24oeyBzdHJva2VDb2xvciB9KSB7XG4gICAgcmV0dXJuIChqc3goRnJhZ21lbnQsIHsgY2hpbGRyZW46IGpzeHMoXCJzdmdcIiwgeyBjbGFzc05hbWU6IFwic3hfX2V2ZW50LWljb25cIiwgdmlld0JveDogXCIwIDAgMjQgMjRcIiwgZmlsbDogXCJub25lXCIsIHhtbG5zOiBcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIsIGNoaWxkcmVuOiBbanN4KFwiZ1wiLCB7IGlkOiBcIlNWR1JlcG9fYmdDYXJyaWVyXCIsIFwic3Ryb2tlLXdpZHRoXCI6IFwiMFwiIH0pLCBqc3goXCJnXCIsIHsgaWQ6IFwiU1ZHUmVwb190cmFjZXJDYXJyaWVyXCIsIFwic3Ryb2tlLWxpbmVjYXBcIjogXCJyb3VuZFwiLCBcInN0cm9rZS1saW5lam9pblwiOiBcInJvdW5kXCIgfSksIGpzeHMoXCJnXCIsIHsgaWQ6IFwiU1ZHUmVwb19pY29uQ2FycmllclwiLCBjaGlsZHJlbjogW2pzeHMoXCJnXCIsIHsgXCJjbGlwLXBhdGhcIjogXCJ1cmwoI2NsaXAwXzQyOV8xMTA0NilcIiwgY2hpbGRyZW46IFtqc3goXCJyZWN0XCIsIHsgeDogXCIxMlwiLCB5OiBcIjExXCIsIHdpZHRoOiBcIjAuMDFcIiwgaGVpZ2h0OiBcIjAuMDFcIiwgc3Ryb2tlOiBzdHJva2VDb2xvciwgXCJzdHJva2Utd2lkdGhcIjogXCIyXCIsIFwic3Ryb2tlLWxpbmVqb2luXCI6IFwicm91bmRcIiB9KSwganN4KFwicGF0aFwiLCB7IGQ6IFwiTTEyIDIyTDE3LjUgMTYuNUMyMC41Mzc2IDEzLjQ2MjQgMjAuNTM3NiA4LjUzNzU3IDE3LjUgNS41QzE0LjQ2MjQgMi40NjI0NCA5LjUzNzU3IDIuNDYyNDQgNi41IDUuNUMzLjQ2MjQ0IDguNTM3NTcgMy40NjI0NCAxMy40NjI0IDYuNSAxNi41TDEyIDIyWlwiLCBzdHJva2U6IHN0cm9rZUNvbG9yLCBcInN0cm9rZS13aWR0aFwiOiBcIjJcIiwgXCJzdHJva2UtbGluZWpvaW5cIjogXCJyb3VuZFwiIH0pXSB9KSwganN4KFwiZGVmc1wiLCB7IGNoaWxkcmVuOiBqc3goXCJjbGlwUGF0aFwiLCB7IGlkOiBcImNsaXAwXzQyOV8xMTA0NlwiLCBjaGlsZHJlbjoganN4KFwicmVjdFwiLCB7IHdpZHRoOiBcIjI0XCIsIGhlaWdodDogXCIyNFwiLCBmaWxsOiBcIndoaXRlXCIgfSkgfSkgfSldIH0pXSB9KSB9KSk7XG59XG5cbmNsYXNzIEludmFsaWRUaW1lU3RyaW5nRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IodGltZVN0cmluZykge1xuICAgICAgICBzdXBlcihgSW52YWxpZCB0aW1lIHN0cmluZzogJHt0aW1lU3RyaW5nfWApO1xuICAgIH1cbn1cblxuLy8gcmVnZXggZm9yIHN0cmluZ3MgYmV0d2VlbiAwMDowMCBhbmQgMjM6NTlcbmNvbnN0IHRpbWVTdHJpbmdSZWdleCA9IC9eKDBbMC05XXwxWzAtOV18MlswLTNdKTpbMC01XVswLTldLztcblxuY29uc3QgbWludXRlVGltZVBvaW50TXVsdGlwbGllciA9IDEuNjY2NjY2NjY2NjY2NjY2NzsgLy8gMTAwIC8gNjBcbmNvbnN0IHRpbWVQb2ludHNGcm9tU3RyaW5nID0gKHRpbWVTdHJpbmcpID0+IHtcbiAgICBpZiAoIXRpbWVTdHJpbmdSZWdleC50ZXN0KHRpbWVTdHJpbmcpICYmIHRpbWVTdHJpbmcgIT09ICcyNDowMCcpXG4gICAgICAgIHRocm93IG5ldyBJbnZhbGlkVGltZVN0cmluZ0Vycm9yKHRpbWVTdHJpbmcpO1xuICAgIGNvbnN0IFtob3Vyc0ludCwgbWludXRlc0ludF0gPSB0aW1lU3RyaW5nXG4gICAgICAgIC5zcGxpdCgnOicpXG4gICAgICAgIC5tYXAoKHRpbWUpID0+IHBhcnNlSW50KHRpbWUsIDEwKSk7XG4gICAgbGV0IG1pbnV0ZVBvaW50cyA9IChtaW51dGVzSW50ICogbWludXRlVGltZVBvaW50TXVsdGlwbGllcikudG9TdHJpbmcoKTtcbiAgICBpZiAobWludXRlUG9pbnRzLnNwbGl0KCcuJylbMF0ubGVuZ3RoIDwgMilcbiAgICAgICAgbWludXRlUG9pbnRzID0gYDAke21pbnV0ZVBvaW50c31gO1xuICAgIHJldHVybiBOdW1iZXIoaG91cnNJbnQgKyBtaW51dGVQb2ludHMpO1xufTtcbmNvbnN0IHRpbWVTdHJpbmdGcm9tVGltZVBvaW50cyA9ICh0aW1lUG9pbnRzKSA9PiB7XG4gICAgY29uc3QgaG91cnMgPSBNYXRoLmZsb29yKHRpbWVQb2ludHMgLyAxMDApO1xuICAgIGNvbnN0IG1pbnV0ZXMgPSBNYXRoLnJvdW5kKCh0aW1lUG9pbnRzICUgMTAwKSAvIG1pbnV0ZVRpbWVQb2ludE11bHRpcGxpZXIpO1xuICAgIHJldHVybiBgJHtkb3VibGVEaWdpdChob3Vycyl9OiR7ZG91YmxlRGlnaXQobWludXRlcyl9YDtcbn07XG5jb25zdCBhZGRUaW1lUG9pbnRzVG9EYXRlVGltZSA9IChkYXRlVGltZSwgcG9pbnRzVG9BZGQpID0+IHtcbiAgICBjb25zdCBtaW51dGVzVG9BZGQgPSBNYXRoLnJvdW5kKHBvaW50c1RvQWRkIC8gbWludXRlVGltZVBvaW50TXVsdGlwbGllcik7XG4gICAgY29uc3QgbmV3RGF0ZVRpbWUgPSBkYXRlVGltZS5hZGQoeyBtaW51dGVzOiBtaW51dGVzVG9BZGQgfSk7XG4gICAgcmV0dXJuIG5ld0RhdGVUaW1lO1xufTtcblxuY29uc3QgZGF0ZUZyb21EYXRlVGltZSA9IChkYXRlVGltZSkgPT4ge1xuICAgIHJldHVybiBkYXRlVGltZS5zbGljZSgwLCAxMCk7XG59O1xuY29uc3QgdGltZUZyb21EYXRlVGltZSA9IChkYXRlVGltZSkgPT4ge1xuICAgIHJldHVybiBkYXRlVGltZS5zbGljZSgxMSk7XG59O1xuXG52YXIgV2Vla0RheTtcbihmdW5jdGlvbiAoV2Vla0RheSkge1xuICAgIFdlZWtEYXlbV2Vla0RheVtcIk1PTkRBWVwiXSA9IDFdID0gXCJNT05EQVlcIjtcbiAgICBXZWVrRGF5W1dlZWtEYXlbXCJUVUVTREFZXCJdID0gMl0gPSBcIlRVRVNEQVlcIjtcbiAgICBXZWVrRGF5W1dlZWtEYXlbXCJXRURORVNEQVlcIl0gPSAzXSA9IFwiV0VETkVTREFZXCI7XG4gICAgV2Vla0RheVtXZWVrRGF5W1wiVEhVUlNEQVlcIl0gPSA0XSA9IFwiVEhVUlNEQVlcIjtcbiAgICBXZWVrRGF5W1dlZWtEYXlbXCJGUklEQVlcIl0gPSA1XSA9IFwiRlJJREFZXCI7XG4gICAgV2Vla0RheVtXZWVrRGF5W1wiU0FUVVJEQVlcIl0gPSA2XSA9IFwiU0FUVVJEQVlcIjtcbiAgICBXZWVrRGF5W1dlZWtEYXlbXCJTVU5EQVlcIl0gPSA3XSA9IFwiU1VOREFZXCI7XG59KShXZWVrRGF5IHx8IChXZWVrRGF5ID0ge30pKTtcblxuY29uc3QgREVGQVVMVF9MT0NBTEUgPSAnZW4tVVMnO1xuY29uc3QgREVGQVVMVF9GSVJTVF9EQVlfT0ZfV0VFSyA9IFdlZWtEYXkuTU9OREFZO1xuY29uc3QgREVGQVVMVF9FVkVOVF9DT0xPUl9OQU1FID0gJ3ByaW1hcnknO1xuXG5jbGFzcyBDYWxlbmRhckV2ZW50SW1wbCB7XG4gICAgY29uc3RydWN0b3IoX2NvbmZpZywgaWQsIF9zdGFydCwgX2VuZCwgdGl0bGUsIHBlb3BsZSwgbG9jYXRpb24sIGRlc2NyaXB0aW9uLCBjYWxlbmRhcklkLCBfb3B0aW9ucyA9IHVuZGVmaW5lZCwgX2N1c3RvbUNvbnRlbnQgPSB7fSwgX2ZvcmVpZ25Qcm9wZXJ0aWVzID0ge30pIHtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiX2NvbmZpZ1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogX2NvbmZpZ1xuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiaWRcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IGlkXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJfc3RhcnRcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IF9zdGFydFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiX2VuZFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogX2VuZFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwidGl0bGVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHRpdGxlXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJwZW9wbGVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHBlb3BsZVxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwibG9jYXRpb25cIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IGxvY2F0aW9uXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJkZXNjcmlwdGlvblwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogZGVzY3JpcHRpb25cbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImNhbGVuZGFySWRcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IGNhbGVuZGFySWRcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl9vcHRpb25zXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBfb3B0aW9uc1xuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiX2N1c3RvbUNvbnRlbnRcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IF9jdXN0b21Db250ZW50XG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJfZm9yZWlnblByb3BlcnRpZXNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IF9mb3JlaWduUHJvcGVydGllc1xuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiX3ByZXZpb3VzQ29uY3VycmVudEV2ZW50c1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJfdG90YWxDb25jdXJyZW50RXZlbnRzXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl9tYXhDb25jdXJyZW50RXZlbnRzXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl9uRGF5c0luR3JpZFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJfY3JlYXRlZEF0XCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl9vcmlnaW5hbFRpbWV6b25lXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl9ldmVudEZyYWdtZW50c1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZToge31cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX29yaWdpbmFsVGltZXpvbmUgPVxuICAgICAgICAgICAgdGhpcy5fc3RhcnQgaW5zdGFuY2VvZiBUZW1wb3JhbC5ab25lZERhdGVUaW1lXG4gICAgICAgICAgICAgICAgPyB0aGlzLl9zdGFydC50aW1lWm9uZUlkXG4gICAgICAgICAgICAgICAgOiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGdldCBzdGFydCgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3N0YXJ0IGluc3RhbmNlb2YgVGVtcG9yYWwuUGxhaW5EYXRlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc3RhcnQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX3N0YXJ0LndpdGhUaW1lWm9uZSh0aGlzLl9jb25maWcudGltZXpvbmUudmFsdWUpO1xuICAgIH1cbiAgICBzZXQgc3RhcnQodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fc3RhcnQgPVxuICAgICAgICAgICAgdmFsdWUgaW5zdGFuY2VvZiBUZW1wb3JhbC5ab25lZERhdGVUaW1lXG4gICAgICAgICAgICAgICAgPyB2YWx1ZS53aXRoVGltZVpvbmUodGhpcy5fb3JpZ2luYWxUaW1lem9uZSlcbiAgICAgICAgICAgICAgICA6IHZhbHVlO1xuICAgIH1cbiAgICBnZXQgZW5kKCkge1xuICAgICAgICBpZiAodGhpcy5fZW5kIGluc3RhbmNlb2YgVGVtcG9yYWwuUGxhaW5EYXRlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZW5kO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9lbmQud2l0aFRpbWVab25lKHRoaXMuX2NvbmZpZy50aW1lem9uZS52YWx1ZSk7XG4gICAgfVxuICAgIHNldCBlbmQodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fZW5kID1cbiAgICAgICAgICAgIHZhbHVlIGluc3RhbmNlb2YgVGVtcG9yYWwuWm9uZWREYXRlVGltZVxuICAgICAgICAgICAgICAgID8gdmFsdWUud2l0aFRpbWVab25lKHRoaXMuX29yaWdpbmFsVGltZXpvbmUpXG4gICAgICAgICAgICAgICAgOiB2YWx1ZTtcbiAgICB9XG4gICAgZ2V0IF9pc1NpbmdsZURheVRpbWVkKCkge1xuICAgICAgICBpZiAodGhpcy5zdGFydCBpbnN0YW5jZW9mIFRlbXBvcmFsLlBsYWluRGF0ZSB8fFxuICAgICAgICAgICAgdGhpcy5lbmQgaW5zdGFuY2VvZiBUZW1wb3JhbC5QbGFpbkRhdGUpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIGNvbnN0IGxvY2FsU3RhcnREYXRlID0gZGF0ZUZyb21EYXRlVGltZSh0aGlzLnN0YXJ0LnRvU3RyaW5nKCkpO1xuICAgICAgICBjb25zdCBsb2NhbEVuZERhdGUgPSBkYXRlRnJvbURhdGVUaW1lKHRoaXMuZW5kLnRvU3RyaW5nKCkpO1xuICAgICAgICByZXR1cm4gbG9jYWxTdGFydERhdGUgPT09IGxvY2FsRW5kRGF0ZTtcbiAgICB9XG4gICAgZ2V0IF9pc1NpbmdsZURheUZ1bGxEYXkoKSB7XG4gICAgICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IGRhdGVGcm9tRGF0ZVRpbWUodGhpcy5zdGFydC50b1N0cmluZygpKTtcbiAgICAgICAgY29uc3QgZW5kRGF0ZSA9IGRhdGVGcm9tRGF0ZVRpbWUodGhpcy5lbmQudG9TdHJpbmcoKSk7XG4gICAgICAgIHJldHVybiAoc3RhcnREYXRlID09PSBlbmREYXRlICYmXG4gICAgICAgICAgICB0aGlzLnN0YXJ0IGluc3RhbmNlb2YgVGVtcG9yYWwuUGxhaW5EYXRlICYmXG4gICAgICAgICAgICB0aGlzLmVuZCBpbnN0YW5jZW9mIFRlbXBvcmFsLlBsYWluRGF0ZSk7XG4gICAgfVxuICAgIGdldCBfaXNNdWx0aURheVRpbWVkKCkge1xuICAgICAgICBpZiAodGhpcy5zdGFydCBpbnN0YW5jZW9mIFRlbXBvcmFsLlBsYWluRGF0ZSB8fFxuICAgICAgICAgICAgdGhpcy5lbmQgaW5zdGFuY2VvZiBUZW1wb3JhbC5QbGFpbkRhdGUpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IGRhdGVGcm9tRGF0ZVRpbWUodGhpcy5zdGFydC50b1N0cmluZygpKTtcbiAgICAgICAgY29uc3QgZW5kRGF0ZSA9IGRhdGVGcm9tRGF0ZVRpbWUodGhpcy5lbmQudG9TdHJpbmcoKSk7XG4gICAgICAgIHJldHVybiBzdGFydERhdGUgIT09IGVuZERhdGU7XG4gICAgfVxuICAgIGdldCBfaXNNdWx0aURheUZ1bGxEYXkoKSB7XG4gICAgICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IGRhdGVGcm9tRGF0ZVRpbWUodGhpcy5zdGFydC50b1N0cmluZygpKTtcbiAgICAgICAgY29uc3QgZW5kRGF0ZSA9IGRhdGVGcm9tRGF0ZVRpbWUodGhpcy5lbmQudG9TdHJpbmcoKSk7XG4gICAgICAgIHJldHVybiAodGhpcy5zdGFydCBpbnN0YW5jZW9mIFRlbXBvcmFsLlBsYWluRGF0ZSAmJlxuICAgICAgICAgICAgdGhpcy5lbmQgaW5zdGFuY2VvZiBUZW1wb3JhbC5QbGFpbkRhdGUgJiZcbiAgICAgICAgICAgIHN0YXJ0RGF0ZSAhPT0gZW5kRGF0ZSk7XG4gICAgfVxuICAgIGdldCBfaXNTaW5nbGVIeWJyaWREYXlUaW1lZCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9jb25maWcuaXNIeWJyaWREYXkpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIGlmICh0aGlzLnN0YXJ0IGluc3RhbmNlb2YgVGVtcG9yYWwuUGxhaW5EYXRlIHx8XG4gICAgICAgICAgICB0aGlzLmVuZCBpbnN0YW5jZW9mIFRlbXBvcmFsLlBsYWluRGF0ZSlcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgY29uc3Qgc3RhcnREYXRlID0gZGF0ZUZyb21EYXRlVGltZSh0aGlzLnN0YXJ0LnRvU3RyaW5nKCkpO1xuICAgICAgICBjb25zdCBlbmREYXRlID0gZGF0ZUZyb21EYXRlVGltZSh0aGlzLmVuZC50b1N0cmluZygpKTtcbiAgICAgICAgY29uc3QgZW5kRGF0ZU1pbnVzT25lRGF5ID0gdG9EYXRlU3RyaW5nJDEoVGVtcG9yYWwuUGxhaW5EYXRlLmZyb20oZW5kRGF0ZSkuc3VidHJhY3QoeyBkYXlzOiAxIH0pKTtcbiAgICAgICAgaWYgKHN0YXJ0RGF0ZSAhPT0gZW5kRGF0ZSAmJiBzdGFydERhdGUgIT09IGVuZERhdGVNaW51c09uZURheSlcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgY29uc3QgZGF5Qm91bmRhcmllcyA9IHRoaXMuX2NvbmZpZy5kYXlCb3VuZGFyaWVzLnZhbHVlO1xuICAgICAgICBjb25zdCBldmVudFN0YXJ0VGltZVBvaW50cyA9IHRpbWVQb2ludHNGcm9tU3RyaW5nKHRpbWVGcm9tRGF0ZVRpbWUodGhpcy5zdGFydC50b1N0cmluZygpKSk7XG4gICAgICAgIGNvbnN0IGV2ZW50RW5kVGltZVBvaW50cyA9IHRpbWVQb2ludHNGcm9tU3RyaW5nKHRpbWVGcm9tRGF0ZVRpbWUodGhpcy5lbmQudG9TdHJpbmcoKSkpO1xuICAgICAgICBjb25zdCBldmVudElzRnVsbHlJbkZpcnN0RGF5T2ZCb3VuZGFyeSA9IGV2ZW50RW5kVGltZVBvaW50cyA+IGV2ZW50U3RhcnRUaW1lUG9pbnRzICYmIHN0YXJ0RGF0ZSA9PT0gZW5kRGF0ZTtcbiAgICAgICAgcmV0dXJuICgoZXZlbnRTdGFydFRpbWVQb2ludHMgPj0gZGF5Qm91bmRhcmllcy5zdGFydCAmJlxuICAgICAgICAgICAgKGV2ZW50RW5kVGltZVBvaW50cyA8PSBkYXlCb3VuZGFyaWVzLmVuZCB8fFxuICAgICAgICAgICAgICAgIGV2ZW50SXNGdWxseUluRmlyc3REYXlPZkJvdW5kYXJ5KSkgfHxcbiAgICAgICAgICAgIChldmVudFN0YXJ0VGltZVBvaW50cyA8IGRheUJvdW5kYXJpZXMuZW5kICYmXG4gICAgICAgICAgICAgICAgZXZlbnRFbmRUaW1lUG9pbnRzIDw9IGRheUJvdW5kYXJpZXMuZW5kKSk7XG4gICAgfVxuICAgIGdldCBfY29sb3IoKSB7XG4gICAgICAgIGlmICh0aGlzLmNhbGVuZGFySWQgJiZcbiAgICAgICAgICAgIHRoaXMuX2NvbmZpZy5jYWxlbmRhcnMudmFsdWUgJiZcbiAgICAgICAgICAgIHRoaXMuY2FsZW5kYXJJZCBpbiB0aGlzLl9jb25maWcuY2FsZW5kYXJzLnZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY29uZmlnLmNhbGVuZGFycy52YWx1ZVt0aGlzLmNhbGVuZGFySWRdLmNvbG9yTmFtZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gREVGQVVMVF9FVkVOVF9DT0xPUl9OQU1FO1xuICAgIH1cbiAgICBfZ2V0Rm9yZWlnblByb3BlcnRpZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9mb3JlaWduUHJvcGVydGllcztcbiAgICB9XG4gICAgX2dldEV4dGVybmFsRXZlbnQoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpZDogdGhpcy5pZCxcbiAgICAgICAgICAgIHN0YXJ0OiB0aGlzLl9zdGFydCxcbiAgICAgICAgICAgIGVuZDogdGhpcy5fZW5kLFxuICAgICAgICAgICAgdGl0bGU6IHRoaXMudGl0bGUsXG4gICAgICAgICAgICBwZW9wbGU6IHRoaXMucGVvcGxlLFxuICAgICAgICAgICAgbG9jYXRpb246IHRoaXMubG9jYXRpb24sXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogdGhpcy5kZXNjcmlwdGlvbixcbiAgICAgICAgICAgIGNhbGVuZGFySWQ6IHRoaXMuY2FsZW5kYXJJZCxcbiAgICAgICAgICAgIF9vcHRpb25zOiB0aGlzLl9vcHRpb25zLFxuICAgICAgICAgICAgLi4udGhpcy5fZ2V0Rm9yZWlnblByb3BlcnRpZXMoKSxcbiAgICAgICAgfTtcbiAgICB9XG59XG5cbmNsYXNzIENhbGVuZGFyRXZlbnRCdWlsZGVyIHtcbiAgICBjb25zdHJ1Y3RvcihfY29uZmlnLCBpZCwgc3RhcnQsIGVuZCkge1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJfY29uZmlnXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBfY29uZmlnXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJpZFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogaWRcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInN0YXJ0XCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBzdGFydFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiZW5kXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBlbmRcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInBlb3BsZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJsb2NhdGlvblwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJkZXNjcmlwdGlvblwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJ0aXRsZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJjYWxlbmRhcklkXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl9mb3JlaWduUHJvcGVydGllc1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZToge31cbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl9vcHRpb25zXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB1bmRlZmluZWRcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl9jdXN0b21Db250ZW50XCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB7fVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgYnVpbGQoKSB7XG4gICAgICAgIHJldHVybiBuZXcgQ2FsZW5kYXJFdmVudEltcGwodGhpcy5fY29uZmlnLCB0aGlzLmlkLCB0aGlzLnN0YXJ0LCB0aGlzLmVuZCwgdGhpcy50aXRsZSwgdGhpcy5wZW9wbGUsIHRoaXMubG9jYXRpb24sIHRoaXMuZGVzY3JpcHRpb24sIHRoaXMuY2FsZW5kYXJJZCwgdGhpcy5fb3B0aW9ucywgdGhpcy5fY3VzdG9tQ29udGVudCwgdGhpcy5fZm9yZWlnblByb3BlcnRpZXMpO1xuICAgIH1cbiAgICB3aXRoVGl0bGUodGl0bGUpIHtcbiAgICAgICAgdGhpcy50aXRsZSA9IHRpdGxlO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgd2l0aFBlb3BsZShwZW9wbGUpIHtcbiAgICAgICAgdGhpcy5wZW9wbGUgPSBwZW9wbGU7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICB3aXRoTG9jYXRpb24obG9jYXRpb24pIHtcbiAgICAgICAgdGhpcy5sb2NhdGlvbiA9IGxvY2F0aW9uO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgd2l0aERlc2NyaXB0aW9uKGRlc2NyaXB0aW9uKSB7XG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHdpdGhGb3JlaWduUHJvcGVydGllcyhmb3JlaWduUHJvcGVydGllcykge1xuICAgICAgICB0aGlzLl9mb3JlaWduUHJvcGVydGllcyA9IGZvcmVpZ25Qcm9wZXJ0aWVzO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgd2l0aENhbGVuZGFySWQoY2FsZW5kYXJJZCkge1xuICAgICAgICB0aGlzLmNhbGVuZGFySWQgPSBjYWxlbmRhcklkO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgd2l0aE9wdGlvbnMob3B0aW9ucykge1xuICAgICAgICB0aGlzLl9vcHRpb25zID0gb3B0aW9ucztcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHdpdGhDdXN0b21Db250ZW50KGN1c3RvbUNvbnRlbnQpIHtcbiAgICAgICAgdGhpcy5fY3VzdG9tQ29udGVudCA9IGN1c3RvbUNvbnRlbnQ7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbn1cblxuY29uc3QgZGVlcENsb25lRXZlbnQgPSAoY2FsZW5kYXJFdmVudCwgJGFwcCkgPT4ge1xuICAgIGNvbnN0IGNhbGVuZGFyRXZlbnRJbnRlcm5hbCA9IG5ldyBDYWxlbmRhckV2ZW50QnVpbGRlcigkYXBwLmNvbmZpZywgY2FsZW5kYXJFdmVudC5pZCwgY2FsZW5kYXJFdmVudC5fc3RhcnQsIGNhbGVuZGFyRXZlbnQuX2VuZClcbiAgICAgICAgLndpdGhUaXRsZShjYWxlbmRhckV2ZW50LnRpdGxlKVxuICAgICAgICAud2l0aFBlb3BsZShjYWxlbmRhckV2ZW50LnBlb3BsZSlcbiAgICAgICAgLndpdGhDYWxlbmRhcklkKGNhbGVuZGFyRXZlbnQuY2FsZW5kYXJJZClcbiAgICAgICAgLndpdGhGb3JlaWduUHJvcGVydGllcyhKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGNhbGVuZGFyRXZlbnQuX2dldEZvcmVpZ25Qcm9wZXJ0aWVzKCkpKSlcbiAgICAgICAgLndpdGhMb2NhdGlvbihjYWxlbmRhckV2ZW50LmxvY2F0aW9uKVxuICAgICAgICAud2l0aERlc2NyaXB0aW9uKGNhbGVuZGFyRXZlbnQuZGVzY3JpcHRpb24pXG4gICAgICAgIC53aXRoT3B0aW9ucyhjYWxlbmRhckV2ZW50Ll9vcHRpb25zKVxuICAgICAgICAud2l0aEN1c3RvbUNvbnRlbnQoY2FsZW5kYXJFdmVudC5fY3VzdG9tQ29udGVudClcbiAgICAgICAgLmJ1aWxkKCk7XG4gICAgY2FsZW5kYXJFdmVudEludGVybmFsLl9uRGF5c0luR3JpZCA9IGNhbGVuZGFyRXZlbnQuX25EYXlzSW5HcmlkO1xuICAgIHJldHVybiBjYWxlbmRhckV2ZW50SW50ZXJuYWw7XG59O1xuXG5jb25zdCBjb25jYXRlbmF0ZVBlb3BsZSA9IChwZW9wbGUpID0+IHtcbiAgICByZXR1cm4gcGVvcGxlLnJlZHVjZSgoYWNjLCBwZXJzb24sIGluZGV4KSA9PiB7XG4gICAgICAgIGlmIChpbmRleCA9PT0gMClcbiAgICAgICAgICAgIHJldHVybiBwZXJzb247XG4gICAgICAgIGlmIChpbmRleCA9PT0gcGVvcGxlLmxlbmd0aCAtIDEpXG4gICAgICAgICAgICByZXR1cm4gYCR7YWNjfSAmICR7cGVyc29ufWA7XG4gICAgICAgIHJldHVybiBgJHthY2N9LCAke3BlcnNvbn1gO1xuICAgIH0sICcnKTtcbn07XG5cbmNvbnN0IGRhdGVGbiA9IChkYXRlVGltZSwgbG9jYWxlKSA9PiB7XG4gICAgcmV0dXJuIGRhdGVUaW1lLnRvTG9jYWxlU3RyaW5nKGxvY2FsZSwge1xuICAgICAgICBkYXk6ICdudW1lcmljJyxcbiAgICAgICAgbW9udGg6ICdsb25nJyxcbiAgICAgICAgeWVhcjogJ251bWVyaWMnLFxuICAgIH0pO1xufTtcbmNvbnN0IGdldExvY2FsaXplZERhdGUkMSA9IGRhdGVGbjtcbmNvbnN0IHRpbWVGbiA9IChkYXRlVGltZSwgbG9jYWxlKSA9PiB7XG4gICAgY29uc3QgZGF0ZVRpbWVTdHJpbmcgPSBkYXRlVGltZS50b1N0cmluZygpO1xuICAgIGNvbnN0IHsgeWVhciwgbW9udGgsIGRhdGUsIGhvdXJzLCBtaW51dGVzIH0gPSB0b0ludGVnZXJzKGRhdGVUaW1lU3RyaW5nKTtcbiAgICByZXR1cm4gbmV3IERhdGUoeWVhciwgbW9udGgsIGRhdGUsIGhvdXJzLCBtaW51dGVzKS50b0xvY2FsZVRpbWVTdHJpbmcobG9jYWxlLCB7XG4gICAgICAgIGhvdXI6ICdudW1lcmljJyxcbiAgICAgICAgbWludXRlOiAnbnVtZXJpYycsXG4gICAgfSk7XG59O1xuY29uc3QgZ2V0VGltZVN0YW1wID0gKGNhbGVuZGFyRXZlbnQsIC8vIHRvIGZhY2lsaXRhdGUgdGVzdGluZy4gSW4gcmVhbGl0eSwgd2Ugd2lsbCBhbHdheXMgaGF2ZSBhIGZ1bGwgQ2FsZW5kYXJFdmVudEludGVybmFsXG5sb2NhbGUsIGRlbGltaXRlciA9ICdcXHUyMDEzJykgPT4ge1xuICAgIHZhciBfYSwgX2IsIF9jLCBfZDtcbiAgICBjb25zdCBldmVudFRpbWUgPSB7IHN0YXJ0OiBjYWxlbmRhckV2ZW50LnN0YXJ0LCBlbmQ6IGNhbGVuZGFyRXZlbnQuZW5kIH07XG4gICAgaWYgKGNhbGVuZGFyRXZlbnQuX2lzU2luZ2xlRGF5RnVsbERheSkge1xuICAgICAgICByZXR1cm4gZGF0ZUZuKGV2ZW50VGltZS5zdGFydCwgbG9jYWxlKTtcbiAgICB9XG4gICAgaWYgKGNhbGVuZGFyRXZlbnQuX2lzTXVsdGlEYXlGdWxsRGF5KSB7XG4gICAgICAgIHJldHVybiBgJHtkYXRlRm4oZXZlbnRUaW1lLnN0YXJ0LCBsb2NhbGUpfSAke2RlbGltaXRlcn0gJHtkYXRlRm4oZXZlbnRUaW1lLmVuZCwgbG9jYWxlKX1gO1xuICAgIH1cbiAgICBpZiAoY2FsZW5kYXJFdmVudC5faXNTaW5nbGVEYXlUaW1lZCAmJlxuICAgICAgICAoKF9hID0gZXZlbnRUaW1lLnN0YXJ0KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EudG9TdHJpbmcoKSkgIT09ICgoX2IgPSBldmVudFRpbWUuZW5kKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IudG9TdHJpbmcoKSkpIHtcbiAgICAgICAgcmV0dXJuIGAke2RhdGVGbihldmVudFRpbWUuc3RhcnQsIGxvY2FsZSl9IDxzcGFuIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPuKLhTwvc3Bhbj4gJHt0aW1lRm4oZXZlbnRUaW1lLnN0YXJ0LCBsb2NhbGUpfSAke2RlbGltaXRlcn0gJHt0aW1lRm4oZXZlbnRUaW1lLmVuZCwgbG9jYWxlKX1gO1xuICAgIH1cbiAgICBpZiAoY2FsZW5kYXJFdmVudC5faXNTaW5nbGVEYXlUaW1lZCAmJlxuICAgICAgICAoKF9jID0gY2FsZW5kYXJFdmVudC5zdGFydCkgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLnRvU3RyaW5nKCkpID09PSAoKF9kID0gY2FsZW5kYXJFdmVudC5lbmQpID09PSBudWxsIHx8IF9kID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZC50b1N0cmluZygpKSkge1xuICAgICAgICByZXR1cm4gYCR7ZGF0ZUZuKGV2ZW50VGltZS5zdGFydCwgbG9jYWxlKX0sICR7dGltZUZuKGV2ZW50VGltZS5zdGFydCwgbG9jYWxlKX1gO1xuICAgIH1cbiAgICByZXR1cm4gYCR7ZGF0ZUZuKGV2ZW50VGltZS5zdGFydCwgbG9jYWxlKX0sICR7dGltZUZuKGV2ZW50VGltZS5zdGFydCwgbG9jYWxlKX0gJHtkZWxpbWl0ZXJ9ICR7ZGF0ZUZuKGV2ZW50VGltZS5lbmQsIGxvY2FsZSl9LCAke3RpbWVGbihldmVudFRpbWUuZW5kLCBsb2NhbGUpfWA7XG59O1xuXG5mdW5jdGlvbiBNb250aFZpZXdXZWVrKHsgd2VlayB9KSB7XG4gICAgY29uc3QgJGFwcCA9IHVzZUNvbnRleHQoQXBwQ29udGV4dCQxKTtcbiAgICBjb25zdCB3ZWVrRGF5cyA9IHdlZWsubWFwKChkYXkpID0+IHtcbiAgICAgICAgY29uc3QgY2xhc3NlcyA9IFsnc3hfX2RhdGUtcGlja2VyX19kYXknXTtcbiAgICAgICAgaWYgKGlzVG9kYXkoZGF5LCAkYXBwLmNvbmZpZy50aW1lem9uZS52YWx1ZSkpXG4gICAgICAgICAgICBjbGFzc2VzLnB1c2goJ3N4X19kYXRlLXBpY2tlcl9fZGF5LS10b2RheScpO1xuICAgICAgICBpZiAoaXNTYW1lRGF5KGRheSwgJGFwcC5kYXRlUGlja2VyU3RhdGUuc2VsZWN0ZWREYXRlLnZhbHVlKSlcbiAgICAgICAgICAgIGNsYXNzZXMucHVzaCgnc3hfX2RhdGUtcGlja2VyX19kYXktLXNlbGVjdGVkJyk7XG4gICAgICAgIGlmICghaXNTYW1lTW9udGgoZGF5LCAkYXBwLmRhdGVQaWNrZXJTdGF0ZS5kYXRlUGlja2VyRGF0ZS52YWx1ZSkpXG4gICAgICAgICAgICBjbGFzc2VzLnB1c2goJ2lzLWxlYWRpbmctb3ItdHJhaWxpbmcnKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGRheTogZGF5LnRvUGxhaW5EYXRlKCksXG4gICAgICAgICAgICBjbGFzc2VzLFxuICAgICAgICB9O1xuICAgIH0pO1xuICAgIGNvbnN0IGlzRGF0ZVNlbGVjdGFibGUgPSAoZGF0ZSkgPT4ge1xuICAgICAgICByZXR1cm4gKGRhdGUudG9TdHJpbmcoKSA+PSAkYXBwLmNvbmZpZy5taW4udG9TdHJpbmcoKSAmJlxuICAgICAgICAgICAgZGF0ZS50b1N0cmluZygpIDw9ICRhcHAuY29uZmlnLm1heC50b1N0cmluZygpKTtcbiAgICB9O1xuICAgIGNvbnN0IHNlbGVjdERhdGUgPSAoZGF0ZSkgPT4ge1xuICAgICAgICAkYXBwLmRhdGVQaWNrZXJTdGF0ZS5zZWxlY3RlZERhdGUudmFsdWUgPSBkYXRlO1xuICAgICAgICAkYXBwLmRhdGVQaWNrZXJTdGF0ZS5jbG9zZSgpO1xuICAgIH07XG4gICAgY29uc3QgaGFzRm9jdXMgPSAod2Vla0RheSkgPT4gaXNTYW1lRGF5KHdlZWtEYXkuZGF5LCAkYXBwLmRhdGVQaWNrZXJTdGF0ZS5kYXRlUGlja2VyRGF0ZS52YWx1ZSk7XG4gICAgY29uc3QgaGFuZGxlS2V5RG93biA9IChldmVudCkgPT4ge1xuICAgICAgICBpZiAoZXZlbnQua2V5ID09PSAnRW50ZXInKSB7XG4gICAgICAgICAgICAkYXBwLmRhdGVQaWNrZXJTdGF0ZS5zZWxlY3RlZERhdGUudmFsdWUgPVxuICAgICAgICAgICAgICAgICRhcHAuZGF0ZVBpY2tlclN0YXRlLmRhdGVQaWNrZXJEYXRlLnZhbHVlO1xuICAgICAgICAgICAgJGFwcC5kYXRlUGlja2VyU3RhdGUuY2xvc2UoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBrZXlNYXBEYXlzVG9BZGQgPSBuZXcgTWFwKFtcbiAgICAgICAgICAgIFsnQXJyb3dEb3duJywgN10sXG4gICAgICAgICAgICBbJ0Fycm93VXAnLCAtN10sXG4gICAgICAgICAgICBbJ0Fycm93TGVmdCcsIC0xXSxcbiAgICAgICAgICAgIFsnQXJyb3dSaWdodCcsIDFdLFxuICAgICAgICBdKTtcbiAgICAgICAgJGFwcC5kYXRlUGlja2VyU3RhdGUuZGF0ZVBpY2tlckRhdGUudmFsdWUgPSBhZGREYXlzKCRhcHAuZGF0ZVBpY2tlclN0YXRlLmRhdGVQaWNrZXJEYXRlLnZhbHVlLCBrZXlNYXBEYXlzVG9BZGQuZ2V0KGV2ZW50LmtleSkgfHwgMCk7XG4gICAgfTtcbiAgICByZXR1cm4gKGpzeChGcmFnbWVudCwgeyBjaGlsZHJlbjoganN4KFwiZGl2XCIsIHsgXCJkYXRhLXRlc3RpZFwiOiBEQVRFX1BJQ0tFUl9XRUVLLCBjbGFzc05hbWU6IFwic3hfX2RhdGUtcGlja2VyX193ZWVrXCIsIGNoaWxkcmVuOiB3ZWVrRGF5cy5tYXAoKHdlZWtEYXkpID0+IChqc3goXCJidXR0b25cIiwgeyB0eXBlOiBcImJ1dHRvblwiLCB0YWJJbmRleDogaGFzRm9jdXMod2Vla0RheSkgPyAwIDogLTEsIGRpc2FibGVkOiAhaXNEYXRlU2VsZWN0YWJsZSh3ZWVrRGF5LmRheSksIFwiYXJpYS1sYWJlbFwiOiBnZXRMb2NhbGl6ZWREYXRlJDEoJGFwcC5kYXRlUGlja2VyU3RhdGUuZGF0ZVBpY2tlckRhdGUudmFsdWUsICRhcHAuY29uZmlnLmxvY2FsZS52YWx1ZSksIGNsYXNzTmFtZTogYHN4X19idXR0b24gJHt3ZWVrRGF5LmNsYXNzZXMuam9pbignICcpfWAsIFwiZGF0YS1mb2N1c1wiOiBoYXNGb2N1cyh3ZWVrRGF5KSA/ICd0cnVlJyA6IHVuZGVmaW5lZCwgb25DbGljazogKCkgPT4gc2VsZWN0RGF0ZSh3ZWVrRGF5LmRheSksIG9uS2V5RG93bjogaGFuZGxlS2V5RG93biwgY2hpbGRyZW46IHdlZWtEYXkuZGF5LmRheSB9KSkpIH0pIH0pKTtcbn1cblxuZnVuY3Rpb24gTW9udGhWaWV3KHsgc2VhdFllYXJzVmlldyB9KSB7XG4gICAgY29uc3QgZWxlbWVudElkID0gcmFuZG9tU3RyaW5nSWQoKTtcbiAgICBjb25zdCAkYXBwID0gdXNlQ29udGV4dChBcHBDb250ZXh0JDEpO1xuICAgIGNvbnN0IFttb250aCwgc2V0TW9udGhdID0gdXNlU3RhdGUoW10pO1xuICAgIGNvbnN0IHJlbmRlck1vbnRoID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBuZXdEYXRlUGlja2VyRGF0ZSA9ICRhcHAuZGF0ZVBpY2tlclN0YXRlLmRhdGVQaWNrZXJEYXRlLnZhbHVlO1xuICAgICAgICBzZXRNb250aCgkYXBwLnRpbWVVbml0c0ltcGwuZ2V0TW9udGhXaXRoVHJhaWxpbmdBbmRMZWFkaW5nRGF5cyhuZXdEYXRlUGlja2VyRGF0ZS55ZWFyLCBuZXdEYXRlUGlja2VyRGF0ZS5tb250aCkpO1xuICAgIH07XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgcmVuZGVyTW9udGgoKTtcbiAgICB9LCBbJGFwcC5kYXRlUGlja2VyU3RhdGUuZGF0ZVBpY2tlckRhdGUudmFsdWVdKTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBjb25zdCBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKChtdXRhdGlvbnMpID0+IHtcbiAgICAgICAgICAgIG11dGF0aW9ucy5mb3JFYWNoKChtdXRhdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IG11dGF0ZWRFbGVtZW50ID0gbXV0YXRpb24udGFyZ2V0O1xuICAgICAgICAgICAgICAgIGlmIChtdXRhdGVkRWxlbWVudC5kYXRhc2V0LmZvY3VzID09PSAndHJ1ZScpXG4gICAgICAgICAgICAgICAgICAgIG11dGF0ZWRFbGVtZW50LmZvY3VzKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IG1vbnRoVmlld0VsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlbGVtZW50SWQpO1xuICAgICAgICBvYnNlcnZlci5vYnNlcnZlKG1vbnRoVmlld0VsZW1lbnQsIHtcbiAgICAgICAgICAgIGNoaWxkTGlzdDogdHJ1ZSxcbiAgICAgICAgICAgIHN1YnRyZWU6IHRydWUsXG4gICAgICAgICAgICBhdHRyaWJ1dGVzOiB0cnVlLFxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuICgpID0+IG9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcbiAgICB9LCBbXSk7XG4gICAgcmV0dXJuIChqc3goRnJhZ21lbnQsIHsgY2hpbGRyZW46IGpzeHMoXCJkaXZcIiwgeyBpZDogZWxlbWVudElkLCBcImRhdGEtdGVzdGlkXCI6IE1PTlRIX1ZJRVcsIGNsYXNzTmFtZTogXCJzeF9fZGF0ZS1waWNrZXJfX21vbnRoLXZpZXdcIiwgY2hpbGRyZW46IFtqc3goTW9udGhWaWV3SGVhZGVyLCB7IHNldFllYXJzVmlldzogc2VhdFllYXJzVmlldyB9KSwganN4KERheU5hbWVzLCB7fSksIG1vbnRoLm1hcCgod2VlaykgPT4gKGpzeChNb250aFZpZXdXZWVrLCB7IHdlZWs6IHdlZWsgfSkpKV0gfSkgfSkpO1xufVxuXG5mdW5jdGlvbiBZZWFyc1ZpZXdBY2NvcmRpb24oeyB5ZWFyLCBzZXRZZWFyQW5kTW9udGgsIGlzRXhwYW5kZWQsIGV4cGFuZCwgfSkge1xuICAgIGNvbnN0ICRhcHAgPSB1c2VDb250ZXh0KEFwcENvbnRleHQkMSk7XG4gICAgY29uc3QgeWVhcldpdGhEYXRlcyA9ICRhcHAudGltZVVuaXRzSW1wbC5nZXRNb250aHNGb3IoeWVhcik7XG4gICAgY29uc3QgaGFuZGxlQ2xpY2tPbk1vbnRoID0gKGV2ZW50LCBtb250aCkgPT4ge1xuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgc2V0WWVhckFuZE1vbnRoKHllYXIsIG1vbnRoLm1vbnRoKTtcbiAgICB9O1xuICAgIHJldHVybiAoanN4KEZyYWdtZW50LCB7IGNoaWxkcmVuOiBqc3hzKFwibGlcIiwgeyBjbGFzc05hbWU6IGlzRXhwYW5kZWQgPyAnc3hfX2lzLWV4cGFuZGVkJyA6ICcnLCBjaGlsZHJlbjogW2pzeChcImJ1dHRvblwiLCB7IHR5cGU6IFwiYnV0dG9uXCIsIGNsYXNzTmFtZTogXCJzeF9fYnV0dG9uIHN4X19kYXRlLXBpY2tlcl9feWVhcnMtYWNjb3JkaW9uX19leHBhbmQtYnV0dG9uIHN4X19yaXBwbGUtLXdpZGVcIiwgb25DbGljazogKCkgPT4gZXhwYW5kKHllYXIpLCBjaGlsZHJlbjogeWVhciB9KSwgaXNFeHBhbmRlZCAmJiAoanN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X19kYXRlLXBpY2tlcl9feWVhcnMtdmlldy1hY2NvcmRpb25fX3BhbmVsXCIsIGNoaWxkcmVuOiB5ZWFyV2l0aERhdGVzLm1hcCgobW9udGgpID0+IChqc3goXCJidXR0b25cIiwgeyB0eXBlOiBcImJ1dHRvblwiLCBjbGFzc05hbWU6IFwic3hfX2J1dHRvbiBzeF9fZGF0ZS1waWNrZXJfX3llYXJzLXZpZXctYWNjb3JkaW9uX19tb250aFwiLCBvbkNsaWNrOiAoZXZlbnQpID0+IGhhbmRsZUNsaWNrT25Nb250aChldmVudCwgbW9udGgpLCBjaGlsZHJlbjogdG9Mb2NhbGl6ZWRNb250aChtb250aCwgJGFwcC5jb25maWcubG9jYWxlLnZhbHVlKSB9KSkpIH0pKV0gfSkgfSkpO1xufVxuXG5mdW5jdGlvbiBZZWFyc1ZpZXcoeyBzZXRNb250aFZpZXcgfSkge1xuICAgIGNvbnN0ICRhcHAgPSB1c2VDb250ZXh0KEFwcENvbnRleHQkMSk7XG4gICAgY29uc3QgbWluWWVhciA9ICRhcHAuY29uZmlnLm1pbi55ZWFyO1xuICAgIGNvbnN0IG1heFllYXIgPSAkYXBwLmNvbmZpZy5tYXgueWVhcjtcbiAgICBjb25zdCB5ZWFycyA9IEFycmF5LmZyb20oeyBsZW5ndGg6IG1heFllYXIgLSBtaW5ZZWFyICsgMSB9LCAoXywgaSkgPT4gbWluWWVhciArIGkpO1xuICAgIGNvbnN0IHNlbGVjdGVkWWVhciA9ICRhcHAuZGF0ZVBpY2tlclN0YXRlLnNlbGVjdGVkRGF0ZS52YWx1ZS55ZWFyO1xuICAgIGNvbnN0IFtleHBhbmRlZFllYXIsIHNldEV4cGFuZGVkWWVhcl0gPSB1c2VTdGF0ZShzZWxlY3RlZFllYXIpO1xuICAgIGNvbnN0IHNldE5ld0RhdGVQaWNrZXJEYXRlID0gKHllYXIsIG1vbnRoKSA9PiB7XG4gICAgICAgICRhcHAuZGF0ZVBpY2tlclN0YXRlLmRhdGVQaWNrZXJEYXRlLnZhbHVlID0gVGVtcG9yYWwuUGxhaW5EYXRlLmZyb20oe1xuICAgICAgICAgICAgeWVhcixcbiAgICAgICAgICAgIG1vbnRoLFxuICAgICAgICAgICAgZGF5OiAxLFxuICAgICAgICB9KTtcbiAgICAgICAgc2V0TW9udGhWaWV3KCk7XG4gICAgfTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGNvbnN0IGluaXRpYWxseUV4cGFuZGVkWWVhciA9IChfYSA9IGRvY3VtZW50XG4gICAgICAgICAgICAucXVlcnlTZWxlY3RvcignLnN4X19kYXRlLXBpY2tlcl9feWVhcnMtdmlldycpKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EucXVlcnlTZWxlY3RvcignLnN4X19pcy1leHBhbmRlZCcpO1xuICAgICAgICBpZiAoIWluaXRpYWxseUV4cGFuZGVkWWVhcilcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgaW5pdGlhbGx5RXhwYW5kZWRZZWFyLnNjcm9sbEludG9WaWV3KHtcbiAgICAgICAgICAgIGJsb2NrOiAnY2VudGVyJyxcbiAgICAgICAgfSk7XG4gICAgfSwgW10pO1xuICAgIHJldHVybiAoanN4KEZyYWdtZW50LCB7IGNoaWxkcmVuOiBqc3goXCJ1bFwiLCB7IGNsYXNzTmFtZTogXCJzeF9fZGF0ZS1waWNrZXJfX3llYXJzLXZpZXdcIiwgXCJkYXRhLXRlc3RpZFwiOiBZRUFSU19WSUVXLCBjaGlsZHJlbjogeWVhcnMubWFwKCh5ZWFyKSA9PiAoanN4KFllYXJzVmlld0FjY29yZGlvbiwgeyB5ZWFyOiB5ZWFyLCBzZXRZZWFyQW5kTW9udGg6ICh5ZWFyLCBtb250aCkgPT4gc2V0TmV3RGF0ZVBpY2tlckRhdGUoeWVhciwgbW9udGgpLCBpc0V4cGFuZGVkOiBleHBhbmRlZFllYXIgPT09IHllYXIsIGV4cGFuZDogKHllYXIpID0+IHNldEV4cGFuZGVkWWVhcih5ZWFyKSB9KSkpIH0pIH0pKTtcbn1cblxuY29uc3QgaXNTY3JvbGxhYmxlID0gKGVsKSA9PiB7XG4gICAgaWYgKGVsKSB7XG4gICAgICAgIGNvbnN0IGhhc1Njcm9sbGFibGVDb250ZW50ID0gZWwuc2Nyb2xsSGVpZ2h0ID4gZWwuY2xpZW50SGVpZ2h0O1xuICAgICAgICBjb25zdCBvdmVyZmxvd1lTdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsKS5vdmVyZmxvd1k7XG4gICAgICAgIGNvbnN0IGlzT3ZlcmZsb3dIaWRkZW4gPSBvdmVyZmxvd1lTdHlsZS5pbmRleE9mKCdoaWRkZW4nKSAhPT0gLTE7XG4gICAgICAgIHJldHVybiBoYXNTY3JvbGxhYmxlQ29udGVudCAmJiAhaXNPdmVyZmxvd0hpZGRlbjtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59O1xuY29uc3QgZ2V0U2Nyb2xsYWJsZVBhcmVudHMgPSAoZWwsIGFjYyA9IFtdKSA9PiB7XG4gICAgaWYgKCFlbCB8fFxuICAgICAgICBlbCA9PT0gZG9jdW1lbnQuYm9keSB8fFxuICAgICAgICBlbC5ub2RlVHlwZSA9PT0gTm9kZS5ET0NVTUVOVF9GUkFHTUVOVF9OT0RFKSB7XG4gICAgICAgIGFjYy5wdXNoKHdpbmRvdyk7XG4gICAgICAgIHJldHVybiBhY2M7XG4gICAgfVxuICAgIGlmIChpc1Njcm9sbGFibGUoZWwpKSB7XG4gICAgICAgIGFjYy5wdXNoKGVsKTtcbiAgICB9XG4gICAgcmV0dXJuIGdldFNjcm9sbGFibGVQYXJlbnRzKChlbC5hc3NpZ25lZFNsb3RcbiAgICAgICAgPyBlbC5hc3NpZ25lZFNsb3QucGFyZW50Tm9kZVxuICAgICAgICA6IGVsLnBhcmVudE5vZGUpLCBhY2MpO1xufTtcblxuY29uc3QgUE9QVVBfQ0xBU1NfTkFNRSA9ICdzeF9fZGF0ZS1waWNrZXItcG9wdXAnO1xuZnVuY3Rpb24gQXBwUG9wdXAoeyB3cmFwcGVyRWwgfSkge1xuICAgIGNvbnN0ICRhcHAgPSB1c2VDb250ZXh0KEFwcENvbnRleHQkMSk7XG4gICAgY29uc3QgW2RhdGVQaWNrZXJWaWV3LCBzZXREYXRlUGlja2VyVmlld10gPSB1c2VTdGF0ZShEYXRlUGlja2VyVmlldy5NT05USF9EQVlTKTtcbiAgICBjb25zdCBjbGFzc0xpc3QgPSB1c2VNZW1vKCgpID0+IHtcbiAgICAgICAgY29uc3QgcmV0dXJuVmFsdWUgPSBbXG4gICAgICAgICAgICBQT1BVUF9DTEFTU19OQU1FLFxuICAgICAgICAgICAgJGFwcC5kYXRlUGlja2VyU3RhdGUuaXNEYXJrLnZhbHVlID8gJ2lzLWRhcmsnIDogJycsXG4gICAgICAgICAgICAkYXBwLmNvbmZpZy50ZWxlcG9ydFRvID8gJ2lzLXRlbGVwb3J0ZWQnIDogJycsXG4gICAgICAgIF07XG4gICAgICAgIGlmICgkYXBwLmNvbmZpZy5wbGFjZW1lbnQgJiYgISRhcHAuY29uZmlnLnRlbGVwb3J0VG8gJiYgd3JhcHBlckVsKSB7XG4gICAgICAgICAgICBjb25zdCBwbGFjZW1lbnQgPSAkYXBwLmNvbmZpZy5wbGFjZW1lbnQgaW5zdGFuY2VvZiBGdW5jdGlvblxuICAgICAgICAgICAgICAgID8gJGFwcC5jb25maWcucGxhY2VtZW50KHdyYXBwZXJFbClcbiAgICAgICAgICAgICAgICA6ICRhcHAuY29uZmlnLnBsYWNlbWVudDtcbiAgICAgICAgICAgIHJldHVyblZhbHVlLnB1c2gocGxhY2VtZW50KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmV0dXJuVmFsdWU7XG4gICAgfSwgW1xuICAgICAgICAkYXBwLmRhdGVQaWNrZXJTdGF0ZS5pc0RhcmsudmFsdWUsXG4gICAgICAgICRhcHAuY29uZmlnLnBsYWNlbWVudCxcbiAgICAgICAgJGFwcC5jb25maWcudGVsZXBvcnRUbyxcbiAgICBdKTtcbiAgICBjb25zdCBjbGlja091dHNpZGVMaXN0ZW5lciA9IChldmVudCkgPT4ge1xuICAgICAgICBjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXQ7XG4gICAgICAgIGlmICghdGFyZ2V0LmNsb3Nlc3QoYC4ke1BPUFVQX0NMQVNTX05BTUV9YCkpXG4gICAgICAgICAgICAkYXBwLmRhdGVQaWNrZXJTdGF0ZS5jbG9zZSgpO1xuICAgIH07XG4gICAgY29uc3QgZXNjYXBlS2V5TGlzdGVuZXIgPSAoZSkgPT4ge1xuICAgICAgICBpZiAoZS5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICAgICAgICBpZiAoJGFwcC5jb25maWcubGlzdGVuZXJzLm9uRXNjYXBlS2V5RG93bilcbiAgICAgICAgICAgICAgICAkYXBwLmNvbmZpZy5saXN0ZW5lcnMub25Fc2NhcGVLZXlEb3duKCRhcHApO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICRhcHAuZGF0ZVBpY2tlclN0YXRlLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xpY2tPdXRzaWRlTGlzdGVuZXIpO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZXNjYXBlS2V5TGlzdGVuZXIpO1xuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbGlja091dHNpZGVMaXN0ZW5lcik7XG4gICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZXNjYXBlS2V5TGlzdGVuZXIpO1xuICAgICAgICB9O1xuICAgIH0sIFtdKTtcbiAgICBjb25zdCByZW1TaXplID0gTnVtYmVyKGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KS5mb250U2l6ZS5zcGxpdCgncHgnKVswXSk7XG4gICAgY29uc3QgcG9wdXBIZWlnaHQgPSAzNjI7XG4gICAgY29uc3QgcG9wdXBXaWR0aCA9IDMzMjtcbiAgICBjb25zdCBnZXRGaXhlZFBvc2l0aW9uU3R5bGVzID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBpbnB1dFdyYXBwZXJFbCA9ICRhcHAuZGF0ZVBpY2tlclN0YXRlLmlucHV0V3JhcHBlckVsZW1lbnQudmFsdWU7XG4gICAgICAgIGNvbnN0IGlucHV0UmVjdCA9IGlucHV0V3JhcHBlckVsID09PSBudWxsIHx8IGlucHV0V3JhcHBlckVsID09PSB2b2lkIDAgPyB2b2lkIDAgOiBpbnB1dFdyYXBwZXJFbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgaWYgKGlucHV0V3JhcHBlckVsID09PSB1bmRlZmluZWQgfHwgIShpbnB1dFJlY3QgaW5zdGFuY2VvZiBET01SZWN0KSlcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIGNvbnN0IHJlc29sdmVkUGxhY2VtZW50ID0gdHlwZW9mICRhcHAuY29uZmlnLnBsYWNlbWVudCA9PT0gJ2Z1bmN0aW9uJ1xuICAgICAgICAgICAgPyB3cmFwcGVyRWxcbiAgICAgICAgICAgICAgICA/ICRhcHAuY29uZmlnLnBsYWNlbWVudCh3cmFwcGVyRWwpXG4gICAgICAgICAgICAgICAgOiAnYm90dG9tLWVuZCdcbiAgICAgICAgICAgIDogJGFwcC5jb25maWcucGxhY2VtZW50O1xuICAgICAgICBpZiAoIXJlc29sdmVkUGxhY2VtZW50KVxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHRvcDogcmVzb2x2ZWRQbGFjZW1lbnQuaW5jbHVkZXMoJ2JvdHRvbScpXG4gICAgICAgICAgICAgICAgPyBpbnB1dFJlY3QuaGVpZ2h0ICsgaW5wdXRSZWN0LnkgKyAxIC8vIDFweCBib3JkZXJcbiAgICAgICAgICAgICAgICA6IGlucHV0UmVjdC55IC0gcmVtU2l6ZSAtIHBvcHVwSGVpZ2h0LCAvLyBzdWJ0cmFjdCByZW1zaXplIHRvIGxlYXZlIHJvb20gZm9yIGxhYmVsIHRleHRcbiAgICAgICAgICAgIGxlZnQ6IHJlc29sdmVkUGxhY2VtZW50LmluY2x1ZGVzKCdzdGFydCcpXG4gICAgICAgICAgICAgICAgPyBpbnB1dFJlY3QueFxuICAgICAgICAgICAgICAgIDogaW5wdXRSZWN0LnggKyBpbnB1dFJlY3Qud2lkdGggLSBwb3B1cFdpZHRoLFxuICAgICAgICAgICAgd2lkdGg6IHBvcHVwV2lkdGgsXG4gICAgICAgICAgICBwb3NpdGlvbjogJ2ZpeGVkJyxcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIGNvbnN0IFtmaXhlZFBvc2l0aW9uU3R5bGUsIHNldEZpeGVkUG9zaXRpb25TdHlsZV0gPSB1c2VTdGF0ZShnZXRGaXhlZFBvc2l0aW9uU3R5bGVzKCkpO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGNvbnN0IGlucHV0V3JhcHBlciA9ICRhcHAuZGF0ZVBpY2tlclN0YXRlLmlucHV0V3JhcHBlckVsZW1lbnQudmFsdWU7XG4gICAgICAgIGlmIChpbnB1dFdyYXBwZXIgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgY29uc3Qgc2Nyb2xsYWJsZVBhcmVudHMgPSBnZXRTY3JvbGxhYmxlUGFyZW50cyhpbnB1dFdyYXBwZXIpO1xuICAgICAgICBjb25zdCBzY3JvbGxMaXN0ZW5lciA9ICgpID0+IHNldEZpeGVkUG9zaXRpb25TdHlsZShnZXRGaXhlZFBvc2l0aW9uU3R5bGVzKCkpO1xuICAgICAgICBzY3JvbGxhYmxlUGFyZW50cy5mb3JFYWNoKChwYXJlbnQpID0+IHBhcmVudC5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBzY3JvbGxMaXN0ZW5lcikpO1xuICAgICAgICByZXR1cm4gKCkgPT4gc2Nyb2xsYWJsZVBhcmVudHMuZm9yRWFjaCgocGFyZW50KSA9PiBwYXJlbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgc2Nyb2xsTGlzdGVuZXIpKTtcbiAgICB9LCBbXSk7XG4gICAgcmV0dXJuIChqc3goRnJhZ21lbnQsIHsgY2hpbGRyZW46IGpzeChcImRpdlwiLCB7IHN0eWxlOiAkYXBwLmNvbmZpZy50ZWxlcG9ydFRvID8gZml4ZWRQb3NpdGlvblN0eWxlIDogdW5kZWZpbmVkLCBcImRhdGEtdGVzdGlkXCI6IFwiZGF0ZS1waWNrZXItcG9wdXBcIiwgY2xhc3NOYW1lOiBjbGFzc0xpc3Quam9pbignICcpLCBjaGlsZHJlbjogZGF0ZVBpY2tlclZpZXcgPT09IERhdGVQaWNrZXJWaWV3Lk1PTlRIX0RBWVMgPyAoanN4KE1vbnRoVmlldywgeyBzZWF0WWVhcnNWaWV3OiAoKSA9PiBzZXREYXRlUGlja2VyVmlldyhEYXRlUGlja2VyVmlldy5ZRUFSUykgfSkpIDogKGpzeChZZWFyc1ZpZXcsIHsgc2V0TW9udGhWaWV3OiAoKSA9PiBzZXREYXRlUGlja2VyVmlldyhEYXRlUGlja2VyVmlldy5NT05USF9EQVlTKSB9KSkgfSkgfSkpO1xufVxuXG5mdW5jdGlvbiBBcHBXcmFwcGVyKHsgJGFwcCB9KSB7XG4gICAgY29uc3QgaW5pdGlhbENsYXNzTGlzdCA9IFsnc3hfX2RhdGUtcGlja2VyLXdyYXBwZXInXTtcbiAgICBjb25zdCBbY2xhc3NMaXN0LCBzZXRDbGFzc0xpc3RdID0gdXNlU3RhdGUoaW5pdGlhbENsYXNzTGlzdCk7XG4gICAgY29uc3QgZWxlbWVudFJlZiA9IHVzZVJlZihudWxsKTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAoZWxlbWVudFJlZiAmJiBlbGVtZW50UmVmLmN1cnJlbnQgaW5zdGFuY2VvZiBIVE1MRGl2RWxlbWVudClcbiAgICAgICAgICAgICRhcHAuZWxlbWVudHMgPSB7IERhdGVQaWNrZXJXcmFwcGVyOiBlbGVtZW50UmVmLmN1cnJlbnQgfTtcbiAgICB9LCBbXSk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICBjb25zdCBsaXN0ID0gWy4uLmluaXRpYWxDbGFzc0xpc3RdO1xuICAgICAgICBpZiAoJGFwcC5kYXRlUGlja2VyU3RhdGUuaXNEYXJrLnZhbHVlKVxuICAgICAgICAgICAgbGlzdC5wdXNoKCdpcy1kYXJrJyk7XG4gICAgICAgIGlmICgoX2EgPSAkYXBwLmNvbmZpZy5zdHlsZSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmZ1bGxXaWR0aClcbiAgICAgICAgICAgIGxpc3QucHVzaCgnaGFzLWZ1bGwtd2lkdGgnKTtcbiAgICAgICAgaWYgKCRhcHAuZGF0ZVBpY2tlclN0YXRlLmlzRGlzYWJsZWQudmFsdWUpXG4gICAgICAgICAgICBsaXN0LnB1c2goJ2lzLWRpc2FibGVkJyk7XG4gICAgICAgIHNldENsYXNzTGlzdChsaXN0KTtcbiAgICB9LCBbJGFwcC5kYXRlUGlja2VyU3RhdGUuaXNEYXJrLnZhbHVlLCAkYXBwLmRhdGVQaWNrZXJTdGF0ZS5pc0Rpc2FibGVkLnZhbHVlXSk7XG4gICAgbGV0IGFwcFBvcHVwSlNYID0ganN4KEFwcFBvcHVwLCB7IHdyYXBwZXJFbDogZWxlbWVudFJlZi5jdXJyZW50IH0pO1xuICAgIGlmICgkYXBwLmNvbmZpZy50ZWxlcG9ydFRvKVxuICAgICAgICBhcHBQb3B1cEpTWCA9IGNyZWF0ZVBvcnRhbChhcHBQb3B1cEpTWCwgJGFwcC5jb25maWcudGVsZXBvcnRUbyk7XG4gICAgcmV0dXJuIChqc3goRnJhZ21lbnQsIHsgY2hpbGRyZW46IGpzeChcImRpdlwiLCB7IHJlZjogZWxlbWVudFJlZiwgY2xhc3NOYW1lOiBjbGFzc0xpc3Quam9pbignICcpLCBjaGlsZHJlbjoganN4cyhBcHBDb250ZXh0JDEuUHJvdmlkZXIsIHsgdmFsdWU6ICRhcHAsIGNoaWxkcmVuOiBbanN4KEFwcElucHV0LCB7fSksICRhcHAuZGF0ZVBpY2tlclN0YXRlLmlzT3Blbi52YWx1ZSAmJiBhcHBQb3B1cEpTWF0gfSkgfSkgfSkpO1xufVxuXG5jb25zdCBBcHBDb250ZXh0ID0gY3JlYXRlQ29udGV4dCh7fSk7XG5cbmNsYXNzIERhdGVQaWNrZXJBcHBTaW5nbGV0b25JbXBsIHtcbiAgICBjb25zdHJ1Y3RvcihkYXRlUGlja2VyU3RhdGUsIGNvbmZpZywgdGltZVVuaXRzSW1wbCwgdHJhbnNsYXRlLCBlbGVtZW50cyA9IHt9KSB7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImRhdGVQaWNrZXJTdGF0ZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogZGF0ZVBpY2tlclN0YXRlXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJjb25maWdcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IGNvbmZpZ1xuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwidGltZVVuaXRzSW1wbFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdGltZVVuaXRzSW1wbFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwidHJhbnNsYXRlXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB0cmFuc2xhdGVcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImVsZW1lbnRzXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBlbGVtZW50c1xuICAgICAgICB9KTtcbiAgICB9XG59XG5cbmNsYXNzIERhdGVQaWNrZXJBcHBTaW5nbGV0b25CdWlsZGVyIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiZGF0ZVBpY2tlclN0YXRlXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImNvbmZpZ1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJ0aW1lVW5pdHNJbXBsXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInRyYW5zbGF0ZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBidWlsZCgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEYXRlUGlja2VyQXBwU2luZ2xldG9uSW1wbCh0aGlzLmRhdGVQaWNrZXJTdGF0ZSwgdGhpcy5jb25maWcsIHRoaXMudGltZVVuaXRzSW1wbCwgdGhpcy50cmFuc2xhdGUpO1xuICAgIH1cbiAgICB3aXRoRGF0ZVBpY2tlclN0YXRlKGRhdGVQaWNrZXJTdGF0ZSkge1xuICAgICAgICB0aGlzLmRhdGVQaWNrZXJTdGF0ZSA9IGRhdGVQaWNrZXJTdGF0ZTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHdpdGhDb25maWcoY29uZmlnKSB7XG4gICAgICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgd2l0aFRpbWVVbml0c0ltcGwodGltZVVuaXRzSW1wbCkge1xuICAgICAgICB0aGlzLnRpbWVVbml0c0ltcGwgPSB0aW1lVW5pdHNJbXBsO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgd2l0aFRyYW5zbGF0ZSh0cmFuc2xhdGUpIHtcbiAgICAgICAgdGhpcy50cmFuc2xhdGUgPSB0cmFuc2xhdGU7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbn1cblxuLy8gVGhpcyBlbnVtIGlzIHVzZWQgdG8gcmVwcmVzZW50IG5hbWVzIG9mIGFsbCBpbnRlcm5hbGx5IGJ1aWx0IHZpZXdzIG9mIHRoZSBjYWxlbmRhclxudmFyIEludGVybmFsVmlld05hbWU7XG4oZnVuY3Rpb24gKEludGVybmFsVmlld05hbWUpIHtcbiAgICBJbnRlcm5hbFZpZXdOYW1lW1wiRGF5XCJdID0gXCJkYXlcIjtcbiAgICBJbnRlcm5hbFZpZXdOYW1lW1wiV2Vla1wiXSA9IFwid2Vla1wiO1xuICAgIEludGVybmFsVmlld05hbWVbXCJNb250aEdyaWRcIl0gPSBcIm1vbnRoLWdyaWRcIjtcbiAgICBJbnRlcm5hbFZpZXdOYW1lW1wiTW9udGhBZ2VuZGFcIl0gPSBcIm1vbnRoLWFnZW5kYVwiO1xuICAgIEludGVybmFsVmlld05hbWVbXCJMaXN0XCJdID0gXCJsaXN0XCI7XG59KShJbnRlcm5hbFZpZXdOYW1lIHx8IChJbnRlcm5hbFZpZXdOYW1lID0ge30pKTtcblxuY29uc3QgZ2V0TG9jYWxlU3RyaW5nTW9udGhBcmdzID0gKCRhcHApID0+IHtcbiAgICByZXR1cm4gWyRhcHAuY29uZmlnLmxvY2FsZS52YWx1ZSwgeyBtb250aDogJ2xvbmcnIH1dO1xufTtcbmNvbnN0IGdldExvY2FsZVN0cmluZ1llYXJBcmdzID0gKCRhcHApID0+IHtcbiAgICByZXR1cm4gWyRhcHAuY29uZmlnLmxvY2FsZS52YWx1ZSwgeyB5ZWFyOiAnbnVtZXJpYycgfV07XG59O1xuY29uc3QgZ2V0TW9udGhBbmRZZWFyRm9yRGF0ZVJhbmdlID0gKCRhcHAsIHJhbmdlU3RhcnQsIHJhbmdlRW5kKSA9PiB7XG4gICAgY29uc3Qgc3RhcnREYXRlTW9udGggPSByYW5nZVN0YXJ0LnRvTG9jYWxlU3RyaW5nKC4uLmdldExvY2FsZVN0cmluZ01vbnRoQXJncygkYXBwKSk7XG4gICAgY29uc3Qgc3RhcnREYXRlWWVhciA9IHJhbmdlU3RhcnQudG9Mb2NhbGVTdHJpbmcoLi4uZ2V0TG9jYWxlU3RyaW5nWWVhckFyZ3MoJGFwcCkpO1xuICAgIGNvbnN0IGVuZERhdGVNb250aCA9IHJhbmdlRW5kLnRvTG9jYWxlU3RyaW5nKC4uLmdldExvY2FsZVN0cmluZ01vbnRoQXJncygkYXBwKSk7XG4gICAgY29uc3QgZW5kRGF0ZVllYXIgPSByYW5nZUVuZC50b0xvY2FsZVN0cmluZyguLi5nZXRMb2NhbGVTdHJpbmdZZWFyQXJncygkYXBwKSk7XG4gICAgaWYgKHN0YXJ0RGF0ZU1vbnRoID09PSBlbmREYXRlTW9udGggJiYgc3RhcnREYXRlWWVhciA9PT0gZW5kRGF0ZVllYXIpIHtcbiAgICAgICAgcmV0dXJuIGAke3N0YXJ0RGF0ZU1vbnRofSAke3N0YXJ0RGF0ZVllYXJ9YDtcbiAgICB9XG4gICAgZWxzZSBpZiAoc3RhcnREYXRlTW9udGggIT09IGVuZERhdGVNb250aCAmJiBzdGFydERhdGVZZWFyID09PSBlbmREYXRlWWVhcikge1xuICAgICAgICByZXR1cm4gYCR7c3RhcnREYXRlTW9udGh9IOKAkyAke2VuZERhdGVNb250aH0gJHtzdGFydERhdGVZZWFyfWA7XG4gICAgfVxuICAgIHJldHVybiBgJHtzdGFydERhdGVNb250aH0gJHtzdGFydERhdGVZZWFyfSDigJMgJHtlbmREYXRlTW9udGh9ICR7ZW5kRGF0ZVllYXJ9YDtcbn07XG5jb25zdCBnZXRNb250aEFuZFllYXJGb3JTZWxlY3RlZERhdGUgPSAoJGFwcCkgPT4ge1xuICAgIGNvbnN0IGRhdGVNb250aCA9ICRhcHAuZGF0ZVBpY2tlclN0YXRlLnNlbGVjdGVkRGF0ZS52YWx1ZS50b0xvY2FsZVN0cmluZyguLi5nZXRMb2NhbGVTdHJpbmdNb250aEFyZ3MoJGFwcCkpO1xuICAgIGNvbnN0IGRhdGVZZWFyID0gJGFwcC5kYXRlUGlja2VyU3RhdGUuc2VsZWN0ZWREYXRlLnZhbHVlLnRvTG9jYWxlU3RyaW5nKC4uLmdldExvY2FsZVN0cmluZ1llYXJBcmdzKCRhcHApKTtcbiAgICByZXR1cm4gYCR7ZGF0ZU1vbnRofSAke2RhdGVZZWFyfWA7XG59O1xuXG5mdW5jdGlvbiBSYW5nZUhlYWRpbmcoKSB7XG4gICAgY29uc3QgJGFwcCA9IHVzZUNvbnRleHQoQXBwQ29udGV4dCk7XG4gICAgY29uc3QgW2N1cnJlbnRIZWFkaW5nLCBzZXRDdXJyZW50SGVhZGluZ10gPSB1c2VTdGF0ZSgnJyk7XG4gICAgdXNlU2lnbmFsRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKCRhcHAuY2FsZW5kYXJTdGF0ZS52aWV3LnZhbHVlID09PSBJbnRlcm5hbFZpZXdOYW1lLldlZWspIHtcbiAgICAgICAgICAgIHNldEN1cnJlbnRIZWFkaW5nKGdldE1vbnRoQW5kWWVhckZvckRhdGVSYW5nZSgkYXBwLCAkYXBwLmNhbGVuZGFyU3RhdGUucmFuZ2UudmFsdWUuc3RhcnQsICRhcHAuY2FsZW5kYXJTdGF0ZS5yYW5nZS52YWx1ZS5lbmQpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoJGFwcC5jYWxlbmRhclN0YXRlLnZpZXcudmFsdWUgPT09IEludGVybmFsVmlld05hbWUuTW9udGhHcmlkIHx8XG4gICAgICAgICAgICAkYXBwLmNhbGVuZGFyU3RhdGUudmlldy52YWx1ZSA9PT0gSW50ZXJuYWxWaWV3TmFtZS5EYXkgfHxcbiAgICAgICAgICAgICRhcHAuY2FsZW5kYXJTdGF0ZS52aWV3LnZhbHVlID09PSBJbnRlcm5hbFZpZXdOYW1lLk1vbnRoQWdlbmRhKSB7XG4gICAgICAgICAgICBzZXRDdXJyZW50SGVhZGluZyhnZXRNb250aEFuZFllYXJGb3JTZWxlY3RlZERhdGUoJGFwcCkpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIGpzeChcInNwYW5cIiwgeyBjbGFzc05hbWU6ICdzeF9fcmFuZ2UtaGVhZGluZycsIGNoaWxkcmVuOiBjdXJyZW50SGVhZGluZyB9KTtcbn1cblxuZnVuY3Rpb24gVG9kYXlCdXR0b24oKSB7XG4gICAgY29uc3QgJGFwcCA9IHVzZUNvbnRleHQoQXBwQ29udGV4dCk7XG4gICAgY29uc3Qgc2V0VG9kYXkgPSAoKSA9PiB7XG4gICAgICAgICRhcHAuZGF0ZVBpY2tlclN0YXRlLnNlbGVjdGVkRGF0ZS52YWx1ZSA9IFRlbXBvcmFsLlBsYWluRGF0ZS5mcm9tKFRlbXBvcmFsLk5vdy5wbGFpbkRhdGVJU08oJGFwcC5jb25maWcudGltZXpvbmUudmFsdWUpKTtcbiAgICB9O1xuICAgIHJldHVybiAoanN4KFwiYnV0dG9uXCIsIHsgdHlwZTogXCJidXR0b25cIiwgY2xhc3NOYW1lOiAnc3hfX2J1dHRvbiBzeF9fdG9kYXktYnV0dG9uIHN4X19yaXBwbGUnLCBvbkNsaWNrOiBzZXRUb2RheSwgY2hpbGRyZW46ICRhcHAudHJhbnNsYXRlKCdUb2RheScpIH0pKTtcbn1cblxuZnVuY3Rpb24gVmlld1NlbGVjdGlvbigpIHtcbiAgICBjb25zdCAkYXBwID0gdXNlQ29udGV4dChBcHBDb250ZXh0KTtcbiAgICBjb25zdCB2aWV3U2VsZWN0SWQgPSByYW5kb21TdHJpbmdJZCgpO1xuICAgIGNvbnN0IHZpZXdMYWJlbElkID0gcmFuZG9tU3RyaW5nSWQoKTtcbiAgICBjb25zdCBbYXZhaWxhYmxlVmlld3MsIHNldEF2YWlsYWJsZVZpZXdzXSA9IHVzZVN0YXRlKFtdKTtcbiAgICB1c2VTaWduYWxFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAoJGFwcC5jYWxlbmRhclN0YXRlLmlzQ2FsZW5kYXJTbWFsbC52YWx1ZSkge1xuICAgICAgICAgICAgc2V0QXZhaWxhYmxlVmlld3MoJGFwcC5jb25maWcudmlld3MudmFsdWUuZmlsdGVyKCh2aWV3KSA9PiB2aWV3Lmhhc1NtYWxsU2NyZWVuQ29tcGF0KSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzZXRBdmFpbGFibGVWaWV3cygkYXBwLmNvbmZpZy52aWV3cy52YWx1ZS5maWx0ZXIoKHZpZXcpID0+IHZpZXcuaGFzV2lkZVNjcmVlbkNvbXBhdCkpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgLy8gR2V0IGluaXRpYWwgc2VsZWN0ZWQgdmlldyBsYWJlbCB0byBwcmV2ZW50IGxheW91dCBzaGlmdFxuICAgIGNvbnN0IGdldEluaXRpYWxTZWxlY3RlZFZpZXdMYWJlbCA9ICgpID0+IHtcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWRWaWV3ID0gJGFwcC5jb25maWcudmlld3MudmFsdWUuZmluZCgodmlldykgPT4gdmlldy5uYW1lID09PSAkYXBwLmNhbGVuZGFyU3RhdGUudmlldy52YWx1ZSk7XG4gICAgICAgIHJldHVybiBzZWxlY3RlZFZpZXcgPyAkYXBwLnRyYW5zbGF0ZShzZWxlY3RlZFZpZXcubGFiZWwpIDogJyc7XG4gICAgfTtcbiAgICBjb25zdCBbc2VsZWN0ZWRWaWV3TGFiZWwsIHNldFNlbGVjdGVkVmlld0xhYmVsXSA9IHVzZVN0YXRlKGdldEluaXRpYWxTZWxlY3RlZFZpZXdMYWJlbCgpKTtcbiAgICB1c2VTaWduYWxFZmZlY3QoKCkgPT4ge1xuICAgICAgICBjb25zdCBzZWxlY3RlZFZpZXcgPSAkYXBwLmNvbmZpZy52aWV3cy52YWx1ZS5maW5kKCh2aWV3KSA9PiB2aWV3Lm5hbWUgPT09ICRhcHAuY2FsZW5kYXJTdGF0ZS52aWV3LnZhbHVlKTtcbiAgICAgICAgaWYgKCFzZWxlY3RlZFZpZXcpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHNldFNlbGVjdGVkVmlld0xhYmVsKCRhcHAudHJhbnNsYXRlKHNlbGVjdGVkVmlldy5sYWJlbCkpO1xuICAgIH0pO1xuICAgIGNvbnN0IFtpc09wZW4sIHNldElzT3Blbl0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gICAgY29uc3QgY2xpY2tPdXRzaWRlTGlzdGVuZXIgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgY29uc3QgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xuICAgICAgICBpZiAodGFyZ2V0IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQgJiZcbiAgICAgICAgICAgICF0YXJnZXQuY2xvc2VzdCgnLnN4X192aWV3LXNlbGVjdGlvbicpKSB7XG4gICAgICAgICAgICBzZXRJc09wZW4oZmFsc2UpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsaWNrT3V0c2lkZUxpc3RlbmVyKTtcbiAgICAgICAgcmV0dXJuICgpID0+IGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xpY2tPdXRzaWRlTGlzdGVuZXIpO1xuICAgIH0sIFtdKTtcbiAgICBjb25zdCBoYW5kbGVDbGlja09uU2VsZWN0aW9uSXRlbSA9ICh2aWV3TmFtZSkgPT4ge1xuICAgICAgICBzZXRJc09wZW4oZmFsc2UpO1xuICAgICAgICAkYXBwLmNhbGVuZGFyU3RhdGUuc2V0Vmlldyh2aWV3TmFtZSwgJGFwcC5kYXRlUGlja2VyU3RhdGUuc2VsZWN0ZWREYXRlLnZhbHVlKTtcbiAgICB9O1xuICAgIGNvbnN0IFt2aWV3U2VsZWN0aW9uSXRlbXMsIHNldFZpZXdTZWxlY3Rpb25JdGVtc10gPSB1c2VTdGF0ZSgpO1xuICAgIGNvbnN0IFtmb2N1c2VkVmlld0luZGV4LCBzZXRGb2N1c2VkVmlld0luZGV4XSA9IHVzZVN0YXRlKDApO1xuICAgIGNvbnN0IGhhbmRsZVNlbGVjdGVkVmlld0tleURvd24gPSAoa2V5Ym9hcmRFdmVudCkgPT4ge1xuICAgICAgICBpZiAoaXNLZXlFbnRlck9yU3BhY2Uoa2V5Ym9hcmRFdmVudCkpIHtcbiAgICAgICAgICAgIHNldElzT3BlbighaXNPcGVuKTtcbiAgICAgICAgfVxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgIGNvbnN0IGFsbE9wdGlvbnMgPSAoX2EgPSAkYXBwLmVsZW1lbnRzLmNhbGVuZGFyV3JhcHBlcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zeF9fdmlldy1zZWxlY3Rpb24taXRlbScpO1xuICAgICAgICAgICAgaWYgKCFhbGxPcHRpb25zKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIHNldFZpZXdTZWxlY3Rpb25JdGVtcyhhbGxPcHRpb25zKTtcbiAgICAgICAgICAgIGNvbnN0IGZpcnN0T3B0aW9uID0gYWxsT3B0aW9uc1swXTtcbiAgICAgICAgICAgIGlmIChmaXJzdE9wdGlvbiBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgc2V0Rm9jdXNlZFZpZXdJbmRleCgwKTtcbiAgICAgICAgICAgICAgICBmaXJzdE9wdGlvbi5mb2N1cygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCA1MCk7XG4gICAgfTtcbiAgICBjb25zdCBuYXZpZ2F0ZVVwT3JEb3duID0gKGtleWJvYXJkRXZlbnQsIHZpZXdOYW1lKSA9PiB7XG4gICAgICAgIGlmICghdmlld1NlbGVjdGlvbkl0ZW1zKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBpZiAoa2V5Ym9hcmRFdmVudC5rZXkgPT09ICdBcnJvd0Rvd24nKSB7XG4gICAgICAgICAgICBjb25zdCBuZXh0T3B0aW9uID0gdmlld1NlbGVjdGlvbkl0ZW1zW2ZvY3VzZWRWaWV3SW5kZXggKyAxXTtcbiAgICAgICAgICAgIGlmIChuZXh0T3B0aW9uIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBzZXRGb2N1c2VkVmlld0luZGV4KGZvY3VzZWRWaWV3SW5kZXggKyAxKTtcbiAgICAgICAgICAgICAgICBuZXh0T3B0aW9uLmZvY3VzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoa2V5Ym9hcmRFdmVudC5rZXkgPT09ICdBcnJvd1VwJykge1xuICAgICAgICAgICAgY29uc3QgcHJldk9wdGlvbiA9IHZpZXdTZWxlY3Rpb25JdGVtc1tmb2N1c2VkVmlld0luZGV4IC0gMV07XG4gICAgICAgICAgICBpZiAocHJldk9wdGlvbiBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgc2V0Rm9jdXNlZFZpZXdJbmRleChmb2N1c2VkVmlld0luZGV4IC0gMSk7XG4gICAgICAgICAgICAgICAgcHJldk9wdGlvbi5mb2N1cygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGlzS2V5RW50ZXJPclNwYWNlKGtleWJvYXJkRXZlbnQpKSB7XG4gICAgICAgICAgICBoYW5kbGVDbGlja09uU2VsZWN0aW9uSXRlbSh2aWV3TmFtZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiAoanN4cyhcImRpdlwiLCB7IGNsYXNzTmFtZTogYHN4X192aWV3LXNlbGVjdGlvbiAke2lzT3BlbiA/ICdpcy1vcGVuJyA6ICcnfWAsIGNoaWxkcmVuOiBbanN4KFwibGFiZWxcIiwgeyBmb3I6IHZpZXdTZWxlY3RJZCwgaWQ6IHZpZXdMYWJlbElkLCBjbGFzc05hbWU6IFwic3hfX3ZpZXctc2VsZWN0aW9uLWxhYmVsXCIsIGNoaWxkcmVuOiAkYXBwLnRyYW5zbGF0ZSgnVmlldycpIH0pLCBqc3hzKFwiZGl2XCIsIHsgaWQ6IHZpZXdTZWxlY3RJZCwgdGFiSW5kZXg6IDAsIHJvbGU6IFwiYnV0dG9uXCIsIFwiYXJpYS1kZXNjcmliZWRieVwiOiB2aWV3TGFiZWxJZCwgXCJhcmlhLWxhYmVsXCI6ICRhcHAudHJhbnNsYXRlKCdTZWxlY3QgVmlldycpLCBjbGFzc05hbWU6IFwic3hfX3ZpZXctc2VsZWN0aW9uLXNlbGVjdGVkLWl0ZW0gc3hfX3JpcHBsZVwiLCBvbkNsaWNrOiAoKSA9PiBzZXRJc09wZW4oIWlzT3BlbiksIG9uS2V5RG93bjogaGFuZGxlU2VsZWN0ZWRWaWV3S2V5RG93biwgY2hpbGRyZW46IFtzZWxlY3RlZFZpZXdMYWJlbCwganN4KFwiaW1nXCIsIHsgY2xhc3NOYW1lOiBcInN4X192aWV3LXNlbGVjdGlvbi1jaGV2cm9uXCIsIHNyYzogaW1nLCBhbHQ6IFwiXCIgfSldIH0pLCBpc09wZW4gJiYgKGpzeChcInVsXCIsIHsgXCJkYXRhLXRlc3RpZFwiOiBcInZpZXctc2VsZWN0aW9uLWl0ZW1zXCIsIGNsYXNzTmFtZTogXCJzeF9fdmlldy1zZWxlY3Rpb24taXRlbXNcIiwgY2hpbGRyZW46IGF2YWlsYWJsZVZpZXdzLm1hcCgodmlldykgPT4gKGpzeChcImxpXCIsIHsgXCJhcmlhLWxhYmVsXCI6ICRhcHAudHJhbnNsYXRlKCdTZWxlY3QgVmlldycpICsgJyAnICsgJGFwcC50cmFuc2xhdGUodmlldy5sYWJlbCksIHRhYkluZGV4OiAtMSwgcm9sZTogXCJidXR0b25cIiwgb25LZXlEb3duOiAoa2V5Ym9hcmRFdmVudCkgPT4gbmF2aWdhdGVVcE9yRG93bihrZXlib2FyZEV2ZW50LCB2aWV3Lm5hbWUpLCBvbkNsaWNrOiAoKSA9PiBoYW5kbGVDbGlja09uU2VsZWN0aW9uSXRlbSh2aWV3Lm5hbWUpLCBjbGFzc05hbWU6ICdzeF9fdmlldy1zZWxlY3Rpb24taXRlbScgK1xuICAgICAgICAgICAgICAgICAgICAgICAgKHZpZXcubmFtZSA9PT0gJGFwcC5jYWxlbmRhclN0YXRlLnZpZXcudmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/ICcgaXMtc2VsZWN0ZWQnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAnJyksIGNoaWxkcmVuOiAkYXBwLnRyYW5zbGF0ZSh2aWV3LmxhYmVsKSB9KSkpIH0pKV0gfSkpO1xufVxuXG5mdW5jdGlvbiBGb3J3YXJkQmFja3dhcmROYXZpZ2F0aW9uKCkge1xuICAgIHZhciBfYTtcbiAgICBjb25zdCAkYXBwID0gdXNlQ29udGV4dChBcHBDb250ZXh0KTtcbiAgICBjb25zdCBuYXZpZ2F0ZSA9IChkaXJlY3Rpb24pID0+IHtcbiAgICAgICAgY29uc3QgY3VycmVudFZpZXcgPSAkYXBwLmNvbmZpZy52aWV3cy52YWx1ZS5maW5kKCh2aWV3KSA9PiB2aWV3Lm5hbWUgPT09ICRhcHAuY2FsZW5kYXJTdGF0ZS52aWV3LnZhbHVlKTtcbiAgICAgICAgaWYgKCFjdXJyZW50VmlldylcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgJGFwcC5kYXRlUGlja2VyU3RhdGUuc2VsZWN0ZWREYXRlLnZhbHVlID0gY3VycmVudFZpZXcuYmFja3dhcmRGb3J3YXJkRm4oJGFwcC5kYXRlUGlja2VyU3RhdGUuc2VsZWN0ZWREYXRlLnZhbHVlLCBkaXJlY3Rpb24gPT09ICdmb3J3YXJkcydcbiAgICAgICAgICAgID8gY3VycmVudFZpZXcuYmFja3dhcmRGb3J3YXJkVW5pdHNcbiAgICAgICAgICAgIDogLWN1cnJlbnRWaWV3LmJhY2t3YXJkRm9yd2FyZFVuaXRzKTtcbiAgICB9O1xuICAgIGNvbnN0IFtsb2NhbGl6ZWRSYW5nZSwgc2V0TG9jYWxpemVkUmFuZ2VdID0gdXNlU3RhdGUoJycpO1xuICAgIHVzZVNpZ25hbEVmZmVjdCgoKSA9PiB7XG4gICAgICAgIHNldExvY2FsaXplZFJhbmdlKGAke2dldExvY2FsaXplZERhdGUkMSgkYXBwLmNhbGVuZGFyU3RhdGUucmFuZ2UudmFsdWUuc3RhcnQsICRhcHAuY29uZmlnLmxvY2FsZS52YWx1ZSl9ICR7JGFwcC50cmFuc2xhdGUoJ3RvJyl9ICR7Z2V0TG9jYWxpemVkRGF0ZSQxKCRhcHAuY2FsZW5kYXJTdGF0ZS5yYW5nZS52YWx1ZS5lbmQsICRhcHAuY29uZmlnLmxvY2FsZS52YWx1ZSl9YCk7XG4gICAgfSk7XG4gICAgY29uc3QgW3JhbmdlRW5kTWludXNPbmVSYW5nZSwgc2V0UmFuZ2VFbmRNaW51c09uZVJhbmdlXSA9IHVzZVN0YXRlKG51bGwpO1xuICAgIGNvbnN0IFtyYW5nZVN0YXJ0UGx1c09uZVJhbmdlLCBzZXRSYW5nZVN0YXJ0UGx1c09uZVJhbmdlXSA9IHVzZVN0YXRlKG51bGwpO1xuICAgIHVzZVNpZ25hbEVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkVmlldyA9ICRhcHAuY29uZmlnLnZpZXdzLnZhbHVlLmZpbmQoKHZpZXcpID0+IHZpZXcubmFtZSA9PT0gJGFwcC5jYWxlbmRhclN0YXRlLnZpZXcudmFsdWUpO1xuICAgICAgICBpZiAoIXNlbGVjdGVkVmlldylcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgc2V0UmFuZ2VFbmRNaW51c09uZVJhbmdlKHNlbGVjdGVkVmlldy5zZXREYXRlUmFuZ2Uoe1xuICAgICAgICAgICAgcmFuZ2U6ICRhcHAuY2FsZW5kYXJTdGF0ZS5yYW5nZSxcbiAgICAgICAgICAgIGNhbGVuZGFyQ29uZmlnOiAkYXBwLmNvbmZpZyxcbiAgICAgICAgICAgIHRpbWVVbml0c0ltcGw6ICRhcHAudGltZVVuaXRzSW1wbCxcbiAgICAgICAgICAgIGRhdGU6ICgoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gc2VsZWN0ZWRWaWV3LmJhY2t3YXJkRm9yd2FyZEZuKCRhcHAuZGF0ZVBpY2tlclN0YXRlLnNlbGVjdGVkRGF0ZS52YWx1ZSwgLXNlbGVjdGVkVmlldy5iYWNrd2FyZEZvcndhcmRVbml0cyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdCBpbnN0YW5jZW9mIFRlbXBvcmFsLlpvbmVkRGF0ZVRpbWVcbiAgICAgICAgICAgICAgICAgICAgPyByZXN1bHQudG9QbGFpbkRhdGUoKVxuICAgICAgICAgICAgICAgICAgICA6IHJlc3VsdDtcbiAgICAgICAgICAgIH0pKCksXG4gICAgICAgIH0pLmVuZCk7XG4gICAgICAgIHNldFJhbmdlU3RhcnRQbHVzT25lUmFuZ2Uoc2VsZWN0ZWRWaWV3LnNldERhdGVSYW5nZSh7XG4gICAgICAgICAgICByYW5nZTogJGFwcC5jYWxlbmRhclN0YXRlLnJhbmdlLFxuICAgICAgICAgICAgY2FsZW5kYXJDb25maWc6ICRhcHAuY29uZmlnLFxuICAgICAgICAgICAgdGltZVVuaXRzSW1wbDogJGFwcC50aW1lVW5pdHNJbXBsLFxuICAgICAgICAgICAgZGF0ZTogKCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBzZWxlY3RlZFZpZXcuYmFja3dhcmRGb3J3YXJkRm4oJGFwcC5kYXRlUGlja2VyU3RhdGUuc2VsZWN0ZWREYXRlLnZhbHVlLCBzZWxlY3RlZFZpZXcuYmFja3dhcmRGb3J3YXJkVW5pdHMpO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQgaW5zdGFuY2VvZiBUZW1wb3JhbC5ab25lZERhdGVUaW1lXG4gICAgICAgICAgICAgICAgICAgID8gcmVzdWx0LnRvUGxhaW5EYXRlKClcbiAgICAgICAgICAgICAgICAgICAgOiByZXN1bHQ7XG4gICAgICAgICAgICB9KSgpLFxuICAgICAgICB9KS5zdGFydCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIChqc3goRnJhZ21lbnQsIHsgY2hpbGRyZW46IGpzeHMoXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic3hfX2ZvcndhcmQtYmFja3dhcmQtbmF2aWdhdGlvblwiLCBcImFyaWEtbGFiZWxcIjogbG9jYWxpemVkUmFuZ2UsIFwiYXJpYS1saXZlXCI6IFwicG9saXRlXCIsIGNoaWxkcmVuOiBbanN4KENoZXZyb24sIHsgZGlzYWJsZWQ6ICEhKCRhcHAuY29uZmlnLm1pbkRhdGUudmFsdWUgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVGcm9tRGF0ZVRpbWUoKF9hID0gcmFuZ2VFbmRNaW51c09uZVJhbmdlID09PSBudWxsIHx8IHJhbmdlRW5kTWludXNPbmVSYW5nZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogcmFuZ2VFbmRNaW51c09uZVJhbmdlLnRvU3RyaW5nKCkpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6ICcnKSA8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGFwcC5jb25maWcubWluRGF0ZS52YWx1ZS50b1N0cmluZygpKSwgb25DbGljazogKCkgPT4gbmF2aWdhdGUoJ2JhY2t3YXJkcycpLCBkaXJlY3Rpb246ICdwcmV2aW91cycsIGJ1dHRvblRleHQ6ICRhcHAudHJhbnNsYXRlKCdQcmV2aW91cyBwZXJpb2QnKSB9KSwganN4KENoZXZyb24sIHsgZGlzYWJsZWQ6ICEhKCRhcHAuY29uZmlnLm1heERhdGUudmFsdWUgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlU3RhcnRQbHVzT25lUmFuZ2UgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVGcm9tRGF0ZVRpbWUocmFuZ2VTdGFydFBsdXNPbmVSYW5nZS50b1N0cmluZygpKSA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGFwcC5jb25maWcubWF4RGF0ZS52YWx1ZS50b1N0cmluZygpKSwgb25DbGljazogKCkgPT4gbmF2aWdhdGUoJ2ZvcndhcmRzJyksIGRpcmVjdGlvbjogJ25leHQnLCBidXR0b25UZXh0OiAkYXBwLnRyYW5zbGF0ZSgnTmV4dCBwZXJpb2QnKSB9KV0gfSkgfSkpO1xufVxuXG4vKipcbiAqIEdldCBhbiBlbGVtZW50IGluIHRoZSBET00gYnkgdGhlaXIgY3VzdG9tIGNvbXBvbmVudCBpZFxuICogKi9cbmNvbnN0IGdldEVsZW1lbnRCeUNDSUQgPSAoY3VzdG9tQ29tcG9uZW50SWQpID0+IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLWNjaWQ9XCIke2N1c3RvbUNvbXBvbmVudElkfVwiXWApO1xuXG5jbGFzcyBQcmVhY3RWaWV3IHtcbiAgICBjb25zdHJ1Y3Rvcihjb25maWcpIHtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwicmFuZG9tSWRcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHJhbmRvbVN0cmluZ0lkKClcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm5hbWVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwibGFiZWxcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiQ29tcG9uZW50XCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInNldERhdGVSYW5nZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJoYXNTbWFsbFNjcmVlbkNvbXBhdFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJoYXNXaWRlU2NyZWVuQ29tcGF0XCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImJhY2t3YXJkRm9yd2FyZEZuXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImJhY2t3YXJkRm9yd2FyZFVuaXRzXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMubmFtZSA9IGNvbmZpZy5uYW1lO1xuICAgICAgICB0aGlzLmxhYmVsID0gY29uZmlnLmxhYmVsO1xuICAgICAgICB0aGlzLkNvbXBvbmVudCA9IGNvbmZpZy5Db21wb25lbnQ7XG4gICAgICAgIHRoaXMuc2V0RGF0ZVJhbmdlID0gY29uZmlnLnNldERhdGVSYW5nZTtcbiAgICAgICAgdGhpcy5oYXNTbWFsbFNjcmVlbkNvbXBhdCA9IGNvbmZpZy5oYXNTbWFsbFNjcmVlbkNvbXBhdDtcbiAgICAgICAgdGhpcy5oYXNXaWRlU2NyZWVuQ29tcGF0ID0gY29uZmlnLmhhc1dpZGVTY3JlZW5Db21wYXQ7XG4gICAgICAgIHRoaXMuYmFja3dhcmRGb3J3YXJkRm4gPSBjb25maWcuYmFja3dhcmRGb3J3YXJkRm47XG4gICAgICAgIHRoaXMuYmFja3dhcmRGb3J3YXJkVW5pdHMgPSBjb25maWcuYmFja3dhcmRGb3J3YXJkVW5pdHM7XG4gICAgfVxuICAgIHJlbmRlcihvbkVsZW1lbnQsICRhcHApIHtcbiAgICAgICAgcmVuZGVyKGNyZWF0ZUVsZW1lbnQodGhpcy5Db21wb25lbnQsIHsgJGFwcCwgaWQ6IHRoaXMucmFuZG9tSWQgfSksIG9uRWxlbWVudCk7XG4gICAgfVxuICAgIGRlc3Ryb3koKSB7XG4gICAgICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5yYW5kb21JZCk7XG4gICAgICAgIGlmIChlbCkge1xuICAgICAgICAgICAgZWwucmVtb3ZlKCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5jb25zdCBjcmVhdGVQcmVhY3RWaWV3ID0gKGNvbmZpZykgPT4ge1xuICAgIHJldHVybiBuZXcgUHJlYWN0Vmlldyhjb25maWcpO1xufTtcblxuY29uc3QgdGltZVBvaW50VG9QZXJjZW50YWdlID0gKHRpbWVQb2ludHNJbkRheSwgZGF5Qm91bmRhcmllcywgdGltZVBvaW50KSA9PiB7XG4gICAgaWYgKHRpbWVQb2ludCA8IGRheUJvdW5kYXJpZXMuc3RhcnQpIHtcbiAgICAgICAgY29uc3QgZmlyc3REYXlUaW1lUG9pbnRzID0gMjQwMCAtIGRheUJvdW5kYXJpZXMuc3RhcnQ7XG4gICAgICAgIHJldHVybiAoKHRpbWVQb2ludCArIGZpcnN0RGF5VGltZVBvaW50cykgLyB0aW1lUG9pbnRzSW5EYXkpICogMTAwO1xuICAgIH1cbiAgICByZXR1cm4gKCh0aW1lUG9pbnQgLSBkYXlCb3VuZGFyaWVzLnN0YXJ0KSAvIHRpbWVQb2ludHNJbkRheSkgKiAxMDA7XG59O1xuXG5jb25zdCBnZXRFdmVudEhlaWdodCA9IChzdGFydCwgZW5kLCBkYXlCb3VuZGFyaWVzLCBwb2ludHNQZXJEYXkpID0+IHtcbiAgICBpZiAoc3RhcnQgPT09IGVuZCkge1xuICAgICAgICByZXR1cm4gKHRpbWVQb2ludFRvUGVyY2VudGFnZShwb2ludHNQZXJEYXksIGRheUJvdW5kYXJpZXMsIHRpbWVQb2ludHNGcm9tU3RyaW5nKHRpbWVGcm9tRGF0ZVRpbWUoYWRkVGltZVBvaW50c1RvRGF0ZVRpbWUoZW5kLCA1MCkudG9TdHJpbmcoKSkpKSAtXG4gICAgICAgICAgICB0aW1lUG9pbnRUb1BlcmNlbnRhZ2UocG9pbnRzUGVyRGF5LCBkYXlCb3VuZGFyaWVzLCB0aW1lUG9pbnRzRnJvbVN0cmluZyh0aW1lRnJvbURhdGVUaW1lKHN0YXJ0LnRvU3RyaW5nKCkpKSkpO1xuICAgIH1cbiAgICByZXR1cm4gKHRpbWVQb2ludFRvUGVyY2VudGFnZShwb2ludHNQZXJEYXksIGRheUJvdW5kYXJpZXMsIHRpbWVQb2ludHNGcm9tU3RyaW5nKHRpbWVGcm9tRGF0ZVRpbWUoZW5kLnRvU3RyaW5nKCkpKSkgLVxuICAgICAgICB0aW1lUG9pbnRUb1BlcmNlbnRhZ2UocG9pbnRzUGVyRGF5LCBkYXlCb3VuZGFyaWVzLCB0aW1lUG9pbnRzRnJvbVN0cmluZyh0aW1lRnJvbURhdGVUaW1lKHN0YXJ0LnRvU3RyaW5nKCkpKSkpO1xufTtcbmNvbnN0IGdldElubGluZVN0YXJ0UnVsZSA9IChjYWxlbmRhckV2ZW50LCBldmVudFdpZHRoKSA9PiB7XG4gICAgaWYgKCFjYWxlbmRhckV2ZW50Ll90b3RhbENvbmN1cnJlbnRFdmVudHMgfHxcbiAgICAgICAgIWNhbGVuZGFyRXZlbnQuX3ByZXZpb3VzQ29uY3VycmVudEV2ZW50cylcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgcmV0dXJuICgoKGNhbGVuZGFyRXZlbnQuX3ByZXZpb3VzQ29uY3VycmVudEV2ZW50cyB8fCAwKSAvXG4gICAgICAgIChjYWxlbmRhckV2ZW50Ll90b3RhbENvbmN1cnJlbnRFdmVudHMgfHwgMCkpICpcbiAgICAgICAgZXZlbnRXaWR0aCk7XG59O1xuY29uc3QgZ2V0V2lkdGhSdWxlID0gKGxlZnRSdWxlLCBldmVudFdpZHRoLCBtYXhDb25jdXJyZW50RXZlbnRzLCBldmVudE92ZXJsYXApID0+IHtcbiAgICBpZiAoZXZlbnRPdmVybGFwIHx8ICFtYXhDb25jdXJyZW50RXZlbnRzKVxuICAgICAgICByZXR1cm4gZXZlbnRXaWR0aCAtIGxlZnRSdWxlO1xuICAgIHJldHVybiBldmVudFdpZHRoIC8gbWF4Q29uY3VycmVudEV2ZW50cztcbn07XG5jb25zdCBnZXRCb3JkZXJSdWxlID0gKGNhbGVuZGFyRXZlbnQpID0+IHtcbiAgICBpZiAoIWNhbGVuZGFyRXZlbnQuX3ByZXZpb3VzQ29uY3VycmVudEV2ZW50cylcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgcmV0dXJuICcxcHggc29saWQgI2ZmZic7XG59O1xuXG5jb25zdCBnZXRUaW1lR3JpZEV2ZW50Q29weUVsZW1lbnRJZCA9IChpZCkgPT4ge1xuICAgIHJldHVybiAndGltZS1ncmlkLWV2ZW50LWNvcHktJyArIGlkO1xufTtcblxuY29uc3QgaXNVSUV2ZW50VG91Y2hFdmVudCA9IChldmVudCkgPT4ge1xuICAgIHJldHVybiAndG91Y2hlcycgaW4gZXZlbnQgJiYgdHlwZW9mIGV2ZW50LnRvdWNoZXMgPT09ICdvYmplY3QnO1xufTtcblxuZnVuY3Rpb24gdXNlRXZlbnRJbnRlcmFjdGlvbnMoJGFwcCkge1xuICAgIGNvbnN0IFtldmVudENvcHksIHNldEV2ZW50Q29weV0gPSB1c2VTdGF0ZSgpO1xuICAgIGNvbnN0IHVwZGF0ZUNvcHkgPSAobmV3Q29weSkgPT4ge1xuICAgICAgICBpZiAoIW5ld0NvcHkpXG4gICAgICAgICAgICByZXR1cm4gc2V0RXZlbnRDb3B5KHVuZGVmaW5lZCk7XG4gICAgICAgIHNldEV2ZW50Q29weShkZWVwQ2xvbmVFdmVudChuZXdDb3B5LCAkYXBwKSk7XG4gICAgfTtcbiAgICBjb25zdCBbZHJhZ1N0YXJ0VGltZW91dCwgc2V0RHJhZ1N0YXJ0VGltZW91dF0gPSB1c2VTdGF0ZSgpO1xuICAgIGNvbnN0IGNyZWF0ZURyYWdTdGFydFRpbWVvdXQgPSAoY2FsbGJhY2ssIHVpRXZlbnQpID0+IHtcbiAgICAgICAgc2V0RHJhZ1N0YXJ0VGltZW91dChzZXRUaW1lb3V0KCgpID0+IGNhbGxiYWNrKHVpRXZlbnQpLCAxNTApKTtcbiAgICB9O1xuICAgIGNvbnN0IHNldENsaWNrZWRFdmVudCA9ICh1aUV2ZW50LCBjYWxlbmRhckV2ZW50KSA9PiB7XG4gICAgICAgIC8vIEZvciBzb21lIHJlYXNvbiwgYW4gZXZlbnQgd2l0aG91dCB0b3VjaGVzIGlzIGJlaW5nIHRyaWdnZXJlZCBvbiB0b3VjaGVuZFxuICAgICAgICBpZiAoaXNVSUV2ZW50VG91Y2hFdmVudCh1aUV2ZW50KSAmJlxuICAgICAgICAgICAgdWlFdmVudC50b3VjaGVzLmxlbmd0aCA9PT0gMClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgaWYgKCEkYXBwLmNvbmZpZy5wbHVnaW5zLmV2ZW50TW9kYWwpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGNvbnN0IGV2ZW50VGFyZ2V0ID0gdWlFdmVudC50YXJnZXQ7XG4gICAgICAgIGlmICghKGV2ZW50VGFyZ2V0IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBjb25zdCBjYWxlbmRhckV2ZW50RWxlbWVudCA9IGV2ZW50VGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnc3hfX2V2ZW50JylcbiAgICAgICAgICAgID8gZXZlbnRUYXJnZXRcbiAgICAgICAgICAgIDogZXZlbnRUYXJnZXQuY2xvc2VzdCgnLnN4X19ldmVudCcpO1xuICAgICAgICBpZiAoY2FsZW5kYXJFdmVudEVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xuICAgICAgICAgICAgJGFwcC5jb25maWcucGx1Z2lucy5ldmVudE1vZGFsLmNhbGVuZGFyRXZlbnRFbGVtZW50LnZhbHVlID1cbiAgICAgICAgICAgICAgICBjYWxlbmRhckV2ZW50RWxlbWVudDtcbiAgICAgICAgICAgICRhcHAuY29uZmlnLnBsdWdpbnMuZXZlbnRNb2RhbC5zZXRDYWxlbmRhckV2ZW50KGNhbGVuZGFyRXZlbnQsIGNhbGVuZGFyRXZlbnRFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3Qgc2V0Q2xpY2tlZEV2ZW50SWZOb3REcmFnZ2luZyA9IChjYWxlbmRhckV2ZW50LCB1aUV2ZW50KSA9PiB7XG4gICAgICAgIGlmIChkcmFnU3RhcnRUaW1lb3V0KSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQoZHJhZ1N0YXJ0VGltZW91dCk7XG4gICAgICAgICAgICBzZXRDbGlja2VkRXZlbnQodWlFdmVudCwgY2FsZW5kYXJFdmVudCk7XG4gICAgICAgIH1cbiAgICAgICAgc2V0RHJhZ1N0YXJ0VGltZW91dCh1bmRlZmluZWQpO1xuICAgIH07XG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZlbnRDb3B5LFxuICAgICAgICB1cGRhdGVDb3B5LFxuICAgICAgICBjcmVhdGVEcmFnU3RhcnRUaW1lb3V0LFxuICAgICAgICBzZXRDbGlja2VkRXZlbnRJZk5vdERyYWdnaW5nLFxuICAgICAgICBzZXRDbGlja2VkRXZlbnQsXG4gICAgfTtcbn1cblxuY29uc3QgZ2V0Q0NJRCA9IChjdXN0b21Db21wb25lbnQsIGlzQ29weSkgPT4ge1xuICAgIGxldCBjdXN0b21Db21wb25lbnRJZCA9IGN1c3RvbUNvbXBvbmVudFxuICAgICAgICA/ICdjdXN0b20tdGltZS1ncmlkLWV2ZW50LScgKyByYW5kb21TdHJpbmdJZCgpIC8vIG5lZWRzIGEgdW5pcXVlIHN0cmluZyB0byBzdXBwb3J0IGV2ZW50IHJlY3VycmVuY2VcbiAgICAgICAgOiB1bmRlZmluZWQ7XG4gICAgaWYgKGN1c3RvbUNvbXBvbmVudElkICYmIGlzQ29weSlcbiAgICAgICAgY3VzdG9tQ29tcG9uZW50SWQgKz0gJy0nICsgJ2NvcHknO1xuICAgIHJldHVybiBjdXN0b21Db21wb25lbnRJZDtcbn07XG5cbmNvbnN0IGludm9rZU9uRXZlbnRDbGlja0NhbGxiYWNrID0gKCRhcHAsIGNhbGVuZGFyRXZlbnQsIGUpID0+IHtcbiAgICBpZiAoJGFwcC5jb25maWcuY2FsbGJhY2tzLm9uRXZlbnRDbGljaykge1xuICAgICAgICAkYXBwLmNvbmZpZy5jYWxsYmFja3Mub25FdmVudENsaWNrKGNhbGVuZGFyRXZlbnQuX2dldEV4dGVybmFsRXZlbnQoKSwgZSk7XG4gICAgfVxufTtcblxuY29uc3QgaW52b2tlT25FdmVudERvdWJsZUNsaWNrQ2FsbGJhY2sgPSAoJGFwcCwgY2FsZW5kYXJFdmVudCwgZSkgPT4ge1xuICAgIGlmICgkYXBwLmNvbmZpZy5jYWxsYmFja3Mub25Eb3VibGVDbGlja0V2ZW50KSB7XG4gICAgICAgICRhcHAuY29uZmlnLmNhbGxiYWNrcy5vbkRvdWJsZUNsaWNrRXZlbnQoY2FsZW5kYXJFdmVudC5fZ2V0RXh0ZXJuYWxFdmVudCgpLCBlKTtcbiAgICB9XG59O1xuXG5jb25zdCBnZXRFdmVudENvb3JkaW5hdGVzID0gKHVpRXZlbnQpID0+IHtcbiAgICBjb25zdCBhY3R1YWxFdmVudCA9IGlzVUlFdmVudFRvdWNoRXZlbnQodWlFdmVudClcbiAgICAgICAgPyB1aUV2ZW50LnRvdWNoZXNbMF1cbiAgICAgICAgOiB1aUV2ZW50O1xuICAgIHJldHVybiB7XG4gICAgICAgIGNsaWVudFg6IGFjdHVhbEV2ZW50LmNsaWVudFgsXG4gICAgICAgIGNsaWVudFk6IGFjdHVhbEV2ZW50LmNsaWVudFksXG4gICAgfTtcbn07XG5cbmNvbnN0IGdldFlDb29yZGluYXRlSW5UaW1lR3JpZCA9IChkYXRlVGltZSwgZGF5Qm91bmRhcmllcywgcG9pbnRzUGVyRGF5KSA9PiB7XG4gICAgcmV0dXJuIHRpbWVQb2ludFRvUGVyY2VudGFnZShwb2ludHNQZXJEYXksIGRheUJvdW5kYXJpZXMsIHRpbWVQb2ludHNGcm9tU3RyaW5nKHRpbWVGcm9tRGF0ZVRpbWUoZGF0ZVRpbWUudG9TdHJpbmcoKSkpKTtcbn07XG5cbi8qKlxuICogUHVzaCBhIHRhc2sgdG8gdGhlIGVuZCBvZiB0aGUgY3VycmVudCBjYWxsIHN0YWNrXG4gKiAqL1xuY29uc3QgbmV4dFRpY2sgPSAoY2IpID0+IHtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgY2IoKTtcbiAgICB9KTtcbn07XG5cbmNvbnN0IGZvY3VzTW9kYWwgPSAoJGFwcCkgPT4ge1xuICAgIGNvbnN0IGNhbGVuZGFyV3JhcHBlciA9ICRhcHAuZWxlbWVudHMuY2FsZW5kYXJXcmFwcGVyO1xuICAgIGlmICghKGNhbGVuZGFyV3JhcHBlciBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSlcbiAgICAgICAgcmV0dXJuO1xuICAgIGNvbnN0IGV2ZW50TW9kYWwgPSBjYWxlbmRhcldyYXBwZXIucXVlcnlTZWxlY3RvcignLnN4X19ldmVudC1tb2RhbCcpO1xuICAgIGlmICghKGV2ZW50TW9kYWwgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkpXG4gICAgICAgIHJldHVybjtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgZXZlbnRNb2RhbC5mb2N1cygpO1xuICAgIH0sIDEwMCk7XG59O1xuXG5jb25zdCB3YXNFdmVudEFkZGVkSW5MYXN0U2Vjb25kID0gKGNhbGVuZGFyRXZlbnQpID0+IHtcbiAgICByZXR1cm4gKGNhbGVuZGFyRXZlbnQuX2NyZWF0ZWRBdCAmJlxuICAgICAgICBEYXRlLm5vdygpIC0gY2FsZW5kYXJFdmVudC5fY3JlYXRlZEF0LmdldFRpbWUoKSA8IDEwMDApO1xufTtcblxuZnVuY3Rpb24gVGltZUdyaWRFdmVudCh7IGNhbGVuZGFyRXZlbnQsIGRheUJvdW5kYXJpZXNEYXRlVGltZSwgaXNDb3B5LCBzZXRNb3VzZURvd24sIH0pIHtcbiAgICB2YXIgX2EsIF9iLCBfYywgX2Q7XG4gICAgY29uc3QgJGFwcCA9IHVzZUNvbnRleHQoQXBwQ29udGV4dCk7XG4gICAgY29uc3QgZXZlbnRSZWYgPSB1c2VSZWYkMShudWxsKTtcbiAgICBjb25zdCBbaXNDb21wYWN0LCBzZXRJc0NvbXBhY3RdID0gdXNlU3RhdGUoZmFsc2UpO1xuICAgIGNvbnN0IHsgZXZlbnRDb3B5LCB1cGRhdGVDb3B5LCBjcmVhdGVEcmFnU3RhcnRUaW1lb3V0LCBzZXRDbGlja2VkRXZlbnRJZk5vdERyYWdnaW5nLCBzZXRDbGlja2VkRXZlbnQsIH0gPSB1c2VFdmVudEludGVyYWN0aW9ucygkYXBwKTtcbiAgICBjb25zdCBsb2NhbGl6ZUFyZ3MgPSBbXG4gICAgICAgICRhcHAuY29uZmlnLmxvY2FsZS52YWx1ZSxcbiAgICAgICAgeyBob3VyOiAnbnVtZXJpYycsIG1pbnV0ZTogJ251bWVyaWMnIH0sXG4gICAgXTtcbiAgICBjb25zdCBnZXRFdmVudFRpbWUgPSAoc3RhcnQsIGVuZCkgPT4ge1xuICAgICAgICBjb25zdCBsb2NhbGl6ZWRTdGFydFRpbWUgPSBzdGFydC50b0xvY2FsZVN0cmluZyguLi5sb2NhbGl6ZUFyZ3MpO1xuICAgICAgICBpZiAoc3RhcnQgPT09IGVuZCkge1xuICAgICAgICAgICAgcmV0dXJuIGxvY2FsaXplZFN0YXJ0VGltZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBsb2NhbGl6ZWRFbmRUaW1lID0gZW5kLnRvTG9jYWxlU3RyaW5nKC4uLmxvY2FsaXplQXJncyk7XG4gICAgICAgIHJldHVybiBgJHtsb2NhbGl6ZWRTdGFydFRpbWV9IOKAkyAke2xvY2FsaXplZEVuZFRpbWV9YDtcbiAgICB9O1xuICAgIGNvbnN0IGV2ZW50Q1NTVmFyaWFibGVzID0ge1xuICAgICAgICBib3JkZXJJbmxpbmVTdGFydDogYDRweCBzb2xpZCB2YXIoLS1zeC1jb2xvci0ke2NhbGVuZGFyRXZlbnQuX2NvbG9yfSlgLFxuICAgICAgICB0ZXh0Q29sb3I6IGB2YXIoLS1zeC1jb2xvci1vbi0ke2NhbGVuZGFyRXZlbnQuX2NvbG9yfS1jb250YWluZXIpYCxcbiAgICAgICAgYmFja2dyb3VuZENvbG9yOiBgdmFyKC0tc3gtY29sb3ItJHtjYWxlbmRhckV2ZW50Ll9jb2xvcn0tY29udGFpbmVyKWAsXG4gICAgICAgIGljb25TdHJva2U6IGB2YXIoLS1zeC1jb2xvci1vbi0ke2NhbGVuZGFyRXZlbnQuX2NvbG9yfS1jb250YWluZXIpYCxcbiAgICB9O1xuICAgIGNvbnN0IGluc2V0SW5saW5lU3RhcnQgPSBnZXRJbmxpbmVTdGFydFJ1bGUoY2FsZW5kYXJFdmVudCwgJGFwcC5jb25maWcud2Vla09wdGlvbnMudmFsdWUuZXZlbnRXaWR0aCk7XG4gICAgY29uc3QgaGFuZGxlU3RhcnREcmFnID0gKHVpRXZlbnQpID0+IHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICBpZiAoaXNVSUV2ZW50VG91Y2hFdmVudCh1aUV2ZW50KSlcbiAgICAgICAgICAgIHVpRXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgaWYgKGlzQ29weSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgaWYgKCF1aUV2ZW50LnRhcmdldClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgaWYgKCEkYXBwLmNvbmZpZy5wbHVnaW5zLmRyYWdBbmREcm9wKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBpZiAoKF9hID0gY2FsZW5kYXJFdmVudC5fb3B0aW9ucykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmRpc2FibGVETkQpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGlmIChyZWFsU3RhcnRJc0JlZm9yZURheUJvdW5kYXJ5U3RhcnQpXG4gICAgICAgICAgICByZXR1cm47IC8vIERvbid0IGFsbG93IGRyYWdnaW5nIGV2ZW50cyB0aGF0IHN0YXJ0IGJlZm9yZSB0aGUgZGF5IGJvdW5kYXJ5OyBpdCB3b3VsZCByZXF1aXJlIGEgYnVuY2ggb2YgYWRqdXN0bWVudHMgaW4gZHJhZyAmIGRyb3AgcGx1Z2luIGluIG9yZGVyIHRvIGxvb2sgbmljZVxuICAgICAgICBjb25zdCBuZXdFdmVudENvcHkgPSBkZWVwQ2xvbmVFdmVudChjYWxlbmRhckV2ZW50LCAkYXBwKTtcbiAgICAgICAgdXBkYXRlQ29weShuZXdFdmVudENvcHkpO1xuICAgICAgICAkYXBwLmNvbmZpZy5wbHVnaW5zLmRyYWdBbmREcm9wLmNyZWF0ZVRpbWVHcmlkRHJhZ0hhbmRsZXIoe1xuICAgICAgICAgICAgJGFwcCxcbiAgICAgICAgICAgIGV2ZW50Q29vcmRpbmF0ZXM6IGdldEV2ZW50Q29vcmRpbmF0ZXModWlFdmVudCksXG4gICAgICAgICAgICB1cGRhdGVDb3B5LFxuICAgICAgICAgICAgZXZlbnRDb3B5OiBuZXdFdmVudENvcHksXG4gICAgICAgIH0sIGRheUJvdW5kYXJpZXNEYXRlVGltZSk7XG4gICAgfTtcbiAgICBjb25zdCBjdXN0b21Db21wb25lbnQgPSAkYXBwLmNvbmZpZy5fY3VzdG9tQ29tcG9uZW50Rm5zLnRpbWVHcmlkRXZlbnQ7XG4gICAgY29uc3QgY3VzdG9tQ29tcG9uZW50SWQgPSB1c2VSZWYkMShnZXRDQ0lEKGN1c3RvbUNvbXBvbmVudCwgaXNDb3B5KSk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKCFjdXN0b21Db21wb25lbnQpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGN1c3RvbUNvbXBvbmVudChnZXRFbGVtZW50QnlDQ0lEKGN1c3RvbUNvbXBvbmVudElkLmN1cnJlbnQpLCB7XG4gICAgICAgICAgICBjYWxlbmRhckV2ZW50OiBjYWxlbmRhckV2ZW50Ll9nZXRFeHRlcm5hbEV2ZW50KCksXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgICAgIChfYiA9IChfYSA9ICRhcHAuY29uZmlnKS5fZGVzdHJveUN1c3RvbUNvbXBvbmVudEluc3RhbmNlKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuY2FsbChfYSwgY3VzdG9tQ29tcG9uZW50SWQuY3VycmVudCk7XG4gICAgICAgIH07XG4gICAgfSwgW2NhbGVuZGFyRXZlbnQsIGV2ZW50Q29weV0pO1xuICAgIC8vIFJlc2l6ZU9ic2VydmVyIHRvIGRldGVjdCB3aGVuIGV2ZW50IGhlaWdodCBjaGFuZ2VzXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKCFldmVudFJlZi5jdXJyZW50KVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBjb25zdCBjaGVja0hlaWdodCA9ICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSBldmVudFJlZi5jdXJyZW50O1xuICAgICAgICAgICAgaWYgKCFlbGVtZW50KVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIGNvbnN0IGhlaWdodCA9IGVsZW1lbnQub2Zmc2V0SGVpZ2h0O1xuICAgICAgICAgICAgY29uc3Qgc2hvdWxkQmVDb21wYWN0ID0gaGVpZ2h0IDwgMzY7XG4gICAgICAgICAgICBzZXRJc0NvbXBhY3Qoc2hvdWxkQmVDb21wYWN0KTtcbiAgICAgICAgfTtcbiAgICAgICAgY2hlY2tIZWlnaHQoKTtcbiAgICAgICAgY29uc3QgcmVzaXplT2JzZXJ2ZXIgPSBuZXcgUmVzaXplT2JzZXJ2ZXIoY2hlY2tIZWlnaHQpO1xuICAgICAgICByZXNpemVPYnNlcnZlci5vYnNlcnZlKGV2ZW50UmVmLmN1cnJlbnQpO1xuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgcmVzaXplT2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICAgICAgICB9O1xuICAgIH0sIFtjYWxlbmRhckV2ZW50LCBldmVudENvcHldKTtcbiAgICBjb25zdCBoYW5kbGVPbkNsaWNrID0gKGUpID0+IHtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgaW52b2tlT25FdmVudENsaWNrQ2FsbGJhY2soJGFwcCwgY2FsZW5kYXJFdmVudCwgZSk7XG4gICAgfTtcbiAgICBjb25zdCBoYW5kbGVPbkRvdWJsZUNsaWNrID0gKGUpID0+IHtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgaW52b2tlT25FdmVudERvdWJsZUNsaWNrQ2FsbGJhY2soJGFwcCwgY2FsZW5kYXJFdmVudCwgZSk7XG4gICAgfTtcbiAgICBjb25zdCBoYW5kbGVLZXlEb3duID0gKGUpID0+IHtcbiAgICAgICAgaWYgKGUua2V5ID09PSAnRW50ZXInIHx8IGUua2V5ID09PSAnICcpIHtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICBzZXRDbGlja2VkRXZlbnQoZSwgY2FsZW5kYXJFdmVudCk7XG4gICAgICAgICAgICBpbnZva2VPbkV2ZW50Q2xpY2tDYWxsYmFjaygkYXBwLCBjYWxlbmRhckV2ZW50LCBlKTtcbiAgICAgICAgICAgIG5leHRUaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICBmb2N1c01vZGFsKCRhcHApO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IHN0YXJ0UmVzaXplID0gKGUpID0+IHtcbiAgICAgICAgc2V0TW91c2VEb3duKHRydWUpO1xuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBpZiAoaXNDb3B5KVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBpZiAoJGFwcC5jb25maWcucGx1Z2lucy5yZXNpemUpIHtcbiAgICAgICAgICAgIGNvbnN0IGV2ZW50Q29weSA9IGRlZXBDbG9uZUV2ZW50KGNhbGVuZGFyRXZlbnQsICRhcHApO1xuICAgICAgICAgICAgdXBkYXRlQ29weShldmVudENvcHkpO1xuICAgICAgICAgICAgJGFwcC5jb25maWcucGx1Z2lucy5yZXNpemUuY3JlYXRlVGltZUdyaWRFdmVudFJlc2l6ZXIoZXZlbnRDb3B5LCB1cGRhdGVDb3B5LCBlLCBkYXlCb3VuZGFyaWVzRGF0ZVRpbWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBib3JkZXJSdWxlID0gZ2V0Qm9yZGVyUnVsZShjYWxlbmRhckV2ZW50KTtcbiAgICBjb25zdCBjbGFzc05hbWVzID0gWydzeF9fdGltZS1ncmlkLWV2ZW50JywgJ3N4X19ldmVudCddO1xuICAgIGlmICh3YXNFdmVudEFkZGVkSW5MYXN0U2Vjb25kKGNhbGVuZGFyRXZlbnQpKVxuICAgICAgICBjbGFzc05hbWVzLnB1c2goJ2lzLWV2ZW50LW5ldycpO1xuICAgIGlmIChpc0NvcHkpXG4gICAgICAgIGNsYXNzTmFtZXMucHVzaCgnaXMtZXZlbnQtY29weScpO1xuICAgIGlmICghJGFwcC5jb25maWcud2Vla09wdGlvbnMudmFsdWUuZXZlbnRPdmVybGFwICYmXG4gICAgICAgIGNhbGVuZGFyRXZlbnQuX21heENvbmN1cnJlbnRFdmVudHMgJiZcbiAgICAgICAgY2FsZW5kYXJFdmVudC5fbWF4Q29uY3VycmVudEV2ZW50cyA+IDEpXG4gICAgICAgIGNsYXNzTmFtZXMucHVzaCgnaXMtZXZlbnQtb3ZlcmxhcCcpO1xuICAgIGlmICgoX2EgPSBjYWxlbmRhckV2ZW50Ll9vcHRpb25zKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuYWRkaXRpb25hbENsYXNzZXMpXG4gICAgICAgIGNsYXNzTmFtZXMucHVzaCguLi5jYWxlbmRhckV2ZW50Ll9vcHRpb25zLmFkZGl0aW9uYWxDbGFzc2VzKTtcbiAgICBjb25zdCBoYW5kbGVQb2ludGVyRG93biA9IChlKSA9PiB7XG4gICAgICAgIHNldE1vdXNlRG93bih0cnVlKTtcbiAgICAgICAgY3JlYXRlRHJhZ1N0YXJ0VGltZW91dChoYW5kbGVTdGFydERyYWcsIGUpO1xuICAgIH07XG4gICAgY29uc3QgaGFuZGxlUG9pbnRlclVwID0gKGUpID0+IHtcbiAgICAgICAgbmV4dFRpY2soKCkgPT4gc2V0TW91c2VEb3duKGZhbHNlKSk7XG4gICAgICAgIHNldENsaWNrZWRFdmVudElmTm90RHJhZ2dpbmcoY2FsZW5kYXJFdmVudCwgZSk7XG4gICAgfTtcbiAgICBjb25zdCBoYXNDdXN0b21Db250ZW50ID0gKF9iID0gY2FsZW5kYXJFdmVudC5fY3VzdG9tQ29udGVudCkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLnRpbWVHcmlkO1xuICAgIGNvbnN0IHJlYWxTdGFydElzQmVmb3JlRGF5Qm91bmRhcnlTdGFydCA9IGRheUJvdW5kYXJpZXNEYXRlVGltZSAmJlxuICAgICAgICBjYWxlbmRhckV2ZW50LnN0YXJ0LnRvU3RyaW5nKCkgPCBkYXlCb3VuZGFyaWVzRGF0ZVRpbWUuc3RhcnQudG9TdHJpbmcoKSAmJlxuICAgICAgICBjYWxlbmRhckV2ZW50LmVuZC50b1N0cmluZygpID49IGRheUJvdW5kYXJpZXNEYXRlVGltZS5zdGFydC50b1N0cmluZygpO1xuICAgIGNvbnN0IHJlbGF0aXZlU3RhcnRXaXRoaW5EYXlCb3VuZGFyeSA9IHJlYWxTdGFydElzQmVmb3JlRGF5Qm91bmRhcnlTdGFydFxuICAgICAgICA/IGRheUJvdW5kYXJpZXNEYXRlVGltZSA9PT0gbnVsbCB8fCBkYXlCb3VuZGFyaWVzRGF0ZVRpbWUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGRheUJvdW5kYXJpZXNEYXRlVGltZS5zdGFydFxuICAgICAgICA6IGNhbGVuZGFyRXZlbnQuc3RhcnQ7XG4gICAgcmV0dXJuIChqc3hzKEZyYWdtZW50LCB7IGNoaWxkcmVuOiBbanN4KFwiZGl2XCIsIHsgcmVmOiBldmVudFJlZiwgaWQ6IGlzQ29weSA/IGdldFRpbWVHcmlkRXZlbnRDb3B5RWxlbWVudElkKGNhbGVuZGFyRXZlbnQuaWQpIDogdW5kZWZpbmVkLCBcImRhdGEtZXZlbnQtaWRcIjogY2FsZW5kYXJFdmVudC5pZCwgb25DbGljazogaGFuZGxlT25DbGljaywgb25EYmxDbGljazogaGFuZGxlT25Eb3VibGVDbGljaywgb25LZXlEb3duOiBoYW5kbGVLZXlEb3duLCBvbk1vdXNlRG93bjogaGFuZGxlUG9pbnRlckRvd24sIG9uTW91c2VVcDogaGFuZGxlUG9pbnRlclVwLCBvblRvdWNoU3RhcnQ6IGhhbmRsZVBvaW50ZXJEb3duLCBvblRvdWNoRW5kOiBoYW5kbGVQb2ludGVyVXAsIGNsYXNzTmFtZTogY2xhc3NOYW1lcy5qb2luKCcgJyksIHRhYkluZGV4OiAwLCByb2xlOiBcImJ1dHRvblwiLCBzdHlsZToge1xuICAgICAgICAgICAgICAgICAgICB0b3A6IGAke2dldFlDb29yZGluYXRlSW5UaW1lR3JpZChyZWxhdGl2ZVN0YXJ0V2l0aGluRGF5Qm91bmRhcnksICRhcHAuY29uZmlnLmRheUJvdW5kYXJpZXMudmFsdWUsICRhcHAuY29uZmlnLnRpbWVQb2ludHNQZXJEYXkpfSVgLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IGAke2dldEV2ZW50SGVpZ2h0KHJlbGF0aXZlU3RhcnRXaXRoaW5EYXlCb3VuZGFyeSwgY2FsZW5kYXJFdmVudC5lbmQsICRhcHAuY29uZmlnLmRheUJvdW5kYXJpZXMudmFsdWUsICRhcHAuY29uZmlnLnRpbWVQb2ludHNQZXJEYXkpfSVgLFxuICAgICAgICAgICAgICAgICAgICBpbnNldElubGluZVN0YXJ0OiBgJHtpbnNldElubGluZVN0YXJ0fSVgLFxuICAgICAgICAgICAgICAgICAgICB3aWR0aDogYCR7Z2V0V2lkdGhSdWxlKGluc2V0SW5saW5lU3RhcnQsIGlzQ29weSA/IDEwMCA6ICRhcHAuY29uZmlnLndlZWtPcHRpb25zLnZhbHVlLmV2ZW50V2lkdGgsIGNhbGVuZGFyRXZlbnQuX21heENvbmN1cnJlbnRFdmVudHMsICRhcHAuY29uZmlnLndlZWtPcHRpb25zLnZhbHVlLmV2ZW50T3ZlcmxhcCl9JWAsXG4gICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogY3VzdG9tQ29tcG9uZW50XG4gICAgICAgICAgICAgICAgICAgICAgICA/IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgOiBldmVudENTU1ZhcmlhYmxlcy5iYWNrZ3JvdW5kQ29sb3IsXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiBjdXN0b21Db21wb25lbnQgPyB1bmRlZmluZWQgOiBldmVudENTU1ZhcmlhYmxlcy50ZXh0Q29sb3IsXG4gICAgICAgICAgICAgICAgICAgIGJvcmRlclRvcDogYm9yZGVyUnVsZSxcbiAgICAgICAgICAgICAgICAgICAgYm9yZGVySW5saW5lRW5kOiBib3JkZXJSdWxlLFxuICAgICAgICAgICAgICAgICAgICBib3JkZXJCb3R0b206IGJvcmRlclJ1bGUsXG4gICAgICAgICAgICAgICAgICAgIGJvcmRlcklubGluZVN0YXJ0OiBjdXN0b21Db21wb25lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgID8gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgICAgICA6IGV2ZW50Q1NTVmFyaWFibGVzLmJvcmRlcklubGluZVN0YXJ0LFxuICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiBjdXN0b21Db21wb25lbnQgPyAnMCcgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgfSwgY2hpbGRyZW46IGpzeHMoXCJkaXZcIiwgeyBcImRhdGEtY2NpZFwiOiBjdXN0b21Db21wb25lbnRJZC5jdXJyZW50LCBjbGFzc05hbWU6IFwic3hfX3RpbWUtZ3JpZC1ldmVudC1pbm5lclwiLCBjaGlsZHJlbjogWyFjdXN0b21Db21wb25lbnQgJiYgIWhhc0N1c3RvbUNvbnRlbnQgJiYgKGpzeHMoRnJhZ21lbnQkMSwgeyBjaGlsZHJlbjogW2lzQ29tcGFjdCAmJiBjYWxlbmRhckV2ZW50LnRpdGxlICYmIChqc3hzKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X190aXRsZS1hbmQtdGltZS1jb21wYWN0XCIsIGNoaWxkcmVuOiBbanN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X190aW1lLWdyaWQtZXZlbnQtdGl0bGVcIiwgY2hpbGRyZW46IGNhbGVuZGFyRXZlbnQudGl0bGUgfSksIGpzeChcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJzeF9fdGltZS1ncmlkLWV2ZW50LXRpbWVcIiwgY2hpbGRyZW46IHRpbWVGbihjYWxlbmRhckV2ZW50LnN0YXJ0LCAkYXBwLmNvbmZpZy5sb2NhbGUudmFsdWUpIH0pXSB9KSksICFpc0NvbXBhY3QgJiYgY2FsZW5kYXJFdmVudC50aXRsZSAmJiAoanN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X190aW1lLWdyaWQtZXZlbnQtdGl0bGVcIiwgY2hpbGRyZW46IGNhbGVuZGFyRXZlbnQudGl0bGUgfSkpLCAoIWlzQ29tcGFjdCB8fCAoaXNDb21wYWN0ICYmICFjYWxlbmRhckV2ZW50LnRpdGxlKSkgJiYgKGpzeHMoXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic3hfX3RpbWUtZ3JpZC1ldmVudC10aW1lXCIsIGNoaWxkcmVuOiBbanN4KFRpbWVJY29uLCB7IHN0cm9rZUNvbG9yOiBldmVudENTU1ZhcmlhYmxlcy5pY29uU3Ryb2tlIH0pLCBnZXRFdmVudFRpbWUoY2FsZW5kYXJFdmVudC5zdGFydCwgY2FsZW5kYXJFdmVudC5lbmQpXSB9KSksIGNhbGVuZGFyRXZlbnQucGVvcGxlICYmIGNhbGVuZGFyRXZlbnQucGVvcGxlLmxlbmd0aCA+IDAgJiYgKGpzeHMoXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic3hfX3RpbWUtZ3JpZC1ldmVudC1wZW9wbGVcIiwgY2hpbGRyZW46IFtqc3goVXNlckljb24sIHsgc3Ryb2tlQ29sb3I6IGV2ZW50Q1NTVmFyaWFibGVzLmljb25TdHJva2UgfSksIGNvbmNhdGVuYXRlUGVvcGxlKGNhbGVuZGFyRXZlbnQucGVvcGxlKV0gfSkpLCBjYWxlbmRhckV2ZW50LmxvY2F0aW9uICYmIChqc3hzKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X190aW1lLWdyaWQtZXZlbnQtbG9jYXRpb25cIiwgY2hpbGRyZW46IFtqc3goTG9jYXRpb25QaW5JY29uLCB7IHN0cm9rZUNvbG9yOiBldmVudENTU1ZhcmlhYmxlcy5pY29uU3Ryb2tlIH0pLCBjYWxlbmRhckV2ZW50LmxvY2F0aW9uXSB9KSldIH0pKSwgaGFzQ3VzdG9tQ29udGVudCAmJiAoanN4KFwiZGl2XCIsIHsgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX19odG1sOiAoKF9jID0gY2FsZW5kYXJFdmVudC5fY3VzdG9tQ29udGVudCkgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLnRpbWVHcmlkKSB8fCAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IH0pKSwgJGFwcC5jb25maWcucGx1Z2lucy5yZXNpemUgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhKChfZCA9IGNhbGVuZGFyRXZlbnQuX29wdGlvbnMpID09PSBudWxsIHx8IF9kID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZC5kaXNhYmxlUmVzaXplKSAmJiAoanN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiAnc3hfX3RpbWUtZ3JpZC1ldmVudC1yZXNpemUtaGFuZGxlJywgb25Nb3VzZURvd246IHN0YXJ0UmVzaXplLCBvblRvdWNoU3RhcnQ6IHN0YXJ0UmVzaXplIH0pKV0gfSkgfSksIGV2ZW50Q29weSAmJiAoanN4KFRpbWVHcmlkRXZlbnQsIHsgY2FsZW5kYXJFdmVudDogZXZlbnRDb3B5LCBpc0NvcHk6IHRydWUsIHNldE1vdXNlRG93bjogc2V0TW91c2VEb3duLCBkYXlCb3VuZGFyaWVzRGF0ZVRpbWU6IGRheUJvdW5kYXJpZXNEYXRlVGltZSB9KSldIH0pKTtcbn1cblxuY29uc3Qgc29ydEV2ZW50c0J5U3RhcnRBbmRFbmQgPSAoYSwgYikgPT4ge1xuICAgIGlmIChhLnN0YXJ0LnRvU3RyaW5nKCkgPT09IGIuc3RhcnQudG9TdHJpbmcoKSkge1xuICAgICAgICBpZiAoYS5lbmQudG9TdHJpbmcoKSA8IGIuZW5kLnRvU3RyaW5nKCkpXG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgaWYgKGEuZW5kLnRvU3RyaW5nKCkgPiBiLmVuZC50b1N0cmluZygpKVxuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgaWYgKGEuc3RhcnQudG9TdHJpbmcoKSA8IGIuc3RhcnQudG9TdHJpbmcoKSlcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIGlmIChhLnN0YXJ0LnRvU3RyaW5nKCkgPiBiLnN0YXJ0LnRvU3RyaW5nKCkpXG4gICAgICAgIHJldHVybiAxO1xuICAgIHJldHVybiAwO1xufTtcbmNvbnN0IHNvcnRFdmVudHNGb3JNb250aEdyaWQgPSAoYSwgYikgPT4ge1xuICAgIGNvbnN0IGFTdGFydERhdGUgPSBkYXRlRnJvbURhdGVUaW1lKGEuc3RhcnQudG9TdHJpbmcoKSk7XG4gICAgY29uc3QgYlN0YXJ0RGF0ZSA9IGRhdGVGcm9tRGF0ZVRpbWUoYi5zdGFydC50b1N0cmluZygpKTtcbiAgICBjb25zdCBhRW5kRGF0ZSA9IGRhdGVGcm9tRGF0ZVRpbWUoYS5lbmQudG9TdHJpbmcoKSk7XG4gICAgY29uc3QgYkVuZERhdGUgPSBkYXRlRnJvbURhdGVUaW1lKGIuZW5kLnRvU3RyaW5nKCkpO1xuICAgIC8qKlxuICAgICAqIEZvciBldmVudHMgdGhhdCBzdGFydCBhbmQgZW5kIGF0IHRoZSBzYW1lIGRheSwgc29ydCB0aGVtIGJ5IHRoZWlyIHN0YXJ0IHRpbWUuXG4gICAgICogSWYgdGhleSBvbmx5IHN0YXJ0IG9uIHRoZSBzYW1lIGRheSBidXQgZW5kIG9uIGRpZmZlcmVudCBkYXlzLCB0aGUgZnVuY3Rpb24gbmVlZHMgdG8gbW92ZSBvbjtcbiAgICAgKiBhbiBldmVudCB0aGF0IHN0YXJ0cyBvbiA1YW0gdG9kYXksIGJ1dCBlbmRzIGluIDUgZGF5cywgbmVlZHMgdG8gYmUgcGxhY2VkIGJlZm9yZSBhbiBldmVudCB0aGF0IHN0YXJ0c1xuICAgICAqIHRvZGF5IGF0IDFhbSBhbmQgZW5kcyBsYXRlciB0b2RheS4gVGhhdCB3YXkgd2UgYXZvaWQgZW1wdHkgZ2FwcyBpbiB0aGUgZ3JpZC5cbiAgICAgKiAqL1xuICAgIGlmIChhU3RhcnREYXRlID09PSBiU3RhcnREYXRlICYmIGFFbmREYXRlID09PSBiRW5kRGF0ZSkge1xuICAgICAgICBpZiAoYS5zdGFydC50b1N0cmluZygpIDwgYi5zdGFydC50b1N0cmluZygpKVxuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICBpZiAoYVN0YXJ0RGF0ZSA9PT0gYlN0YXJ0RGF0ZSkge1xuICAgICAgICBpZiAoYUVuZERhdGUgPCBiRW5kRGF0ZSlcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICBpZiAoYUVuZERhdGUgPiBiRW5kRGF0ZSlcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIGlmIChhU3RhcnREYXRlIDwgYlN0YXJ0RGF0ZSlcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIGlmIChhU3RhcnREYXRlID4gYlN0YXJ0RGF0ZSlcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgcmV0dXJuIDA7XG59O1xuXG5jb25zdCBhcmVTYW1lTWludXRlID0gKHN0YXJ0LCBlbmQpID0+IHtcbiAgICByZXR1cm4gKHN0YXJ0LnllYXIgPT09IGVuZC55ZWFyICYmXG4gICAgICAgIHN0YXJ0Lm1vbnRoID09PSBlbmQubW9udGggJiZcbiAgICAgICAgc3RhcnQuZGF5ID09PSBlbmQuZGF5ICYmXG4gICAgICAgIHN0YXJ0LmhvdXIgPT09IGVuZC5ob3VyICYmXG4gICAgICAgIHN0YXJ0Lm1pbnV0ZSA9PT0gZW5kLm1pbnV0ZSk7XG59O1xuY29uc3QgaXNFdmVudDBNaW51dGVzID0gKGUpID0+IHtcbiAgICByZXR1cm4gKChlID09PSBudWxsIHx8IGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGUuc3RhcnQpIGluc3RhbmNlb2YgVGVtcG9yYWwuWm9uZWREYXRlVGltZSAmJlxuICAgICAgICAoZSA9PT0gbnVsbCB8fCBlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBlLmVuZCkgaW5zdGFuY2VvZiBUZW1wb3JhbC5ab25lZERhdGVUaW1lICYmXG4gICAgICAgIGFyZVNhbWVNaW51dGUoZS5zdGFydCwgZS5lbmQpKTtcbn07XG5jb25zdCBhcmVFdmVudHMwTWludXRlc0FuZENvbmN1cnJlbnQgPSAoZTEsIGUyKSA9PiB7XG4gICAgcmV0dXJuIChpc0V2ZW50ME1pbnV0ZXMoZTEpICYmXG4gICAgICAgIGlzRXZlbnQwTWludXRlcyhlMikgJiZcbiAgICAgICAgKGUxID09PSBudWxsIHx8IGUxID09PSB2b2lkIDAgPyB2b2lkIDAgOiBlMS5zdGFydCkgaW5zdGFuY2VvZiBUZW1wb3JhbC5ab25lZERhdGVUaW1lICYmXG4gICAgICAgIChlMiA9PT0gbnVsbCB8fCBlMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogZTIuc3RhcnQpIGluc3RhbmNlb2YgVGVtcG9yYWwuWm9uZWREYXRlVGltZSAmJlxuICAgICAgICBhcmVTYW1lTWludXRlKGUxLnN0YXJ0LCBlMi5zdGFydCkpO1xufTtcblxuY29uc3QgaGFuZGxlRXZlbnRDb25jdXJyZW5jeSA9IChzb3J0ZWRFdmVudHMsIGNvbmN1cnJlbnRFdmVudHNDYWNoZSA9IFtdLCBjdXJyZW50SW5kZXggPSAwKSA9PiB7XG4gICAgZm9yIChsZXQgaSA9IGN1cnJlbnRJbmRleDsgaSA8IHNvcnRlZEV2ZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBldmVudCA9IHNvcnRlZEV2ZW50c1tpXTtcbiAgICAgICAgY29uc3QgbmV4dEV2ZW50ID0gc29ydGVkRXZlbnRzW2kgKyAxXTtcbiAgICAgICAgY29uc3QgYXJlQm90aEV2ZW50c1plcm9NaW51dGVzID0gYXJlRXZlbnRzME1pbnV0ZXNBbmRDb25jdXJyZW50KGV2ZW50LCBuZXh0RXZlbnQpO1xuICAgICAgICBpZiAoY29uY3VycmVudEV2ZW50c0NhY2hlLmxlbmd0aCAmJlxuICAgICAgICAgICAgKCFuZXh0RXZlbnQgfHxcbiAgICAgICAgICAgICAgICAoY29uY3VycmVudEV2ZW50c0NhY2hlLmV2ZXJ5KChlKSA9PiBlLmVuZC5lcG9jaE5hbm9zZWNvbmRzIDw9XG4gICAgICAgICAgICAgICAgICAgIG5leHRFdmVudC5zdGFydC5lcG9jaE5hbm9zZWNvbmRzKSAmJlxuICAgICAgICAgICAgICAgICAgICAhYXJlQm90aEV2ZW50c1plcm9NaW51dGVzKSkpIHtcbiAgICAgICAgICAgIGNvbmN1cnJlbnRFdmVudHNDYWNoZS5wdXNoKGV2ZW50KTtcbiAgICAgICAgICAgIGZvciAobGV0IGlpID0gMDsgaWkgPCBjb25jdXJyZW50RXZlbnRzQ2FjaGUubGVuZ3RoOyBpaSsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudEV2ZW50ID0gY29uY3VycmVudEV2ZW50c0NhY2hlW2lpXTtcbiAgICAgICAgICAgICAgICBjb25zdCBOcHJldmlvdXNDb25jdXJyZW50RXZlbnRzID0gY29uY3VycmVudEV2ZW50c0NhY2hlLmZpbHRlcigoY2FjaGVkRXZlbnQsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjYWNoZWRFdmVudCA9PT0gY3VycmVudEV2ZW50IHx8IGluZGV4ID4gaWkpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhcmVFdmVudHMwTWludXRlc0FuZENvbmN1cnJlbnQoY2FjaGVkRXZlbnQsIGN1cnJlbnRFdmVudCkpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChjYWNoZWRFdmVudC5zdGFydC5lcG9jaE5hbm9zZWNvbmRzIDw9XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50RXZlbnQuc3RhcnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZXBvY2hOYW5vc2Vjb25kcyAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGVkRXZlbnQuZW5kLmVwb2NoTmFub3NlY29uZHMgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRFdmVudC5zdGFydC5lcG9jaE5hbm9zZWNvbmRzKTtcbiAgICAgICAgICAgICAgICB9KS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgY29uc3QgTnVwY29taW5nQ29uY3VycmVudEV2ZW50cyA9IGNvbmN1cnJlbnRFdmVudHNDYWNoZS5maWx0ZXIoKGNhY2hlZEV2ZW50LCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY2FjaGVkRXZlbnQgPT09IGN1cnJlbnRFdmVudCB8fCBpbmRleCA8IGlpKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYXJlRXZlbnRzME1pbnV0ZXNBbmRDb25jdXJyZW50KGNhY2hlZEV2ZW50LCBjdXJyZW50RXZlbnQpKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoY2FjaGVkRXZlbnQuc3RhcnQuZXBvY2hOYW5vc2Vjb25kcyA8XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50RXZlbnQuZW5kLmVwb2NoTmFub3NlY29uZHMgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlZEV2ZW50LmVuZC5lcG9jaE5hbm9zZWNvbmRzID49XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEV2ZW50LnN0YXJ0LmVwb2NoTmFub3NlY29uZHMpO1xuICAgICAgICAgICAgICAgIH0pLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBjdXJyZW50RXZlbnQuX3RvdGFsQ29uY3VycmVudEV2ZW50cyA9XG4gICAgICAgICAgICAgICAgICAgIE5wcmV2aW91c0NvbmN1cnJlbnRFdmVudHMgKyBOdXBjb21pbmdDb25jdXJyZW50RXZlbnRzICsgMTtcbiAgICAgICAgICAgICAgICBjdXJyZW50RXZlbnQuX3ByZXZpb3VzQ29uY3VycmVudEV2ZW50cyA9IE5wcmV2aW91c0NvbmN1cnJlbnRFdmVudHM7XG4gICAgICAgICAgICAgICAgLy8gVE9ETyB2MzogdHJ5IHRvIHVzZSBfbWF4Q29uY3VycmVudEV2ZW50cyBmb3IgYm90aCBvdmVybGFwL25vIG92ZXJsYXAgbW9kZSwgYW5kIHJlbW92ZSBfdG90YWxDb25jdXJyZW50RXZlbnRzXG4gICAgICAgICAgICAgICAgbGV0IG1heE92ZXJsYXBwaW5nRXZlbnRzID0gMDtcbiAgICAgICAgICAgICAgICBjb25zdCB0aW1lUG9pbnRzID0gW107XG4gICAgICAgICAgICAgICAgY29uY3VycmVudEV2ZW50c0NhY2hlLmZvckVhY2goKGNhY2hlZEV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgoY2FjaGVkRXZlbnQuZW5kLmVwb2NoTmFub3NlY29uZHMgPlxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEV2ZW50LnN0YXJ0LmVwb2NoTmFub3NlY29uZHMgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlZEV2ZW50LnN0YXJ0LmVwb2NoTmFub3NlY29uZHMgPFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRFdmVudC5lbmRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmVwb2NoTmFub3NlY29uZHMpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmVFdmVudHMwTWludXRlc0FuZENvbmN1cnJlbnQoY2FjaGVkRXZlbnQsIGN1cnJlbnRFdmVudCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVQb2ludHMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZTogY2FjaGVkRXZlbnQuc3RhcnQudG9TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnc3RhcnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aW1lUG9pbnRzLnB1c2goeyB0aW1lOiBjYWNoZWRFdmVudC5lbmQudG9TdHJpbmcoKSwgdHlwZTogJ2VuZCcgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aW1lUG9pbnRzLnNvcnQoKGEsIGIpID0+IGEudGltZS5sb2NhbGVDb21wYXJlKGIudGltZSkgfHwgKGEudHlwZSA9PT0gJ2VuZCcgPyAtMSA6IDEpKTtcbiAgICAgICAgICAgICAgICBsZXQgY3VycmVudE92ZXJsYXAgPSAwO1xuICAgICAgICAgICAgICAgIHRpbWVQb2ludHMuZm9yRWFjaCgocG9pbnQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvaW50LnR5cGUgPT09ICdzdGFydCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRPdmVybGFwKys7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXhPdmVybGFwcGluZ0V2ZW50cyA9IE1hdGgubWF4KG1heE92ZXJsYXBwaW5nRXZlbnRzLCBjdXJyZW50T3ZlcmxhcCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50T3ZlcmxhcC0tO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgY3VycmVudEV2ZW50Ll9tYXhDb25jdXJyZW50RXZlbnRzID0gbWF4T3ZlcmxhcHBpbmdFdmVudHM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25jdXJyZW50RXZlbnRzQ2FjaGUgPSBbXTtcbiAgICAgICAgICAgIHJldHVybiBoYW5kbGVFdmVudENvbmN1cnJlbmN5KHNvcnRlZEV2ZW50cywgY29uY3VycmVudEV2ZW50c0NhY2hlLCBpICsgMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKChuZXh0RXZlbnQgJiZcbiAgICAgICAgICAgIGV2ZW50LmVuZC5lcG9jaE5hbm9zZWNvbmRzID5cbiAgICAgICAgICAgICAgICBuZXh0RXZlbnQuc3RhcnQuZXBvY2hOYW5vc2Vjb25kcykgfHxcbiAgICAgICAgICAgIGNvbmN1cnJlbnRFdmVudHNDYWNoZS5zb21lKChlKSA9PiBlLmVuZC5lcG9jaE5hbm9zZWNvbmRzID5cbiAgICAgICAgICAgICAgICBldmVudC5zdGFydC5lcG9jaE5hbm9zZWNvbmRzKSB8fFxuICAgICAgICAgICAgYXJlQm90aEV2ZW50c1plcm9NaW51dGVzKSB7XG4gICAgICAgICAgICBjb25jdXJyZW50RXZlbnRzQ2FjaGUucHVzaChldmVudCk7XG4gICAgICAgICAgICByZXR1cm4gaGFuZGxlRXZlbnRDb25jdXJyZW5jeShzb3J0ZWRFdmVudHMsIGNvbmN1cnJlbnRFdmVudHNDYWNoZSwgaSArIDEpO1xuICAgICAgICB9XG4gICAgICAgIGV2ZW50Ll90b3RhbENvbmN1cnJlbnRFdmVudHMgPSAxO1xuICAgICAgICBldmVudC5fcHJldmlvdXNDb25jdXJyZW50RXZlbnRzID0gMDtcbiAgICAgICAgZXZlbnQuX21heENvbmN1cnJlbnRFdmVudHMgPSAxO1xuICAgIH1cbiAgICByZXR1cm4gc29ydGVkRXZlbnRzO1xufTtcblxuY29uc3QgZ2V0Q2xpY2tEYXRlVGltZSA9IChlLCAkYXBwLCBkYXlTdGFydERhdGVUaW1lKSA9PiB7XG4gICAgaWYgKCEoZS50YXJnZXQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkpXG4gICAgICAgIHJldHVybjtcbiAgICBjb25zdCBEQVlfR1JJRF9DTEFTU19OQU1FID0gJ3N4X190aW1lLWdyaWQtZGF5JztcbiAgICBjb25zdCBkYXlHcmlkRWxlbWVudCA9IGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhEQVlfR1JJRF9DTEFTU19OQU1FKVxuICAgICAgICA/IGUudGFyZ2V0XG4gICAgICAgIDogZS50YXJnZXQuY2xvc2VzdCgnLicgKyBEQVlfR1JJRF9DTEFTU19OQU1FKTtcbiAgICBjb25zdCBjbGllbnRZID0gZS5jbGllbnRZIC0gZGF5R3JpZEVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wO1xuICAgIGNvbnN0IGNsaWNrUGVyY2VudGFnZU9mRGF5ID0gKGNsaWVudFkgLyBkYXlHcmlkRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQpICogMTAwO1xuICAgIGNvbnN0IGNsaWNrVGltZVBvaW50c0ludG9EYXkgPSBNYXRoLnJvdW5kKCgkYXBwLmNvbmZpZy50aW1lUG9pbnRzUGVyRGF5IC8gMTAwKSAqIGNsaWNrUGVyY2VudGFnZU9mRGF5KTtcbiAgICByZXR1cm4gYWRkVGltZVBvaW50c1RvRGF0ZVRpbWUoZGF5U3RhcnREYXRlVGltZSwgY2xpY2tUaW1lUG9pbnRzSW50b0RheSk7XG59O1xuXG5jb25zdCBnZXRDbGFzc05hbWVGb3JXZWVrZGF5ID0gKHdlZWtkYXkpID0+IHtcbiAgICBzd2l0Y2ggKHdlZWtkYXkpIHtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgcmV0dXJuICdzeF9fbW9uZGF5JztcbiAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgcmV0dXJuICdzeF9fdHVlc2RheSc7XG4gICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgIHJldHVybiAnc3hfX3dlZG5lc2RheSc7XG4gICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgIHJldHVybiAnc3hfX3RodXJzZGF5JztcbiAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgcmV0dXJuICdzeF9fZnJpZGF5JztcbiAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgcmV0dXJuICdzeF9fc2F0dXJkYXknO1xuICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICByZXR1cm4gJ3N4X19zdW5kYXknO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIHdlZWtkYXkgJHt3ZWVrZGF5fWApO1xuICAgIH1cbn07XG5cbmZ1bmN0aW9uIFRpbWVHcmlkQmFja2dyb3VuZEV2ZW50KHsgYmFja2dyb3VuZEV2ZW50LCBkYXRlLCB9KSB7XG4gICAgY29uc3QgJGFwcCA9IHVzZUNvbnRleHQoQXBwQ29udGV4dCk7XG4gICAgbGV0IHN0YXJ0ID0gYmFja2dyb3VuZEV2ZW50LnN0YXJ0O1xuICAgIGxldCBlbmQgPSBiYWNrZ3JvdW5kRXZlbnQuZW5kO1xuICAgIGNvbnN0IHN0YXJ0SXNBbm90aGVyRGF0ZSA9ICFpc1NhbWVEYXkoc3RhcnQsIFRlbXBvcmFsLlBsYWluRGF0ZS5mcm9tKGRhdGUpKTtcbiAgICBjb25zdCBlbmRJc0Fub3RoZXJEYXRlID0gIWlzU2FtZURheShlbmQsIFRlbXBvcmFsLlBsYWluRGF0ZS5mcm9tKGRhdGUpKTtcbiAgICAvLyBnZXQgWVlZWS1NTS1ERCBmcm9tIHN0YXJ0IGFuZCBlbmQgYW5kIGFkZCAwMDowMCBvciAyMzo1OSwgaWYgdGhlIGRhdGUgaXMgbm90IHRoZSBzYW1lIGFzIHRoZSBkYXRlIG9mIHRoZSBiYWNrZ3JvdW5kIGV2ZW50XG4gICAgLy8gb3IgaWYgaXQncyBhIGZ1bGwtZGF5IGV2ZW50XG4gICAgaWYgKHN0YXJ0SXNBbm90aGVyRGF0ZSB8fCBzdGFydCBpbnN0YW5jZW9mIFRlbXBvcmFsLlBsYWluRGF0ZSkge1xuICAgICAgICBzdGFydCA9IFRlbXBvcmFsLlpvbmVkRGF0ZVRpbWUuZnJvbSh7XG4gICAgICAgICAgICB5ZWFyOiBUZW1wb3JhbC5QbGFpbkRhdGUuZnJvbShkYXRlKS55ZWFyLFxuICAgICAgICAgICAgbW9udGg6IFRlbXBvcmFsLlBsYWluRGF0ZS5mcm9tKGRhdGUpLm1vbnRoLFxuICAgICAgICAgICAgZGF5OiBUZW1wb3JhbC5QbGFpbkRhdGUuZnJvbShkYXRlKS5kYXksXG4gICAgICAgICAgICBob3VyOiAwLFxuICAgICAgICAgICAgbWludXRlOiAwLFxuICAgICAgICAgICAgc2Vjb25kOiAwLFxuICAgICAgICAgICAgdGltZVpvbmU6ICRhcHAuY29uZmlnLnRpbWV6b25lLnZhbHVlLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGVuZElzQW5vdGhlckRhdGUgfHwgZW5kIGluc3RhbmNlb2YgVGVtcG9yYWwuUGxhaW5EYXRlKSB7XG4gICAgICAgIGVuZCA9IFRlbXBvcmFsLlpvbmVkRGF0ZVRpbWUuZnJvbSh7XG4gICAgICAgICAgICB5ZWFyOiBUZW1wb3JhbC5QbGFpbkRhdGUuZnJvbShkYXRlKS55ZWFyLFxuICAgICAgICAgICAgbW9udGg6IFRlbXBvcmFsLlBsYWluRGF0ZS5mcm9tKGRhdGUpLm1vbnRoLFxuICAgICAgICAgICAgZGF5OiBUZW1wb3JhbC5QbGFpbkRhdGUuZnJvbShkYXRlKS5kYXksXG4gICAgICAgICAgICBob3VyOiAyMyxcbiAgICAgICAgICAgIG1pbnV0ZTogNTksXG4gICAgICAgICAgICBzZWNvbmQ6IDU5LFxuICAgICAgICAgICAgdGltZVpvbmU6ICRhcHAuY29uZmlnLnRpbWV6b25lLnZhbHVlLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLy8gYWRqdXN0IHRoZSBzdGFydCB0aW1lIGFjY29yZGluZyB0byB0aGUgZGF5IGJvdW5kYXJpZXNcbiAgICAvLyBvdGhlcndpc2UgdGhlIGJhY2tncm91bmQgZXZlbnQgYHRvcGAgaXMgY2FsY3VsYXRlZCBpbmNvcnJlY3RseVxuICAgIGNvbnN0IHN0YXJ0SG91ciA9IHN0YXJ0LmhvdXI7XG4gICAgY29uc3Qgc3RhcnRNaW51dGUgPSBzdGFydC5taW51dGU7XG4gICAgY29uc3QgZm9ybWF0dGVkU3RhcnQgPSBgJHtzdGFydEhvdXIudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfToke3N0YXJ0TWludXRlLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX1gO1xuICAgIGNvbnN0IHN0YXJ0VGltZVBvaW50cyA9IHRpbWVQb2ludHNGcm9tU3RyaW5nKGZvcm1hdHRlZFN0YXJ0KTtcbiAgICBpZiAoc3RhcnRUaW1lUG9pbnRzIDwgJGFwcC5jb25maWcuZGF5Qm91bmRhcmllcy52YWx1ZS5zdGFydCkge1xuICAgICAgICBjb25zdCB1cGRhdGVkU3RhcnQgPSB0aW1lU3RyaW5nRnJvbVRpbWVQb2ludHMoJGFwcC5jb25maWcuZGF5Qm91bmRhcmllcy52YWx1ZS5zdGFydCk7XG4gICAgICAgIGNvbnN0IHVwZGF0ZWRTdGFydEhvdXIgPSB1cGRhdGVkU3RhcnQuc3BsaXQoJzonKVswXTtcbiAgICAgICAgY29uc3QgdXBkYXRlZFN0YXJ0TWludXRlID0gdXBkYXRlZFN0YXJ0LnNwbGl0KCc6JylbMV07XG4gICAgICAgIHN0YXJ0ID0gVGVtcG9yYWwuWm9uZWREYXRlVGltZS5mcm9tKHtcbiAgICAgICAgICAgIHllYXI6IFRlbXBvcmFsLlBsYWluRGF0ZS5mcm9tKGRhdGUpLnllYXIsXG4gICAgICAgICAgICBtb250aDogVGVtcG9yYWwuUGxhaW5EYXRlLmZyb20oZGF0ZSkubW9udGgsXG4gICAgICAgICAgICBkYXk6IFRlbXBvcmFsLlBsYWluRGF0ZS5mcm9tKGRhdGUpLmRheSxcbiAgICAgICAgICAgIGhvdXI6ICt1cGRhdGVkU3RhcnRIb3VyLFxuICAgICAgICAgICAgbWludXRlOiArdXBkYXRlZFN0YXJ0TWludXRlLFxuICAgICAgICAgICAgc2Vjb25kOiAwLFxuICAgICAgICAgICAgdGltZVpvbmU6ICRhcHAuY29uZmlnLnRpbWV6b25lLnZhbHVlLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLy8gd2hlbiBzdGFydCBhbmQgZW5kIGRhdGV0aW1lcyBhcmUgZXF1YWwsIHRoZSByZW5kZXJpbmcgb2YgdGhlIGJhY2tncm91bmQgZXZlbnQgY2FuIGJlIHNraXBwZWQgY29tcGxldGVseS5cbiAgICAvLyBvdGhlcndpc2UsIGBoZWlnaHRgIGlzIGNhbGN1bGF0ZWQgYXMgNSUgKGJ5IGBnZXRFdmVudEhlaWdodGApIGFuZCB0aGlzIGlzIG1pc2xlYWRpbmcgZm9yIGEgYmFja2dyb3VuZCBldmVudCBsaWtlIFwib3V0LW9mLW9mZmljZVwiIGhvdXJzLlxuICAgIC8vIFRoaXMgY29tcGFyaXNvbiBpcyBzYWZlIGFsc28gZm9yIGZ1bGwtZGF5IGJhY2tncm91bmQgZXZlbnRzLCBiZWNhdXNlIGVhcmxpZXIgaW4gY29kZSB3ZSBhZGQgdGltZSAoMDA6MDAgLSAyMzo1OSkgdG8gZnVsbC1kYXkgZXZlbnRzLCBtYWtpbmcgc3RhcnQgYW5kIGVuZCBubyBsb25nZXIgZXF1YWwgaW4gZnVsbC1kYXkgZXZlbnQgY2FzZS5cbiAgICBpZiAoc3RhcnQudG9TdHJpbmcoKSA9PT0gZW5kLnRvU3RyaW5nKCkpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHJldHVybiAoanN4KEZyYWdtZW50LCB7IGNoaWxkcmVuOiBqc3goXCJkaXZcIiwgeyBjbGFzczogXCJzeF9fdGltZS1ncmlkLWJhY2tncm91bmQtZXZlbnRcIiwgdGl0bGU6IGJhY2tncm91bmRFdmVudC50aXRsZSwgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICAuLi5iYWNrZ3JvdW5kRXZlbnQuc3R5bGUsXG4gICAgICAgICAgICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gICAgICAgICAgICAgICAgekluZGV4OiAwLFxuICAgICAgICAgICAgICAgIHRvcDogYCR7Z2V0WUNvb3JkaW5hdGVJblRpbWVHcmlkKHN0YXJ0LCAkYXBwLmNvbmZpZy5kYXlCb3VuZGFyaWVzLnZhbHVlLCAkYXBwLmNvbmZpZy50aW1lUG9pbnRzUGVyRGF5KX0lYCxcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IGAke2dldEV2ZW50SGVpZ2h0KHN0YXJ0LCBlbmQsICRhcHAuY29uZmlnLmRheUJvdW5kYXJpZXMudmFsdWUsICRhcHAuY29uZmlnLnRpbWVQb2ludHNQZXJEYXkpfSVgLFxuICAgICAgICAgICAgICAgIHdpZHRoOiAnMTAwJScsXG4gICAgICAgICAgICB9IH0pIH0pKTtcbn1cblxuZnVuY3Rpb24gVGltZUdyaWREYXkoeyBjYWxlbmRhckV2ZW50cywgZGF0ZSwgYmFja2dyb3VuZEV2ZW50cywgfSkge1xuICAgIC8qKlxuICAgICAqIFRoZSB0aW1lIGdyaWQgZGF5IG5lZWRzIHRvIGtlZXAgdHJhY2sgb2Ygd2hldGhlciB0aGUgbW91c2Vkb3duIGV2ZW50IGhhcHBlbmVkIG9uIGEgY2FsZW5kYXIgZXZlbnQsIGluIG9yZGVyIHRvIHByZXZlbnRcbiAgICAgKiBjbGljayBldmVudHMgZnJvbSBmaXJpbmcgd2hlbiBkcmFnZ2luZyBhbiBldmVudC5cbiAgICAgKiAqL1xuICAgIGNvbnN0IFttb3VzZURvd25PbkNoaWxkLCBzZXRNb3VzZURvd25PbkNoaWxkXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgICBjb25zdCAkYXBwID0gdXNlQ29udGV4dChBcHBDb250ZXh0KTtcbiAgICBjb25zdCB0aW1lU3RyaW5nRnJvbURheUJvdW5kYXJ5ID0gdGltZVN0cmluZ0Zyb21UaW1lUG9pbnRzKCRhcHAuY29uZmlnLmRheUJvdW5kYXJpZXMudmFsdWUuc3RhcnQpO1xuICAgIGNvbnN0IHRpbWVTdHJpbmdGcm9tRGF5Qm91bmRhcnlFbmQgPSB0aW1lU3RyaW5nRnJvbVRpbWVQb2ludHMoJGFwcC5jb25maWcuZGF5Qm91bmRhcmllcy52YWx1ZS5lbmQpO1xuICAgIGNvbnN0IGRheVN0YXJ0RGF0ZVRpbWUgPSBkYXRlLndpdGgoe1xuICAgICAgICBob3VyOiArdGltZVN0cmluZ0Zyb21EYXlCb3VuZGFyeS5zcGxpdCgnOicpWzBdLFxuICAgICAgICBtaW51dGU6ICt0aW1lU3RyaW5nRnJvbURheUJvdW5kYXJ5LnNwbGl0KCc6JylbMV0sXG4gICAgfSk7XG4gICAgY29uc3QgZW5kSG91ciA9ICt0aW1lU3RyaW5nRnJvbURheUJvdW5kYXJ5RW5kLnNwbGl0KCc6JylbMF07XG4gICAgY29uc3QgZW5kV2l0aEFkanVzdGVkVGltZSA9IGRhdGUud2l0aCh7XG4gICAgICAgIGhvdXI6IGVuZEhvdXIgPT09IDI0ID8gMjMgOiBlbmRIb3VyLFxuICAgICAgICBtaW51dGU6IGVuZEhvdXIgPT09IDI0ID8gNTkgOiArdGltZVN0cmluZ0Zyb21EYXlCb3VuZGFyeUVuZC5zcGxpdCgnOicpWzFdLFxuICAgICAgICBzZWNvbmQ6IGVuZEhvdXIgPT09IDI0ID8gNTkgOiAwLFxuICAgIH0pO1xuICAgIGNvbnN0IGRheUVuZERhdGVUaW1lID0gJGFwcC5jb25maWcuaXNIeWJyaWREYXlcbiAgICAgICAgPyBhZGREYXlzKGVuZFdpdGhBZGp1c3RlZFRpbWUsIDEpXG4gICAgICAgIDogZW5kV2l0aEFkanVzdGVkVGltZTtcbiAgICBjb25zdCBkYXlCb3VuZGFyaWVzRGF0ZVRpbWUgPSB7XG4gICAgICAgIHN0YXJ0OiBkYXlTdGFydERhdGVUaW1lLFxuICAgICAgICBlbmQ6IGRheUVuZERhdGVUaW1lLFxuICAgIH07XG4gICAgY29uc3QgZXZlbnRzV2l0aENvbmN1cnJlbmN5ID0gdXNlTWVtbygoKSA9PiB7XG4gICAgICAgIGNvbnN0IHNvcnRlZEV2ZW50cyA9IGNhbGVuZGFyRXZlbnRzLnNvcnQoc29ydEV2ZW50c0J5U3RhcnRBbmRFbmQpO1xuICAgICAgICByZXR1cm4gaGFuZGxlRXZlbnRDb25jdXJyZW5jeShzb3J0ZWRFdmVudHMpO1xuICAgIH0sIFtjYWxlbmRhckV2ZW50c10pO1xuICAgIGNvbnN0IGhhbmRsZU9uQ2xpY2sgPSAoZSwgY2FsbGJhY2spID0+IHtcbiAgICAgICAgaWYgKCFjYWxsYmFjayB8fCBtb3VzZURvd25PbkNoaWxkKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBjb25zdCBjbGlja0RhdGVUaW1lID0gZ2V0Q2xpY2tEYXRlVGltZShlLCAkYXBwLCBkYXlTdGFydERhdGVUaW1lKTtcbiAgICAgICAgaWYgKGNsaWNrRGF0ZVRpbWUpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKGNsaWNrRGF0ZVRpbWUsIGUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBoYW5kbGVNb3VzZURvd24gPSAoZSkgPT4ge1xuICAgICAgICBjb25zdCBjYWxsYmFjayA9ICRhcHAuY29uZmlnLmNhbGxiYWNrcy5vbk1vdXNlRG93bkRhdGVUaW1lO1xuICAgICAgICBpZiAoIWNhbGxiYWNrIHx8IG1vdXNlRG93bk9uQ2hpbGQpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGNvbnN0IGNsaWNrRGF0ZVRpbWUgPSBnZXRDbGlja0RhdGVUaW1lKGUsICRhcHAsIGRheVN0YXJ0RGF0ZVRpbWUpO1xuICAgICAgICBpZiAoY2xpY2tEYXRlVGltZSkge1xuICAgICAgICAgICAgY2FsbGJhY2soY2xpY2tEYXRlVGltZSwgZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IGhhbmRsZVBvaW50ZXJVcCA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgbXNXYWl0VG9FbnN1cmVUaGF0Q2xpY2tFdmVudFdhc0Rpc3BhdGNoZWQgPSAxMDtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBzZXRNb3VzZURvd25PbkNoaWxkKGZhbHNlKTtcbiAgICAgICAgfSwgbXNXYWl0VG9FbnN1cmVUaGF0Q2xpY2tFdmVudFdhc0Rpc3BhdGNoZWQpO1xuICAgIH07XG4gICAgY29uc3QgYmFzZUNsYXNzZXMgPSBbXG4gICAgICAgICdzeF9fdGltZS1ncmlkLWRheScsXG4gICAgICAgIGdldENsYXNzTmFtZUZvcldlZWtkYXkoZGF0ZS5kYXlPZldlZWspLFxuICAgIF07XG4gICAgY29uc3QgY2xhc3NOYW1lcyA9IHVzZUNvbXB1dGVkKCgpID0+IHtcbiAgICAgICAgY29uc3QgbmV3Q2xhc3NOYW1lcyA9IFsuLi5iYXNlQ2xhc3Nlc107XG4gICAgICAgIGlmIChpc1NhbWVEYXkoJGFwcC5kYXRlUGlja2VyU3RhdGUuc2VsZWN0ZWREYXRlLnZhbHVlLCBkYXRlKSlcbiAgICAgICAgICAgIG5ld0NsYXNzTmFtZXMucHVzaCgnaXMtc2VsZWN0ZWQnKTtcbiAgICAgICAgcmV0dXJuIG5ld0NsYXNzTmFtZXM7XG4gICAgfSk7XG4gICAgcmV0dXJuIChqc3hzKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBjbGFzc05hbWVzLnZhbHVlLmpvaW4oJyAnKSwgXCJkYXRhLXRpbWUtZ3JpZC1kYXRlXCI6IHRvRGF0ZVN0cmluZyQxKGRhdGUpLCBvbkNsaWNrOiAoZSkgPT4gaGFuZGxlT25DbGljayhlLCAkYXBwLmNvbmZpZy5jYWxsYmFja3Mub25DbGlja0RhdGVUaW1lKSwgb25EYmxDbGljazogKGUpID0+IGhhbmRsZU9uQ2xpY2soZSwgJGFwcC5jb25maWcuY2FsbGJhY2tzLm9uRG91YmxlQ2xpY2tEYXRlVGltZSksIFwiYXJpYS1sYWJlbFwiOiBnZXRMb2NhbGl6ZWREYXRlJDEoZGF0ZSwgJGFwcC5jb25maWcubG9jYWxlLnZhbHVlKSwgb25Nb3VzZUxlYXZlOiAoKSA9PiBzZXRNb3VzZURvd25PbkNoaWxkKGZhbHNlKSwgb25Nb3VzZVVwOiBoYW5kbGVQb2ludGVyVXAsIG9uVG91Y2hFbmQ6IGhhbmRsZVBvaW50ZXJVcCwgb25Nb3VzZURvd246IGhhbmRsZU1vdXNlRG93biwgY2hpbGRyZW46IFtiYWNrZ3JvdW5kRXZlbnRzLm1hcCgoZXZlbnQpID0+IChqc3goRnJhZ21lbnQsIHsgY2hpbGRyZW46IGpzeChUaW1lR3JpZEJhY2tncm91bmRFdmVudCwgeyBiYWNrZ3JvdW5kRXZlbnQ6IGV2ZW50LCBkYXRlOiBkYXRlLnRvU3RyaW5nKCkgfSkgfSkpKSwgZXZlbnRzV2l0aENvbmN1cnJlbmN5Lm1hcCgoZXZlbnQpID0+IChqc3goVGltZUdyaWRFdmVudCwgeyBjYWxlbmRhckV2ZW50OiBldmVudCwgZGF5Qm91bmRhcmllc0RhdGVUaW1lOiBkYXlCb3VuZGFyaWVzRGF0ZVRpbWUsIHNldE1vdXNlRG93bjogc2V0TW91c2VEb3duT25DaGlsZCB9LCBldmVudC5pZCkpKV0gfSkpO1xufVxuXG5jb25zdCBnZXRUaW1lQXhpc0hvdXJzID0gKHsgc3RhcnQsIGVuZCB9LCBpc0h5YnJpZERheSkgPT4ge1xuICAgIGNvbnN0IGhvdXJzID0gW107XG4gICAgbGV0IGhvdXIgPSBNYXRoLmZsb29yKHN0YXJ0IC8gMTAwKTtcbiAgICBpZiAoaXNIeWJyaWREYXkpIHtcbiAgICAgICAgd2hpbGUgKGhvdXIgPCAyNCkge1xuICAgICAgICAgICAgaG91cnMucHVzaChob3VyKTtcbiAgICAgICAgICAgIGhvdXIgKz0gMTtcbiAgICAgICAgfVxuICAgICAgICBob3VyID0gMDtcbiAgICB9XG4gICAgY29uc3QgbGFzdEhvdXIgPSBlbmQgPT09IDAgPyAyNCA6IE1hdGguY2VpbChlbmQgLyAxMDApO1xuICAgIHdoaWxlIChob3VyIDwgbGFzdEhvdXIpIHtcbiAgICAgICAgaG91cnMucHVzaChob3VyKTtcbiAgICAgICAgaG91ciArPSAxO1xuICAgIH1cbiAgICByZXR1cm4gaG91cnM7XG59O1xuXG5mdW5jdGlvbiBUaW1lQXhpcygpIHtcbiAgICBjb25zdCAkYXBwID0gdXNlQ29udGV4dChBcHBDb250ZXh0KTtcbiAgICBjb25zdCBbZ3JpZFN0ZXBzLCBzZXRHcmlkU3RlcHNdID0gdXNlU3RhdGUoW10pO1xuICAgIHVzZVNpZ25hbEVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGNvbnN0IGhvdXJTdGVwcyA9IGdldFRpbWVBeGlzSG91cnMoJGFwcC5jb25maWcuZGF5Qm91bmRhcmllcy52YWx1ZSwgJGFwcC5jb25maWcuaXNIeWJyaWREYXkpO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBbXTtcbiAgICAgICAgaG91clN0ZXBzLmZvckVhY2goKGhvdXIpID0+IHtcbiAgICAgICAgICAgIGlmICgkYXBwLmNvbmZpZy53ZWVrT3B0aW9ucy52YWx1ZS5ncmlkU3RlcCA9PT0gNjApIHtcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh7IGhvdXI6IGhvdXIsIG1pbnV0ZTogMCB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgkYXBwLmNvbmZpZy53ZWVrT3B0aW9ucy52YWx1ZS5ncmlkU3RlcCA9PT0gMzApIHtcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh7IGhvdXI6IGhvdXIsIG1pbnV0ZTogMCB9LCB7IGhvdXI6IGhvdXIsIG1pbnV0ZTogMzAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoJGFwcC5jb25maWcud2Vla09wdGlvbnMudmFsdWUuZ3JpZFN0ZXAgPT09IDE1KSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goeyBob3VyOiBob3VyLCBtaW51dGU6IDAgfSwgeyBob3VyOiBob3VyLCBtaW51dGU6IDE1IH0sIHsgaG91cjogaG91ciwgbWludXRlOiAzMCB9LCB7IGhvdXI6IGhvdXIsIG1pbnV0ZTogNDUgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBzZXRHcmlkU3RlcHMocmVzdWx0KTtcbiAgICAgICAgY29uc3QgcGl4ZWxzUGVyR3JpZFN0ZXAgPSAkYXBwLmNvbmZpZy53ZWVrT3B0aW9ucy52YWx1ZS5ncmlkSGVpZ2h0IC8gcmVzdWx0Lmxlbmd0aDtcbiAgICAgICAgLy8gVE9ETyB2NDogcmVuYW1lIC0tc3gtd2Vlay1ncmlkLWhvdXItaGVpZ2h0IHRvIC0tc3gtd2Vlay1ncmlkLWdyaWQtc3RlcC1oZWlnaHRcbiAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KCctLXN4LXdlZWstZ3JpZC1ob3VyLWhlaWdodCcsIGAke3BpeGVsc1BlckdyaWRTdGVwfXB4YCk7XG4gICAgfSk7XG4gICAgY29uc3QgZm9ybWF0dGVyID0gbmV3IEludGwuRGF0ZVRpbWVGb3JtYXQoJGFwcC5jb25maWcubG9jYWxlLnZhbHVlLCAkYXBwLmNvbmZpZy53ZWVrT3B0aW9ucy52YWx1ZS50aW1lQXhpc0Zvcm1hdE9wdGlvbnMpO1xuICAgIGNvbnN0IGhvdXJDdXN0b21Db21wb25lbnRGbiA9ICRhcHAuY29uZmlnLl9jdXN0b21Db21wb25lbnRGbnMud2Vla0dyaWRIb3VyO1xuICAgIGNvbnN0IGhvdXJDQ0lEcyA9IHVzZU1lbW8oKCkgPT4ge1xuICAgICAgICBpZiAoIWhvdXJDdXN0b21Db21wb25lbnRGbilcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgcmV0dXJuIGdyaWRTdGVwcy5tYXAoKCkgPT4gYGN1c3RvbS13ZWVrLWdyaWQtaG91ci0ke3JhbmRvbVN0cmluZ0lkKCl9YCk7XG4gICAgfSwgW2dyaWRTdGVwc10pO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGlmIChob3VyQ3VzdG9tQ29tcG9uZW50Rm4gJiYgaG91ckNDSURzLmxlbmd0aCkge1xuICAgICAgICAgICAgZ3JpZFN0ZXBzLmZvckVhY2goKGdyaWRTdGVwLCBpZHgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLWNjaWQ9XCIke2hvdXJDQ0lEc1tpZHhdfVwiXWApO1xuICAgICAgICAgICAgICAgIGlmICghKGVsIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb25zb2xlLndhcm4oJ0NvdWxkIG5vdCBmaW5kIGVsZW1lbnQgZm9yIGN1c3RvbSBjb21wb25lbnQgd2Vla0dyaWRIb3VyJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGhvdXJDdXN0b21Db21wb25lbnRGbihlbCwgeyBob3VyOiBncmlkU3RlcC5ob3VyLCBncmlkU3RlcCB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSwgW2dyaWRTdGVwcywgaG91ckNDSURzXSk7XG4gICAgcmV0dXJuIChqc3goRnJhZ21lbnQsIHsgY2hpbGRyZW46IGpzeChcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJzeF9fd2Vlay1ncmlkX190aW1lLWF4aXNcIiwgY2hpbGRyZW46IGdyaWRTdGVwcy5tYXAoKGdyaWRTdGVwLCBpbmRleCkgPT4gKGpzeHMoXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic3hfX3dlZWstZ3JpZF9faG91clwiLCBjaGlsZHJlbjogW2hvdXJDdXN0b21Db21wb25lbnRGbiAmJiBob3VyQ0NJRHMubGVuZ3RoICYmIChqc3goXCJkaXZcIiwgeyBcImRhdGEtY2NpZFwiOiBob3VyQ0NJRHNbaW5kZXhdIH0pKSwgIWhvdXJDdXN0b21Db21wb25lbnRGbiAmJiAoanN4KFwic3BhblwiLCB7IGNsYXNzTmFtZTogXCJzeF9fd2Vlay1ncmlkX19ob3VyLXRleHRcIiwgY2hpbGRyZW46IGZvcm1hdHRlci5mb3JtYXQobmV3IERhdGUoMCwgMCwgMCwgZ3JpZFN0ZXAuaG91ciwgZ3JpZFN0ZXAubWludXRlKSkgfSkpXSB9KSkpIH0pIH0pKTtcbn1cblxuZnVuY3Rpb24gRGF0ZUF4aXMoeyB3ZWVrIH0pIHtcbiAgICBjb25zdCAkYXBwID0gdXNlQ29udGV4dChBcHBDb250ZXh0KTtcbiAgICBjb25zdCBnZXRDbGFzc05hbWVzID0gKGRhdGUpID0+IHtcbiAgICAgICAgY29uc3QgY2xhc3NOYW1lcyA9IFtcbiAgICAgICAgICAgICdzeF9fd2Vlay1ncmlkX19kYXRlJyxcbiAgICAgICAgICAgIGdldENsYXNzTmFtZUZvcldlZWtkYXkoZGF0ZS5kYXlPZldlZWspLFxuICAgICAgICBdO1xuICAgICAgICBpZiAoaXNUb2RheShkYXRlLCAkYXBwLmNvbmZpZy50aW1lem9uZS52YWx1ZSkpIHtcbiAgICAgICAgICAgIGNsYXNzTmFtZXMucHVzaCgnc3hfX3dlZWstZ3JpZF9fZGF0ZS0taXMtdG9kYXknKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2xhc3NOYW1lcy5qb2luKCcgJyk7XG4gICAgfTtcbiAgICBjb25zdCB3ZWVrR3JpZERhdGVDdXN0b21Db21wb25lbnRGbiA9ICRhcHAuY29uZmlnLl9jdXN0b21Db21wb25lbnRGbnMud2Vla0dyaWREYXRlO1xuICAgIGNvbnN0IHdlZWtHcmlkRGF0ZUNDSURzID0gdXNlU3RhdGUoKCkgPT4gQXJyYXkuZnJvbSh7IGxlbmd0aDogNyB9LCAoKSA9PiBgY3VzdG9tLXdlZWstZ3JpZC1kYXRlLSR7cmFuZG9tU3RyaW5nSWQoKX1gKSk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKHdlZWtHcmlkRGF0ZUN1c3RvbUNvbXBvbmVudEZuKSB7XG4gICAgICAgICAgICB3ZWVrLmZvckVhY2goKGRhdGUsIGlkeCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgW2RhdGEtY2NpZD1cIiR7d2Vla0dyaWREYXRlQ0NJRHNbMF1baWR4XX1cIl1gKTtcbiAgICAgICAgICAgICAgICBpZiAoIShlbCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29uc29sZS53YXJuKCdDb3VsZCBub3QgZmluZCBlbGVtZW50IGZvciBjdXN0b20gY29tcG9uZW50IHdlZWtHcmlkRGF0ZScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB3ZWVrR3JpZERhdGVDdXN0b21Db21wb25lbnRGbihlbCwge1xuICAgICAgICAgICAgICAgICAgICBkYXRlOiB0b0RhdGVTdHJpbmckMShkYXRlKSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSwgW3dlZWtdKTtcbiAgICByZXR1cm4gKGpzeChGcmFnbWVudCwgeyBjaGlsZHJlbjoganN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X193ZWVrLWdyaWRfX2RhdGUtYXhpc1wiLCBjaGlsZHJlbjogd2Vlay5tYXAoKGRhdGUsIGlkeCkgPT4gKGpzeHMoXCJkaXZcIiwgeyBjbGFzc05hbWU6IGdldENsYXNzTmFtZXMoZGF0ZSksIFwiZGF0YS1kYXRlXCI6IHRvRGF0ZVN0cmluZyQxKGRhdGUpLCBjaGlsZHJlbjogW3dlZWtHcmlkRGF0ZUN1c3RvbUNvbXBvbmVudEZuICYmIChqc3goXCJkaXZcIiwgeyBcImRhdGEtY2NpZFwiOiB3ZWVrR3JpZERhdGVDQ0lEc1swXVtpZHhdIH0pKSwgIXdlZWtHcmlkRGF0ZUN1c3RvbUNvbXBvbmVudEZuICYmIChqc3hzKEZyYWdtZW50LCB7IGNoaWxkcmVuOiBbanN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X193ZWVrLWdyaWRfX2RheS1uYW1lXCIsIGNoaWxkcmVuOiBnZXREYXlOYW1lU2hvcnQoZGF0ZSwgJGFwcC5jb25maWcubG9jYWxlLnZhbHVlKSB9KSwganN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X193ZWVrLWdyaWRfX2RhdGUtbnVtYmVyXCIsIGNoaWxkcmVuOiBkYXRlLmRheSB9KV0gfSkpXSB9KSkpIH0pIH0pKTtcbn1cblxuY29uc3Qgc29ydEV2ZW50c0ZvcldlZWtWaWV3ID0gKGFsbENhbGVuZGFyRXZlbnRzKSA9PiB7XG4gICAgY29uc3QgZGF0ZUdyaWRFdmVudHMgPSBbXTtcbiAgICBjb25zdCB0aW1lR3JpZEV2ZW50cyA9IFtdO1xuICAgIGZvciAoY29uc3QgZXZlbnQgb2YgYWxsQ2FsZW5kYXJFdmVudHMpIHtcbiAgICAgICAgaWYgKGV2ZW50Ll9pc1NpbmdsZURheVRpbWVkIHx8IGV2ZW50Ll9pc1NpbmdsZUh5YnJpZERheVRpbWVkKSB7XG4gICAgICAgICAgICB0aW1lR3JpZEV2ZW50cy5wdXNoKGV2ZW50KTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChldmVudC5faXNTaW5nbGVEYXlGdWxsRGF5IHx8XG4gICAgICAgICAgICBldmVudC5faXNNdWx0aURheUZ1bGxEYXkgfHxcbiAgICAgICAgICAgIGV2ZW50Ll9pc011bHRpRGF5VGltZWQpIHtcbiAgICAgICAgICAgIGRhdGVHcmlkRXZlbnRzLnB1c2goZXZlbnQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7IHRpbWVHcmlkRXZlbnRzLCBkYXRlR3JpZEV2ZW50cyB9O1xufTtcblxuY29uc3QgY3JlYXRlT25lRGF5ID0gKHdlZWssIGRhdGUpID0+IHtcbiAgICBjb25zdCBkYXRlU3RyaW5nID0gdG9EYXRlU3RyaW5nJDEoZGF0ZSk7XG4gICAgd2Vla1tkYXRlU3RyaW5nXSA9IHtcbiAgICAgICAgZGF0ZTogZGF0ZVN0cmluZyxcbiAgICAgICAgdGltZUdyaWRFdmVudHM6IFtdLFxuICAgICAgICBkYXRlR3JpZEV2ZW50czoge30sXG4gICAgICAgIGJhY2tncm91bmRFdmVudHM6IFtdLFxuICAgIH07XG4gICAgcmV0dXJuIHdlZWs7XG59O1xuY29uc3QgY3JlYXRlV2VlayA9ICgkYXBwKSA9PiB7XG4gICAgaWYgKCRhcHAuY2FsZW5kYXJTdGF0ZS52aWV3LnZhbHVlID09PSBJbnRlcm5hbFZpZXdOYW1lLkRheSlcbiAgICAgICAgcmV0dXJuIGNyZWF0ZU9uZURheSh7fSwgJGFwcC5jYWxlbmRhclN0YXRlLnJhbmdlLnZhbHVlLnN0YXJ0KTtcbiAgICAvLyBXZWVrIG1vZGVcbiAgICByZXR1cm4gJGFwcC50aW1lVW5pdHNJbXBsXG4gICAgICAgIC5nZXRXZWVrRm9yKCRhcHAuZGF0ZVBpY2tlclN0YXRlLnNlbGVjdGVkRGF0ZS52YWx1ZSlcbiAgICAgICAgLnNsaWNlKDAsICRhcHAuY29uZmlnLndlZWtPcHRpb25zLnZhbHVlLm5EYXlzKVxuICAgICAgICAucmVkdWNlKGNyZWF0ZU9uZURheSwge30pO1xufTtcblxuY29uc3QgcG9zaXRpb25JblRpbWVHcmlkID0gKHRpbWVHcmlkRXZlbnRzLCB3ZWVrLCAkYXBwKSA9PiB7XG4gICAgdmFyIF9hO1xuICAgIGZvciAoY29uc3QgZXZlbnQgb2YgdGltZUdyaWRFdmVudHMpIHtcbiAgICAgICAgY29uc3QgcmFuZ2UgPSAkYXBwLmNhbGVuZGFyU3RhdGUucmFuZ2UudmFsdWU7XG4gICAgICAgIGlmIChldmVudC5zdGFydC5lcG9jaE5hbm9zZWNvbmRzID49XG4gICAgICAgICAgICByYW5nZS5zdGFydC5lcG9jaE5hbm9zZWNvbmRzICYmXG4gICAgICAgICAgICBldmVudC5lbmQuZXBvY2hOYW5vc2Vjb25kcyA8PVxuICAgICAgICAgICAgICAgIHJhbmdlLmVuZC5lcG9jaE5hbm9zZWNvbmRzKSB7XG4gICAgICAgICAgICBsZXQgZGF0ZSA9IGRhdGVGcm9tRGF0ZVRpbWUoZXZlbnQuc3RhcnQudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICBpZiAoJGFwcC5jb25maWcuaXNIeWJyaWREYXkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IHllYXIsIG1vbnRoLCBkYXRlOiBkYXkgfSA9IHRvSW50ZWdlcnMoZGF0ZSk7XG4gICAgICAgICAgICAgICAgY29uc3QgcHJldmlvdXNEYXlTdGFydCA9IGAke2FkZERheXMoVGVtcG9yYWwuUGxhaW5EYXRlLmZyb20oeyB5ZWFyLCBtb250aDogbW9udGggKyAxLCBkYXkgfSksIC0xKX0gJHt0aW1lU3RyaW5nRnJvbVRpbWVQb2ludHMoJGFwcC5jb25maWcuZGF5Qm91bmRhcmllcy52YWx1ZS5zdGFydCl9YDtcbiAgICAgICAgICAgICAgICBjb25zdCBwcmV2aW91c0RheUVuZCA9IGAke2RhdGV9ICR7dGltZVN0cmluZ0Zyb21UaW1lUG9pbnRzKCRhcHAuY29uZmlnLmRheUJvdW5kYXJpZXMudmFsdWUuZW5kKX1gO1xuICAgICAgICAgICAgICAgIGNvbnN0IGFjdHVhbERheVN0YXJ0ID0gYCR7ZGF0ZX0gJHt0aW1lU3RyaW5nRnJvbVRpbWVQb2ludHMoJGFwcC5jb25maWcuZGF5Qm91bmRhcmllcy52YWx1ZS5zdGFydCl9YDtcbiAgICAgICAgICAgICAgICBjb25zdCBldmVudFN0YXJ0WkRUID0gZXZlbnQuc3RhcnQ7XG4gICAgICAgICAgICAgICAgY29uc3QgZXZlbnRTdGFydEZsb2F0aW5nID0gYCR7ZXZlbnRTdGFydFpEVC55ZWFyfS0ke2RvdWJsZURpZ2l0KGV2ZW50U3RhcnRaRFQubW9udGgpfS0ke2RvdWJsZURpZ2l0KGV2ZW50U3RhcnRaRFQuZGF5KX0gJHtkb3VibGVEaWdpdChldmVudFN0YXJ0WkRULmhvdXIpfToke2RvdWJsZURpZ2l0KGV2ZW50U3RhcnRaRFQubWludXRlKX1gO1xuICAgICAgICAgICAgICAgIGlmIChldmVudFN0YXJ0RmxvYXRpbmcgPiBwcmV2aW91c0RheVN0YXJ0ICYmXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50U3RhcnRGbG9hdGluZyA8IHByZXZpb3VzRGF5RW5kICYmXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50U3RhcnRGbG9hdGluZyA8IGFjdHVhbERheVN0YXJ0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHsgeWVhciwgbW9udGgsIGRhdGU6IGRheSB9ID0gdG9JbnRlZ2VycyhkYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgZGF0ZSA9IGRhdGVGcm9tRGF0ZVRpbWUoYWRkRGF5cyhUZW1wb3JhbC5QbGFpbkRhdGUuZnJvbSh7IHllYXIsIG1vbnRoOiBtb250aCArIDEsIGRheSB9KSwgLTEpLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIChfYSA9IHdlZWtbZGF0ZV0pID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS50aW1lR3JpZEV2ZW50cy5wdXNoKGV2ZW50KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gd2Vlaztcbn07XG5cbkludGVybmFsVmlld05hbWUuV2VlaztcbmNvbnN0IERFRkFVTFRfREFZX0JPVU5EQVJJRVMgPSB7XG4gICAgc3RhcnQ6IDAsXG4gICAgZW5kOiAyNDAwLFxufTtcbmNvbnN0IERFRkFVTFRfV0VFS19HUklEX0hFSUdIVCA9IDE2MDA7XG5jb25zdCBEQVRFX0dSSURfQkxPQ0tFUiA9ICdibG9ja2VyJztcblxuLyoqXG4gKiBDcmVhdGUgYSB0YWJsZS1saWtlIHJlcHJlc2VudGF0aW9uIG9mIHRoZSB3ZWVrLCB3aGVyZSBlYWNoIGNlbGwgY2FuIGhvbGQgYSBmdWxsLWRheSBldmVudCBvciBtdWx0aXBsZS1kYXktdGltZWQgZXZlbnQuXG4gKiBJZiBhbiBldmVudCBsYXN0cyBtb3JlIHRoYW4gb25lIGRheSwgaXQgY3JlYXRlcyBibG9ja2VycyBpbiB0aGUgZ3JpZCBmb3IgaXRzIHN1YnNlcXVlbnQgZGF5cywgc28gdGhhdCBldmVudHMgZG9uJ3QgY29sbGlkZS5cbiAqIEZvciBleGFtcGxlOlxuICpcbiAqIHwgIE1vICAgIHwgVHVlICAgIHwgICBXZSAgIHwgIFRodSAgIHwgIEZyaSAgIHwgU2F0ICAgIHwgU3VuICAgIHxcbiAqIHwgZTEgICAgIHwgYmxvY2tlcnwgYmxvY2tlcnwgYmxvY2tlcnwgYmxvY2tlcnwgYmxvY2tlcnwgYmxvY2tlcnxcbiAqIHwgICAgICAgIHwgIGUyICAgIHwgYmxvY2tlcnwgICAgICAgIHwgIGU0ICAgIHwgICAgICAgIHwgICAgICAgIHxcbiAqIHwgICAgICAgIHwgICAgICAgIHwgIGUzICAgIHwgICAgICAgIHwgICAgICAgIHwgICAgICAgIHwgICAgICAgIHxcbiAqICovXG5jb25zdCBwb3NpdGlvbkluRGF0ZUdyaWQgPSAoc29ydGVkRGF0ZUdyaWRFdmVudHMsIHdlZWspID0+IHtcbiAgICBjb25zdCB3ZWVrRGF0ZXMgPSBPYmplY3Qua2V5cyh3ZWVrKS5zb3J0KCk7XG4gICAgY29uc3QgZmlyc3REYXRlT2ZXZWVrID0gd2Vla0RhdGVzWzBdO1xuICAgIGNvbnN0IGxhc3REYXRlT2ZXZWVrID0gd2Vla0RhdGVzW3dlZWtEYXRlcy5sZW5ndGggLSAxXTtcbiAgICBjb25zdCBvY2N1cGllZExldmVscyA9IG5ldyBTZXQoKTtcbiAgICBmb3IgKGNvbnN0IGV2ZW50IG9mIHNvcnRlZERhdGVHcmlkRXZlbnRzKSB7XG4gICAgICAgIGNvbnN0IGV2ZW50T3JpZ2luYWxTdGFydERhdGUgPSBkYXRlRnJvbURhdGVUaW1lKGV2ZW50LnN0YXJ0LnRvU3RyaW5nKCkpO1xuICAgICAgICBjb25zdCBldmVudE9yaWdpbmFsRW5kRGF0ZSA9IGRhdGVGcm9tRGF0ZVRpbWUoZXZlbnQuZW5kLnRvU3RyaW5nKCkpO1xuICAgICAgICBjb25zdCBpc0V2ZW50U3RhcnRJbldlZWsgPSAhIXdlZWtbZXZlbnRPcmlnaW5hbFN0YXJ0RGF0ZV07XG4gICAgICAgIGxldCBpc0V2ZW50SW5XZWVrID0gaXNFdmVudFN0YXJ0SW5XZWVrO1xuICAgICAgICBpZiAoIWlzRXZlbnRTdGFydEluV2VlayAmJlxuICAgICAgICAgICAgZXZlbnRPcmlnaW5hbFN0YXJ0RGF0ZSA8IGZpcnN0RGF0ZU9mV2VlayAmJlxuICAgICAgICAgICAgZXZlbnRPcmlnaW5hbEVuZERhdGUgPj0gZmlyc3REYXRlT2ZXZWVrKSB7XG4gICAgICAgICAgICBpc0V2ZW50SW5XZWVrID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWlzRXZlbnRJbldlZWspXG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgY29uc3QgZmlyc3REYXRlT2ZFdmVudCA9IGlzRXZlbnRTdGFydEluV2Vla1xuICAgICAgICAgICAgPyBldmVudE9yaWdpbmFsU3RhcnREYXRlXG4gICAgICAgICAgICA6IGZpcnN0RGF0ZU9mV2VlaztcbiAgICAgICAgY29uc3QgbGFzdERhdGVPZkV2ZW50ID0gZXZlbnRPcmlnaW5hbEVuZERhdGUgPD0gbGFzdERhdGVPZldlZWtcbiAgICAgICAgICAgID8gZXZlbnRPcmlnaW5hbEVuZERhdGVcbiAgICAgICAgICAgIDogbGFzdERhdGVPZldlZWs7XG4gICAgICAgIGNvbnN0IGV2ZW50RGF5cyA9IE9iamVjdC52YWx1ZXMod2VlaykuZmlsdGVyKChkYXkpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBkYXkuZGF0ZSA+PSBmaXJzdERhdGVPZkV2ZW50ICYmIGRheS5kYXRlIDw9IGxhc3REYXRlT2ZFdmVudDtcbiAgICAgICAgfSk7XG4gICAgICAgIGxldCBsZXZlbEluV2Vla0ZvckV2ZW50O1xuICAgICAgICBsZXQgdGVzdExldmVsID0gMDtcbiAgICAgICAgd2hpbGUgKGxldmVsSW5XZWVrRm9yRXZlbnQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY29uc3QgaXNMZXZlbEZyZWUgPSBldmVudERheXMuZXZlcnkoKGRheSkgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiAhZGF5LmRhdGVHcmlkRXZlbnRzW3Rlc3RMZXZlbF07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChpc0xldmVsRnJlZSkge1xuICAgICAgICAgICAgICAgIGxldmVsSW5XZWVrRm9yRXZlbnQgPSB0ZXN0TGV2ZWw7XG4gICAgICAgICAgICAgICAgb2NjdXBpZWRMZXZlbHMuYWRkKHRlc3RMZXZlbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgdGVzdExldmVsKys7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCBbZXZlbnREYXlJbmRleCwgZXZlbnREYXldIG9mIGV2ZW50RGF5cy5lbnRyaWVzKCkpIHtcbiAgICAgICAgICAgIGlmIChldmVudERheUluZGV4ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgZXZlbnQuX25EYXlzSW5HcmlkID0gZXZlbnREYXlzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBldmVudERheS5kYXRlR3JpZEV2ZW50c1tsZXZlbEluV2Vla0ZvckV2ZW50XSA9IGV2ZW50O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZXZlbnREYXkuZGF0ZUdyaWRFdmVudHNbbGV2ZWxJbldlZWtGb3JFdmVudF0gPSBEQVRFX0dSSURfQkxPQ0tFUjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBmb3IgKGNvbnN0IGxldmVsIG9mIEFycmF5LmZyb20ob2NjdXBpZWRMZXZlbHMpKSB7XG4gICAgICAgIGZvciAoY29uc3QgWywgZGF5XSBvZiBPYmplY3QuZW50cmllcyh3ZWVrKSkge1xuICAgICAgICAgICAgaWYgKCFkYXkuZGF0ZUdyaWRFdmVudHNbbGV2ZWxdKSB7XG4gICAgICAgICAgICAgICAgZGF5LmRhdGVHcmlkRXZlbnRzW2xldmVsXSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gd2Vlaztcbn07XG5cbmNvbnN0IGdldFdpZHRoVG9TdWJ0cmFjdCA9IChoYXNPdmVyZmxvd0xlZnQsIGhhc092ZXJmbG93UmlnaHQsIGVuYWJsZU92ZXJmbG93U3VidHJhY3Rpb24pID0+IHtcbiAgICBsZXQgd2lkdGhUb1N1YnRyYWN0ID0gMjsgLy8gMnB4IGZvciBhbGwgZXZlbnRzLCB0byBsZWF2ZSBzb21lIHNwYWNlIGJldHdlZW4gdGhlbVxuICAgIGNvbnN0IGV2ZW50T3ZlcmZsb3dNYXJnaW4gPSAxMDsgLy8gQ09SUkVMQVRJT04gSUQ6IDFcbiAgICBpZiAoaGFzT3ZlcmZsb3dMZWZ0ICYmIGVuYWJsZU92ZXJmbG93U3VidHJhY3Rpb24pXG4gICAgICAgIHdpZHRoVG9TdWJ0cmFjdCArPSBldmVudE92ZXJmbG93TWFyZ2luO1xuICAgIGlmIChoYXNPdmVyZmxvd1JpZ2h0ICYmIGVuYWJsZU92ZXJmbG93U3VidHJhY3Rpb24pXG4gICAgICAgIHdpZHRoVG9TdWJ0cmFjdCArPSBldmVudE92ZXJmbG93TWFyZ2luO1xuICAgIHJldHVybiB3aWR0aFRvU3VidHJhY3Q7XG59O1xuY29uc3QgZ2V0Qm9yZGVyUmFkaXVzID0gKGhhc092ZXJmbG93TGVmdCwgaGFzT3ZlcmZsb3dSaWdodCwgZm9yY2VaZXJvUnVsZSkgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICAgIGJvcmRlckJvdHRvbUxlZnRSYWRpdXM6IGhhc092ZXJmbG93TGVmdCB8fCBmb3JjZVplcm9SdWxlID8gMCA6IHVuZGVmaW5lZCxcbiAgICAgICAgYm9yZGVyVG9wTGVmdFJhZGl1czogaGFzT3ZlcmZsb3dMZWZ0IHx8IGZvcmNlWmVyb1J1bGUgPyAwIDogdW5kZWZpbmVkLFxuICAgICAgICBib3JkZXJCb3R0b21SaWdodFJhZGl1czogaGFzT3ZlcmZsb3dSaWdodCB8fCBmb3JjZVplcm9SdWxlID8gMCA6IHVuZGVmaW5lZCxcbiAgICAgICAgYm9yZGVyVG9wUmlnaHRSYWRpdXM6IGhhc092ZXJmbG93UmlnaHQgfHwgZm9yY2VaZXJvUnVsZSA/IDAgOiB1bmRlZmluZWQsXG4gICAgfTtcbn07XG5cbmZ1bmN0aW9uIERhdGVHcmlkRXZlbnQoeyBjYWxlbmRhckV2ZW50LCBncmlkUm93LCBpc0NvcHksIH0pIHtcbiAgICB2YXIgX2EsIF9iLCBfYywgX2Q7XG4gICAgY29uc3QgJGFwcCA9IHVzZUNvbnRleHQoQXBwQ29udGV4dCk7XG4gICAgY29uc3QgeyBldmVudENvcHksIHVwZGF0ZUNvcHksIGNyZWF0ZURyYWdTdGFydFRpbWVvdXQsIHNldENsaWNrZWRFdmVudElmTm90RHJhZ2dpbmcsIHNldENsaWNrZWRFdmVudCwgfSA9IHVzZUV2ZW50SW50ZXJhY3Rpb25zKCRhcHApO1xuICAgIGNvbnN0IGV2ZW50Q1NTVmFyaWFibGVzID0ge1xuICAgICAgICBib3JkZXJJbmxpbmVTdGFydDogYDRweCBzb2xpZCB2YXIoLS1zeC1jb2xvci0ke2NhbGVuZGFyRXZlbnQuX2NvbG9yfSlgLFxuICAgICAgICBjb2xvcjogYHZhcigtLXN4LWNvbG9yLW9uLSR7Y2FsZW5kYXJFdmVudC5fY29sb3J9LWNvbnRhaW5lcilgLFxuICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IGB2YXIoLS1zeC1jb2xvci0ke2NhbGVuZGFyRXZlbnQuX2NvbG9yfS1jb250YWluZXIpYCxcbiAgICB9O1xuICAgIGNvbnN0IGhhbmRsZVN0YXJ0RHJhZyA9ICh1aUV2ZW50KSA9PiB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgaWYgKCEkYXBwLmNvbmZpZy5wbHVnaW5zLmRyYWdBbmREcm9wKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBpZiAoKF9hID0gY2FsZW5kYXJFdmVudC5fb3B0aW9ucykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmRpc2FibGVETkQpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGlmIChpc1VJRXZlbnRUb3VjaEV2ZW50KHVpRXZlbnQpKVxuICAgICAgICAgICAgdWlFdmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBjb25zdCBuZXdFdmVudENvcHkgPSBkZWVwQ2xvbmVFdmVudChjYWxlbmRhckV2ZW50LCAkYXBwKTtcbiAgICAgICAgdXBkYXRlQ29weShuZXdFdmVudENvcHkpO1xuICAgICAgICAkYXBwLmNvbmZpZy5wbHVnaW5zLmRyYWdBbmREcm9wLmNyZWF0ZURhdGVHcmlkRHJhZ0hhbmRsZXIoe1xuICAgICAgICAgICAgZXZlbnRDb29yZGluYXRlczogZ2V0RXZlbnRDb29yZGluYXRlcyh1aUV2ZW50KSxcbiAgICAgICAgICAgIGV2ZW50Q29weTogbmV3RXZlbnRDb3B5LFxuICAgICAgICAgICAgdXBkYXRlQ29weSxcbiAgICAgICAgICAgICRhcHAsXG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgY29uc3QgcmFuZ2VTdGFydEZvckNvbXBhcmlzb24gPSBjYWxlbmRhckV2ZW50LnN0YXJ0IGluc3RhbmNlb2YgVGVtcG9yYWwuWm9uZWREYXRlVGltZVxuICAgICAgICA/ICRhcHAuY2FsZW5kYXJTdGF0ZS5yYW5nZS52YWx1ZS5zdGFydC50b1N0cmluZygpXG4gICAgICAgIDogVGVtcG9yYWwuUGxhaW5EYXRlLmZyb20oe1xuICAgICAgICAgICAgeWVhcjogJGFwcC5jYWxlbmRhclN0YXRlLnJhbmdlLnZhbHVlLnN0YXJ0LnllYXIsXG4gICAgICAgICAgICBtb250aDogJGFwcC5jYWxlbmRhclN0YXRlLnJhbmdlLnZhbHVlLnN0YXJ0Lm1vbnRoLFxuICAgICAgICAgICAgZGF5OiAkYXBwLmNhbGVuZGFyU3RhdGUucmFuZ2UudmFsdWUuc3RhcnQuZGF5LFxuICAgICAgICB9KS50b1N0cmluZygpO1xuICAgIGNvbnN0IHJhbmdlRW5kRm9yQ29tcGFyaXNvbiA9IGNhbGVuZGFyRXZlbnQuZW5kIGluc3RhbmNlb2YgVGVtcG9yYWwuWm9uZWREYXRlVGltZVxuICAgICAgICA/ICRhcHAuY2FsZW5kYXJTdGF0ZS5yYW5nZS52YWx1ZS5lbmQudG9TdHJpbmcoKVxuICAgICAgICA6IFRlbXBvcmFsLlBsYWluRGF0ZS5mcm9tKHtcbiAgICAgICAgICAgIHllYXI6ICRhcHAuY2FsZW5kYXJTdGF0ZS5yYW5nZS52YWx1ZS5lbmQueWVhcixcbiAgICAgICAgICAgIG1vbnRoOiAkYXBwLmNhbGVuZGFyU3RhdGUucmFuZ2UudmFsdWUuZW5kLm1vbnRoLFxuICAgICAgICAgICAgZGF5OiAkYXBwLmNhbGVuZGFyU3RhdGUucmFuZ2UudmFsdWUuZW5kLmRheSxcbiAgICAgICAgfSkudG9TdHJpbmcoKTtcbiAgICBjb25zdCBzdGFydHNCZWZvcmVXZWVrID0gY2FsZW5kYXJFdmVudC5zdGFydC50b1N0cmluZygpIDwgcmFuZ2VTdGFydEZvckNvbXBhcmlzb247XG4gICAgY29uc3QgZW5kc0FmdGVyV2VlayA9IGNhbGVuZGFyRXZlbnQuZW5kLnRvU3RyaW5nKCkgPiByYW5nZUVuZEZvckNvbXBhcmlzb247XG4gICAgY29uc3QgaGFzT3ZlcmZsb3dMZWZ0ID0gdXNlTWVtbygoKSA9PiB7XG4gICAgICAgIGlmICgkYXBwLmNvbmZpZy5kaXJlY3Rpb24gPT09ICdsdHInKSB7XG4gICAgICAgICAgICByZXR1cm4gc3RhcnRzQmVmb3JlV2VlaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZW5kc0FmdGVyV2VlaztcbiAgICB9LCBbc3RhcnRzQmVmb3JlV2VlaywgZW5kc0FmdGVyV2Vla10pO1xuICAgIGNvbnN0IGhhc092ZXJmbG93UmlnaHQgPSB1c2VNZW1vKCgpID0+IHtcbiAgICAgICAgaWYgKCRhcHAuY29uZmlnLmRpcmVjdGlvbiA9PT0gJ2x0cicpIHtcbiAgICAgICAgICAgIHJldHVybiBlbmRzQWZ0ZXJXZWVrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdGFydHNCZWZvcmVXZWVrO1xuICAgIH0sIFtzdGFydHNCZWZvcmVXZWVrLCBlbmRzQWZ0ZXJXZWVrXSk7XG4gICAgY29uc3Qgb3ZlcmZsb3dTdHlsZXMgPSB7IGJhY2tncm91bmRDb2xvcjogZXZlbnRDU1NWYXJpYWJsZXMuYmFja2dyb3VuZENvbG9yIH07XG4gICAgY29uc3QgY3VzdG9tQ29tcG9uZW50ID0gJGFwcC5jb25maWcuX2N1c3RvbUNvbXBvbmVudEZucy5kYXRlR3JpZEV2ZW50O1xuICAgIGNvbnN0IGN1c3RvbUNvbXBvbmVudElkID0gdXNlUmVmJDEoY3VzdG9tQ29tcG9uZW50XG4gICAgICAgID8gJ2N1c3RvbS1kYXRlLWdyaWQtZXZlbnQtJyArIHJhbmRvbVN0cmluZ0lkKCkgLy8gbmVlZHMgYSB1bmlxdWUgc3RyaW5nIHRvIHN1cHBvcnQgZXZlbnQgcmVjdXJyZW5jZVxuICAgICAgICA6IHVuZGVmaW5lZCk7XG4gICAgaWYgKGlzQ29weSAmJiBjdXN0b21Db21wb25lbnRJZC5jdXJyZW50KVxuICAgICAgICBjdXN0b21Db21wb25lbnRJZC5jdXJyZW50ICs9ICctY29weSc7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKCFjdXN0b21Db21wb25lbnQpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGN1c3RvbUNvbXBvbmVudChnZXRFbGVtZW50QnlDQ0lEKGN1c3RvbUNvbXBvbmVudElkLmN1cnJlbnQpLCB7XG4gICAgICAgICAgICBjYWxlbmRhckV2ZW50OiBjYWxlbmRhckV2ZW50Ll9nZXRFeHRlcm5hbEV2ZW50KCksXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgICAgIChfYiA9IChfYSA9ICRhcHAuY29uZmlnKS5fZGVzdHJveUN1c3RvbUNvbXBvbmVudEluc3RhbmNlKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuY2FsbChfYSwgY3VzdG9tQ29tcG9uZW50SWQuY3VycmVudCk7XG4gICAgICAgIH07XG4gICAgfSwgW2NhbGVuZGFyRXZlbnQsIGV2ZW50Q29weV0pO1xuICAgIGNvbnN0IHN0YXJ0UmVzaXplID0gKG1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgbW91c2VFdmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgY29uc3QgZXZlbnRDb3B5ID0gZGVlcENsb25lRXZlbnQoY2FsZW5kYXJFdmVudCwgJGFwcCk7XG4gICAgICAgIHVwZGF0ZUNvcHkoZXZlbnRDb3B5KTtcbiAgICAgICAgJGFwcC5jb25maWcucGx1Z2lucy5yZXNpemUuY3JlYXRlRGF0ZUdyaWRFdmVudFJlc2l6ZXIoZXZlbnRDb3B5LCB1cGRhdGVDb3B5LCBtb3VzZUV2ZW50KTtcbiAgICB9O1xuICAgIGNvbnN0IGhhbmRsZUtleURvd24gPSAoZSkgPT4ge1xuICAgICAgICBpZiAoZS5rZXkgPT09ICdFbnRlcicgfHwgZS5rZXkgPT09ICcgJykge1xuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgIHNldENsaWNrZWRFdmVudChlLCBjYWxlbmRhckV2ZW50KTtcbiAgICAgICAgICAgIGludm9rZU9uRXZlbnRDbGlja0NhbGxiYWNrKCRhcHAsIGNhbGVuZGFyRXZlbnQsIGUpO1xuICAgICAgICAgICAgbmV4dFRpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgIGZvY3VzTW9kYWwoJGFwcCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3QgZXZlbnRDbGFzc2VzID0gW1xuICAgICAgICAnc3hfX2V2ZW50JyxcbiAgICAgICAgJ3N4X19kYXRlLWdyaWQtZXZlbnQnLFxuICAgICAgICAnc3hfX2RhdGUtZ3JpZC1jZWxsJyxcbiAgICBdO1xuICAgIGlmIChpc0NvcHkpXG4gICAgICAgIGV2ZW50Q2xhc3Nlcy5wdXNoKCdzeF9fZGF0ZS1ncmlkLWV2ZW50LS1jb3B5Jyk7XG4gICAgaWYgKHdhc0V2ZW50QWRkZWRJbkxhc3RTZWNvbmQoY2FsZW5kYXJFdmVudCkpXG4gICAgICAgIGV2ZW50Q2xhc3Nlcy5wdXNoKCdpcy1ldmVudC1uZXcnKTtcbiAgICBpZiAoaGFzT3ZlcmZsb3dMZWZ0KVxuICAgICAgICBldmVudENsYXNzZXMucHVzaCgnc3hfX2RhdGUtZ3JpZC1ldmVudC0tb3ZlcmZsb3ctbGVmdCcpO1xuICAgIGlmIChoYXNPdmVyZmxvd1JpZ2h0KVxuICAgICAgICBldmVudENsYXNzZXMucHVzaCgnc3hfX2RhdGUtZ3JpZC1ldmVudC0tb3ZlcmZsb3ctcmlnaHQnKTtcbiAgICBpZiAoKF9hID0gY2FsZW5kYXJFdmVudC5fb3B0aW9ucykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmFkZGl0aW9uYWxDbGFzc2VzKVxuICAgICAgICBldmVudENsYXNzZXMucHVzaCguLi5jYWxlbmRhckV2ZW50Ll9vcHRpb25zLmFkZGl0aW9uYWxDbGFzc2VzKTtcbiAgICBjb25zdCBib3JkZXJJbmxpbmVTdGFydE5vbkN1c3RvbSA9IHN0YXJ0c0JlZm9yZVdlZWtcbiAgICAgICAgPyAnbm9uZSdcbiAgICAgICAgOiBldmVudENTU1ZhcmlhYmxlcy5ib3JkZXJJbmxpbmVTdGFydDtcbiAgICBjb25zdCBoYXNDdXN0b21Db250ZW50ID0gKF9iID0gY2FsZW5kYXJFdmVudC5fY3VzdG9tQ29udGVudCkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmRhdGVHcmlkO1xuICAgIHJldHVybiAoanN4cyhGcmFnbWVudCwgeyBjaGlsZHJlbjogW2pzeHMoXCJkaXZcIiwgeyBpZDogaXNDb3B5ID8gZ2V0VGltZUdyaWRFdmVudENvcHlFbGVtZW50SWQoY2FsZW5kYXJFdmVudC5pZCkgOiB1bmRlZmluZWQsIHRhYkluZGV4OiAwLCBcImFyaWEtbGFiZWxcIjogY2FsZW5kYXJFdmVudC50aXRsZSArXG4gICAgICAgICAgICAgICAgICAgICcgJyArXG4gICAgICAgICAgICAgICAgICAgIGdldFRpbWVTdGFtcChjYWxlbmRhckV2ZW50LCAkYXBwLmNvbmZpZy5sb2NhbGUudmFsdWUsICRhcHAudHJhbnNsYXRlKCd0bycpKSwgcm9sZTogXCJidXR0b25cIiwgXCJkYXRhLWNjaWRcIjogY3VzdG9tQ29tcG9uZW50SWQuY3VycmVudCwgXCJkYXRhLWV2ZW50LWlkXCI6IGNhbGVuZGFyRXZlbnQuaWQsIG9uTW91c2VEb3duOiAoZSkgPT4gY3JlYXRlRHJhZ1N0YXJ0VGltZW91dChoYW5kbGVTdGFydERyYWcsIGUpLCBvbk1vdXNlVXA6IChlKSA9PiBzZXRDbGlja2VkRXZlbnRJZk5vdERyYWdnaW5nKGNhbGVuZGFyRXZlbnQsIGUpLCBvblRvdWNoU3RhcnQ6IChlKSA9PiBjcmVhdGVEcmFnU3RhcnRUaW1lb3V0KGhhbmRsZVN0YXJ0RHJhZywgZSksIG9uVG91Y2hFbmQ6IChlKSA9PiBzZXRDbGlja2VkRXZlbnRJZk5vdERyYWdnaW5nKGNhbGVuZGFyRXZlbnQsIGUpLCBvbkNsaWNrOiAoZSkgPT4gaW52b2tlT25FdmVudENsaWNrQ2FsbGJhY2soJGFwcCwgY2FsZW5kYXJFdmVudCwgZSksIG9uRGJsQ2xpY2s6IChlKSA9PiBpbnZva2VPbkV2ZW50RG91YmxlQ2xpY2tDYWxsYmFjaygkYXBwLCBjYWxlbmRhckV2ZW50LCBlKSwgb25LZXlEb3duOiBoYW5kbGVLZXlEb3duLCBjbGFzc05hbWU6IGV2ZW50Q2xhc3Nlcy5qb2luKCcgJyksIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiBgY2FsYygke2NhbGVuZGFyRXZlbnQuX25EYXlzSW5HcmlkICogMTAwfSUgLSAke2dldFdpZHRoVG9TdWJ0cmFjdChoYXNPdmVyZmxvd0xlZnQsIGhhc092ZXJmbG93UmlnaHQsICFjdXN0b21Db21wb25lbnQpfXB4KWAsXG4gICAgICAgICAgICAgICAgICAgIGdyaWRSb3csXG4gICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IGV2ZW50Q29weSA/ICdub25lJyA6ICdmbGV4JyxcbiAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogY3VzdG9tQ29tcG9uZW50ID8gJzBweCcgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgIGJvcmRlcklubGluZVN0YXJ0OiBjdXN0b21Db21wb25lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgID8gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgICAgICA6IGJvcmRlcklubGluZVN0YXJ0Tm9uQ3VzdG9tLFxuICAgICAgICAgICAgICAgICAgICBjb2xvcjogY3VzdG9tQ29tcG9uZW50ID8gdW5kZWZpbmVkIDogZXZlbnRDU1NWYXJpYWJsZXMuY29sb3IsXG4gICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogY3VzdG9tQ29tcG9uZW50XG4gICAgICAgICAgICAgICAgICAgICAgICA/IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgOiBldmVudENTU1ZhcmlhYmxlcy5iYWNrZ3JvdW5kQ29sb3IsXG4gICAgICAgICAgICAgICAgICAgIC4uLmdldEJvcmRlclJhZGl1cyhoYXNPdmVyZmxvd0xlZnQsIGhhc092ZXJmbG93UmlnaHQsICEhY3VzdG9tQ29tcG9uZW50KSxcbiAgICAgICAgICAgICAgICB9LCBjaGlsZHJlbjogWyFjdXN0b21Db21wb25lbnQgJiYgIWhhc0N1c3RvbUNvbnRlbnQgJiYgKGpzeHMoRnJhZ21lbnQkMSwgeyBjaGlsZHJlbjogW2hhc092ZXJmbG93TGVmdCAmJiAoanN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiAnc3hfX2RhdGUtZ3JpZC1ldmVudC0tbGVmdC1vdmVyZmxvdycsIHN0eWxlOiBvdmVyZmxvd1N0eWxlcyB9KSksIGpzeHMoXCJzcGFuXCIsIHsgY2xhc3NOYW1lOiBcInN4X19kYXRlLWdyaWQtZXZlbnQtdGV4dFwiLCBjaGlsZHJlbjogW2NhbGVuZGFyRXZlbnQudGl0bGUsIFwiIFxcdTAwQTBcIiwgY2FsZW5kYXJFdmVudC5zdGFydCBpbnN0YW5jZW9mIFRlbXBvcmFsLlpvbmVkRGF0ZVRpbWUgJiYgKGpzeChcInNwYW5cIiwgeyBjbGFzc05hbWU6IFwic3hfX2RhdGUtZ3JpZC1ldmVudC10aW1lXCIsIGNoaWxkcmVuOiB0aW1lRm4oY2FsZW5kYXJFdmVudC5zdGFydCwgJGFwcC5jb25maWcubG9jYWxlLnZhbHVlKSB9KSldIH0pLCBoYXNPdmVyZmxvd1JpZ2h0ICYmIChqc3goXCJkaXZcIiwgeyBjbGFzc05hbWU6ICdzeF9fZGF0ZS1ncmlkLWV2ZW50LS1yaWdodC1vdmVyZmxvdycsIHN0eWxlOiBvdmVyZmxvd1N0eWxlcyB9KSldIH0pKSwgaGFzQ3VzdG9tQ29udGVudCAmJiAoanN4KFwiZGl2XCIsIHsgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX2h0bWw6ICgoX2MgPSBjYWxlbmRhckV2ZW50Ll9jdXN0b21Db250ZW50KSA9PT0gbnVsbCB8fCBfYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2MuZGF0ZUdyaWQpIHx8ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSB9KSksICRhcHAuY29uZmlnLnBsdWdpbnMucmVzaXplICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAhKChfZCA9IGNhbGVuZGFyRXZlbnQuX29wdGlvbnMpID09PSBudWxsIHx8IF9kID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZC5kaXNhYmxlUmVzaXplKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgIWVuZHNBZnRlcldlZWsgJiYgKGpzeChcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJzeF9fZGF0ZS1ncmlkLWV2ZW50LXJlc2l6ZS1oYW5kbGVcIiwgb25Nb3VzZURvd246IHN0YXJ0UmVzaXplLCBvblRvdWNoU3RhcnQ6IHN0YXJ0UmVzaXplIH0pKV0gfSksIGV2ZW50Q29weSAmJiAoanN4KERhdGVHcmlkRXZlbnQsIHsgY2FsZW5kYXJFdmVudDogZXZlbnRDb3B5LCBncmlkUm93OiBncmlkUm93LCBpc0NvcHk6IHRydWUgfSkpXSB9KSk7XG59XG5cbmZ1bmN0aW9uIERhdGVHcmlkRGF5KHsgY2FsZW5kYXJFdmVudHMsIGRhdGUsIGJhY2tncm91bmRFdmVudHMsIH0pIHtcbiAgICBjb25zdCAkYXBwID0gdXNlQ29udGV4dChBcHBDb250ZXh0KTtcbiAgICBjb25zdCBkYXRlU3RhcnQgPSBUZW1wb3JhbC5ab25lZERhdGVUaW1lLmZyb20oe1xuICAgICAgICB5ZWFyOiBUZW1wb3JhbC5QbGFpbkRhdGUuZnJvbShkYXRlKS55ZWFyLFxuICAgICAgICBtb250aDogVGVtcG9yYWwuUGxhaW5EYXRlLmZyb20oZGF0ZSkubW9udGgsXG4gICAgICAgIGRheTogVGVtcG9yYWwuUGxhaW5EYXRlLmZyb20oZGF0ZSkuZGF5LFxuICAgICAgICBob3VyOiAkYXBwLmNvbmZpZy5kYXlCb3VuZGFyaWVzLnZhbHVlLnN0YXJ0ID09PSAwXG4gICAgICAgICAgICA/IDBcbiAgICAgICAgICAgIDogJGFwcC5jb25maWcuZGF5Qm91bmRhcmllcy52YWx1ZS5zdGFydCAvIDEwMCxcbiAgICAgICAgbWludXRlOiAwLFxuICAgICAgICBzZWNvbmQ6IDAsXG4gICAgICAgIHRpbWVab25lOiAkYXBwLmNvbmZpZy50aW1lem9uZS52YWx1ZSxcbiAgICB9KTtcbiAgICBsZXQgZGF0ZUVuZCA9IFRlbXBvcmFsLlpvbmVkRGF0ZVRpbWUuZnJvbSh7XG4gICAgICAgIHllYXI6IFRlbXBvcmFsLlBsYWluRGF0ZS5mcm9tKGRhdGUpLnllYXIsXG4gICAgICAgIG1vbnRoOiBUZW1wb3JhbC5QbGFpbkRhdGUuZnJvbShkYXRlKS5tb250aCxcbiAgICAgICAgZGF5OiBUZW1wb3JhbC5QbGFpbkRhdGUuZnJvbShkYXRlKS5kYXksXG4gICAgICAgIGhvdXI6ICRhcHAuY29uZmlnLmRheUJvdW5kYXJpZXMudmFsdWUuZW5kID09PSAyNDAwXG4gICAgICAgICAgICA/IDIzXG4gICAgICAgICAgICA6ICRhcHAuY29uZmlnLmRheUJvdW5kYXJpZXMudmFsdWUuZW5kIC8gMTAwLFxuICAgICAgICBtaW51dGU6ICRhcHAuY29uZmlnLmRheUJvdW5kYXJpZXMudmFsdWUuZW5kID09PSAyNDAwID8gNTkgOiAwLFxuICAgICAgICBzZWNvbmQ6ICRhcHAuY29uZmlnLmRheUJvdW5kYXJpZXMudmFsdWUuZW5kID09PSAyNDAwID8gNTkgOiAwLFxuICAgICAgICB0aW1lWm9uZTogJGFwcC5jb25maWcudGltZXpvbmUudmFsdWUsXG4gICAgfSk7XG4gICAgaWYgKCRhcHAuY29uZmlnLmlzSHlicmlkRGF5KSB7XG4gICAgICAgIGRhdGVFbmQgPSBkYXRlRW5kLmFkZCh7IGRheXM6IDEgfSk7XG4gICAgfVxuICAgIGNvbnN0IGZ1bGxEYXlCYWNrZ3JvdW5kRXZlbnQgPSBiYWNrZ3JvdW5kRXZlbnRzLmZpbmQoKGV2ZW50KSA9PiB7XG4gICAgICAgIGNvbnN0IGV2ZW50U3RhcnRXaXRoVGltZSA9IGV2ZW50LnN0YXJ0IGluc3RhbmNlb2YgVGVtcG9yYWwuUGxhaW5EYXRlXG4gICAgICAgICAgICA/IGV2ZW50LnN0YXJ0LnRvWm9uZWREYXRlVGltZSgkYXBwLmNvbmZpZy50aW1lem9uZS52YWx1ZSlcbiAgICAgICAgICAgIDogZXZlbnQuc3RhcnQ7XG4gICAgICAgIGNvbnN0IGV2ZW50RW5kV2l0aFRpbWUgPSBldmVudC5lbmQgaW5zdGFuY2VvZiBUZW1wb3JhbC5QbGFpbkRhdGVcbiAgICAgICAgICAgID8gZXZlbnQuZW5kLnRvWm9uZWREYXRlVGltZSgkYXBwLmNvbmZpZy50aW1lem9uZS52YWx1ZSkud2l0aCh7XG4gICAgICAgICAgICAgICAgaG91cjogMjMsXG4gICAgICAgICAgICAgICAgbWludXRlOiA1OSxcbiAgICAgICAgICAgICAgICBzZWNvbmQ6IDU5LFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIDogZXZlbnQuZW5kO1xuICAgICAgICByZXR1cm4gKGV2ZW50U3RhcnRXaXRoVGltZS50b1N0cmluZygpIDw9IGRhdGVTdGFydC50b1N0cmluZygpICYmXG4gICAgICAgICAgICBldmVudEVuZFdpdGhUaW1lLnRvU3RyaW5nKCkgPj0gZGF0ZUVuZC50b1N0cmluZygpKTtcbiAgICB9KTtcbiAgICBjb25zdCBoYW5kbGVNb3VzZURvd24gPSAoZSkgPT4ge1xuICAgICAgICBjb25zdCBjYWxsYmFjayA9ICRhcHAuY29uZmlnLmNhbGxiYWNrcy5vbk1vdXNlRG93bkRhdGVHcmlkRGF0ZTtcbiAgICAgICAgaWYgKCFjYWxsYmFjaylcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgY2FsbGJhY2soVGVtcG9yYWwuUGxhaW5EYXRlLmZyb20oZGF0ZSksIGUpO1xuICAgIH07XG4gICAgcmV0dXJuIChqc3hzKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X19kYXRlLWdyaWQtZGF5XCIsIFwiZGF0YS1kYXRlLWdyaWQtZGF0ZVwiOiBkYXRlLCBjaGlsZHJlbjogW2Z1bGxEYXlCYWNrZ3JvdW5kRXZlbnQgJiYgKGpzeChcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJzeF9fZGF0ZS1ncmlkLWJhY2tncm91bmQtZXZlbnRcIiwgdGl0bGU6IGZ1bGxEYXlCYWNrZ3JvdW5kRXZlbnQudGl0bGUsIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgICAgIC4uLmZ1bGxEYXlCYWNrZ3JvdW5kRXZlbnQuc3R5bGUsXG4gICAgICAgICAgICAgICAgfSB9KSksIE9iamVjdC52YWx1ZXMoY2FsZW5kYXJFdmVudHMpLm1hcCgoZXZlbnQsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50ID09PSBEQVRFX0dSSURfQkxPQ0tFUiB8fCAhZXZlbnQpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoanN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X19kYXRlLWdyaWQtY2VsbFwiLCBzdHlsZTogeyBncmlkUm93OiBpbmRleCArIDEgfSwgb25Nb3VzZURvd246IGhhbmRsZU1vdXNlRG93biB9KSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChqc3goRGF0ZUdyaWRFdmVudCwgeyBjYWxlbmRhckV2ZW50OiBldmVudCwgZ3JpZFJvdzogaW5kZXggKyAxIH0sIGV2ZW50LnN0YXJ0LnRvU3RyaW5nKCkgKyBldmVudC5lbmQudG9TdHJpbmcoKSArIGluZGV4KSk7XG4gICAgICAgICAgICB9KSwganN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiAnc3hfX3NwYWNlcicsIG9uTW91c2VEb3duOiBoYW5kbGVNb3VzZURvd24gfSldIH0pKTtcbn1cblxuY29uc3QgZmlsdGVyQnlSYW5nZSA9IChldmVudHMsIHJhbmdlLCB0aW1lem9uZSkgPT4ge1xuICAgIHJldHVybiBldmVudHMuZmlsdGVyKChldmVudCkgPT4ge1xuICAgICAgICBjb25zdCByYW5nZVN0YXJ0ID0gcmFuZ2Uuc3RhcnQ7XG4gICAgICAgIGNvbnN0IHJhbmdlRW5kID0gcmFuZ2UuZW5kO1xuICAgICAgICBsZXQgZXZlbnRTdGFydCA9IGV2ZW50LnN0YXJ0O1xuICAgICAgICBsZXQgZXZlbnRFbmQgPSBldmVudC5lbmQ7XG4gICAgICAgIC8vIENvbnZlcnQgUGxhaW5EYXRlIHRvIFpvbmVkRGF0ZVRpbWUgd2l0aCBzdGFydCB0aW1lIDAwOjAwOjAwXG4gICAgICAgIGlmIChldmVudFN0YXJ0IGluc3RhbmNlb2YgVGVtcG9yYWwuUGxhaW5EYXRlKSB7XG4gICAgICAgICAgICBldmVudFN0YXJ0ID0gZXZlbnRTdGFydC50b1pvbmVkRGF0ZVRpbWUodGltZXpvbmUpO1xuICAgICAgICB9XG4gICAgICAgIC8vIENvbnZlcnQgUGxhaW5EYXRlIHRvIFpvbmVkRGF0ZVRpbWUgd2l0aCBlbmQgdGltZSAyMzo1OTo1OVxuICAgICAgICBpZiAoZXZlbnRFbmQgaW5zdGFuY2VvZiBUZW1wb3JhbC5QbGFpbkRhdGUpIHtcbiAgICAgICAgICAgIGV2ZW50RW5kID0gZXZlbnRFbmQudG9ab25lZERhdGVUaW1lKHRpbWV6b25lKS53aXRoKHtcbiAgICAgICAgICAgICAgICBob3VyOiAyMyxcbiAgICAgICAgICAgICAgICBtaW51dGU6IDU5LFxuICAgICAgICAgICAgICAgIHNlY29uZDogNTksXG4gICAgICAgICAgICAgICAgbWlsbGlzZWNvbmQ6IDk5OSxcbiAgICAgICAgICAgICAgICBtaWNyb3NlY29uZDogOTk5LFxuICAgICAgICAgICAgICAgIG5hbm9zZWNvbmQ6IDk5OSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGV2ZW50U3RhcnRzSW5SYW5nZSA9IGV2ZW50U3RhcnQuZXBvY2hOYW5vc2Vjb25kcyA+PSByYW5nZVN0YXJ0LmVwb2NoTmFub3NlY29uZHMgJiZcbiAgICAgICAgICAgIGV2ZW50U3RhcnQuZXBvY2hOYW5vc2Vjb25kcyA8PSByYW5nZUVuZC5lcG9jaE5hbm9zZWNvbmRzO1xuICAgICAgICBjb25zdCBldmVudEVuZEluUmFuZ2UgPSBldmVudEVuZC5lcG9jaE5hbm9zZWNvbmRzID49IHJhbmdlU3RhcnQuZXBvY2hOYW5vc2Vjb25kcyAmJlxuICAgICAgICAgICAgZXZlbnRFbmQuZXBvY2hOYW5vc2Vjb25kcyA8PSByYW5nZUVuZC5lcG9jaE5hbm9zZWNvbmRzO1xuICAgICAgICBjb25zdCBldmVudFN0YXJ0QmVmb3JlQW5kRXZlbnRFbmRBZnRlclJhbmdlID0gZXZlbnRTdGFydC5lcG9jaE5hbm9zZWNvbmRzIDwgcmFuZ2VTdGFydC5lcG9jaE5hbm9zZWNvbmRzICYmXG4gICAgICAgICAgICBldmVudEVuZC5lcG9jaE5hbm9zZWNvbmRzID4gcmFuZ2VFbmQuZXBvY2hOYW5vc2Vjb25kcztcbiAgICAgICAgcmV0dXJuIChldmVudFN0YXJ0c0luUmFuZ2UgfHxcbiAgICAgICAgICAgIGV2ZW50RW5kSW5SYW5nZSB8fFxuICAgICAgICAgICAgZXZlbnRTdGFydEJlZm9yZUFuZEV2ZW50RW5kQWZ0ZXJSYW5nZSk7XG4gICAgfSk7XG59O1xuXG5jb25zdCBXZWVrV3JhcHBlciA9ICh7ICRhcHAsIGlkIH0pID0+IHtcbiAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuc2V0UHJvcGVydHkoJy0tc3gtd2Vlay1ncmlkLWhlaWdodCcsIGAkeyRhcHAuY29uZmlnLndlZWtPcHRpb25zLnZhbHVlLmdyaWRIZWlnaHR9cHhgKTtcbiAgICBjb25zdCB3ZWVrID0gdXNlQ29tcHV0ZWQoKCkgPT4ge1xuICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICBjb25zdCByYW5nZVN0YXJ0ID0gKF9hID0gJGFwcC5jYWxlbmRhclN0YXRlLnJhbmdlLnZhbHVlKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Euc3RhcnQ7XG4gICAgICAgIGNvbnN0IHJhbmdlRW5kID0gKF9iID0gJGFwcC5jYWxlbmRhclN0YXRlLnJhbmdlLnZhbHVlKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuZW5kO1xuICAgICAgICBpZiAoIXJhbmdlU3RhcnQgfHwgIXJhbmdlRW5kKVxuICAgICAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgICBsZXQgbmV3V2VlayA9IGNyZWF0ZVdlZWsoJGFwcCk7XG4gICAgICAgIGNvbnN0IGZpbHRlcmVkRXZlbnRzID0gJGFwcC5jYWxlbmRhckV2ZW50cy5maWx0ZXJQcmVkaWNhdGUudmFsdWVcbiAgICAgICAgICAgID8gJGFwcC5jYWxlbmRhckV2ZW50cy5saXN0LnZhbHVlLmZpbHRlcigkYXBwLmNhbGVuZGFyRXZlbnRzLmZpbHRlclByZWRpY2F0ZS52YWx1ZSlcbiAgICAgICAgICAgIDogJGFwcC5jYWxlbmRhckV2ZW50cy5saXN0LnZhbHVlO1xuICAgICAgICBjb25zdCB7IGRhdGVHcmlkRXZlbnRzLCB0aW1lR3JpZEV2ZW50cyB9ID0gc29ydEV2ZW50c0ZvcldlZWtWaWV3KGZpbHRlcmVkRXZlbnRzKTtcbiAgICAgICAgbmV3V2VlayA9IHBvc2l0aW9uSW5EYXRlR3JpZChkYXRlR3JpZEV2ZW50cy5zb3J0KHNvcnRFdmVudHNCeVN0YXJ0QW5kRW5kKSwgbmV3V2Vlayk7XG4gICAgICAgIE9iamVjdC5lbnRyaWVzKG5ld1dlZWspLmZvckVhY2goKFtkYXRlLCBkYXldKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBwbGFpbkRhdGUgPSBUZW1wb3JhbC5QbGFpbkRhdGUuZnJvbShkYXRlKTtcbiAgICAgICAgICAgIGNvbnN0IHJhbmdlU3RhcnREYXRlVGltZSA9IFRlbXBvcmFsLlpvbmVkRGF0ZVRpbWUuZnJvbSh7XG4gICAgICAgICAgICAgICAgeWVhcjogcGxhaW5EYXRlLnllYXIsXG4gICAgICAgICAgICAgICAgbW9udGg6IHBsYWluRGF0ZS5tb250aCxcbiAgICAgICAgICAgICAgICBkYXk6IHBsYWluRGF0ZS5kYXksXG4gICAgICAgICAgICAgICAgaG91cjogJGFwcC5jb25maWcuZGF5Qm91bmRhcmllcy52YWx1ZS5zdGFydCA9PT0gMFxuICAgICAgICAgICAgICAgICAgICA/IDBcbiAgICAgICAgICAgICAgICAgICAgOiAkYXBwLmNvbmZpZy5kYXlCb3VuZGFyaWVzLnZhbHVlLnN0YXJ0IC8gMTAwLFxuICAgICAgICAgICAgICAgIG1pbnV0ZTogMCxcbiAgICAgICAgICAgICAgICBzZWNvbmQ6IDAsXG4gICAgICAgICAgICAgICAgdGltZVpvbmU6ICRhcHAuY29uZmlnLnRpbWV6b25lLnZhbHVlLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBsZXQgcmFuZ2VFbmREYXRlVGltZSA9IFRlbXBvcmFsLlpvbmVkRGF0ZVRpbWUuZnJvbSh7XG4gICAgICAgICAgICAgICAgeWVhcjogcGxhaW5EYXRlLnllYXIsXG4gICAgICAgICAgICAgICAgbW9udGg6IHBsYWluRGF0ZS5tb250aCxcbiAgICAgICAgICAgICAgICBkYXk6IHBsYWluRGF0ZS5kYXksXG4gICAgICAgICAgICAgICAgaG91cjogJGFwcC5jb25maWcuZGF5Qm91bmRhcmllcy52YWx1ZS5lbmQgPT09IDI0MDBcbiAgICAgICAgICAgICAgICAgICAgPyAyM1xuICAgICAgICAgICAgICAgICAgICA6ICRhcHAuY29uZmlnLmRheUJvdW5kYXJpZXMudmFsdWUuZW5kIC8gMTAwLFxuICAgICAgICAgICAgICAgIG1pbnV0ZTogJGFwcC5jb25maWcuZGF5Qm91bmRhcmllcy52YWx1ZS5lbmQgPT09IDI0MDAgPyA1OSA6IDAsXG4gICAgICAgICAgICAgICAgc2Vjb25kOiAkYXBwLmNvbmZpZy5kYXlCb3VuZGFyaWVzLnZhbHVlLmVuZCA9PT0gMjQwMCA/IDU5IDogMCxcbiAgICAgICAgICAgICAgICB0aW1lWm9uZTogJGFwcC5jb25maWcudGltZXpvbmUudmFsdWUsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmICgkYXBwLmNvbmZpZy5pc0h5YnJpZERheSkge1xuICAgICAgICAgICAgICAgIHJhbmdlRW5kRGF0ZVRpbWUgPSByYW5nZUVuZERhdGVUaW1lLmFkZCh7IGRheXM6IDEgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkYXkuYmFja2dyb3VuZEV2ZW50cyA9IGZpbHRlckJ5UmFuZ2UoJGFwcC5jYWxlbmRhckV2ZW50cy5iYWNrZ3JvdW5kRXZlbnRzLnZhbHVlLCB7XG4gICAgICAgICAgICAgICAgc3RhcnQ6IHJhbmdlU3RhcnREYXRlVGltZSxcbiAgICAgICAgICAgICAgICBlbmQ6IHJhbmdlRW5kRGF0ZVRpbWUsXG4gICAgICAgICAgICB9LCAkYXBwLmNvbmZpZy50aW1lem9uZS52YWx1ZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBuZXdXZWVrID0gcG9zaXRpb25JblRpbWVHcmlkKHRpbWVHcmlkRXZlbnRzLCBuZXdXZWVrLCAkYXBwKTtcbiAgICAgICAgcmV0dXJuIG5ld1dlZWs7XG4gICAgfSk7XG4gICAgcmV0dXJuIChqc3goRnJhZ21lbnQsIHsgY2hpbGRyZW46IGpzeChBcHBDb250ZXh0LlByb3ZpZGVyLCB7IHZhbHVlOiAkYXBwLCBjaGlsZHJlbjoganN4cyhcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJzeF9fd2Vlay13cmFwcGVyXCIsIGlkOiBpZCwgY2hpbGRyZW46IFtqc3goXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic3hfX3dlZWstaGVhZGVyXCIsIGNoaWxkcmVuOiBqc3hzKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X193ZWVrLWhlYWRlci1jb250ZW50XCIsIGNoaWxkcmVuOiBbanN4KERhdGVBeGlzLCB7IHdlZWs6IE9iamVjdC52YWx1ZXMod2Vlay52YWx1ZSkubWFwKChkYXkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwbGFpbkRhdGUgPSBUZW1wb3JhbC5QbGFpbkRhdGUuZnJvbShkYXkuZGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFRlbXBvcmFsLlpvbmVkRGF0ZVRpbWUuZnJvbSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHllYXI6IHBsYWluRGF0ZS55ZWFyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb250aDogcGxhaW5EYXRlLm1vbnRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXk6IHBsYWluRGF0ZS5kYXksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVab25lOiAkYXBwLmNvbmZpZy50aW1lem9uZS52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pIH0pLCBqc3goXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic3hfX2RhdGUtZ3JpZFwiLCBcImFyaWEtbGFiZWxcIjogJGFwcC50cmFuc2xhdGUoJ0Z1bGwgZGF5LSBhbmQgbXVsdGlwbGUgZGF5IGV2ZW50cycpLCBjaGlsZHJlbjogT2JqZWN0LnZhbHVlcyh3ZWVrLnZhbHVlKS5tYXAoKGRheSkgPT4gKGpzeChEYXRlR3JpZERheSwgeyBkYXRlOiBkYXkuZGF0ZSwgY2FsZW5kYXJFdmVudHM6IGRheS5kYXRlR3JpZEV2ZW50cywgYmFja2dyb3VuZEV2ZW50czogZGF5LmJhY2tncm91bmRFdmVudHMgfSwgZGF5LmRhdGUpKSkgfSksIGpzeChcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJzeF9fd2Vlay1oZWFkZXItYm9yZGVyXCIgfSldIH0pIH0pLCBqc3hzKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X193ZWVrLWdyaWRcIiwgY2hpbGRyZW46IFtqc3goVGltZUF4aXMsIHt9KSwgT2JqZWN0LnZhbHVlcyh3ZWVrLnZhbHVlKS5tYXAoKGRheSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB7IHllYXIsIG1vbnRoLCBkYXRlIH0gPSB0b0ludGVnZXJzKGRheS5kYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgem9uZWREYXRlVGltZSA9IFRlbXBvcmFsLlpvbmVkRGF0ZVRpbWUuZnJvbSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ZWFyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9udGg6IG1vbnRoICsgMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRheTogZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVab25lOiAkYXBwLmNvbmZpZy50aW1lem9uZS52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoanN4KFRpbWVHcmlkRGF5LCB7IGNhbGVuZGFyRXZlbnRzOiBkYXkudGltZUdyaWRFdmVudHMsIGJhY2tncm91bmRFdmVudHM6IGRheS5iYWNrZ3JvdW5kRXZlbnRzLCBkYXRlOiB6b25lZERhdGVUaW1lIH0sIGRheS5kYXRlKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSldIH0pXSB9KSB9KSB9KSk7XG59O1xuXG5jb25zdCBnZXRSYW5nZVN0YXJ0R2l2ZW5EYXlCb3VuZGFyaWVzID0gKGNhbGVuZGFyQ29uZmlnLCBkYXRlKSA9PiB7XG4gICAgY29uc3QgdGltZVN0cmluZyA9IHRpbWVTdHJpbmdGcm9tVGltZVBvaW50cyhjYWxlbmRhckNvbmZpZy5kYXlCb3VuZGFyaWVzLnZhbHVlLnN0YXJ0KTtcbiAgICByZXR1cm4gVGVtcG9yYWwuWm9uZWREYXRlVGltZS5mcm9tKHtcbiAgICAgICAgeWVhcjogZGF0ZS55ZWFyLFxuICAgICAgICBtb250aDogZGF0ZS5tb250aCxcbiAgICAgICAgZGF5OiBkYXRlLmRheSxcbiAgICAgICAgaG91cjogK3RpbWVTdHJpbmcuc3BsaXQoJzonKVswXSxcbiAgICAgICAgbWludXRlOiArdGltZVN0cmluZy5zcGxpdCgnOicpWzFdLFxuICAgICAgICB0aW1lWm9uZTogY2FsZW5kYXJDb25maWcudGltZXpvbmUudmFsdWUsXG4gICAgfSk7XG59O1xuY29uc3QgZ2V0UmFuZ2VFbmRHaXZlbkRheUJvdW5kYXJpZXMgPSAoY2FsZW5kYXJDb25maWcsIGRhdGUpID0+IHtcbiAgICBsZXQgZGF5RW5kVGltZVN0cmluZyA9IHRpbWVTdHJpbmdGcm9tVGltZVBvaW50cyhjYWxlbmRhckNvbmZpZy5kYXlCb3VuZGFyaWVzLnZhbHVlLmVuZCk7XG4gICAgbGV0IG5ld1JhbmdlRW5kRGF0ZSA9IGRhdGU7XG4gICAgaWYgKGNhbGVuZGFyQ29uZmlnLmlzSHlicmlkRGF5KSB7XG4gICAgICAgIG5ld1JhbmdlRW5kRGF0ZSA9IGFkZERheXMobmV3UmFuZ2VFbmREYXRlLCAxKTtcbiAgICB9XG4gICAgaWYgKGNhbGVuZGFyQ29uZmlnLmRheUJvdW5kYXJpZXMudmFsdWUuZW5kID09PSAyNDAwKSB7XG4gICAgICAgIGRheUVuZFRpbWVTdHJpbmcgPSAnMjM6NTknO1xuICAgIH1cbiAgICByZXR1cm4gVGVtcG9yYWwuWm9uZWREYXRlVGltZS5mcm9tKHtcbiAgICAgICAgeWVhcjogbmV3UmFuZ2VFbmREYXRlLnllYXIsXG4gICAgICAgIG1vbnRoOiBuZXdSYW5nZUVuZERhdGUubW9udGgsXG4gICAgICAgIGRheTogbmV3UmFuZ2VFbmREYXRlLmRheSxcbiAgICAgICAgaG91cjogK2RheUVuZFRpbWVTdHJpbmcuc3BsaXQoJzonKVswXSxcbiAgICAgICAgbWludXRlOiArZGF5RW5kVGltZVN0cmluZy5zcGxpdCgnOicpWzFdLFxuICAgICAgICB0aW1lWm9uZTogY2FsZW5kYXJDb25maWcudGltZXpvbmUudmFsdWUsXG4gICAgfSk7XG59O1xuY29uc3Qgc2V0UmFuZ2VGb3JXZWVrID0gKGNvbmZpZykgPT4ge1xuICAgIGNvbnN0IHdlZWtGb3JEYXRlID0gY29uZmlnLnRpbWVVbml0c0ltcGxcbiAgICAgICAgLmdldFdlZWtGb3IoY29uZmlnLmRhdGUpXG4gICAgICAgIC5zbGljZSgwLCBjb25maWcuY2FsZW5kYXJDb25maWcud2Vla09wdGlvbnMudmFsdWUubkRheXMpO1xuICAgIHJldHVybiB7XG4gICAgICAgIHN0YXJ0OiBnZXRSYW5nZVN0YXJ0R2l2ZW5EYXlCb3VuZGFyaWVzKGNvbmZpZy5jYWxlbmRhckNvbmZpZywgd2Vla0ZvckRhdGVbMF0pLFxuICAgICAgICBlbmQ6IGdldFJhbmdlRW5kR2l2ZW5EYXlCb3VuZGFyaWVzKGNvbmZpZy5jYWxlbmRhckNvbmZpZywgd2Vla0ZvckRhdGVbd2Vla0ZvckRhdGUubGVuZ3RoIC0gMV0pLFxuICAgIH07XG59O1xuY29uc3Qgc2V0UmFuZ2VGb3JNb250aCA9IChjb25maWcpID0+IHtcbiAgICBjb25zdCBtb250aEZvckRhdGUgPSBjb25maWcudGltZVVuaXRzSW1wbC5nZXRNb250aFdpdGhUcmFpbGluZ0FuZExlYWRpbmdEYXlzKGNvbmZpZy5kYXRlLnllYXIsIGNvbmZpZy5kYXRlLm1vbnRoKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBzdGFydDogbW9udGhGb3JEYXRlWzBdWzBdLFxuICAgICAgICBlbmQ6IG1vbnRoRm9yRGF0ZVttb250aEZvckRhdGUubGVuZ3RoIC0gMV1bbW9udGhGb3JEYXRlW21vbnRoRm9yRGF0ZS5sZW5ndGggLSAxXS5sZW5ndGggLSAxXS53aXRoKHsgaG91cjogMjMsIG1pbnV0ZTogNTkgfSksXG4gICAgfTtcbn07XG5jb25zdCBzZXRSYW5nZUZvckRheSA9IChjb25maWcpID0+IHtcbiAgICBsZXQgZGF0ZSA9IGNvbmZpZy5kYXRlO1xuICAgIGlmIChkYXRlIGluc3RhbmNlb2YgVGVtcG9yYWwuUGxhaW5EYXRlKSB7XG4gICAgICAgIGRhdGUgPSBkYXRlLnRvWm9uZWREYXRlVGltZSh7XG4gICAgICAgICAgICB0aW1lWm9uZTogY29uZmlnLmNhbGVuZGFyQ29uZmlnLnRpbWV6b25lLnZhbHVlLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgc3RhcnQ6IGdldFJhbmdlU3RhcnRHaXZlbkRheUJvdW5kYXJpZXMoY29uZmlnLmNhbGVuZGFyQ29uZmlnLCBkYXRlKSxcbiAgICAgICAgZW5kOiBnZXRSYW5nZUVuZEdpdmVuRGF5Qm91bmRhcmllcyhjb25maWcuY2FsZW5kYXJDb25maWcsIGRhdGUpLFxuICAgIH07XG59O1xuXG5jb25zdCBjb25maWckNCA9IHtcbiAgICBuYW1lOiBJbnRlcm5hbFZpZXdOYW1lLldlZWssXG4gICAgbGFiZWw6ICdXZWVrJyxcbiAgICBDb21wb25lbnQ6IFdlZWtXcmFwcGVyLFxuICAgIHNldERhdGVSYW5nZTogc2V0UmFuZ2VGb3JXZWVrLFxuICAgIGhhc1NtYWxsU2NyZWVuQ29tcGF0OiBmYWxzZSxcbiAgICBoYXNXaWRlU2NyZWVuQ29tcGF0OiB0cnVlLFxuICAgIGJhY2t3YXJkRm9yd2FyZEZuOiBhZGREYXlzLFxuICAgIGJhY2t3YXJkRm9yd2FyZFVuaXRzOiA3LFxufTtcbmNvbnN0IHZpZXdXZWVrID0gY3JlYXRlUHJlYWN0Vmlldyhjb25maWckNCk7XG5jb25zdCBjcmVhdGVWaWV3V2VlayA9ICgpID0+IGNyZWF0ZVByZWFjdFZpZXcoY29uZmlnJDQpO1xuXG5jb25zdCBEYXlXcmFwcGVyID0gKHsgJGFwcCwgaWQgfSkgPT4ge1xuICAgIHJldHVybiBqc3goV2Vla1dyYXBwZXIsIHsgXCIkYXBwXCI6ICRhcHAsIGlkOiBpZCB9KTtcbn07XG5cbmNvbnN0IGNvbmZpZyQzID0ge1xuICAgIG5hbWU6IEludGVybmFsVmlld05hbWUuRGF5LFxuICAgIGxhYmVsOiAnRGF5JyxcbiAgICBzZXREYXRlUmFuZ2U6IHNldFJhbmdlRm9yRGF5LFxuICAgIGhhc1dpZGVTY3JlZW5Db21wYXQ6IHRydWUsXG4gICAgaGFzU21hbGxTY3JlZW5Db21wYXQ6IHRydWUsXG4gICAgQ29tcG9uZW50OiBEYXlXcmFwcGVyLFxuICAgIGJhY2t3YXJkRm9yd2FyZEZuOiBhZGREYXlzLFxuICAgIGJhY2t3YXJkRm9yd2FyZFVuaXRzOiAxLFxufTtcbmNvbnN0IHZpZXdEYXkgPSBjcmVhdGVQcmVhY3RWaWV3KGNvbmZpZyQzKTtcbmNvbnN0IGNyZWF0ZVZpZXdEYXkgPSAoKSA9PiBjcmVhdGVQcmVhY3RWaWV3KGNvbmZpZyQzKTtcblxuY29uc3QgZ2V0V2Vla051bWJlciA9IChkLCBmaXJzdERheU9mV2VlaykgPT4ge1xuICAgIC8vIENvbnZlcnQgdG8gWm9uZWREYXRlVGltZSBpZiBpdCdzIGEgUGxhaW5EYXRlXG4gICAgY29uc3Qgem9uZWREYXRlID0gZCBpbnN0YW5jZW9mIFRlbXBvcmFsLlBsYWluRGF0ZVxuICAgICAgICA/IGQudG9ab25lZERhdGVUaW1lKCdVVEMnKVxuICAgICAgICA6IGQudG9JbnN0YW50KCkudG9ab25lZERhdGVUaW1lSVNPKCdVVEMnKTtcbiAgICAvLyBBZGp1c3QgdGhlIGRhdGUgdG8gdGhlIG5lYXJlc3QgZGVzaXJlZCBmaXJzdCBkYXkgb2YgdGhlIHdlZWtcbiAgICBjb25zdCBkYXlPZmZzZXQgPSAoem9uZWREYXRlLmRheU9mV2VlayAtIGZpcnN0RGF5T2ZXZWVrICsgNykgJSA3O1xuICAgIGNvbnN0IGFkanVzdGVkRGF0ZSA9IHpvbmVkRGF0ZS5zdWJ0cmFjdCh7IGRheXM6IGRheU9mZnNldCAtIDMgfSk7XG4gICAgLy8gR2V0IGZpcnN0IGRheSBvZiB5ZWFyIGFkanVzdGVkIGZvciBmaXJzdERheU9mV2Vla1xuICAgIGNvbnN0IHllYXJTdGFydCA9IFRlbXBvcmFsLlpvbmVkRGF0ZVRpbWUuZnJvbSh7XG4gICAgICAgIHllYXI6IGFkanVzdGVkRGF0ZS55ZWFyLFxuICAgICAgICBtb250aDogMSxcbiAgICAgICAgZGF5OiAxLFxuICAgICAgICB0aW1lWm9uZTogJ1VUQycsXG4gICAgfSk7XG4gICAgY29uc3QgeWVhclN0YXJ0T2Zmc2V0ID0gKHllYXJTdGFydC5kYXlPZldlZWsgLSBmaXJzdERheU9mV2VlayArIDcpICUgNztcbiAgICBjb25zdCBhZGp1c3RlZFllYXJTdGFydCA9IHllYXJTdGFydC5zdWJ0cmFjdCh7IGRheXM6IHllYXJTdGFydE9mZnNldCB9KTtcbiAgICAvLyBDYWxjdWxhdGUgZnVsbCB3ZWVrcyBmcm9tIGFkanVzdGVkIHN0YXJ0IG9mIHRoZSB5ZWFyXG4gICAgY29uc3QgZGF5c0RpZmYgPSBhZGp1c3RlZERhdGUudW50aWwoYWRqdXN0ZWRZZWFyU3RhcnQsIHtcbiAgICAgICAgbGFyZ2VzdFVuaXQ6ICdkYXlzJyxcbiAgICB9KS5kYXlzO1xuICAgIGNvbnN0IHdlZWtObyA9IE1hdGguY2VpbCgoTWF0aC5hYnMoZGF5c0RpZmYpICsgMSkgLyA3KTtcbiAgICAvLyBIYW5kbGUgZWRnZSBjYXNlIGZvciB0aGUgbGFzdCBkYXlzIG9mIHRoZSB5ZWFyIGZhbGxpbmcgaW50byB3ZWVrIDUzXG4gICAgY29uc3QgbmV4dFllYXJTdGFydCA9IFRlbXBvcmFsLlpvbmVkRGF0ZVRpbWUuZnJvbSh7XG4gICAgICAgIHllYXI6IGFkanVzdGVkRGF0ZS55ZWFyICsgMSxcbiAgICAgICAgbW9udGg6IDEsXG4gICAgICAgIGRheTogMSxcbiAgICAgICAgdGltZVpvbmU6ICdVVEMnLFxuICAgIH0pO1xuICAgIGNvbnN0IG5leHRZZWFyU3RhcnRPZmZzZXQgPSAobmV4dFllYXJTdGFydC5kYXlPZldlZWsgLSBmaXJzdERheU9mV2VlayArIDcpICUgNztcbiAgICBjb25zdCBhZGp1c3RlZE5leHRZZWFyU3RhcnQgPSBuZXh0WWVhclN0YXJ0LnN1YnRyYWN0KHtcbiAgICAgICAgZGF5czogbmV4dFllYXJTdGFydE9mZnNldCxcbiAgICB9KTtcbiAgICBpZiAoVGVtcG9yYWwuWm9uZWREYXRlVGltZS5jb21wYXJlKGFkanVzdGVkRGF0ZSwgYWRqdXN0ZWROZXh0WWVhclN0YXJ0KSA+PSAwKSB7XG4gICAgICAgIHJldHVybiAxO1xuICAgIH1cbiAgICByZXR1cm4gd2Vla05vO1xufTtcblxuZnVuY3Rpb24gV2Vla051bWJlcigpIHtcbiAgICBjb25zdCAkYXBwID0gdXNlQ29udGV4dChBcHBDb250ZXh0KTtcbiAgICByZXR1cm4gKGpzeChcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJzeF9fY2FsZW5kYXItaGVhZGVyX193ZWVrLW51bWJlclwiLCBjaGlsZHJlbjogJGFwcC50cmFuc2xhdGUoJ0NXJywge1xuICAgICAgICAgICAgd2VlazogZ2V0V2Vla051bWJlcigkYXBwLmRhdGVQaWNrZXJTdGF0ZS5zZWxlY3RlZERhdGUudmFsdWUsICRhcHAuY29uZmlnLmZpcnN0RGF5T2ZXZWVrLnZhbHVlKSxcbiAgICAgICAgfSkgfSkpO1xufVxuXG5mdW5jdGlvbiBDYWxlbmRhckhlYWRlcigpIHtcbiAgICBjb25zdCAkYXBwID0gdXNlQ29udGV4dChBcHBDb250ZXh0KTtcbiAgICBjb25zdCBkYXRlUGlja2VyQXBwU2luZ2xldG9uID0gbmV3IERhdGVQaWNrZXJBcHBTaW5nbGV0b25CdWlsZGVyKClcbiAgICAgICAgLndpdGhEYXRlUGlja2VyU3RhdGUoJGFwcC5kYXRlUGlja2VyU3RhdGUpXG4gICAgICAgIC53aXRoQ29uZmlnKCRhcHAuZGF0ZVBpY2tlckNvbmZpZylcbiAgICAgICAgLndpdGhUcmFuc2xhdGUoJGFwcC50cmFuc2xhdGUpXG4gICAgICAgIC53aXRoVGltZVVuaXRzSW1wbCgkYXBwLnRpbWVVbml0c0ltcGwpXG4gICAgICAgIC5idWlsZCgpO1xuICAgIGNvbnN0IGhlYWRlckNvbnRlbnQgPSAkYXBwLmNvbmZpZy5fY3VzdG9tQ29tcG9uZW50Rm5zLmhlYWRlckNvbnRlbnQ7XG4gICAgY29uc3QgaGVhZGVyQ29udGVudElkID0gdXNlU3RhdGUoaGVhZGVyQ29udGVudCA/IHJhbmRvbVN0cmluZ0lkKCkgOiB1bmRlZmluZWQpWzBdO1xuICAgIGNvbnN0IGhlYWRlckNvbnRlbnRMZWZ0UHJlcGVuZCA9ICRhcHAuY29uZmlnLl9jdXN0b21Db21wb25lbnRGbnMuaGVhZGVyQ29udGVudExlZnRQcmVwZW5kO1xuICAgIGNvbnN0IGhlYWRlckNvbnRlbnRMZWZ0UHJlcGVuZElkID0gdXNlU3RhdGUoaGVhZGVyQ29udGVudExlZnRQcmVwZW5kID8gcmFuZG9tU3RyaW5nSWQoKSA6IHVuZGVmaW5lZClbMF07XG4gICAgY29uc3QgaGVhZGVyQ29udGVudExlZnRBcHBlbmQgPSAkYXBwLmNvbmZpZy5fY3VzdG9tQ29tcG9uZW50Rm5zLmhlYWRlckNvbnRlbnRMZWZ0QXBwZW5kO1xuICAgIGNvbnN0IGhlYWRlckNvbnRlbnRMZWZ0QXBwZW5kSWQgPSB1c2VTdGF0ZShoZWFkZXJDb250ZW50TGVmdEFwcGVuZCA/IHJhbmRvbVN0cmluZ0lkKCkgOiB1bmRlZmluZWQpWzBdO1xuICAgIGNvbnN0IGhlYWRlckNvbnRlbnRSaWdodFByZXBlbmQgPSAkYXBwLmNvbmZpZy5fY3VzdG9tQ29tcG9uZW50Rm5zLmhlYWRlckNvbnRlbnRSaWdodFByZXBlbmQ7XG4gICAgY29uc3QgaGVhZGVyQ29udGVudFJpZ2h0UHJlcGVuZElkID0gdXNlU3RhdGUoaGVhZGVyQ29udGVudFJpZ2h0UHJlcGVuZCA/IHJhbmRvbVN0cmluZ0lkKCkgOiB1bmRlZmluZWQpWzBdO1xuICAgIGNvbnN0IGhlYWRlckNvbnRlbnRSaWdodEFwcGVuZCA9ICRhcHAuY29uZmlnLl9jdXN0b21Db21wb25lbnRGbnMuaGVhZGVyQ29udGVudFJpZ2h0QXBwZW5kO1xuICAgIGNvbnN0IGhlYWRlckNvbnRlbnRSaWdodEFwcGVuZElkID0gdXNlU3RhdGUoaGVhZGVyQ29udGVudFJpZ2h0QXBwZW5kID8gcmFuZG9tU3RyaW5nSWQoKSA6IHVuZGVmaW5lZClbMF07XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKGhlYWRlckNvbnRlbnQpIHtcbiAgICAgICAgICAgIGhlYWRlckNvbnRlbnQoZ2V0RWxlbWVudEJ5Q0NJRChoZWFkZXJDb250ZW50SWQpLCB7ICRhcHAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGhlYWRlckNvbnRlbnRMZWZ0UHJlcGVuZCAmJiBoZWFkZXJDb250ZW50TGVmdFByZXBlbmRJZCkge1xuICAgICAgICAgICAgaGVhZGVyQ29udGVudExlZnRQcmVwZW5kKGdldEVsZW1lbnRCeUNDSUQoaGVhZGVyQ29udGVudExlZnRQcmVwZW5kSWQpLCB7XG4gICAgICAgICAgICAgICAgJGFwcCxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChoZWFkZXJDb250ZW50TGVmdEFwcGVuZCkge1xuICAgICAgICAgICAgaGVhZGVyQ29udGVudExlZnRBcHBlbmQoZ2V0RWxlbWVudEJ5Q0NJRChoZWFkZXJDb250ZW50TGVmdEFwcGVuZElkKSwge1xuICAgICAgICAgICAgICAgICRhcHAsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaGVhZGVyQ29udGVudFJpZ2h0UHJlcGVuZCkge1xuICAgICAgICAgICAgaGVhZGVyQ29udGVudFJpZ2h0UHJlcGVuZChnZXRFbGVtZW50QnlDQ0lEKGhlYWRlckNvbnRlbnRSaWdodFByZXBlbmRJZCksIHtcbiAgICAgICAgICAgICAgICAkYXBwLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGhlYWRlckNvbnRlbnRSaWdodEFwcGVuZCkge1xuICAgICAgICAgICAgaGVhZGVyQ29udGVudFJpZ2h0QXBwZW5kKGdldEVsZW1lbnRCeUNDSUQoaGVhZGVyQ29udGVudFJpZ2h0QXBwZW5kSWQpLCB7XG4gICAgICAgICAgICAgICAgJGFwcCxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSwgW1xuICAgICAgICAkYXBwLmRhdGVQaWNrZXJTdGF0ZS5zZWxlY3RlZERhdGUudmFsdWUsXG4gICAgICAgICRhcHAuY2FsZW5kYXJTdGF0ZS5yYW5nZS52YWx1ZSxcbiAgICAgICAgJGFwcC5jYWxlbmRhclN0YXRlLmlzRGFyay52YWx1ZSxcbiAgICAgICAgJGFwcC5jYWxlbmRhclN0YXRlLmlzQ2FsZW5kYXJTbWFsbC52YWx1ZSxcbiAgICBdKTtcbiAgICBjb25zdCBrZXlGb3JSZXJlbmRlcmluZ09uTG9jYWxlQ2hhbmdlID0gJGFwcC5jb25maWcubG9jYWxlLnZhbHVlO1xuICAgIGNvbnN0IGlzRGF5T3JXZWVrVmlldyA9IHVzZU1lbW8oKCkgPT4ge1xuICAgICAgICByZXR1cm4gW3ZpZXdXZWVrLm5hbWUsIHZpZXdEYXkubmFtZV0uaW5jbHVkZXMoJGFwcC5jYWxlbmRhclN0YXRlLnZpZXcudmFsdWUpO1xuICAgIH0sIFskYXBwLmNhbGVuZGFyU3RhdGUudmlldy52YWx1ZV0pO1xuICAgIHJldHVybiAoanN4KFwiaGVhZGVyXCIsIHsgY2xhc3NOYW1lOiAnc3hfX2NhbGVuZGFyLWhlYWRlcicsIFwiZGF0YS1jY2lkXCI6IGhlYWRlckNvbnRlbnRJZCwgY2hpbGRyZW46ICFoZWFkZXJDb250ZW50ICYmIChqc3hzKEZyYWdtZW50LCB7IGNoaWxkcmVuOiBbanN4cyhcImRpdlwiLCB7IGNsYXNzTmFtZTogJ3N4X19jYWxlbmRhci1oZWFkZXItY29udGVudCcsIGNoaWxkcmVuOiBbaGVhZGVyQ29udGVudExlZnRQcmVwZW5kSWQgJiYgKGpzeChcImRpdlwiLCB7IFwiZGF0YS1jY2lkXCI6IGhlYWRlckNvbnRlbnRMZWZ0UHJlcGVuZElkIH0pKSwganN4KFRvZGF5QnV0dG9uLCB7fSksIGpzeChGb3J3YXJkQmFja3dhcmROYXZpZ2F0aW9uLCB7fSksIGpzeChSYW5nZUhlYWRpbmcsIHt9LCAkYXBwLmNvbmZpZy5sb2NhbGUudmFsdWUpLCAkYXBwLmNvbmZpZy5zaG93V2Vla051bWJlcnMudmFsdWUgJiYgaXNEYXlPcldlZWtWaWV3ICYmIChqc3goV2Vla051bWJlciwge30pKSwgaGVhZGVyQ29udGVudExlZnRBcHBlbmRJZCAmJiAoanN4KFwiZGl2XCIsIHsgXCJkYXRhLWNjaWRcIjogaGVhZGVyQ29udGVudExlZnRBcHBlbmRJZCB9KSldIH0pLCBqc3hzKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiAnc3hfX2NhbGVuZGFyLWhlYWRlci1jb250ZW50JywgY2hpbGRyZW46IFtoZWFkZXJDb250ZW50UmlnaHRQcmVwZW5kSWQgJiYgKGpzeChcImRpdlwiLCB7IFwiZGF0YS1jY2lkXCI6IGhlYWRlckNvbnRlbnRSaWdodFByZXBlbmRJZCB9KSksICRhcHAuY29uZmlnLnBsdWdpbnMudGltZXpvbmVTZWxlY3QgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYXBwLmNvbmZpZy5wbHVnaW5zLnRpbWV6b25lU2VsZWN0LmlzRW5hYmxlZC52YWx1ZSAmJiAoanN4KCRhcHAuY29uZmlnLnBsdWdpbnMudGltZXpvbmVTZWxlY3QuQ29tcG9uZW50Rm4sIHsgXCIkYXBwXCI6ICRhcHAgfSkpLCAkYXBwLmNvbmZpZy52aWV3cy52YWx1ZS5sZW5ndGggPiAxICYmIChqc3goVmlld1NlbGVjdGlvbiwge30sIGtleUZvclJlcmVuZGVyaW5nT25Mb2NhbGVDaGFuZ2UgKyAnLXZpZXctc2VsZWN0aW9uJykpLCBqc3goQXBwV3JhcHBlciwgeyBcIiRhcHBcIjogZGF0ZVBpY2tlckFwcFNpbmdsZXRvbiB9KSwgaGVhZGVyQ29udGVudFJpZ2h0QXBwZW5kSWQgJiYgKGpzeChcImRpdlwiLCB7IFwiZGF0YS1jY2lkXCI6IGhlYWRlckNvbnRlbnRSaWdodEFwcGVuZElkIH0pKV0gfSldIH0pKSB9KSk7XG59XG5cbmNvbnN0IHNldFdyYXBwZXJFbGVtZW50ID0gKCRhcHAsIGNhbGVuZGFySWQpID0+IHtcbiAgICAkYXBwLmVsZW1lbnRzLmNhbGVuZGFyV3JhcHBlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNhbGVuZGFySWQpO1xufTtcblxuY29uc3Qgc2V0U2NyZWVuU2l6ZUNvbXBhdGlibGVWaWV3ID0gKCRhcHAsIGlzU21hbGwpID0+IHtcbiAgICBjb25zdCBjdXJyZW50VmlldyA9ICRhcHAuY29uZmlnLnZpZXdzLnZhbHVlLmZpbmQoKHZpZXcpID0+IHZpZXcubmFtZSA9PT0gJGFwcC5jYWxlbmRhclN0YXRlLnZpZXcudmFsdWUpO1xuICAgIGlmIChpc1NtYWxsKSB7XG4gICAgICAgIGlmIChjdXJyZW50Vmlldy5oYXNTbWFsbFNjcmVlbkNvbXBhdClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgY29uc3Qgc21hbGxTY3JlZW5Db21wYXRpYmxlVmlldyA9ICRhcHAuY29uZmlnLnZpZXdzLnZhbHVlLmZpbmQoKHZpZXcpID0+IHZpZXcuaGFzU21hbGxTY3JlZW5Db21wYXQpO1xuICAgICAgICBpZiAoc21hbGxTY3JlZW5Db21wYXRpYmxlVmlldykge1xuICAgICAgICAgICAgJGFwcC5jYWxlbmRhclN0YXRlLnNldFZpZXcoc21hbGxTY3JlZW5Db21wYXRpYmxlVmlldy5uYW1lLCAkYXBwLmRhdGVQaWNrZXJTdGF0ZS5zZWxlY3RlZERhdGUudmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpZiAoY3VycmVudFZpZXcuaGFzV2lkZVNjcmVlbkNvbXBhdClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgY29uc3Qgd2lkZVNjcmVlbkNvbXBhdGlibGVWaWV3ID0gJGFwcC5jb25maWcudmlld3MudmFsdWUuZmluZCgodmlldykgPT4gdmlldy5oYXNXaWRlU2NyZWVuQ29tcGF0KTtcbiAgICAgICAgaWYgKHdpZGVTY3JlZW5Db21wYXRpYmxlVmlldykge1xuICAgICAgICAgICAgJGFwcC5jYWxlbmRhclN0YXRlLnNldFZpZXcod2lkZVNjcmVlbkNvbXBhdGlibGVWaWV3Lm5hbWUsICRhcHAuZGF0ZVBpY2tlclN0YXRlLnNlbGVjdGVkRGF0ZS52YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG59O1xuY29uc3QgaGFuZGxlV2luZG93UmVzaXplID0gKCRhcHApID0+IHtcbiAgICBjb25zdCBkb2N1bWVudFJvb3QgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XG4gICAgY29uc3QgY2FsZW5kYXJSb290ID0gJGFwcC5lbGVtZW50cy5jYWxlbmRhcldyYXBwZXI7XG4gICAgY29uc3QgZG9jdW1lbnRGb250U2l6ZSA9ICt3aW5kb3dcbiAgICAgICAgLmdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnRSb290KVxuICAgICAgICAuZm9udFNpemUuc3BsaXQoJ3AnKVswXTtcbiAgICBjb25zdCBicmVha1BvaW50Rm9yMVJlbUVxdWFsczE2cHggPSA3MDA7XG4gICAgY29uc3QgbXVsdGlwbGllciA9IDE2IC8gZG9jdW1lbnRGb250U2l6ZTtcbiAgICBjb25zdCBzbWFsbENhbGVuZGFyQnJlYWtwb2ludCA9IGJyZWFrUG9pbnRGb3IxUmVtRXF1YWxzMTZweCAvIG11bHRpcGxpZXI7IC8vIEZvciAxNnB4IHJvb3QgZm9udC1zaXplLCBicmVhayBwb2ludCBpcyBhdCA0My43NXJlbVxuICAgIGlmICghY2FsZW5kYXJSb290KVxuICAgICAgICByZXR1cm47XG4gICAgY29uc3QgaXNTbWFsbCA9ICRhcHAuY29uZmlnLmNhbGxiYWNrcy5pc0NhbGVuZGFyU21hbGxcbiAgICAgICAgPyAkYXBwLmNvbmZpZy5jYWxsYmFja3MuaXNDYWxlbmRhclNtYWxsKCRhcHApXG4gICAgICAgIDogY2FsZW5kYXJSb290LmNsaWVudFdpZHRoIDwgc21hbGxDYWxlbmRhckJyZWFrcG9pbnQ7XG4gICAgY29uc3QgZGlkSXNTbWFsbFNjcmVlbkNoYW5nZSA9IGlzU21hbGwgIT09ICRhcHAuY2FsZW5kYXJTdGF0ZS5pc0NhbGVuZGFyU21hbGwudmFsdWU7XG4gICAgaWYgKCFkaWRJc1NtYWxsU2NyZWVuQ2hhbmdlKVxuICAgICAgICByZXR1cm47XG4gICAgJGFwcC5jYWxlbmRhclN0YXRlLmlzQ2FsZW5kYXJTbWFsbC52YWx1ZSA9IGlzU21hbGw7XG4gICAgc2V0U2NyZWVuU2l6ZUNvbXBhdGlibGVWaWV3KCRhcHAsIGlzU21hbGwpO1xufTtcblxuY29uc3QgZ2V0Q2xhc3NGb3JWaWV3ID0gKCRhcHApID0+IHtcbiAgICByZXR1cm4gYGlzLSR7JGFwcC5jYWxlbmRhclN0YXRlLnZpZXcudmFsdWV9LXZpZXdgO1xufTtcbmZ1bmN0aW9uIHVzZVdyYXBwZXJDbGFzc2VzKCRhcHApIHtcbiAgICBjb25zdCBjYWxlbmRhcldyYXBwZXJDbGFzcyA9ICdzeF9fY2FsZW5kYXItd3JhcHBlcic7XG4gICAgY29uc3QgW3dyYXBwZXJDbGFzc2VzLCBzZXRXcmFwcGVyQ2xhc3Nlc10gPSB1c2VTdGF0ZShbXG4gICAgICAgIGNhbGVuZGFyV3JhcHBlckNsYXNzLFxuICAgICAgICBnZXRDbGFzc0ZvclZpZXcoJGFwcCksXG4gICAgXSk7XG4gICAgdXNlU2lnbmFsRWZmZWN0KCgpID0+IHtcbiAgICAgICAgY29uc3QgY2xhc3NlcyA9IFtjYWxlbmRhcldyYXBwZXJDbGFzc107XG4gICAgICAgIGlmICgkYXBwLmNhbGVuZGFyU3RhdGUuaXNDYWxlbmRhclNtYWxsLnZhbHVlKVxuICAgICAgICAgICAgY2xhc3Nlcy5wdXNoKCdzeF9faXMtY2FsZW5kYXItc21hbGwnKTtcbiAgICAgICAgaWYgKCRhcHAuY2FsZW5kYXJTdGF0ZS5pc0RhcmsudmFsdWUpXG4gICAgICAgICAgICBjbGFzc2VzLnB1c2goJ2lzLWRhcmsnKTtcbiAgICAgICAgaWYgKCRhcHAuY29uZmlnLnRoZW1lID09PSAnc2hhZGNuJylcbiAgICAgICAgICAgIGNsYXNzZXMucHVzaCgnaXMtc2hhZGNuJyk7XG4gICAgICAgIGNsYXNzZXMucHVzaChnZXRDbGFzc0ZvclZpZXcoJGFwcCkpO1xuICAgICAgICBzZXRXcmFwcGVyQ2xhc3NlcyhjbGFzc2VzKTtcbiAgICB9KTtcbiAgICByZXR1cm4gd3JhcHBlckNsYXNzZXM7XG59XG5cbmNvbnN0IGluaXRQbHVnaW5zID0gKCRhcHApID0+IHtcbiAgICBPYmplY3QudmFsdWVzKCRhcHAuY29uZmlnLnBsdWdpbnMpLmZvckVhY2goKHBsdWdpbikgPT4ge1xuICAgICAgICBpZiAocGx1Z2luID09PSBudWxsIHx8IHBsdWdpbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogcGx1Z2luLm9uUmVuZGVyKSB7XG4gICAgICAgICAgICBwbHVnaW4ub25SZW5kZXIoJGFwcCk7XG4gICAgICAgIH1cbiAgICB9KTtcbn07XG5jb25zdCBkZXN0cm95UGx1Z2lucyA9ICgkYXBwKSA9PiB7XG4gICAgT2JqZWN0LnZhbHVlcygkYXBwLmNvbmZpZy5wbHVnaW5zKS5mb3JFYWNoKChwbHVnaW4pID0+IHtcbiAgICAgICAgaWYgKHBsdWdpbiA9PT0gbnVsbCB8fCBwbHVnaW4gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHBsdWdpbi5kZXN0cm95KVxuICAgICAgICAgICAgcGx1Z2luLmRlc3Ryb3koKTtcbiAgICB9KTtcbn07XG5jb25zdCBpbnZva2VQbHVnaW5zQmVmb3JlUmVuZGVyID0gKCRhcHApID0+IHtcbiAgICBPYmplY3QudmFsdWVzKCRhcHAuY29uZmlnLnBsdWdpbnMpLmZvckVhY2goKHBsdWdpbikgPT4ge1xuICAgICAgICBpZiAocGx1Z2luID09PSBudWxsIHx8IHBsdWdpbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogcGx1Z2luLmJlZm9yZVJlbmRlcilcbiAgICAgICAgICAgIHBsdWdpbi5iZWZvcmVSZW5kZXIoJGFwcCk7XG4gICAgfSk7XG59O1xuXG5mdW5jdGlvbiBDYWxlbmRhcldyYXBwZXIoeyAkYXBwIH0pIHtcbiAgICB2YXIgX2E7XG4gICAgY29uc3QgY2FsZW5kYXJJZCA9IHJhbmRvbVN0cmluZ0lkKCk7XG4gICAgY29uc3Qgdmlld0NvbnRhaW5lcklkID0gcmFuZG9tU3RyaW5nSWQoKTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHNldFdyYXBwZXJFbGVtZW50KCRhcHAsIGNhbGVuZGFySWQpO1xuICAgICAgICBpbml0UGx1Z2lucygkYXBwKTtcbiAgICAgICAgaWYgKChfYSA9ICRhcHAuY29uZmlnLmNhbGxiYWNrcykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLm9uUmVuZGVyKSB7XG4gICAgICAgICAgICAkYXBwLmNvbmZpZy5jYWxsYmFja3Mub25SZW5kZXIoJGFwcCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICgpID0+IGRlc3Ryb3lQbHVnaW5zKCRhcHApO1xuICAgIH0sIFtdKTtcbiAgICBjb25zdCBvblJlc2l6ZSA9ICgpID0+IHtcbiAgICAgICAgaGFuZGxlV2luZG93UmVzaXplKCRhcHApO1xuICAgIH07XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKCRhcHAuY29uZmlnLmlzUmVzcG9uc2l2ZSkge1xuICAgICAgICAgICAgb25SZXNpemUoKTtcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBvblJlc2l6ZSk7XG4gICAgICAgICAgICByZXR1cm4gKCkgPT4gd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIG9uUmVzaXplKTtcbiAgICAgICAgfVxuICAgIH0sIFtdKTtcbiAgICBjb25zdCB3cmFwcGVyQ2xhc3NlcyA9IHVzZVdyYXBwZXJDbGFzc2VzKCRhcHApO1xuICAgIGNvbnN0IFtjdXJyZW50Vmlldywgc2V0Q3VycmVudFZpZXddID0gdXNlU3RhdGUoKTtcbiAgICB1c2VTaWduYWxFZmZlY3QoKCkgPT4ge1xuICAgICAgICBjb25zdCBuZXdWaWV3ID0gJGFwcC5jb25maWcudmlld3MudmFsdWUuZmluZCgodmlldykgPT4gdmlldy5uYW1lID09PSAkYXBwLmNhbGVuZGFyU3RhdGUudmlldy52YWx1ZSk7XG4gICAgICAgIGNvbnN0IHZpZXdFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodmlld0NvbnRhaW5lcklkKTtcbiAgICAgICAgaWYgKCFuZXdWaWV3IHx8ICF2aWV3RWxlbWVudCB8fCBuZXdWaWV3Lm5hbWUgPT09IChjdXJyZW50VmlldyA9PT0gbnVsbCB8fCBjdXJyZW50VmlldyA9PT0gdm9pZCAwID8gdm9pZCAwIDogY3VycmVudFZpZXcubmFtZSkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGlmIChjdXJyZW50VmlldylcbiAgICAgICAgICAgIGN1cnJlbnRWaWV3LmRlc3Ryb3koKTtcbiAgICAgICAgc2V0Q3VycmVudFZpZXcobmV3Vmlldyk7XG4gICAgICAgIG5ld1ZpZXcucmVuZGVyKHZpZXdFbGVtZW50LCAkYXBwKTtcbiAgICB9KTtcbiAgICBjb25zdCBbcHJldmlvdXNSYW5nZVN0YXJ0LCBzZXRQcmV2aW91c1JhbmdlU3RhcnRdID0gdXNlU3RhdGUoJycpO1xuICAgIGNvbnN0IFt0cmFuc2l0aW9uQ2xhc3MsIHNldFRyYW5zaXRpb25DbGFzc10gPSB1c2VTdGF0ZSgnJyk7XG4gICAgdXNlU2lnbmFsRWZmZWN0KCgpID0+IHtcbiAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgLy8gVGhlcmUgaXMgbm8gcmVhc29uIHRvIHRyYW5zaXRpb24gc2lkZXdheXMsIGJlY2F1c2UgdGhlIGxpc3QgdmlldyBpcyBleHBhbmRlZCB2ZXJ0aWNhbGx5LCB1bmxpa2UgdGhlIG90aGVyIHZpZXdzXG4gICAgICAgIGlmICgkYXBwLmNhbGVuZGFyU3RhdGUudmlldy52YWx1ZSA9PT0gSW50ZXJuYWxWaWV3TmFtZS5MaXN0KVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBjb25zdCBuZXdSYW5nZVN0YXJ0SXNMYXRlclRoYW5QcmV2aW91cyA9ICgoKF9hID0gJGFwcC5jYWxlbmRhclN0YXRlLnJhbmdlLnZhbHVlKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Euc3RhcnQudG9TdHJpbmcoKSkgfHwgJycpID5cbiAgICAgICAgICAgIHByZXZpb3VzUmFuZ2VTdGFydDtcbiAgICAgICAgLy8gVXNlIHJlcXVlc3RBbmltYXRpb25GcmFtZSB0byBlbnN1cmUgc21vb3RoIGFuaW1hdGlvbiB0aW1pbmdcbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcbiAgICAgICAgICAgIHNldFRyYW5zaXRpb25DbGFzcyhuZXdSYW5nZVN0YXJ0SXNMYXRlclRoYW5QcmV2aW91cyA/ICdzeF9fc2xpZGUtbGVmdCcgOiAnc3hfX3NsaWRlLXJpZ2h0Jyk7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICBzZXRUcmFuc2l0aW9uQ2xhc3MoJycpO1xuICAgICAgICAgICAgfSwgMzAwKTsgLy8gQ09SUkVMQVRJT04gSUQ6IDNcbiAgICAgICAgfSk7XG4gICAgICAgIHNldFByZXZpb3VzUmFuZ2VTdGFydCgoKF9iID0gJGFwcC5jYWxlbmRhclN0YXRlLnJhbmdlLnZhbHVlKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Iuc3RhcnQudG9TdHJpbmcoKSkgfHwgJycpO1xuICAgIH0pO1xuICAgIHVzZVNpZ25hbEVmZmVjdCgoKSA9PiB7XG4gICAgICAgICRhcHAuZGF0ZVBpY2tlckNvbmZpZy5sb2NhbGUudmFsdWUgPSAkYXBwLmNvbmZpZy5sb2NhbGUudmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIChqc3goRnJhZ21lbnQsIHsgY2hpbGRyZW46IGpzeChcImRpdlwiLCB7IGNsYXNzTmFtZTogd3JhcHBlckNsYXNzZXMuam9pbignICcpLCBpZDogY2FsZW5kYXJJZCwgY2hpbGRyZW46IGpzeChcImRpdlwiLCB7IGNsYXNzTmFtZTogJ3N4X19jYWxlbmRhcicsIGNoaWxkcmVuOiBqc3hzKEFwcENvbnRleHQuUHJvdmlkZXIsIHsgdmFsdWU6ICRhcHAsIGNoaWxkcmVuOiBbanN4KENhbGVuZGFySGVhZGVyLCB7fSksIGpzeChcImRpdlwiLCB7IGNsYXNzTmFtZTogWydzeF9fdmlldy1jb250YWluZXInLCB0cmFuc2l0aW9uQ2xhc3NdLmpvaW4oJyAnKSwgaWQ6IHZpZXdDb250YWluZXJJZCB9KSwgJGFwcC5jb25maWcucGx1Z2lucy5ldmVudE1vZGFsICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGFwcC5jb25maWcucGx1Z2lucy5ldmVudE1vZGFsLmNhbGVuZGFyRXZlbnQudmFsdWUgJiYgKGpzeCgkYXBwLmNvbmZpZy5wbHVnaW5zLmV2ZW50TW9kYWwuQ29tcG9uZW50Rm4sIHsgXCIkYXBwXCI6ICRhcHAgfSwgKF9hID0gJGFwcC5jb25maWcucGx1Z2lucy5ldmVudE1vZGFsLmNhbGVuZGFyRXZlbnQudmFsdWUpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5pZCkpXSB9KSB9KSB9KSB9KSk7XG59XG5cbmNvbnN0IGV4dGVybmFsRXZlbnRUb0ludGVybmFsID0gKGV2ZW50LCBjb25maWcpID0+IHtcbiAgICBjb25zdCB7IGlkLCBzdGFydCwgZW5kLCB0aXRsZSwgZGVzY3JpcHRpb24sIGxvY2F0aW9uLCBwZW9wbGUsIF9vcHRpb25zLCAuLi5mb3JlaWduUHJvcGVydGllcyB9ID0gZXZlbnQ7XG4gICAgcmV0dXJuIG5ldyBDYWxlbmRhckV2ZW50QnVpbGRlcihjb25maWcsIGlkLCBzdGFydCwgZW5kKVxuICAgICAgICAud2l0aFRpdGxlKHRpdGxlKVxuICAgICAgICAud2l0aERlc2NyaXB0aW9uKGRlc2NyaXB0aW9uKVxuICAgICAgICAud2l0aExvY2F0aW9uKGxvY2F0aW9uKVxuICAgICAgICAud2l0aFBlb3BsZShwZW9wbGUpXG4gICAgICAgIC53aXRoQ2FsZW5kYXJJZChldmVudC5jYWxlbmRhcklkKVxuICAgICAgICAud2l0aE9wdGlvbnMoX29wdGlvbnMpXG4gICAgICAgIC53aXRoRm9yZWlnblByb3BlcnRpZXMoZm9yZWlnblByb3BlcnRpZXMpXG4gICAgICAgIC53aXRoQ3VzdG9tQ29udGVudChldmVudC5fY3VzdG9tQ29udGVudClcbiAgICAgICAgLmJ1aWxkKCk7XG59O1xuXG5jbGFzcyBFdmVudHNGYWNhZGVJbXBsIHtcbiAgICBjb25zdHJ1Y3RvcigkYXBwKSB7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIiRhcHBcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6ICRhcHBcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHNldChldmVudHMpIHtcbiAgICAgICAgdGhpcy4kYXBwLmNhbGVuZGFyRXZlbnRzLmxpc3QudmFsdWUgPSBldmVudHMubWFwKChldmVudCkgPT4gZXh0ZXJuYWxFdmVudFRvSW50ZXJuYWwoZXZlbnQsIHRoaXMuJGFwcC5jb25maWcpKTtcbiAgICB9XG4gICAgYWRkKGV2ZW50KSB7XG4gICAgICAgIGNvbnN0IG5ld0V2ZW50ID0gZXh0ZXJuYWxFdmVudFRvSW50ZXJuYWwoZXZlbnQsIHRoaXMuJGFwcC5jb25maWcpO1xuICAgICAgICBuZXdFdmVudC5fY3JlYXRlZEF0ID0gbmV3IERhdGUoKTtcbiAgICAgICAgY29uc3QgY29waWVkRXZlbnRzID0gWy4uLnRoaXMuJGFwcC5jYWxlbmRhckV2ZW50cy5saXN0LnZhbHVlXTtcbiAgICAgICAgY29waWVkRXZlbnRzLnB1c2gobmV3RXZlbnQpO1xuICAgICAgICB0aGlzLiRhcHAuY2FsZW5kYXJFdmVudHMubGlzdC52YWx1ZSA9IGNvcGllZEV2ZW50cztcbiAgICB9XG4gICAgZ2V0KGlkKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgcmV0dXJuIChfYSA9IHRoaXMuJGFwcC5jYWxlbmRhckV2ZW50cy5saXN0LnZhbHVlXG4gICAgICAgICAgICAuZmluZCgoZXZlbnQpID0+IGV2ZW50LmlkID09PSBpZCkpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5fZ2V0RXh0ZXJuYWxFdmVudCgpO1xuICAgIH1cbiAgICBnZXRBbGwoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLiRhcHAuY2FsZW5kYXJFdmVudHMubGlzdC52YWx1ZS5tYXAoKGV2ZW50KSA9PiBldmVudC5fZ2V0RXh0ZXJuYWxFdmVudCgpKTtcbiAgICB9XG4gICAgcmVtb3ZlKGlkKSB7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy4kYXBwLmNhbGVuZGFyRXZlbnRzLmxpc3QudmFsdWUuZmluZEluZGV4KChldmVudCkgPT4gZXZlbnQuaWQgPT09IGlkKTtcbiAgICAgICAgY29uc3QgY29waWVkRXZlbnRzID0gWy4uLnRoaXMuJGFwcC5jYWxlbmRhckV2ZW50cy5saXN0LnZhbHVlXTtcbiAgICAgICAgY29waWVkRXZlbnRzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIHRoaXMuJGFwcC5jYWxlbmRhckV2ZW50cy5saXN0LnZhbHVlID0gY29waWVkRXZlbnRzO1xuICAgIH1cbiAgICB1cGRhdGUoZXZlbnQpIHtcbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLiRhcHAuY2FsZW5kYXJFdmVudHMubGlzdC52YWx1ZS5maW5kSW5kZXgoKGUpID0+IGUuaWQgPT09IGV2ZW50LmlkKTtcbiAgICAgICAgY29uc3QgY29waWVkRXZlbnRzID0gWy4uLnRoaXMuJGFwcC5jYWxlbmRhckV2ZW50cy5saXN0LnZhbHVlXTtcbiAgICAgICAgY29waWVkRXZlbnRzLnNwbGljZShpbmRleCwgMSwgZXh0ZXJuYWxFdmVudFRvSW50ZXJuYWwoZXZlbnQsIHRoaXMuJGFwcC5jb25maWcpKTtcbiAgICAgICAgdGhpcy4kYXBwLmNhbGVuZGFyRXZlbnRzLmxpc3QudmFsdWUgPSBjb3BpZWRFdmVudHM7XG4gICAgfVxufVxuXG5jbGFzcyBDYWxlbmRhckFwcCB7XG4gICAgY29uc3RydWN0b3IoJGFwcCkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIiRhcHBcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6ICRhcHBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImV2ZW50c1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJjYWxlbmRhckNvbnRhaW5lckVsXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZXZlbnRzID0gbmV3IEV2ZW50c0ZhY2FkZUltcGwodGhpcy4kYXBwKTtcbiAgICAgICAgaW52b2tlUGx1Z2luc0JlZm9yZVJlbmRlcih0aGlzLiRhcHApO1xuICAgICAgICBPYmplY3QudmFsdWVzKHRoaXMuJGFwcC5jb25maWcucGx1Z2lucykuZm9yRWFjaCgocGx1Z2luKSA9PiB7XG4gICAgICAgICAgICBpZiAoIShwbHVnaW4gPT09IG51bGwgfHwgcGx1Z2luID09PSB2b2lkIDAgPyB2b2lkIDAgOiBwbHVnaW4ubmFtZSkpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgLy8gXCJoYWNrXCIgZm9yIGVuYWJsaW5nIGFjY2Vzc2luZyBwbHVnaW5zIHZpYSBjYWxlbmRhckFwcFtwbHVnaW5OYW1lXVxuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHMtY29tbWVudFxuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgdGhpc1twbHVnaW4ubmFtZV0gPSBwbHVnaW47XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoKF9hID0gJGFwcC5jb25maWcuY2FsbGJhY2tzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuYmVmb3JlUmVuZGVyKSB7XG4gICAgICAgICAgICAkYXBwLmNvbmZpZy5jYWxsYmFja3MuYmVmb3JlUmVuZGVyKCRhcHApO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlbmRlcihlbCkge1xuICAgICAgICB0aGlzLmNhbGVuZGFyQ29udGFpbmVyRWwgPSBlbDtcbiAgICAgICAgcmVuZGVyKGNyZWF0ZUVsZW1lbnQoQ2FsZW5kYXJXcmFwcGVyLCB7ICRhcHA6IHRoaXMuJGFwcCB9KSwgZWwpO1xuICAgIH1cbiAgICBkZXN0cm95KCkge1xuICAgICAgICBPYmplY3QudmFsdWVzKHRoaXMuJGFwcC5jb25maWcucGx1Z2lucyB8fCB7fSkuZm9yRWFjaCgocGx1Z2luKSA9PiB7XG4gICAgICAgICAgICBpZiAoIXBsdWdpbiB8fCAhcGx1Z2luLmRlc3Ryb3kpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgcGx1Z2luLmRlc3Ryb3koKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh0aGlzLmNhbGVuZGFyQ29udGFpbmVyRWwpIHtcbiAgICAgICAgICAgIHJlbmRlcihudWxsLCB0aGlzLmNhbGVuZGFyQ29udGFpbmVyRWwpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNldFRoZW1lKHRoZW1lKSB7XG4gICAgICAgIHRoaXMuJGFwcC5jYWxlbmRhclN0YXRlLmlzRGFyay52YWx1ZSA9IHRoZW1lID09PSAnZGFyayc7XG4gICAgfVxuICAgIGdldFRoZW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy4kYXBwLmNhbGVuZGFyU3RhdGUuaXNEYXJrLnZhbHVlID8gJ2RhcmsnIDogJ2xpZ2h0JztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGludGVybmFsXG4gICAgICogUHVycG9zZTogVG8gYmUgY29uc3VtZWQgYnkgZnJhbWV3b3JrIGFkYXB0ZXJzIGZvciBjdXN0b20gY29tcG9uZW50IHJlbmRlcmluZy5cbiAgICAgKiAqL1xuICAgIF9zZXRDdXN0b21Db21wb25lbnRGbihmbklkLCBmbikge1xuICAgICAgICB0aGlzLiRhcHAuY29uZmlnLl9jdXN0b21Db21wb25lbnRGbnNbZm5JZF0gPSBmbjtcbiAgICB9XG4gICAgX3NldERlc3Ryb3lDdXN0b21Db21wb25lbnRJbnN0YW5jZShjYikge1xuICAgICAgICB0aGlzLiRhcHAuY29uZmlnLl9kZXN0cm95Q3VzdG9tQ29tcG9uZW50SW5zdGFuY2UgPSBjYjtcbiAgICB9XG59XG5cbmNsYXNzIENhbGVuZGFyQXBwU2luZ2xldG9uSW1wbCB7XG4gICAgY29uc3RydWN0b3IoY29uZmlnLCB0aW1lVW5pdHNJbXBsLCBjYWxlbmRhclN0YXRlLCBkYXRlUGlja2VyU3RhdGUsIHRyYW5zbGF0ZSwgZGF0ZVBpY2tlckNvbmZpZywgY2FsZW5kYXJFdmVudHMsIGVsZW1lbnRzID0geyBjYWxlbmRhcldyYXBwZXI6IHVuZGVmaW5lZCB9KSB7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImNvbmZpZ1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogY29uZmlnXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJ0aW1lVW5pdHNJbXBsXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB0aW1lVW5pdHNJbXBsXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJjYWxlbmRhclN0YXRlXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBjYWxlbmRhclN0YXRlXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJkYXRlUGlja2VyU3RhdGVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IGRhdGVQaWNrZXJTdGF0ZVxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwidHJhbnNsYXRlXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB0cmFuc2xhdGVcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImRhdGVQaWNrZXJDb25maWdcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IGRhdGVQaWNrZXJDb25maWdcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImNhbGVuZGFyRXZlbnRzXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBjYWxlbmRhckV2ZW50c1xuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiZWxlbWVudHNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IGVsZW1lbnRzXG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuY2xhc3MgQ2FsZW5kYXJBcHBTaW5nbGV0b25CdWlsZGVyIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiY29uZmlnXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInRpbWVVbml0c0ltcGxcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiZGF0ZVBpY2tlclN0YXRlXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImNhbGVuZGFyU3RhdGVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwidHJhbnNsYXRlXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImRhdGVQaWNrZXJDb25maWdcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiY2FsZW5kYXJFdmVudHNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgYnVpbGQoKSB7XG4gICAgICAgIHJldHVybiBuZXcgQ2FsZW5kYXJBcHBTaW5nbGV0b25JbXBsKHRoaXMuY29uZmlnLCB0aGlzLnRpbWVVbml0c0ltcGwsIHRoaXMuY2FsZW5kYXJTdGF0ZSwgdGhpcy5kYXRlUGlja2VyU3RhdGUsIHRoaXMudHJhbnNsYXRlLCB0aGlzLmRhdGVQaWNrZXJDb25maWcsIHRoaXMuY2FsZW5kYXJFdmVudHMpO1xuICAgIH1cbiAgICB3aXRoQ29uZmlnKGNvbmZpZykge1xuICAgICAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZztcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHdpdGhUaW1lVW5pdHNJbXBsKHRpbWVVbml0c0ltcGwpIHtcbiAgICAgICAgdGhpcy50aW1lVW5pdHNJbXBsID0gdGltZVVuaXRzSW1wbDtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHdpdGhEYXRlUGlja2VyU3RhdGUoZGF0ZVBpY2tlclN0YXRlKSB7XG4gICAgICAgIHRoaXMuZGF0ZVBpY2tlclN0YXRlID0gZGF0ZVBpY2tlclN0YXRlO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgd2l0aENhbGVuZGFyU3RhdGUoY2FsZW5kYXJTdGF0ZSkge1xuICAgICAgICB0aGlzLmNhbGVuZGFyU3RhdGUgPSBjYWxlbmRhclN0YXRlO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgd2l0aFRyYW5zbGF0ZSh0cmFuc2xhdGUpIHtcbiAgICAgICAgdGhpcy50cmFuc2xhdGUgPSB0cmFuc2xhdGU7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICB3aXRoRGF0ZVBpY2tlckNvbmZpZyhkYXRlUGlja2VyQ29uZmlnKSB7XG4gICAgICAgIHRoaXMuZGF0ZVBpY2tlckNvbmZpZyA9IGRhdGVQaWNrZXJDb25maWc7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICB3aXRoQ2FsZW5kYXJFdmVudHMoY2FsZW5kYXJFdmVudHMpIHtcbiAgICAgICAgdGhpcy5jYWxlbmRhckV2ZW50cyA9IGNhbGVuZGFyRXZlbnRzO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG59XG5cbnZhciBEYXRlRm9ybWF0RGVsaW1pdGVyO1xuKGZ1bmN0aW9uIChEYXRlRm9ybWF0RGVsaW1pdGVyKSB7XG4gICAgRGF0ZUZvcm1hdERlbGltaXRlcltcIlNMQVNIXCJdID0gXCIvXCI7XG4gICAgRGF0ZUZvcm1hdERlbGltaXRlcltcIkRBU0hcIl0gPSBcIi1cIjtcbiAgICBEYXRlRm9ybWF0RGVsaW1pdGVyW1wiUEVSSU9EXCJdID0gXCIuXCI7XG59KShEYXRlRm9ybWF0RGVsaW1pdGVyIHx8IChEYXRlRm9ybWF0RGVsaW1pdGVyID0ge30pKTtcbnZhciBEYXRlRm9ybWF0T3JkZXI7XG4oZnVuY3Rpb24gKERhdGVGb3JtYXRPcmRlcikge1xuICAgIERhdGVGb3JtYXRPcmRlcltcIkRNWVwiXSA9IFwiRE1ZXCI7XG4gICAgRGF0ZUZvcm1hdE9yZGVyW1wiTURZXCJdID0gXCJNRFlcIjtcbiAgICBEYXRlRm9ybWF0T3JkZXJbXCJZTURcIl0gPSBcIllNRFwiO1xufSkoRGF0ZUZvcm1hdE9yZGVyIHx8IChEYXRlRm9ybWF0T3JkZXIgPSB7fSkpO1xuXG5jb25zdCBmb3JtYXRSdWxlcyA9IHtcbiAgICBzbGFzaE1EWToge1xuICAgICAgICBkZWxpbWl0ZXI6IERhdGVGb3JtYXREZWxpbWl0ZXIuU0xBU0gsXG4gICAgICAgIG9yZGVyOiBEYXRlRm9ybWF0T3JkZXIuTURZLFxuICAgIH0sXG4gICAgc2xhc2hETVk6IHtcbiAgICAgICAgZGVsaW1pdGVyOiBEYXRlRm9ybWF0RGVsaW1pdGVyLlNMQVNILFxuICAgICAgICBvcmRlcjogRGF0ZUZvcm1hdE9yZGVyLkRNWSxcbiAgICB9LFxuICAgIHNsYXNoWU1EOiB7XG4gICAgICAgIGRlbGltaXRlcjogRGF0ZUZvcm1hdERlbGltaXRlci5TTEFTSCxcbiAgICAgICAgb3JkZXI6IERhdGVGb3JtYXRPcmRlci5ZTUQsXG4gICAgfSxcbiAgICBwZXJpb2RETVk6IHtcbiAgICAgICAgZGVsaW1pdGVyOiBEYXRlRm9ybWF0RGVsaW1pdGVyLlBFUklPRCxcbiAgICAgICAgb3JkZXI6IERhdGVGb3JtYXRPcmRlci5ETVksXG4gICAgfSxcbiAgICBkYXNoWU1EOiB7XG4gICAgICAgIGRlbGltaXRlcjogRGF0ZUZvcm1hdERlbGltaXRlci5EQVNILFxuICAgICAgICBvcmRlcjogRGF0ZUZvcm1hdE9yZGVyLllNRCxcbiAgICB9LFxuICAgIGRhc2hETVk6IHtcbiAgICAgICAgZGVsaW1pdGVyOiBEYXRlRm9ybWF0RGVsaW1pdGVyLkRBU0gsXG4gICAgICAgIG9yZGVyOiBEYXRlRm9ybWF0T3JkZXIuRE1ZLFxuICAgIH0sXG59O1xuY29uc3QgZGF0ZUZvcm1hdExvY2FsaXplZFJ1bGVzID0gbmV3IE1hcChbXG4gICAgWydjYS1FUycsIGZvcm1hdFJ1bGVzLnNsYXNoRE1ZXSxcbiAgICBbJ2NzLUNaJywgZm9ybWF0UnVsZXMucGVyaW9kRE1ZXSxcbiAgICBbJ2RhLURLJywgZm9ybWF0UnVsZXMucGVyaW9kRE1ZXSxcbiAgICBbJ2RlLURFJywgZm9ybWF0UnVsZXMucGVyaW9kRE1ZXSxcbiAgICBbJ2VuLUdCJywgZm9ybWF0UnVsZXMuc2xhc2hETVldLFxuICAgIFsnZW4tVVMnLCBmb3JtYXRSdWxlcy5zbGFzaE1EWV0sXG4gICAgWydlcy1FUycsIGZvcm1hdFJ1bGVzLnNsYXNoRE1ZXSxcbiAgICBbJ2V0LUVFJywgZm9ybWF0UnVsZXMucGVyaW9kRE1ZXSxcbiAgICBbJ2ZpLUZJJywgZm9ybWF0UnVsZXMucGVyaW9kRE1ZXSxcbiAgICBbJ2ZyLUZSJywgZm9ybWF0UnVsZXMuc2xhc2hETVldLFxuICAgIFsnZnItQ0gnLCBmb3JtYXRSdWxlcy5wZXJpb2RETVldLFxuICAgIFsnaHItSFInLCBmb3JtYXRSdWxlcy5wZXJpb2RETVldLFxuICAgIFsnaWQtSUQnLCBmb3JtYXRSdWxlcy5zbGFzaERNWV0sXG4gICAgWydpdC1JVCcsIGZvcm1hdFJ1bGVzLnNsYXNoRE1ZXSxcbiAgICBbJ2phLUpQJywgZm9ybWF0UnVsZXMuc2xhc2hZTURdLFxuICAgIFsna28tS1InLCBmb3JtYXRSdWxlcy5zbGFzaFlNRF0sXG4gICAgWydreS1LRycsIGZvcm1hdFJ1bGVzLnNsYXNoRE1ZXSxcbiAgICBbJ2x0LUxUJywgZm9ybWF0UnVsZXMuZGFzaFlNRF0sXG4gICAgWydtay1NSycsIGZvcm1hdFJ1bGVzLnBlcmlvZERNWV0sXG4gICAgWydubC1OTCcsIGZvcm1hdFJ1bGVzLmRhc2hETVldLFxuICAgIFsncGwtUEwnLCBmb3JtYXRSdWxlcy5wZXJpb2RETVldLFxuICAgIFsncHQtQlInLCBmb3JtYXRSdWxlcy5zbGFzaERNWV0sXG4gICAgWydyby1STycsIGZvcm1hdFJ1bGVzLnBlcmlvZERNWV0sXG4gICAgWydydS1SVScsIGZvcm1hdFJ1bGVzLnBlcmlvZERNWV0sXG4gICAgWydzay1TSycsIGZvcm1hdFJ1bGVzLnBlcmlvZERNWV0sXG4gICAgWydzbC1TSScsIGZvcm1hdFJ1bGVzLnBlcmlvZERNWV0sXG4gICAgWydzci1MYXRuLVJTJywgZm9ybWF0UnVsZXMucGVyaW9kRE1ZXSxcbiAgICBbJ3NyLVJTJywgZm9ybWF0UnVsZXMucGVyaW9kRE1ZXSxcbiAgICBbJ3N2LVNFJywgZm9ybWF0UnVsZXMuZGFzaFlNRF0sXG4gICAgWyd0ci1UUicsIGZvcm1hdFJ1bGVzLnBlcmlvZERNWV0sXG4gICAgWyd1ay1VQScsIGZvcm1hdFJ1bGVzLnBlcmlvZERNWV0sXG4gICAgWyd6aC1DTicsIGZvcm1hdFJ1bGVzLnNsYXNoWU1EXSxcbiAgICBbJ3poLVRXJywgZm9ybWF0UnVsZXMuc2xhc2hZTURdLFxuXSk7XG5cbmNsYXNzIExvY2FsZU5vdFN1cHBvcnRlZEVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICAgIGNvbnN0cnVjdG9yKGxvY2FsZSkge1xuICAgICAgICBzdXBlcihgTG9jYWxlIG5vdCBzdXBwb3J0ZWQ6ICR7bG9jYWxlfWApO1xuICAgIH1cbn1cblxuY2xhc3MgSW52YWxpZERhdGVGb3JtYXRFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgICBjb25zdHJ1Y3RvcihkYXRlRm9ybWF0LCBsb2NhbGUpIHtcbiAgICAgICAgc3VwZXIoYEludmFsaWQgZGF0ZSBmb3JtYXQ6ICR7ZGF0ZUZvcm1hdH0gZm9yIGxvY2FsZTogJHtsb2NhbGV9YCk7XG4gICAgfVxufVxuXG5jb25zdCBfZ2V0TWF0Y2hlc09yVGhyb3cgPSAoZm9ybWF0LCBtYXRjaGVyLCBsb2NhbGUpID0+IHtcbiAgICBjb25zdCBtYXRjaGVzID0gZm9ybWF0Lm1hdGNoKG1hdGNoZXIpO1xuICAgIGlmICghbWF0Y2hlcylcbiAgICAgICAgdGhyb3cgbmV3IEludmFsaWREYXRlRm9ybWF0RXJyb3IoZm9ybWF0LCBsb2NhbGUpO1xuICAgIHJldHVybiBtYXRjaGVzO1xufTtcbmNvbnN0IHRvRGF0ZVN0cmluZyA9IChmb3JtYXQsIGxvY2FsZSkgPT4ge1xuICAgIGNvbnN0IGludGVybmF0aW9uYWxGb3JtYXQgPSAvXlxcZHs0fS1cXGR7Mn0tXFxkezJ9JC87XG4gICAgaWYgKGludGVybmF0aW9uYWxGb3JtYXQudGVzdChmb3JtYXQpKVxuICAgICAgICByZXR1cm4gZm9ybWF0OyAvLyBhbGxvdyBpbnRlcm5hdGlvbmFsIGZvcm1hdCByZWdhcmRsZXNzIG9mIGxvY2FsZVxuICAgIGNvbnN0IGxvY2FsZURhdGVGb3JtYXRSdWxlID0gZGF0ZUZvcm1hdExvY2FsaXplZFJ1bGVzLmdldChsb2NhbGUpO1xuICAgIGlmICghbG9jYWxlRGF0ZUZvcm1hdFJ1bGUpXG4gICAgICAgIHRocm93IG5ldyBMb2NhbGVOb3RTdXBwb3J0ZWRFcnJvcihsb2NhbGUpO1xuICAgIGNvbnN0IHsgb3JkZXIsIGRlbGltaXRlciB9ID0gbG9jYWxlRGF0ZUZvcm1hdFJ1bGU7XG4gICAgY29uc3QgcGF0dGVybjIyNFNsYXNoZWQgPSAvXihcXGR7MSwyfSlcXC8oXFxkezEsMn0pXFwvKFxcZHs0fSkkLztcbiAgICBjb25zdCBwYXR0ZXJuMjI0RG90dGVkID0gL14oXFxkezEsMn0pXFwuKFxcZHsxLDJ9KVxcLihcXGR7NH0pJC87XG4gICAgY29uc3QgcGF0dGVybjQ0MlNsYXNoZWQgPSAvXihcXGR7NH0pXFwvKFxcZHsxLDJ9KVxcLyhcXGR7MSwyfSkkLztcbiAgICBpZiAob3JkZXIgPT09IERhdGVGb3JtYXRPcmRlci5ETVkgJiYgZGVsaW1pdGVyID09PSBEYXRlRm9ybWF0RGVsaW1pdGVyLlNMQVNIKSB7XG4gICAgICAgIGNvbnN0IG1hdGNoZXMgPSBfZ2V0TWF0Y2hlc09yVGhyb3coZm9ybWF0LCBwYXR0ZXJuMjI0U2xhc2hlZCwgbG9jYWxlKTtcbiAgICAgICAgY29uc3QgWywgZGF5LCBtb250aCwgeWVhcl0gPSBtYXRjaGVzO1xuICAgICAgICByZXR1cm4gYCR7eWVhcn0tJHtkb3VibGVEaWdpdCgrbW9udGgpfS0ke2RvdWJsZURpZ2l0KCtkYXkpfWA7XG4gICAgfVxuICAgIGlmIChvcmRlciA9PT0gRGF0ZUZvcm1hdE9yZGVyLk1EWSAmJiBkZWxpbWl0ZXIgPT09IERhdGVGb3JtYXREZWxpbWl0ZXIuU0xBU0gpIHtcbiAgICAgICAgY29uc3QgbWF0Y2hlcyA9IF9nZXRNYXRjaGVzT3JUaHJvdyhmb3JtYXQsIHBhdHRlcm4yMjRTbGFzaGVkLCBsb2NhbGUpO1xuICAgICAgICBjb25zdCBbLCBtb250aCwgZGF5LCB5ZWFyXSA9IG1hdGNoZXM7XG4gICAgICAgIHJldHVybiBgJHt5ZWFyfS0ke2RvdWJsZURpZ2l0KCttb250aCl9LSR7ZG91YmxlRGlnaXQoK2RheSl9YDtcbiAgICB9XG4gICAgaWYgKG9yZGVyID09PSBEYXRlRm9ybWF0T3JkZXIuWU1EICYmIGRlbGltaXRlciA9PT0gRGF0ZUZvcm1hdERlbGltaXRlci5TTEFTSCkge1xuICAgICAgICBjb25zdCBtYXRjaGVzID0gX2dldE1hdGNoZXNPclRocm93KGZvcm1hdCwgcGF0dGVybjQ0MlNsYXNoZWQsIGxvY2FsZSk7XG4gICAgICAgIGNvbnN0IFssIHllYXIsIG1vbnRoLCBkYXldID0gbWF0Y2hlcztcbiAgICAgICAgcmV0dXJuIGAke3llYXJ9LSR7ZG91YmxlRGlnaXQoK21vbnRoKX0tJHtkb3VibGVEaWdpdCgrZGF5KX1gO1xuICAgIH1cbiAgICBpZiAob3JkZXIgPT09IERhdGVGb3JtYXRPcmRlci5ETVkgJiYgZGVsaW1pdGVyID09PSBEYXRlRm9ybWF0RGVsaW1pdGVyLlBFUklPRCkge1xuICAgICAgICBjb25zdCBtYXRjaGVzID0gX2dldE1hdGNoZXNPclRocm93KGZvcm1hdCwgcGF0dGVybjIyNERvdHRlZCwgbG9jYWxlKTtcbiAgICAgICAgY29uc3QgWywgZGF5LCBtb250aCwgeWVhcl0gPSBtYXRjaGVzO1xuICAgICAgICByZXR1cm4gYCR7eWVhcn0tJHtkb3VibGVEaWdpdCgrbW9udGgpfS0ke2RvdWJsZURpZ2l0KCtkYXkpfWA7XG4gICAgfVxuICAgIHRocm93IG5ldyBJbnZhbGlkRGF0ZUZvcm1hdEVycm9yKGZvcm1hdCwgbG9jYWxlKTtcbn07XG5cbmNvbnN0IGdldExvY2FsaXplZERhdGUgPSAoZGF0ZSwgbG9jYWxlKSA9PiB7XG4gICAgcmV0dXJuIHRvTG9jYWxpemVkRGF0ZVN0cmluZyhkYXRlLCBsb2NhbGUpO1xufTtcbmNvbnN0IGNyZWF0ZURhdGVQaWNrZXJTdGF0ZSA9IChjb25maWcsIHNlbGVjdGVkRGF0ZVBhcmFtKSA9PiB7XG4gICAgdmFyIF9hO1xuICAgIGNvbnN0IGluaXRpYWxTZWxlY3RlZERhdGUgPSBzZWxlY3RlZERhdGVQYXJhbSBpbnN0YW5jZW9mIFRlbXBvcmFsLlBsYWluRGF0ZVxuICAgICAgICA/IHNlbGVjdGVkRGF0ZVBhcmFtXG4gICAgICAgIDogVGVtcG9yYWwuTm93LnBsYWluRGF0ZUlTTygpO1xuICAgIGNvbnN0IGlzT3BlbiA9IHNpZ25hbChmYWxzZSk7XG4gICAgY29uc3QgaXNEaXNhYmxlZCA9IHNpZ25hbChjb25maWcuZGlzYWJsZWQgfHwgZmFsc2UpO1xuICAgIGNvbnN0IGRhdGVQaWNrZXJWaWV3ID0gc2lnbmFsKERhdGVQaWNrZXJWaWV3Lk1PTlRIX0RBWVMpO1xuICAgIGNvbnN0IHNlbGVjdGVkRGF0ZSA9IHNpZ25hbChpbml0aWFsU2VsZWN0ZWREYXRlKTtcbiAgICBjb25zdCBkYXRlUGlja2VyRGF0ZSA9IHNpZ25hbChpbml0aWFsU2VsZWN0ZWREYXRlKTtcbiAgICBjb25zdCBpc0RhcmsgPSBzaWduYWwoKChfYSA9IGNvbmZpZy5zdHlsZSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmRhcmspIHx8IGZhbHNlKTtcbiAgICBjb25zdCBpbnB1dERpc3BsYXllZFZhbHVlID0gc2lnbmFsKHRvTG9jYWxpemVkRGF0ZVN0cmluZyhpbml0aWFsU2VsZWN0ZWREYXRlLCBjb25maWcubG9jYWxlLnZhbHVlKSk7XG4gICAgY29uc3QgbGFzdFZhbGlkRGlzcGxheWVkVmFsdWUgPSBzaWduYWwoaW5wdXREaXNwbGF5ZWRWYWx1ZS52YWx1ZSk7XG4gICAgY29uc3QgaGFuZGxlSW5wdXQgPSAobmV3SW5wdXRWYWx1ZSkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgbmV3VmFsdWUgPSB0b0RhdGVTdHJpbmcobmV3SW5wdXRWYWx1ZSwgY29uZmlnLmxvY2FsZS52YWx1ZSk7XG4gICAgICAgICAgICBpZiAobmV3VmFsdWUgPCBjb25maWcubWluLnRvU3RyaW5nKCkgfHxcbiAgICAgICAgICAgICAgICBuZXdWYWx1ZSA+IGNvbmZpZy5tYXgudG9TdHJpbmcoKSkge1xuICAgICAgICAgICAgICAgIGlucHV0RGlzcGxheWVkVmFsdWUudmFsdWUgPSBsYXN0VmFsaWREaXNwbGF5ZWRWYWx1ZS52YWx1ZTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCB7IHllYXIsIG1vbnRoLCBkYXRlOiBkYXkgfSA9IHRvSW50ZWdlcnMobmV3VmFsdWUpO1xuICAgICAgICAgICAgY29uc3QgbmV3UGxhaW5EYXRlID0gVGVtcG9yYWwuUGxhaW5EYXRlLmZyb20oe1xuICAgICAgICAgICAgICAgIHllYXIsXG4gICAgICAgICAgICAgICAgbW9udGg6IG1vbnRoICsgMSxcbiAgICAgICAgICAgICAgICBkYXksXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHNlbGVjdGVkRGF0ZS52YWx1ZSA9IG5ld1BsYWluRGF0ZTtcbiAgICAgICAgICAgIGRhdGVQaWNrZXJEYXRlLnZhbHVlID0gbmV3UGxhaW5EYXRlO1xuICAgICAgICAgICAgbGFzdFZhbGlkRGlzcGxheWVkVmFsdWUudmFsdWUgPSBpbnB1dERpc3BsYXllZFZhbHVlLnZhbHVlO1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFyc1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChfZSkge1xuICAgICAgICAgICAgLy8gTm90aGluZyB0byBkbyBoZXJlLiBXZSBkb24ndCB3YW50IHRvIGxvZyBlcnJvcnMgd2hlbiB1c2VycyBhcmUgdHlwaW5nIGludmFsaWQgZm9ybWF0c1xuICAgICAgICB9XG4gICAgfTtcbiAgICBlZmZlY3QoKCkgPT4ge1xuICAgICAgICBpbnB1dERpc3BsYXllZFZhbHVlLnZhbHVlID0gZ2V0TG9jYWxpemVkRGF0ZShzZWxlY3RlZERhdGUudmFsdWUsIGNvbmZpZy5sb2NhbGUudmFsdWUpO1xuICAgIH0pO1xuICAgIGxldCB3YXNJbml0aWFsaXplZCA9IGZhbHNlO1xuICAgIGNvbnN0IGhhbmRsZU9uQ2hhbmdlID0gKHNlbGVjdGVkRGF0ZSkgPT4ge1xuICAgICAgICBpZiAoIXdhc0luaXRpYWxpemVkKVxuICAgICAgICAgICAgcmV0dXJuICh3YXNJbml0aWFsaXplZCA9IHRydWUpO1xuICAgICAgICBjb25maWcubGlzdGVuZXJzLm9uQ2hhbmdlKHNlbGVjdGVkRGF0ZSk7XG4gICAgfTtcbiAgICBlZmZlY3QoKCkgPT4ge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGlmICgoX2EgPSBjb25maWcubGlzdGVuZXJzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Eub25DaGFuZ2UpXG4gICAgICAgICAgICBoYW5kbGVPbkNoYW5nZShzZWxlY3RlZERhdGUudmFsdWUpO1xuICAgIH0pO1xuICAgIHJldHVybiB7XG4gICAgICAgIGlucHV0V3JhcHBlckVsZW1lbnQ6IHNpZ25hbCh1bmRlZmluZWQpLFxuICAgICAgICBpc09wZW4sXG4gICAgICAgIGlzRGlzYWJsZWQsXG4gICAgICAgIGRhdGVQaWNrZXJWaWV3LFxuICAgICAgICBzZWxlY3RlZERhdGUsXG4gICAgICAgIGRhdGVQaWNrZXJEYXRlLFxuICAgICAgICBpbnB1dERpc3BsYXllZFZhbHVlLFxuICAgICAgICBoYW5kbGVJbnB1dCxcbiAgICAgICAgaXNEYXJrLFxuICAgICAgICBvcGVuOiAoKSA9PiAoaXNPcGVuLnZhbHVlID0gdHJ1ZSksXG4gICAgICAgIGNsb3NlOiAoKSA9PiAoaXNPcGVuLnZhbHVlID0gZmFsc2UpLFxuICAgICAgICB0b2dnbGU6ICgpID0+IChpc09wZW4udmFsdWUgPSAhaXNPcGVuLnZhbHVlKSxcbiAgICAgICAgc2V0VmlldzogKHZpZXcpID0+IChkYXRlUGlja2VyVmlldy52YWx1ZSA9IHZpZXcpLFxuICAgIH07XG59O1xuXG5jb25zdCBkYXRlUGlja2VyQXJFRyA9IHtcbiAgICBEYXRlOiAn2KfZhNiq2KfYsdmK2K4nLFxuICAgICdNTS9ERC9ZWVlZJzogJ0REL01NL1lZWVknLCAvLyBLZWVwIGZvcm1hdCB1bmNoYW5nZWQgdW5sZXNzIHlvdSB3YW50IHRvIGxvY2FsaXplIGl0XG4gICAgJ05leHQgbW9udGgnOiAn2KfZhNi02YfYsSDYp9mE2YLYp9iv2YUnLFxuICAgICdQcmV2aW91cyBtb250aCc6ICfYp9mE2LTZh9ixINin2YTYs9in2KjZgicsXG4gICAgJ0Nob29zZSBEYXRlJzogJ9in2K7YqtixINin2YTYqtin2LHZitiuJyxcbn07XG5cbmNvbnN0IHRpbWVQaWNrZXJBckVHID0ge1xuICAgIFRpbWU6ICfYp9mE2YjZgtiqJyxcbiAgICBBTTogJ9i1JyxcbiAgICBQTTogJ9mFJyxcbiAgICBDYW5jZWw6ICfYpdmE2LrYp9ihJyxcbiAgICBPSzogJ9mF2YjYp9mB2YInLFxuICAgICdTZWxlY3QgdGltZSc6ICfYp9iu2KrYsSDYp9mE2YjZgtiqJyxcbn07XG5cbmNvbnN0IGNhbGVuZGFyQXJFRyA9IHtcbiAgICBUb2RheTogJ9in2YTZitmI2YUnLFxuICAgIE1vbnRoOiAn2KfZhNi02YfYsScsXG4gICAgV2VlazogJ9in2YTYo9iz2KjZiNi5JyxcbiAgICBEYXk6ICfYp9mE2YrZiNmFJyxcbiAgICBMaXN0OiAn2KfZhNmC2KfYptmF2KknLFxuICAgICdTZWxlY3QgVmlldyc6ICfYp9iu2KrYsSDYp9mE2LnYsdi2JyxcbiAgICAnKyB7e259fSBldmVudHMnOiAnKyB7e259fSDYp9mE2KPYrdiv2KfYqycsXG4gICAgJysgMSBldmVudCc6ICcrIDEg2K3Yr9irJyxcbiAgICAnTm8gZXZlbnRzJzogJ9mE2Kcg2KrZiNis2K8g2KPYrdiv2KfYqycsXG4gICAgJ05leHQgcGVyaW9kJzogJ9in2YTZgdiq2LHYqSDYp9mE2KrYp9mE2YrYqScsXG4gICAgJ1ByZXZpb3VzIHBlcmlvZCc6ICfYp9mE2YHYqtix2Kkg2KfZhNiz2KfYqNmC2KknLFxuICAgIHRvOiAn2KXZhNmJJywgLy8gYXMgaW4gMi8xLzIwMjAgdG8gMi8yLzIwMjBcbiAgICAnRnVsbCBkYXktIGFuZCBtdWx0aXBsZSBkYXkgZXZlbnRzJzogJ9ij2K3Yr9in2Ksg2YTZitmI2YUg2YPYp9mF2YQg2KPZiCDZhNi52K/YqSDYo9mK2KfZhScsXG4gICAgJ0xpbmsgdG8ge3tufX0gbW9yZSBldmVudHMgb24ge3tkYXRlfX0nOiAn2LHYp9io2Lcg2KXZhNmJIHt7bn19INij2K3Yr9in2Ksg2KPYrtix2Ykg2YHZiiB7e2RhdGV9fScsXG4gICAgJ0xpbmsgdG8gMSBtb3JlIGV2ZW50IG9uIHt7ZGF0ZX19JzogJ9ix2KfYqNi3INil2YTZiSDYrdiv2Ksg2KLYrtixINmB2Yoge3tkYXRlfX0nLFxuICAgIENXOiAn2KfZhNij2LPYqNmI2Lkge3t3ZWVrfX0nLFxuICAgIFZpZXc6ICfYudix2LYnLFxufTtcblxuY29uc3QgYXJFRyA9IHtcbiAgICAuLi5jYWxlbmRhckFyRUcsXG4gICAgLi4uZGF0ZVBpY2tlckFyRUcsXG4gICAgLi4udGltZVBpY2tlckFyRUcsXG59O1xuXG5jb25zdCBkYXRlUGlja2VyRGVERSA9IHtcbiAgICBEYXRlOiAnRGF0dW0nLFxuICAgICdNTS9ERC9ZWVlZJzogJ1RULk1NLkpKSkonLFxuICAgICdOZXh0IG1vbnRoJzogJ07DpGNoc3RlciBNb25hdCcsXG4gICAgJ1ByZXZpb3VzIG1vbnRoJzogJ1ZvcmhlcmlnZXIgTW9uYXQnLFxuICAgICdDaG9vc2UgRGF0ZSc6ICdEYXR1bSBhdXN3w6RobGVuJyxcbn07XG5cbmNvbnN0IGNhbGVuZGFyRGVERSA9IHtcbiAgICBUb2RheTogJ0hldXRlJyxcbiAgICBNb250aDogJ01vbmF0JyxcbiAgICBXZWVrOiAnV29jaGUnLFxuICAgIERheTogJ1RhZycsXG4gICAgTGlzdDogJ0xpc3RlJyxcbiAgICAnU2VsZWN0IFZpZXcnOiAnQW5zaWNodCBhdXN3w6RobGVuJyxcbiAgICBWaWV3OiAnQW5zaWNodCcsXG4gICAgJysge3tufX0gZXZlbnRzJzogJysge3tufX0gRXJlaWduaXNzZScsXG4gICAgJysgMSBldmVudCc6ICcrIDEgRXJlaWduaXMnLFxuICAgICdObyBldmVudHMnOiAnS2VpbmUgRXJlaWduaXNzZScsXG4gICAgJ05leHQgcGVyaW9kJzogJ07DpGNoc3RlciBaZWl0cmF1bScsXG4gICAgJ1ByZXZpb3VzIHBlcmlvZCc6ICdWb3JoZXJpZ2VyIFplaXRyYXVtJyxcbiAgICB0bzogJ2JpcycsIC8vIGFzIGluIDIvMS8yMDIwIHRvIDIvMi8yMDIwXG4gICAgJ0Z1bGwgZGF5LSBhbmQgbXVsdGlwbGUgZGF5IGV2ZW50cyc6ICdHYW56dMOkZ2lnZSB1bmQgbWVocnTDpGdpZ2UgVGVybWluZScsXG4gICAgJ0xpbmsgdG8ge3tufX0gbW9yZSBldmVudHMgb24ge3tkYXRlfX0nOiAnTGluayB6dSB7e259fSB3ZWl0ZXJlbiBUZXJtaW5lbiBhbSB7e2RhdGV9fScsXG4gICAgJ0xpbmsgdG8gMSBtb3JlIGV2ZW50IG9uIHt7ZGF0ZX19JzogJ0xpbmsgenUgMSB3ZWl0ZXJlbSBUZXJtaW4gYW0ge3tkYXRlfX0nLFxuICAgIENXOiAnS1cge3t3ZWVrfX0nLFxufTtcblxuY29uc3QgdGltZVBpY2tlckRlREUgPSB7XG4gICAgVGltZTogJ1VocnplaXQnLFxuICAgIEFNOiAnQU0nLFxuICAgIFBNOiAnUE0nLFxuICAgIENhbmNlbDogJ0FiYnJlY2hlbicsXG4gICAgT0s6ICdPSycsXG4gICAgJ1NlbGVjdCB0aW1lJzogJ1VocnplaXQgYXVzd8OkaGxlbicsXG59O1xuXG5jb25zdCBkZURFID0ge1xuICAgIC4uLmRhdGVQaWNrZXJEZURFLFxuICAgIC4uLmNhbGVuZGFyRGVERSxcbiAgICAuLi50aW1lUGlja2VyRGVERSxcbn07XG5cbmNvbnN0IGRhdGVQaWNrZXJFblVTID0ge1xuICAgIERhdGU6ICdEYXRlJyxcbiAgICAnTU0vREQvWVlZWSc6ICdNTS9ERC9ZWVlZJyxcbiAgICAnTmV4dCBtb250aCc6ICdOZXh0IG1vbnRoJyxcbiAgICAnUHJldmlvdXMgbW9udGgnOiAnUHJldmlvdXMgbW9udGgnLFxuICAgICdDaG9vc2UgRGF0ZSc6ICdDaG9vc2UgRGF0ZScsXG59O1xuXG5jb25zdCBjYWxlbmRhckVuVVMgPSB7XG4gICAgVG9kYXk6ICdUb2RheScsXG4gICAgTW9udGg6ICdNb250aCcsXG4gICAgV2VlazogJ1dlZWsnLFxuICAgIERheTogJ0RheScsXG4gICAgTGlzdDogJ0xpc3QnLFxuICAgICdTZWxlY3QgVmlldyc6ICdTZWxlY3QgVmlldycsXG4gICAgVmlldzogJ1ZpZXcnLFxuICAgICcrIHt7bn19IGV2ZW50cyc6ICcrIHt7bn19IGV2ZW50cycsXG4gICAgJysgMSBldmVudCc6ICcrIDEgZXZlbnQnLFxuICAgICdObyBldmVudHMnOiAnTm8gZXZlbnRzJyxcbiAgICAnTmV4dCBwZXJpb2QnOiAnTmV4dCBwZXJpb2QnLFxuICAgICdQcmV2aW91cyBwZXJpb2QnOiAnUHJldmlvdXMgcGVyaW9kJyxcbiAgICB0bzogJ3RvJywgLy8gYXMgaW4gMi8xLzIwMjAgdG8gMi8yLzIwMjBcbiAgICAnRnVsbCBkYXktIGFuZCBtdWx0aXBsZSBkYXkgZXZlbnRzJzogJ0Z1bGwgZGF5LSBhbmQgbXVsdGlwbGUgZGF5IGV2ZW50cycsXG4gICAgJ0xpbmsgdG8ge3tufX0gbW9yZSBldmVudHMgb24ge3tkYXRlfX0nOiAnTGluayB0byB7e259fSBtb3JlIGV2ZW50cyBvbiB7e2RhdGV9fScsXG4gICAgJ0xpbmsgdG8gMSBtb3JlIGV2ZW50IG9uIHt7ZGF0ZX19JzogJ0xpbmsgdG8gMSBtb3JlIGV2ZW50IG9uIHt7ZGF0ZX19JyxcbiAgICBDVzogJ1dlZWsge3t3ZWVrfX0nLFxufTtcblxuY29uc3QgdGltZVBpY2tlckVuVVMgPSB7XG4gICAgVGltZTogJ1RpbWUnLFxuICAgIEFNOiAnQU0nLFxuICAgIFBNOiAnUE0nLFxuICAgIENhbmNlbDogJ0NhbmNlbCcsXG4gICAgT0s6ICdPSycsXG4gICAgJ1NlbGVjdCB0aW1lJzogJ1NlbGVjdCB0aW1lJyxcbn07XG5cbmNvbnN0IGVuVVMgPSB7XG4gICAgLi4uZGF0ZVBpY2tlckVuVVMsXG4gICAgLi4uY2FsZW5kYXJFblVTLFxuICAgIC4uLnRpbWVQaWNrZXJFblVTLFxufTtcblxuY29uc3QgZGF0ZVBpY2tlckl0SVQgPSB7XG4gICAgRGF0ZTogJ0RhdGEnLFxuICAgICdNTS9ERC9ZWVlZJzogJ0REL01NL1lZWVknLFxuICAgICdOZXh0IG1vbnRoJzogJ01lc2Ugc3VjY2Vzc2l2bycsXG4gICAgJ1ByZXZpb3VzIG1vbnRoJzogJ01lc2UgcHJlY2VkZW50ZScsXG4gICAgJ0Nob29zZSBEYXRlJzogJ1NjZWdsaSBsYSBkYXRhJyxcbn07XG5cbmNvbnN0IGNhbGVuZGFySXRJVCA9IHtcbiAgICBUb2RheTogJ09nZ2knLFxuICAgIE1vbnRoOiAnTWVzZScsXG4gICAgV2VlazogJ1NldHRpbWFuYScsXG4gICAgRGF5OiAnR2lvcm5vJyxcbiAgICBMaXN0OiAnTGlzdGEnLFxuICAgICdTZWxlY3QgVmlldyc6ICdTZWxlemlvbmEgbGEgdmlzdGEnLFxuICAgIFZpZXc6ICdWaXN0YScsXG4gICAgJysge3tufX0gZXZlbnRzJzogJysge3tufX0gZXZlbnRpJyxcbiAgICAnKyAxIGV2ZW50JzogJysgMSBldmVudG8nLFxuICAgICdObyBldmVudHMnOiAnTmVzc3VuIGV2ZW50bycsXG4gICAgJ05leHQgcGVyaW9kJzogJ1BlcmlvZG8gc3VjY2Vzc2l2bycsXG4gICAgJ1ByZXZpb3VzIHBlcmlvZCc6ICdQZXJpb2RvIHByZWNlZGVudGUnLFxuICAgIHRvOiAnYScsIC8vIGFzIGluIDIvMS8yMDIwIHRvIDIvMi8yMDIwXG4gICAgJ0Z1bGwgZGF5LSBhbmQgbXVsdGlwbGUgZGF5IGV2ZW50cyc6ICdFdmVudGkgZGVsbGEgZ2lvcm5hdGEgZSBwbHVyaWdpb3JuYWxpZXJpJyxcbiAgICAnTGluayB0byB7e259fSBtb3JlIGV2ZW50cyBvbiB7e2RhdGV9fSc6ICdMaW5rIGEge3tufX0gZXZlbnRpIGluIHBpw7kgaWwge3tkYXRlfX0nLFxuICAgICdMaW5rIHRvIDEgbW9yZSBldmVudCBvbiB7e2RhdGV9fSc6ICdMaW5rIGEgMSBldmVudG8gaW4gcGnDuSBpbCB7e2RhdGV9fScsXG4gICAgQ1c6ICdTZXR0aW1hbmEge3t3ZWVrfX0nLFxufTtcblxuY29uc3QgdGltZVBpY2tlckl0SVQgPSB7XG4gICAgVGltZTogJ09yYScsXG4gICAgQU06ICdBTScsXG4gICAgUE06ICdQTScsXG4gICAgQ2FuY2VsOiAnQW5udWxsYScsXG4gICAgT0s6ICdPSycsXG4gICAgJ1NlbGVjdCB0aW1lJzogJ1NlbGV6aW9uYSBvcmEnLFxufTtcblxuY29uc3QgaXRJVCA9IHtcbiAgICAuLi5kYXRlUGlja2VySXRJVCxcbiAgICAuLi5jYWxlbmRhckl0SVQsXG4gICAgLi4udGltZVBpY2tlckl0SVQsXG59O1xuXG5jb25zdCBkYXRlUGlja2VyRW5HQiA9IHtcbiAgICBEYXRlOiAnRGF0ZScsXG4gICAgJ01NL0REL1lZWVknOiAnREQvTU0vWVlZWScsXG4gICAgJ05leHQgbW9udGgnOiAnTmV4dCBtb250aCcsXG4gICAgJ1ByZXZpb3VzIG1vbnRoJzogJ1ByZXZpb3VzIG1vbnRoJyxcbiAgICAnQ2hvb3NlIERhdGUnOiAnQ2hvb3NlIERhdGUnLFxufTtcblxuY29uc3QgY2FsZW5kYXJFbkdCID0ge1xuICAgIFRvZGF5OiAnVG9kYXknLFxuICAgIE1vbnRoOiAnTW9udGgnLFxuICAgIFdlZWs6ICdXZWVrJyxcbiAgICBEYXk6ICdEYXknLFxuICAgIExpc3Q6ICdMaXN0JyxcbiAgICAnU2VsZWN0IFZpZXcnOiAnU2VsZWN0IFZpZXcnLFxuICAgICcrIHt7bn19IGV2ZW50cyc6ICcrIHt7bn19IGV2ZW50cycsXG4gICAgJysgMSBldmVudCc6ICcrIDEgZXZlbnQnLFxuICAgICdObyBldmVudHMnOiAnTm8gZXZlbnRzJyxcbiAgICAnTmV4dCBwZXJpb2QnOiAnTmV4dCBwZXJpb2QnLFxuICAgICdQcmV2aW91cyBwZXJpb2QnOiAnUHJldmlvdXMgcGVyaW9kJyxcbiAgICB0bzogJ3RvJywgLy8gYXMgaW4gMi8xLzIwMjAgdG8gMi8yLzIwMjBcbiAgICAnRnVsbCBkYXktIGFuZCBtdWx0aXBsZSBkYXkgZXZlbnRzJzogJ0Z1bGwgZGF5LSBhbmQgbXVsdGlwbGUgZGF5IGV2ZW50cycsXG4gICAgJ0xpbmsgdG8ge3tufX0gbW9yZSBldmVudHMgb24ge3tkYXRlfX0nOiAnTGluayB0byB7e259fSBtb3JlIGV2ZW50cyBvbiB7e2RhdGV9fScsXG4gICAgJ0xpbmsgdG8gMSBtb3JlIGV2ZW50IG9uIHt7ZGF0ZX19JzogJ0xpbmsgdG8gMSBtb3JlIGV2ZW50IG9uIHt7ZGF0ZX19JyxcbiAgICBDVzogJ1dlZWsge3t3ZWVrfX0nLFxuICAgIFZpZXc6ICdWaWV3Jyxcbn07XG5cbmNvbnN0IHRpbWVQaWNrZXJFbkdCID0ge1xuICAgIFRpbWU6ICdUaW1lJyxcbiAgICBBTTogJ0FNJyxcbiAgICBQTTogJ1BNJyxcbiAgICBDYW5jZWw6ICdDYW5jZWwnLFxuICAgIE9LOiAnT0snLFxuICAgICdTZWxlY3QgdGltZSc6ICdTZWxlY3QgdGltZScsXG59O1xuXG5jb25zdCBlbkdCID0ge1xuICAgIC4uLmRhdGVQaWNrZXJFbkdCLFxuICAgIC4uLmNhbGVuZGFyRW5HQixcbiAgICAuLi50aW1lUGlja2VyRW5HQixcbn07XG5cbmNvbnN0IGRhdGVQaWNrZXJTdlNFID0ge1xuICAgIERhdGU6ICdEYXR1bScsXG4gICAgJ01NL0REL1lZWVknOiAnw4XDhcOFw4UtTU0tREQnLFxuICAgICdOZXh0IG1vbnRoJzogJ07DpHN0YSBtw6VuYWQnLFxuICAgICdQcmV2aW91cyBtb250aCc6ICdGw7ZyZWfDpWVuZGUgbcOlbmFkJyxcbiAgICAnQ2hvb3NlIERhdGUnOiAnVsOkbGogZGF0dW0nLFxufTtcblxuY29uc3QgY2FsZW5kYXJTdlNFID0ge1xuICAgIFRvZGF5OiAnSWRhZycsXG4gICAgTW9udGg6ICdNw6VuYWQnLFxuICAgIFdlZWs6ICdWZWNrYScsXG4gICAgRGF5OiAnRGFnJyxcbiAgICBMaXN0OiAnTGlzdGEnLFxuICAgICdTZWxlY3QgVmlldyc6ICdWw6RsaiB2eScsXG4gICAgVmlldzogJ1Z5JyxcbiAgICAnKyB7e259fSBldmVudHMnOiAnKyB7e259fSBow6RuZGVsc2VyJyxcbiAgICAnKyAxIGV2ZW50JzogJysgMSBow6RuZGVsc2UnLFxuICAgICdObyBldmVudHMnOiAnSW5nYSBow6RuZGVsc2VyJyxcbiAgICAnTmV4dCBwZXJpb2QnOiAnTsOkc3RhIHBlcmlvZCcsXG4gICAgJ1ByZXZpb3VzIHBlcmlvZCc6ICdGw7ZyZWfDpWVuZGUgcGVyaW9kJyxcbiAgICB0bzogJ3RpbGwnLCAvLyBhcyBpbiAyLzEvMjAyMCB0byAyLzIvMjAyMFxuICAgICdGdWxsIGRheS0gYW5kIG11bHRpcGxlIGRheSBldmVudHMnOiAnSGVsZGFncy0gb2NoIGZsZXJkYWdzaMOkbmRlbHNlcicsXG4gICAgJ0xpbmsgdG8ge3tufX0gbW9yZSBldmVudHMgb24ge3tkYXRlfX0nOiAnTMOkbmsgdGlsbCB7e259fSBmbGVyIGjDpG5kZWxzZXIgZGVuIHt7ZGF0ZX19JyxcbiAgICAnTGluayB0byAxIG1vcmUgZXZlbnQgb24ge3tkYXRlfX0nOiAnTMOkbmsgdGlsbCAxIGjDpG5kZWxzZSB0aWxsIGRlbiB7e2RhdGV9fScsXG4gICAgQ1c6ICdWZWNrYSB7e3dlZWt9fScsXG59O1xuXG5jb25zdCB0aW1lUGlja2VyU3ZTRSA9IHtcbiAgICBUaW1lOiAnVGlkJyxcbiAgICBBTTogJ0ZNJyxcbiAgICBQTTogJ0VNJyxcbiAgICBDYW5jZWw6ICdBdmJyeXQnLFxuICAgIE9LOiAnT0snLFxuICAgICdTZWxlY3QgdGltZSc6ICdWw6RsaiB0aWQnLFxufTtcblxuY29uc3Qgc3ZTRSA9IHtcbiAgICAuLi5kYXRlUGlja2VyU3ZTRSxcbiAgICAuLi5jYWxlbmRhclN2U0UsXG4gICAgLi4udGltZVBpY2tlclN2U0UsXG59O1xuXG5jb25zdCBkYXRlUGlja2VyWmhDTiA9IHtcbiAgICBEYXRlOiAn5pel5pyfJyxcbiAgICAnTU0vREQvWVlZWSc6ICflubQv5pyIL+aXpScsXG4gICAgJ05leHQgbW9udGgnOiAn5LiL5Liq5pyIJyxcbiAgICAnUHJldmlvdXMgbW9udGgnOiAn5LiK5Liq5pyIJyxcbiAgICAnQ2hvb3NlIERhdGUnOiAn6YCJ5oup5pel5pyfJyxcbn07XG5cbmNvbnN0IGNhbGVuZGFyWmhDTiA9IHtcbiAgICBUb2RheTogJ+S7iuWkqScsXG4gICAgTW9udGg6ICfmnIgnLFxuICAgIFdlZWs6ICflkagnLFxuICAgIERheTogJ+aXpScsXG4gICAgTGlzdDogJ+WIl+ihqCcsXG4gICAgJ1NlbGVjdCBWaWV3JzogJ+mAieaLqeinhuWbvicsXG4gICAgVmlldzogJ+inhuWbvicsXG4gICAgJysge3tufX0gZXZlbnRzJzogJysge3tufX0g5Zy65rS75YqoJyxcbiAgICAnKyAxIGV2ZW50JzogJysgMSDmtLvliqgnLFxuICAgICdObyBldmVudHMnOiAn5rKh5pyJ5rS75YqoJyxcbiAgICAnTmV4dCBwZXJpb2QnOiAn5LiL5LiA5q615pe26Ze0JyxcbiAgICAnUHJldmlvdXMgcGVyaW9kJzogJ+S4iuS4gOauteaXtumXtCcsXG4gICAgdG86ICfoh7MnLCAvLyBhcyBpbiAyLzEvMjAyMCB0byAyLzIvMjAyMFxuICAgICdGdWxsIGRheS0gYW5kIG11bHRpcGxlIGRheSBldmVudHMnOiAn5YWo5aSp5ZKM5aSa5aSp5rS75YqoJyxcbiAgICAnTGluayB0byB7e259fSBtb3JlIGV2ZW50cyBvbiB7e2RhdGV9fSc6ICfpk77mjqXliLB7e2RhdGV9feS4iueahHt7bn195Liq5pu05aSa5rS75YqoJyxcbiAgICAnTGluayB0byAxIG1vcmUgZXZlbnQgb24ge3tkYXRlfX0nOiAn6ZO+5o6l5Yiwe3tkYXRlfX3kuIrnmoQx5Liq5pu05aSa5rS75YqoJyxcbiAgICBDVzogJ+esrHt7d2Vla3195ZGoJyxcbn07XG5cbmNvbnN0IHRpbWVQaWNrZXJaaENOID0ge1xuICAgIFRpbWU6ICfml7bpl7QnLFxuICAgIEFNOiAn5LiK5Y2IJyxcbiAgICBQTTogJ+S4i+WNiCcsXG4gICAgQ2FuY2VsOiAn5Y+W5raIJyxcbiAgICBPSzogJ+ehruWumicsXG4gICAgJ1NlbGVjdCB0aW1lJzogJ+mAieaLqeaXtumXtCcsXG59O1xuXG5jb25zdCB6aENOID0ge1xuICAgIC4uLmRhdGVQaWNrZXJaaENOLFxuICAgIC4uLmNhbGVuZGFyWmhDTixcbiAgICAuLi50aW1lUGlja2VyWmhDTixcbn07XG5cbmNvbnN0IGRhdGVQaWNrZXJaaFRXID0ge1xuICAgIERhdGU6ICfml6XmnJ8nLFxuICAgICdNTS9ERC9ZWVlZJzogJ+W5tC/mnIgv5pelJyxcbiAgICAnTmV4dCBtb250aCc6ICfkuIvlgIvmnIgnLFxuICAgICdQcmV2aW91cyBtb250aCc6ICfkuIrlgIvmnIgnLFxuICAgICdDaG9vc2UgRGF0ZSc6ICfpgbjmk4fml6XmnJ8nLFxufTtcblxuY29uc3QgY2FsZW5kYXJaaFRXID0ge1xuICAgIFRvZGF5OiAn5LuK5aSpJyxcbiAgICBNb250aDogJ+aciCcsXG4gICAgV2VlazogJ+WRqCcsXG4gICAgRGF5OiAn5pelJyxcbiAgICBMaXN0OiAn5YiX6KGoJyxcbiAgICAnU2VsZWN0IFZpZXcnOiAn6YG45pOH5qqi6KaW5qih5byPJyxcbiAgICBWaWV3OiAn5qqi6KaWJyxcbiAgICAnKyB7e259fSBldmVudHMnOiAnKyB7e259fSDloLTmtLvli5UnLFxuICAgICcrIDEgZXZlbnQnOiAnKyAxIOa0u+WLlScsXG4gICAgJ05vIGV2ZW50cyc6ICfmspLmnInmtLvli5UnLFxuICAgICdOZXh0IHBlcmlvZCc6ICfkuIvkuIDmrrXmmYLplpMnLFxuICAgICdQcmV2aW91cyBwZXJpb2QnOiAn5LiK5LiA5q615pmC6ZaTJyxcbiAgICB0bzogJ+WIsCcsIC8vIGFzIGluIDIvMS8yMDIwIHRvIDIvMi8yMDIwXG4gICAgJ0Z1bGwgZGF5LSBhbmQgbXVsdGlwbGUgZGF5IGV2ZW50cyc6ICflhajlpKnlkozlpJrlpKnmtLvli5UnLFxuICAgICdMaW5rIHRvIHt7bn19IG1vcmUgZXZlbnRzIG9uIHt7ZGF0ZX19JzogJ+mAo+aOpeWIsHt7ZGF0ZX195LiK55qEe3tufX3lgIvmm7TlpJrmtLvli5UnLFxuICAgICdMaW5rIHRvIDEgbW9yZSBldmVudCBvbiB7e2RhdGV9fSc6ICfpgKPmjqXliLB7e2RhdGV9feS4iueahDHlgIvmm7TlpJrmtLvli5UnLFxuICAgIENXOiAn56yse3t3ZWVrfX3lkagnLFxufTtcblxuY29uc3QgdGltZVBpY2tlclpoVFcgPSB7XG4gICAgVGltZTogJ+aZgumWkycsXG4gICAgQU06ICfkuIrljYgnLFxuICAgIFBNOiAn5LiL5Y2IJyxcbiAgICBDYW5jZWw6ICflj5bmtognLFxuICAgIE9LOiAn56K65a6aJyxcbiAgICAnU2VsZWN0IHRpbWUnOiAn6YG45pOH5pmC6ZaTJyxcbn07XG5cbmNvbnN0IHpoVFcgPSB7XG4gICAgLi4uZGF0ZVBpY2tlclpoVFcsXG4gICAgLi4uY2FsZW5kYXJaaFRXLFxuICAgIC4uLnRpbWVQaWNrZXJaaFRXLFxufTtcblxuY29uc3QgZGF0ZVBpY2tlckphSlAgPSB7XG4gICAgRGF0ZTogJ+aXpeS7mCcsXG4gICAgJ01NL0REL1lZWVknOiAn5bm0L+aciC/ml6UnLFxuICAgICdOZXh0IG1vbnRoJzogJ+asoeOBruaciCcsXG4gICAgJ1ByZXZpb3VzIG1vbnRoJzogJ+WJjeOBruaciCcsXG4gICAgJ0Nob29zZSBEYXRlJzogJ+aXpeS7mOOCkumBuOaKnicsXG59O1xuXG5jb25zdCBjYWxlbmRhckphSlAgPSB7XG4gICAgVG9kYXk6ICfku4rml6UnLFxuICAgIE1vbnRoOiAn5pyIJyxcbiAgICBXZWVrOiAn6YCxJyxcbiAgICBEYXk6ICfml6UnLFxuICAgIExpc3Q6ICfjg6rjgrnjg4gnLFxuICAgICdTZWxlY3QgVmlldyc6ICfjg5Pjg6Xjg7zjgpLpgbjmip4nLFxuICAgIFZpZXc6ICfjg5Pjg6Xjg7wnLFxuICAgICcrIHt7bn19IGV2ZW50cyc6ICcrIHt7bn19IOOCpOODmeODs+ODiCcsXG4gICAgJysgMSBldmVudCc6ICcrIDEg44Kk44OZ44Oz44OIJyxcbiAgICAnTm8gZXZlbnRzJzogJ+OCpOODmeODs+ODiOOBquOBlycsXG4gICAgJ05leHQgcGVyaW9kJzogJ+asoeOBruacn+mWkycsXG4gICAgJ1ByZXZpb3VzIHBlcmlvZCc6ICfliY3jga7mnJ/plpMnLFxuICAgIHRvOiAn44GL44KJJywgLy8gYXMgaW4gMi8xLzIwMjAgdG8gMi8yLzIwMjBcbiAgICAnRnVsbCBkYXktIGFuZCBtdWx0aXBsZSBkYXkgZXZlbnRzJzogJ+e1guaXpeOBiuOCiOOBs+ikh+aVsOaXpeOCpOODmeODs+ODiCcsXG4gICAgJ0xpbmsgdG8ge3tufX0gbW9yZSBldmVudHMgb24ge3tkYXRlfX0nOiAne3tkYXRlfX0g44Gre3tufX3ku7bjga7jgqTjg5njg7Pjg4jjgbjjga7jg6rjg7Pjgq8nLFxuICAgICdMaW5rIHRvIDEgbW9yZSBldmVudCBvbiB7e2RhdGV9fSc6ICd7e2RhdGV9fSDjgasx5Lu244Gu44Kk44OZ44Oz44OI44G444Gu44Oq44Oz44KvJyxcbiAgICBDVzogJ+mAsSB7e3dlZWt9fScsXG59O1xuXG5jb25zdCB0aW1lUGlja2VySmFKUCA9IHtcbiAgICBUaW1lOiAn5pmC6ZaTJyxcbiAgICBBTTogJ+WNiOWJjScsXG4gICAgUE06ICfljYjlvownLFxuICAgIENhbmNlbDogJ+OCreODo+ODs+OCu+ODqycsXG4gICAgT0s6ICdPSycsXG4gICAgJ1NlbGVjdCB0aW1lJzogJ+aZgumWk+OCkumBuOaKnicsXG59O1xuXG5jb25zdCBqYUpQID0ge1xuICAgIC4uLmRhdGVQaWNrZXJKYUpQLFxuICAgIC4uLmNhbGVuZGFySmFKUCxcbiAgICAuLi50aW1lUGlja2VySmFKUCxcbn07XG5cbmNvbnN0IGRhdGVQaWNrZXJSdVJVID0ge1xuICAgIERhdGU6ICfQlNCw0YLQsCcsXG4gICAgJ01NL0REL1lZWVknOiAn0JzQnC/QlNCUL9CT0JPQk9CTJyxcbiAgICAnTmV4dCBtb250aCc6ICfQodC70LXQtNGD0Y7RidC40Lkg0LzQtdGB0Y/RhicsXG4gICAgJ1ByZXZpb3VzIG1vbnRoJzogJ9Cf0YDQvtGI0LvRi9C5INC80LXRgdGP0YYnLFxuICAgICdDaG9vc2UgRGF0ZSc6ICfQktGL0LHQtdGA0LjRgtC1INC00LDRgtGDJyxcbn07XG5cbmNvbnN0IGNhbGVuZGFyUnVSVSA9IHtcbiAgICBUb2RheTogJ9Ch0LXQs9C+0LTQvdGPJyxcbiAgICBNb250aDogJ9Cc0LXRgdGP0YYnLFxuICAgIFdlZWs6ICfQndC10LTQtdC70Y8nLFxuICAgIERheTogJ9CU0LXQvdGMJyxcbiAgICBMaXN0OiAn0KHQv9C40YHQvtC6JyxcbiAgICAnU2VsZWN0IFZpZXcnOiAn0JLRi9Cx0LXRgNC40YLQtSDQstC40LQnLFxuICAgICcrIHt7bn19IGV2ZW50cyc6ICcrIHt7bn19INGB0L7QsdGL0YLQuNGPJyxcbiAgICAnKyAxIGV2ZW50JzogJysgMSDRgdC+0LHRi9GC0LjQtScsXG4gICAgJ05vIGV2ZW50cyc6ICfQndC10YIg0YHQvtCx0YvRgtC40LknLFxuICAgICdOZXh0IHBlcmlvZCc6ICfQodC70LXQtNGD0Y7RidC40Lkg0L/QtdGA0LjQvtC0JyxcbiAgICAnUHJldmlvdXMgcGVyaW9kJzogJ9Cf0YDQvtGI0LvRi9C5INC/0LXRgNC40L7QtCcsXG4gICAgdG86ICfQv9C+JywgLy8gYXMgaW4gMi8xLzIwMjAgdG8gMi8yLzIwMjBcbiAgICAnRnVsbCBkYXktIGFuZCBtdWx0aXBsZSBkYXkgZXZlbnRzJzogJ9Ch0L7QsdGL0YLQuNGPINC90LAg0YbQtdC70YvQuSDQtNC10L3RjCDQuCDQvdC10YHQutC+0LvRjNC60L4g0LTQvdC10Lkg0L/QvtC00YDRj9C0JyxcbiAgICAnTGluayB0byB7e259fSBtb3JlIGV2ZW50cyBvbiB7e2RhdGV9fSc6ICfQodGB0YvQu9C60LAg0L3QsCB7e259fSDQtNC+0L/QvtC70L3QuNGC0LXQu9GM0L3Ri9GFINGB0L7QsdGL0YLQuNC5INC90LAge3tkYXRlfX0nLFxuICAgICdMaW5rIHRvIDEgbW9yZSBldmVudCBvbiB7e2RhdGV9fSc6ICfQodGB0YvQu9C60LAg0L3QsCAxINC00L7Qv9C+0LvQvdC40YLQtdC70YzQvdC+0LUg0YHQvtCx0YvRgtC40LUg0L3QsCB7e2RhdGV9fScsXG4gICAgQ1c6ICfQndC10LTQtdC70Y8ge3t3ZWVrfX0nLFxuICAgIFZpZXc6ICfQktC40LQnLFxufTtcblxuY29uc3QgdGltZVBpY2tlclJ1UlUgPSB7XG4gICAgVGltZTogJ9CS0YDQtdC80Y8nLFxuICAgIEFNOiAnQU0nLFxuICAgIFBNOiAnUE0nLFxuICAgIENhbmNlbDogJ9Ce0YLQvNC10L3QsCcsXG4gICAgT0s6ICfQntCaJyxcbiAgICAnU2VsZWN0IHRpbWUnOiAn0JLRi9Cx0LXRgNC40YLQtSDQstGA0LXQvNGPJyxcbn07XG5cbmNvbnN0IHJ1UlUgPSB7XG4gICAgLi4uZGF0ZVBpY2tlclJ1UlUsXG4gICAgLi4uY2FsZW5kYXJSdVJVLFxuICAgIC4uLnRpbWVQaWNrZXJSdVJVLFxufTtcblxuY29uc3QgZGF0ZVBpY2tlcktvS1IgPSB7XG4gICAgRGF0ZTogJ+ydvOyekCcsXG4gICAgJ01NL0REL1lZWVknOiAn64WEL+yblC/snbwnLFxuICAgICdOZXh0IG1vbnRoJzogJ+uLpOydjCDri6wnLFxuICAgICdQcmV2aW91cyBtb250aCc6ICfsnbTsoIQg64usJyxcbiAgICAnQ2hvb3NlIERhdGUnOiAn64Kg7KecIOyEoO2DnScsXG59O1xuXG5jb25zdCBjYWxlbmRhcktvS1IgPSB7XG4gICAgVG9kYXk6ICfsmKTripgnLFxuICAgIE1vbnRoOiAn7JuUJyxcbiAgICBXZWVrOiAn7KO8JyxcbiAgICBEYXk6ICfsnbwnLFxuICAgIExpc3Q6ICfrqqnroZ0nLFxuICAgICdTZWxlY3QgVmlldyc6ICfrs7TquLAg7ISg7YOdJyxcbiAgICAnKyB7e259fSBldmVudHMnOiAnKyB7e259fSDsnbzsoJXrk6QnLFxuICAgICcrIDEgZXZlbnQnOiAnKyAxIOydvOyglScsXG4gICAgJ05vIGV2ZW50cyc6ICfsnbzsoJUg7JeG7J2MJyxcbiAgICAnTmV4dCBwZXJpb2QnOiAn64uk7J2MJyxcbiAgICAnUHJldmlvdXMgcGVyaW9kJzogJ+ydtOyghCcsXG4gICAgdG86ICfrtoDthLAnLCAvLyBhcyBpbiAyLzEvMjAyMCB0byAyLzIvMjAyMFxuICAgICdGdWxsIGRheS0gYW5kIG11bHRpcGxlIGRheSBldmVudHMnOiAn7KKF7J28IOuwjyDrs7XsiJjsnbwg7J287KCVJyxcbiAgICAnTGluayB0byB7e259fSBtb3JlIGV2ZW50cyBvbiB7e2RhdGV9fSc6ICd7e2RhdGV9feyXkCB7e259feqwnCDsnbTsg4HsnZgg7J2067Kk7Yq466GcIOydtOuPmScsXG4gICAgJ0xpbmsgdG8gMSBtb3JlIGV2ZW50IG9uIHt7ZGF0ZX19JzogJ3t7ZGF0ZX197JeQIDHqsJwg7J207IOB7J2YIOydtOuypO2KuOuhnCDsnbTrj5knLFxuICAgIENXOiAne3t3ZWVrfX3so7wnLFxuICAgIFZpZXc6ICfrs7TquLAnLFxufTtcblxuY29uc3QgdGltZVBpY2tlcktvS1IgPSB7XG4gICAgVGltZTogJ+yLnOqwhCcsXG4gICAgQU06ICfsmKTsoIQnLFxuICAgIFBNOiAn7Jik7ZuEJyxcbiAgICBDYW5jZWw6ICfst6jshownLFxuICAgIE9LOiAn7ZmV7J24JyxcbiAgICAnU2VsZWN0IHRpbWUnOiAn7Iuc6rCEIOyEoO2DnScsXG59O1xuXG5jb25zdCBrb0tSID0ge1xuICAgIC4uLmRhdGVQaWNrZXJLb0tSLFxuICAgIC4uLmNhbGVuZGFyS29LUixcbiAgICAuLi50aW1lUGlja2VyS29LUixcbn07XG5cbmNvbnN0IGRhdGVQaWNrZXJGckZSID0ge1xuICAgIERhdGU6ICdEYXRlJyxcbiAgICAnTU0vREQvWVlZWSc6ICdKSi9NTS9BQUFBJyxcbiAgICAnTmV4dCBtb250aCc6ICdNb2lzIHN1aXZhbnQnLFxuICAgICdQcmV2aW91cyBtb250aCc6ICdNb2lzIHByw6ljw6lkZW50JyxcbiAgICAnQ2hvb3NlIERhdGUnOiAnQ2hvaXNpciB1bmUgZGF0ZScsXG59O1xuXG5jb25zdCBjYWxlbmRhckZyRlIgPSB7XG4gICAgVG9kYXk6IFwiQXVqb3VyZCdodWlcIixcbiAgICBNb250aDogJ01vaXMnLFxuICAgIFdlZWs6ICdTZW1haW5lJyxcbiAgICBEYXk6ICdKb3VyJyxcbiAgICBMaXN0OiAnTGlzdGUnLFxuICAgICdTZWxlY3QgVmlldyc6ICdTw6lsZWN0aW9ubmVyIGxhIHZ1ZScsXG4gICAgVmlldzogJ1Z1ZScsXG4gICAgJysge3tufX0gZXZlbnRzJzogJysge3tufX0gw6l2w6luZW1lbnRzJyxcbiAgICAnKyAxIGV2ZW50JzogJysgMSDDqXbDqW5lbWVudCcsXG4gICAgJ05vIGV2ZW50cyc6ICdBdWN1biDDqXbDqW5lbWVudCcsXG4gICAgJ05leHQgcGVyaW9kJzogJ1DDqXJpb2RlIHN1aXZhbnRlJyxcbiAgICAnUHJldmlvdXMgcGVyaW9kJzogJ1DDqXJpb2RlIHByw6ljw6lkZW50ZScsXG4gICAgdG86ICdhdScsIC8vIGFzIGluIDIvMS8yMDIwIHRvIDIvMi8yMDIwXG4gICAgJ0Z1bGwgZGF5LSBhbmQgbXVsdGlwbGUgZGF5IGV2ZW50cyc6ICfDiXbDqW5lbWVudHMgc3VyIHVuZSBqb3VybsOpZSBvdSBwbHVzaWV1cnMgam91cnMnLFxuICAgICdMaW5rIHRvIHt7bn19IG1vcmUgZXZlbnRzIG9uIHt7ZGF0ZX19JzogJ0xpZW4gdmVycyB7e259fSDDqXbDqW5lbWVudHMgc3VwcGzDqW1lbnRhaXJlcyBsZSB7e2RhdGV9fScsXG4gICAgJ0xpbmsgdG8gMSBtb3JlIGV2ZW50IG9uIHt7ZGF0ZX19JzogJ0xpZW4gdmVycyAxIMOpdsOpbmVtZW50IHN1cHBsw6ltZW50YWlyZSBsZSB7e2RhdGV9fScsXG4gICAgQ1c6ICdTe3t3ZWVrfX0nLFxufTtcblxuY29uc3QgdGltZVBpY2tlckZyRlIgPSB7XG4gICAgVGltZTogJ0hldXJlJyxcbiAgICBBTTogJ0FNJyxcbiAgICBQTTogJ1BNJyxcbiAgICBDYW5jZWw6ICdBbm51bGVyJyxcbiAgICBPSzogJ09LJyxcbiAgICAnU2VsZWN0IHRpbWUnOiBcIlPDqWxlY3Rpb25uZXIgbCdoZXVyZVwiLFxufTtcblxuY29uc3QgZnJGUiA9IHtcbiAgICAuLi5kYXRlUGlja2VyRnJGUixcbiAgICAuLi5jYWxlbmRhckZyRlIsXG4gICAgLi4udGltZVBpY2tlckZyRlIsXG59O1xuXG5jb25zdCBkYXRlUGlja2VyRGFESyA9IHtcbiAgICBEYXRlOiAnRGF0bycsXG4gICAgJ01NL0REL1lZWVknOiAnw4XDhcOFw4UtTU0tREQnLFxuICAgICdOZXh0IG1vbnRoJzogJ07DpnN0ZSBtw6VuZWQnLFxuICAgICdQcmV2aW91cyBtb250aCc6ICdGb3JlZ8OlZW5kZSBtw6VuZWQnLFxuICAgICdDaG9vc2UgRGF0ZSc6ICdWw6ZsZyBkYXRvJyxcbn07XG5cbmNvbnN0IGNhbGVuZGFyRGFESyA9IHtcbiAgICBUb2RheTogJ0kgZGFnJyxcbiAgICBNb250aDogJ03DpW5lZCcsXG4gICAgV2VlazogJ1VnZScsXG4gICAgRGF5OiAnRGFnJyxcbiAgICBMaXN0OiAnTGlzdGUnLFxuICAgICdTZWxlY3QgVmlldyc6ICdWw6ZsZyB2aXNuaW5nJyxcbiAgICAnKyB7e259fSBldmVudHMnOiAnKyB7e259fSBiZWdpdmVuaGVkZXInLFxuICAgICcrIDEgZXZlbnQnOiAnKyAxIGJlZ2l2ZW5oZWQnLFxuICAgICdObyBldmVudHMnOiAnSW5nZW4gYmVnaXZlbmhlZGVyJyxcbiAgICAnTmV4dCBwZXJpb2QnOiAnTsOmc3RlIHBlcmlvZGUnLFxuICAgICdQcmV2aW91cyBwZXJpb2QnOiAnRm9yZ8OlZW5kZSBwZXJpb2RlJyxcbiAgICB0bzogJ3RpbCcsIC8vIGFzIGluIDIvMS8yMDIwIHRvIDIvMi8yMDIwXG4gICAgJ0Z1bGwgZGF5LSBhbmQgbXVsdGlwbGUgZGF5IGV2ZW50cyc6ICdIZWxkYWdzYmVnaXZlbmhlZGVyIG9nIGZsZXJkYWdzYmVnaXZlbmhlZGVyJyxcbiAgICAnTGluayB0byB7e259fSBtb3JlIGV2ZW50cyBvbiB7e2RhdGV9fSc6ICdMaW5rIHRpbCB7e259fSBmbGVyZSBiZWdpdmVuaGVkZXIgZGVuIHt7ZGF0ZX19JyxcbiAgICAnTGluayB0byAxIG1vcmUgZXZlbnQgb24ge3tkYXRlfX0nOiAnTGluayB0aWwgMSBtZXJlIGJlZ2l2ZW5oZWQgZGVuIHt7ZGF0ZX19JyxcbiAgICBDVzogJ1VnZSB7e3dlZWt9fScsXG4gICAgVmlldzogJ1Zpc25pbmcnLFxufTtcblxuY29uc3QgdGltZVBpY2tlckRhREsgPSB7XG4gICAgVGltZTogJ1RpZCcsXG4gICAgQU06ICdBTScsXG4gICAgUE06ICdQTScsXG4gICAgQ2FuY2VsOiAnQW5udWxsZXInLFxuICAgIE9LOiAnT0snLFxuICAgICdTZWxlY3QgdGltZSc6ICdWw6ZsZyB0aWQnLFxufTtcblxuY29uc3QgZGFESyA9IHtcbiAgICAuLi5kYXRlUGlja2VyRGFESyxcbiAgICAuLi5jYWxlbmRhckRhREssXG4gICAgLi4udGltZVBpY2tlckRhREssXG59O1xuXG5jb25zdCBkYXRlUGlja2VyUGxQTCA9IHtcbiAgICBEYXRlOiAnRGF0YScsXG4gICAgJ01NL0REL1lZWVknOiAnREQvTU0vWVlZWScsXG4gICAgJ05leHQgbW9udGgnOiAnTmFzdMSZcG55IG1pZXNpxIVjJyxcbiAgICAnUHJldmlvdXMgbW9udGgnOiAnUG9wcnplZG5pIG1pZXNpxIVjJyxcbiAgICAnQ2hvb3NlIERhdGUnOiAnV3liaWV3cnogZGF0xJknLFxufTtcblxuY29uc3QgY2FsZW5kYXJQbFBMID0ge1xuICAgIFRvZGF5OiAnRHppc2lhaicsXG4gICAgTW9udGg6ICdNaWVzacSFYycsXG4gICAgV2VlazogJ1R5ZHppZcWEJyxcbiAgICBEYXk6ICdEemllxYQnLFxuICAgIExpc3Q6ICdMaXN0YScsXG4gICAgJ1NlbGVjdCBWaWV3JzogJ1d5Ymllcnogd2lkb2snLFxuICAgICcrIHt7bn19IGV2ZW50cyc6ICcrIHt7bn19IHd5ZGFyemVuaWEnLFxuICAgICcrIDEgZXZlbnQnOiAnKyAxIHd5ZGFyemVuaWUnLFxuICAgICdObyBldmVudHMnOiAnQnJhayB3eWRhcnplxYQnLFxuICAgICdOZXh0IHBlcmlvZCc6ICdOYXN0xJlwbnkgb2tyZXMnLFxuICAgICdQcmV2aW91cyBwZXJpb2QnOiAnUG9wcnplZG5pIG9rcmVzJyxcbiAgICB0bzogJ2RvJywgLy8gYXMgaW4gMi8xLzIwMjAgdG8gMi8yLzIwMjBcbiAgICAnRnVsbCBkYXktIGFuZCBtdWx0aXBsZSBkYXkgZXZlbnRzJzogJ1d5ZGFyemVuaWEgY2HFgm9kbmlvd2UgaSB3aWVsb2RuaW93ZScsXG4gICAgJ0xpbmsgdG8ge3tufX0gbW9yZSBldmVudHMgb24ge3tkYXRlfX0nOiAnTGluayBkbyB7e259fSBrb2xlam55Y2ggd3lkYXJ6ZcWEIHcgZG5pdSB7e2RhdGV9fScsXG4gICAgJ0xpbmsgdG8gMSBtb3JlIGV2ZW50IG9uIHt7ZGF0ZX19JzogJ0xpbmsgZG8gMSBrb2xlam5lZ28gd3lkYXJ6ZW5pYSB3IGRuaXUge3tkYXRlfX0nLFxuICAgIENXOiAnVHlkemllxYQge3t3ZWVrfX0nLFxuICAgIFZpZXc6ICdXaWRvaycsXG59O1xuXG5jb25zdCB0aW1lUGlja2VyUGxQTCA9IHtcbiAgICBUaW1lOiAnR29kemluYScsXG4gICAgQU06ICdBTScsXG4gICAgUE06ICdQTScsXG4gICAgQ2FuY2VsOiAnQW51bHVqJyxcbiAgICBPSzogJ09LJyxcbiAgICAnU2VsZWN0IHRpbWUnOiAnV3liaWVyeiBnb2R6aW7EmScsXG59O1xuXG5jb25zdCBwbFBMID0ge1xuICAgIC4uLmRhdGVQaWNrZXJQbFBMLFxuICAgIC4uLmNhbGVuZGFyUGxQTCxcbiAgICAuLi50aW1lUGlja2VyUGxQTCxcbn07XG5cbmNvbnN0IGRhdGVQaWNrZXJFc0VTID0ge1xuICAgIERhdGU6ICdGZWNoYScsXG4gICAgJ01NL0REL1lZWVknOiAnREQvTU0vWVlZWScsXG4gICAgJ05leHQgbW9udGgnOiAnU2lndWllbnRlIG1lcycsXG4gICAgJ1ByZXZpb3VzIG1vbnRoJzogJ01lcyBhbnRlcmlvcicsXG4gICAgJ0Nob29zZSBEYXRlJzogJ1NlbGVjY2lvbmUgdW5hIGZlY2hhJyxcbn07XG5cbmNvbnN0IGNhbGVuZGFyRXNFUyA9IHtcbiAgICBUb2RheTogJ0hveScsXG4gICAgTW9udGg6ICdNZXMnLFxuICAgIFdlZWs6ICdTZW1hbmEnLFxuICAgIERheTogJ0TDrWEnLFxuICAgIExpc3Q6ICdMaXN0YScsXG4gICAgJ1NlbGVjdCBWaWV3JzogJ1NlbGVjY2lvbmFyIHZpc3RhJyxcbiAgICBWaWV3OiAnVmlzdGEnLFxuICAgICcrIHt7bn19IGV2ZW50cyc6ICcrIHt7bn19IGV2ZW50b3MnLFxuICAgICcrIDEgZXZlbnQnOiAnKyAxIGV2ZW50bycsXG4gICAgJ05vIGV2ZW50cyc6ICdObyBoYXkgZXZlbnRvcycsXG4gICAgJ05leHQgcGVyaW9kJzogJ1NpZ3VpZW50ZSBwZXLDrW9kbycsXG4gICAgJ1ByZXZpb3VzIHBlcmlvZCc6ICdQZXLDrW9kbyBhbnRlcmlvcicsXG4gICAgdG86ICdhJywgLy8gYXMgaW4gMi8xLzIwMjAgdG8gMi8yLzIwMjBcbiAgICAnRnVsbCBkYXktIGFuZCBtdWx0aXBsZSBkYXkgZXZlbnRzJzogJ0TDrWEgY29tcGxldG8geSBldmVudG9zIGRlIG3Dumx0aXBsZXMgZMOtYXMnLFxuICAgICdMaW5rIHRvIHt7bn19IG1vcmUgZXZlbnRzIG9uIHt7ZGF0ZX19JzogJ0VubGFjZSBhIHt7bn19IGV2ZW50b3MgbcOhcyBlbCB7e2RhdGV9fScsXG4gICAgJ0xpbmsgdG8gMSBtb3JlIGV2ZW50IG9uIHt7ZGF0ZX19JzogJ0VubGFjZSBhIDEgZXZlbnRvIG3DoXMgZWwge3tkYXRlfX0nLFxuICAgIENXOiAnU2VtYW5hIHt7d2Vla319Jyxcbn07XG5cbmNvbnN0IHRpbWVQaWNrZXJFc0VTID0ge1xuICAgIFRpbWU6ICdIb3JhJyxcbiAgICBBTTogJ0FNJyxcbiAgICBQTTogJ1BNJyxcbiAgICBDYW5jZWw6ICdDYW5jZWxhcicsXG4gICAgT0s6ICdBY2VwdGFyJyxcbiAgICAnU2VsZWN0IHRpbWUnOiAnU2VsZWNjaW9uYXIgaG9yYScsXG59O1xuXG5jb25zdCBlc0VTID0ge1xuICAgIC4uLmRhdGVQaWNrZXJFc0VTLFxuICAgIC4uLmNhbGVuZGFyRXNFUyxcbiAgICAuLi50aW1lUGlja2VyRXNFUyxcbn07XG5cbmNvbnN0IGNhbGVuZGFyTmxOTCA9IHtcbiAgICBUb2RheTogJ1ZhbmRhYWcnLFxuICAgIE1vbnRoOiAnTWFhbmQnLFxuICAgIFdlZWs6ICdXZWVrJyxcbiAgICBEYXk6ICdEYWcnLFxuICAgIExpc3Q6ICdMaWpzdCcsXG4gICAgJ1NlbGVjdCBWaWV3JzogJ0tpZXMgd2VlcmdhdmUnLFxuICAgICcrIHt7bn19IGV2ZW50cyc6ICcrIHt7bn19IGdlYmV1cnRlbmlzc2VuJyxcbiAgICAnKyAxIGV2ZW50JzogJysgMSBnZWJldXJ0ZW5pcycsXG4gICAgJ05vIGV2ZW50cyc6ICdHZWVuIGdlYmV1cnRlbmlzc2VuJyxcbiAgICAnTmV4dCBwZXJpb2QnOiAnVm9sZ2VuZGUgcGVyaW9kZScsXG4gICAgJ1ByZXZpb3VzIHBlcmlvZCc6ICdWb3JpZ2UgcGVyaW9kZScsXG4gICAgdG86ICd0b3QnLCAvLyBhcyBpbiAyLzEvMjAyMCB0byAyLzIvMjAyMFxuICAgICdGdWxsIGRheS0gYW5kIG11bHRpcGxlIGRheSBldmVudHMnOiAnRXZlbmVtZW50ZW4gdmFuIGVlbiBoZWxlIGRhZyBlbiBtZWVyZGVyZSBkYWdlbicsXG4gICAgJ0xpbmsgdG8ge3tufX0gbW9yZSBldmVudHMgb24ge3tkYXRlfX0nOiAnTGluayBuYWFyIHt7bn19IG1lZXIgZXZlbmVtZW50ZW4gb3Age3tkYXRlfX0nLFxuICAgICdMaW5rIHRvIDEgbW9yZSBldmVudCBvbiB7e2RhdGV9fSc6ICdMaW5rIG5hYXIgMSBtZWVyIGV2ZW5lbWVudCBvcCB7e2RhdGV9fScsXG4gICAgQ1c6ICdXZWVrIHt7d2Vla319JyxcbiAgICBWaWV3OiAnV2VlcmdhdmUnLFxufTtcblxuY29uc3QgZGF0ZVBpY2tlck5sTkwgPSB7XG4gICAgRGF0ZTogJ0RhdHVtJyxcbiAgICAnTU0vREQvWVlZWSc6ICdERC1NTS1KSkpKJyxcbiAgICAnTmV4dCBtb250aCc6ICdWb2xnZW5kZSBtYWFuZCcsXG4gICAgJ1ByZXZpb3VzIG1vbnRoJzogJ1ZvcmlnZSBtYWFuZCcsXG4gICAgJ0Nob29zZSBEYXRlJzogJ0tpZXMgZGF0dW0nLFxufTtcblxuY29uc3QgdGltZVBpY2tlck5sTkwgPSB7XG4gICAgVGltZTogJ1RpamQnLFxuICAgIEFNOiAnQU0nLFxuICAgIFBNOiAnUE0nLFxuICAgIENhbmNlbDogJ0FubnVsZXJlbicsXG4gICAgT0s6ICdPSycsXG4gICAgJ1NlbGVjdCB0aW1lJzogJ1NlbGVjdGVlciB0aWpkJyxcbn07XG5cbmNvbnN0IG5sTkwgPSB7XG4gICAgLi4uZGF0ZVBpY2tlck5sTkwsXG4gICAgLi4uY2FsZW5kYXJObE5MLFxuICAgIC4uLnRpbWVQaWNrZXJObE5MLFxufTtcblxuY29uc3QgZGF0ZVBpY2tlclB0QlIgPSB7XG4gICAgRGF0ZTogJ0RhdGEnLFxuICAgICdNTS9ERC9ZWVlZJzogJ0REL01NL1lZWVknLFxuICAgICdOZXh0IG1vbnRoJzogJ03DqnMgc2VndWludGUnLFxuICAgICdQcmV2aW91cyBtb250aCc6ICdNw6pzIGFudGVyaW9yJyxcbiAgICAnQ2hvb3NlIERhdGUnOiAnRXNjb2xoYSB1bWEgZGF0YScsXG59O1xuXG5jb25zdCBjYWxlbmRhclB0QlIgPSB7XG4gICAgVG9kYXk6ICdIb2plJyxcbiAgICBNb250aDogJ03DqnMnLFxuICAgIFdlZWs6ICdTZW1hbmEnLFxuICAgIERheTogJ0RpYScsXG4gICAgTGlzdDogJ0xpc3RhJyxcbiAgICAnU2VsZWN0IFZpZXcnOiAnU2VsZWNpb25lIHVtYSB2aXN1YWxpemHDp8OjbycsXG4gICAgJysge3tufX0gZXZlbnRzJzogJysge3tufX0gZXZlbnRvcycsXG4gICAgJysgMSBldmVudCc6ICcrIDEgZXZlbnRvJyxcbiAgICAnTm8gZXZlbnRzJzogJ1NlbSBldmVudG9zJyxcbiAgICAnTmV4dCBwZXJpb2QnOiAnUGVyw61vZG8gc2VndWludGUnLFxuICAgICdQcmV2aW91cyBwZXJpb2QnOiAnUGVyw61vZG8gYW50ZXJpb3InLFxuICAgIHRvOiAnYScsIC8vIGFzIGluIDIvMS8yMDIwIHRvIDIvMi8yMDIwXG4gICAgJ0Z1bGwgZGF5LSBhbmQgbXVsdGlwbGUgZGF5IGV2ZW50cyc6ICdEaWEgaW50ZWlybyBlIGV2ZW50b3MgZGUgdsOhcmlvcyBkaWFzJyxcbiAgICAnTGluayB0byB7e259fSBtb3JlIGV2ZW50cyBvbiB7e2RhdGV9fSc6ICdMaW5rIHBhcmEgbWFpcyB7e259fSBldmVudG9zIGVtIHt7ZGF0ZX19JyxcbiAgICAnTGluayB0byAxIG1vcmUgZXZlbnQgb24ge3tkYXRlfX0nOiAnTGluayBwYXJhIG1haXMgMSBldmVudG8gZW0ge3tkYXRlfX0nLFxuICAgIENXOiAnU2VtYW5hIHt7d2Vla319JyxcbiAgICBWaWV3OiAnVmlzdWFsaXphw6fDo28nLFxufTtcblxuY29uc3QgdGltZVBpY2tlclB0QlIgPSB7XG4gICAgVGltZTogJ0hvcmEnLFxuICAgIEFNOiAnQU0nLFxuICAgIFBNOiAnUE0nLFxuICAgIENhbmNlbDogJ0NhbmNlbGFyJyxcbiAgICBPSzogJ09LJyxcbiAgICAnU2VsZWN0IHRpbWUnOiAnU2VsZWNpb25hciBob3JhJyxcbn07XG5cbmNvbnN0IHB0QlIgPSB7XG4gICAgLi4uZGF0ZVBpY2tlclB0QlIsXG4gICAgLi4uY2FsZW5kYXJQdEJSLFxuICAgIC4uLnRpbWVQaWNrZXJQdEJSLFxufTtcblxuY29uc3QgZGF0ZVBpY2tlclNrU0sgPSB7XG4gICAgRGF0ZTogJ0TDoXR1bScsXG4gICAgJ01NL0REL1lZWVknOiAnREQvTU0vWVlZWScsXG4gICAgJ05leHQgbW9udGgnOiAnxI5hbMWhw60gbWVzaWFjJyxcbiAgICAnUHJldmlvdXMgbW9udGgnOiAnUHJlZGNow6FkemFqw7pjaSBtZXNpYWMnLFxuICAgICdDaG9vc2UgRGF0ZSc6ICdWeWJlcnRlIGTDoXR1bScsXG59O1xuXG5jb25zdCBjYWxlbmRhclNrU0sgPSB7XG4gICAgVG9kYXk6ICdEbmVzJyxcbiAgICBNb250aDogJ01lc2lhYycsXG4gICAgV2VlazogJ1TDvcW+ZGXFiCcsXG4gICAgRGF5OiAnRGXFiCcsXG4gICAgTGlzdDogJ1pvem5hbScsXG4gICAgJ1NlbGVjdCBWaWV3JzogJ1Z5YmVydGUgem9icmF6ZW5pZScsXG4gICAgJysge3tufX0gZXZlbnRzJzogJysge3tufX0gdWRhbG9zdGknLFxuICAgICcrIDEgZXZlbnQnOiAnKyAxIHVkYWxvc8WlJyxcbiAgICAnTm8gZXZlbnRzJzogJ8W9aWFkbmUgdWRhbG9zdGknLFxuICAgICdOZXh0IHBlcmlvZCc6ICfEjmFsxaFpZSBvYmRvYmllJyxcbiAgICAnUHJldmlvdXMgcGVyaW9kJzogJ1ByZWRjaMOhZHphasO6Y2Ugb2Jkb2JpZScsXG4gICAgdG86ICdkbycsIC8vIGFzIGluIDIvMS8yMDIwIHRvIDIvMi8yMDIwXG4gICAgJ0Z1bGwgZGF5LSBhbmQgbXVsdGlwbGUgZGF5IGV2ZW50cyc6ICdDZWxvZGVubsOpIGEgdmlhY2TFiG92w6kgdWRhbG9zdGknLFxuICAgICdMaW5rIHRvIHt7bn19IG1vcmUgZXZlbnRzIG9uIHt7ZGF0ZX19JzogJ09ka2F6IG5hIHt7bn19IMSPYWzFocOtY2ggdWRhbG9zdMOtIGTFiGEge3tkYXRlfX0nLFxuICAgICdMaW5rIHRvIDEgbW9yZSBldmVudCBvbiB7e2RhdGV9fSc6ICdPZGtheiBuYSAxIMSPYWzFoWl1IHVkYWxvc8WlIGTFiGEge3tkYXRlfX0nLFxuICAgIENXOiAne3t3ZWVrfX0uIHTDvcW+ZGXFiCcsXG4gICAgVmlldzogJ1pvYnJhemVuaWUnLFxufTtcblxuY29uc3QgdGltZVBpY2tlclNrU0sgPSB7XG4gICAgVGltZTogJ8SMYXMnLFxuICAgIEFNOiAnQU0nLFxuICAgIFBNOiAnUE0nLFxuICAgIENhbmNlbDogJ1pydcWhacWlJyxcbiAgICBPSzogJ09LJyxcbiAgICAnU2VsZWN0IHRpbWUnOiAnVnlicmHFpSDEjWFzJyxcbn07XG5cbmNvbnN0IHNrU0sgPSB7XG4gICAgLi4uZGF0ZVBpY2tlclNrU0ssXG4gICAgLi4uY2FsZW5kYXJTa1NLLFxuICAgIC4uLnRpbWVQaWNrZXJTa1NLLFxufTtcblxuY29uc3QgZGF0ZVBpY2tlck1rTUsgPSB7XG4gICAgRGF0ZTogJ9CU0LDRgtGD0LwnLFxuICAgICdNTS9ERC9ZWVlZJzogJ0REL01NL1lZWVknLFxuICAgICdOZXh0IG1vbnRoJzogJ9Ch0LvQtdC00LXQvSDQvNC10YHQtdGGJyxcbiAgICAnUHJldmlvdXMgbW9udGgnOiAn0J/RgNC10YLRhdC+0LTQtdC9INC80LXRgdC10YYnLFxuICAgICdDaG9vc2UgRGF0ZSc6ICfQmNC30LHQtdGA0Lgg0JTQsNGC0YPQvCcsXG59O1xuXG5jb25zdCBjYWxlbmRhck1rTUsgPSB7XG4gICAgVG9kYXk6ICfQlNC10L3QtdGBJyxcbiAgICBNb250aDogJ9Cc0LXRgdC10YYnLFxuICAgIFdlZWs6ICfQndC10LTQtdC70LAnLFxuICAgIERheTogJ9CU0LXQvScsXG4gICAgTGlzdDogJ9Cb0LjRgdGC0LAnLFxuICAgICdTZWxlY3QgVmlldyc6ICfQmNC30LHQtdGA0Lgg0J/RgNC10LPQu9C10LQnLFxuICAgICcrIHt7bn19IGV2ZW50cyc6ICcrIHt7bn19INC90LDRgdGC0LDQvdC4JyxcbiAgICAnKyAxIGV2ZW50JzogJysgMSDQvdCw0YHRgtCw0L0nLFxuICAgICdObyBldmVudHMnOiAn0J3QtdC80LAg0L3QsNGB0YLQsNC90LgnLFxuICAgICdOZXh0IHBlcmlvZCc6ICfQodC70LXQtNC10L0g0L/QtdGA0LjQvtC0JyxcbiAgICAnUHJldmlvdXMgcGVyaW9kJzogJ9Cf0YDQtdGC0YXQvtC00LXQvSDQv9C10YDQuNC+0LQnLFxuICAgIHRvOiAn0LTQvicsIC8vIGFzIGluIDIvMS8yMDIwIHRvIDIvMi8yMDIwXG4gICAgJ0Z1bGwgZGF5LSBhbmQgbXVsdGlwbGUgZGF5IGV2ZW50cyc6ICfQptC10LvQvtC00L3QtdCy0L3QuCDQuCDQv9C+0LLQtdGc0LXQtNC90LXQstC90Lgg0L3QsNGB0YLQsNC90LgnLFxuICAgICdMaW5rIHRvIHt7bn19IG1vcmUgZXZlbnRzIG9uIHt7ZGF0ZX19JzogJ9Cb0LjQvdC6INC00L4ge3tufX0g0L/QvtCy0LXRnNC1INC90LDRgdGC0LDQvdC4INC90LAge3tkYXRlfX0nLFxuICAgICdMaW5rIHRvIDEgbW9yZSBldmVudCBvbiB7e2RhdGV9fSc6ICfQm9C40L3QuiDQtNC+IDEg0L/QvtCy0LXRnNC1INC90LDRgdGC0LDQvSDQvdCwIHt7ZGF0ZX19JyxcbiAgICBDVzogJ9Cd0LXQtNC10LvQsCB7e3dlZWt9fScsXG4gICAgVmlldzogJ9Cf0YDQtdCz0LvQtdC0Jyxcbn07XG5cbmNvbnN0IHRpbWVQaWNrZXJNa01LID0ge1xuICAgIFRpbWU6ICfQktGA0LXQvNC1JyxcbiAgICBBTTogJ0FNJyxcbiAgICBQTTogJ1BNJyxcbiAgICBDYW5jZWw6ICfQntGC0LrQsNC20LgnLFxuICAgIE9LOiAn0KMg0YDQtdC00YMnLFxuICAgICdTZWxlY3QgdGltZSc6ICfQmNC30LHQtdGA0Lgg0LLRgNC10LzQtScsXG59O1xuXG5jb25zdCBta01LID0ge1xuICAgIC4uLmRhdGVQaWNrZXJNa01LLFxuICAgIC4uLmNhbGVuZGFyTWtNSyxcbiAgICAuLi50aW1lUGlja2VyTWtNSyxcbn07XG5cbmNvbnN0IGRhdGVQaWNrZXJOYk5PID0ge1xuICAgIERhdGU6ICdEYXRvJyxcbiAgICAnTU0vREQvWVlZWSc6ICdERC5NTS5ZWVlZJyxcbiAgICAnTmV4dCBtb250aCc6ICdOZXN0ZSBtw6VuZWQnLFxuICAgICdQcmV2aW91cyBtb250aCc6ICdGb3JyaWdlIG3DpW5lZCcsXG4gICAgJ0Nob29zZSBEYXRlJzogJ1ZlbGcgZGF0bycsXG59O1xuXG5jb25zdCBjYWxlbmRhck5iTk8gPSB7XG4gICAgVG9kYXk6ICdJIGRhZycsXG4gICAgTW9udGg6ICdNw6VuZWQnLFxuICAgIFdlZWs6ICdVa2UnLFxuICAgIERheTogJ0RhZycsXG4gICAgTGlzdDogJ0xpc3RlJyxcbiAgICAnU2VsZWN0IFZpZXcnOiAnVmVsZyB2aXNuaW5nJyxcbiAgICBWaWV3OiAnVmlzbmluZycsXG4gICAgJysge3tufX0gZXZlbnRzJzogJysge3tufX0gaGVuZGVsc2VyJyxcbiAgICAnKyAxIGV2ZW50JzogJysgMSBoZW5kZWxzZScsXG4gICAgJ05vIGV2ZW50cyc6ICdJbmdlbiBoZW5kZWxzZXInLFxuICAgICdOZXh0IHBlcmlvZCc6ICdOZXN0ZSBwZXJpb2RlJyxcbiAgICAnUHJldmlvdXMgcGVyaW9kJzogJ0ZvcnJpZ2UgcGVyaW9kZScsXG4gICAgdG86ICd0aWwnLCAvLyBhcyBpbiAyLzEvMjAyMCB0byAyLzIvMjAyMFxuICAgICdGdWxsIGRheS0gYW5kIG11bHRpcGxlIGRheSBldmVudHMnOiAnSGVsZGFncy0gb2cgZmxlcmRhZ3NoZW5kZWxzZXInLFxuICAgICdMaW5rIHRvIHt7bn19IG1vcmUgZXZlbnRzIG9uIHt7ZGF0ZX19JzogJ0xlbmtlIHRpbCB7e259fSBmbGVyZSBoZW5kZWxzZXIgcMOlIHt7ZGF0ZX19JyxcbiAgICAnTGluayB0byAxIG1vcmUgZXZlbnQgb24ge3tkYXRlfX0nOiAnTGVua2UgdGlsIDEgaGVuZGVsc2UgdGlsIHDDpSB7e2RhdGV9fScsXG4gICAgQ1c6ICdVa2Uge3t3ZWVrfX0nLFxufTtcblxuY29uc3QgdGltZVBpY2tlck5iTk8gPSB7XG4gICAgVGltZTogJ1RpZCcsXG4gICAgQU06ICdBTScsXG4gICAgUE06ICdQTScsXG4gICAgQ2FuY2VsOiAnQXZicnl0JyxcbiAgICBPSzogJ09LJyxcbiAgICAnU2VsZWN0IHRpbWUnOiAnVmVsZyB0aWQnLFxufTtcblxuY29uc3QgbmJOTyA9IHtcbiAgICAuLi5kYXRlUGlja2VyTmJOTyxcbiAgICAuLi5jYWxlbmRhck5iTk8sXG4gICAgLi4udGltZVBpY2tlck5iTk8sXG59O1xuXG5jb25zdCBkYXRlUGlja2VyVHJUUiA9IHtcbiAgICBEYXRlOiAnVGFyaWgnLFxuICAgICdNTS9ERC9ZWVlZJzogJ0dHL0FBL1lZWVknLFxuICAgICdOZXh0IG1vbnRoJzogJ1NvbnJha2kgYXknLFxuICAgICdQcmV2aW91cyBtb250aCc6ICfDlm5jZWtpIGF5JyxcbiAgICAnQ2hvb3NlIERhdGUnOiAnVGFyaWggU2XDpycsXG59O1xuXG5jb25zdCBjYWxlbmRhclRyVFIgPSB7XG4gICAgVG9kYXk6ICdCdWfDvG4nLFxuICAgIE1vbnRoOiAnQXlsxLFrJyxcbiAgICBXZWVrOiAnSGFmdGFsxLFrJyxcbiAgICBEYXk6ICdHw7xubMO8aycsXG4gICAgTGlzdDogJ0xpc3RlJyxcbiAgICAnU2VsZWN0IFZpZXcnOiAnR8O2csO8bsO8bSBTZcOnJyxcbiAgICAnKyB7e259fSBldmVudHMnOiAnKyB7e259fSBldGtpbmxpa2xlcicsXG4gICAgJysgMSBldmVudCc6ICcrIDEgZXRraW5saWsnLFxuICAgICdObyBldmVudHMnOiAnRXRraW5saWsgeW9rJyxcbiAgICAnTmV4dCBwZXJpb2QnOiAnU29ucmFraSBkw7ZuZW0nLFxuICAgICdQcmV2aW91cyBwZXJpb2QnOiAnw5ZuY2VraSBkw7ZuZW0nLFxuICAgIHRvOiAnZGFuJywgLy8gYXMgaW4gMi8xLzIwMjAgdG8gMi8yLzIwMjBcbiAgICAnRnVsbCBkYXktIGFuZCBtdWx0aXBsZSBkYXkgZXZlbnRzJzogJ1TDvG0gZ8O8biB2ZSDDp29rbHUgZ8O8biBldGtpbmxpa2xlcmknLFxuICAgICdMaW5rIHRvIHt7bn19IG1vcmUgZXZlbnRzIG9uIHt7ZGF0ZX19JzogJ3t7ZGF0ZX19IHRhcmloaW5kZSB7e259fSBldGtpbmxpxJ9lIGJhxJ9sYW50xLEnLFxuICAgICdMaW5rIHRvIDEgbW9yZSBldmVudCBvbiB7e2RhdGV9fSc6ICd7e2RhdGV9fSB0YXJpaGluZGUgMSBldGtpbmxpxJ9lIGJhxJ9sYW50xLEnLFxuICAgIENXOiAne3t3ZWVrfX0uIEhhZnRhJyxcbiAgICBWaWV3OiAnR8O2csO8bsO8bScsXG59O1xuXG5jb25zdCB0aW1lUGlja2VyVHJUUiA9IHtcbiAgICBUaW1lOiAnWmFtYW4nLFxuICAgIEFNOiAnw5bDlicsXG4gICAgUE06ICfDllMnLFxuICAgIENhbmNlbDogJ8SwcHRhbCcsXG4gICAgT0s6ICdUYW1hbScsXG4gICAgJ1NlbGVjdCB0aW1lJzogJ1phbWFuxLEgc2XDpycsXG59O1xuXG5jb25zdCB0clRSID0ge1xuICAgIC4uLmRhdGVQaWNrZXJUclRSLFxuICAgIC4uLmNhbGVuZGFyVHJUUixcbiAgICAuLi50aW1lUGlja2VyVHJUUixcbn07XG5cbmNvbnN0IGRhdGVQaWNrZXJLeUtHID0ge1xuICAgIERhdGU6ICfQlNCw0YLQsNGB0YsnLFxuICAgICdNTS9ERC9ZWVlZJzogJ9CQ0JAv0JrQmi/QltCW0JbQlicsXG4gICAgJ05leHQgbW9udGgnOiAn0JrQuNC50LjQvdC60Lgg0LDQuScsXG4gICAgJ1ByZXZpb3VzIG1vbnRoJzogJ9Oo0YLQutOp0L0g0LDQuScsXG4gICAgJ0Nob29zZSBEYXRlJzogJ9Ca0q/QvdC00q8g0YLQsNC90LTQsNKj0YvQtycsXG59O1xuXG5jb25zdCBjYWxlbmRhckt5S0cgPSB7XG4gICAgVG9kYXk6ICfQkdKv0LPSr9C9JyxcbiAgICBNb250aDogJ9CQ0LknLFxuICAgIFdlZWs6ICfQkNC/0YLQsCcsXG4gICAgRGF5OiAn0JrSr9C9JyxcbiAgICBMaXN0OiAn0KLQuNC30LzQtScsXG4gICAgJ1NlbGVjdCBWaWV3JzogJ9Ca06nRgNKv0L3Sr9GI0YLSryDRgtCw0L3QtNCw0qPRi9C3JyxcbiAgICAnKyB7e259fSBldmVudHMnOiAnKyB7e259fSDQntC60YPRj9C70LDRgCcsXG4gICAgJysgMSBldmVudCc6ICcrIDEg0J7QutGD0Y8nLFxuICAgICdObyBldmVudHMnOiAn0J7QutGD0Y8g0LbQvtC6JyxcbiAgICAnTmV4dCBwZXJpb2QnOiAn0JrQuNC50LjQvdC60Lgg0LzQtdC30LPQuNC7JyxcbiAgICAnUHJldmlvdXMgcGVyaW9kJzogJ9Oo0YLQutOp0L0g0LzQtdC30LPQuNC7JyxcbiAgICB0bzogJ9GH0LXQudC40L0nLCAvLyBhcyBpbiAyLzEvMjAyMCB0byAyLzIvMjAyMFxuICAgICdGdWxsIGRheS0gYW5kIG11bHRpcGxlIGRheSBldmVudHMnOiAn0JrSr9C9INCx0L7RjiDQttCw0L3QsCDQsdC40YAg0L3QtdGH0LUg0LrSr9C9INC60LDRgtCw0YDRiyDQvNC10L3QtdC9INCx0L7Qu9Cz0L7QvSDQvtC60YPRj9C70LDRgCcsXG4gICAgJ0xpbmsgdG8ge3tufX0gbW9yZSBldmVudHMgb24ge3tkYXRlfX0nOiAne3tkYXRlfX0g0LrSr9C90q/QvdC006kge3tufX0g0L7QutGD0Y/Qs9CwINCx0LDQudC70LDQvdGL0YgnLFxuICAgICdMaW5rIHRvIDEgbW9yZSBldmVudCBvbiB7e2RhdGV9fSc6ICd7e2RhdGV9fSDQutKv0L3Sr9C90LTTqSAxINC+0LrRg9GP0LPQsCDQsdCw0LnQu9Cw0L3Ri9GIJyxcbiAgICBDVzogJ9CQ0L/RgtCwIHt7d2Vla319JyxcbiAgICBWaWV3OiAn0JrTqdGA0q/QvdKv0YgnLFxufTtcblxuY29uc3QgdGltZVBpY2tlckt5S0cgPSB7XG4gICAgVGltZTogJ9Cj0LHQsNC60YLRiycsXG4gICAgQU06ICdBTScsXG4gICAgUE06ICdQTScsXG4gICAgQ2FuY2VsOiAn0JHQvtC70LHQvtC5JyxcbiAgICBPSzogJ9Ce0L7QsdCwJyxcbiAgICAnU2VsZWN0IHRpbWUnOiAn0KPQsdCw0LrRgtGLINGC0LDQvdC00LDSo9GL0LcnLFxufTtcblxuY29uc3Qga3lLRyA9IHtcbiAgICAuLi5kYXRlUGlja2VyS3lLRyxcbiAgICAuLi5jYWxlbmRhckt5S0csXG4gICAgLi4udGltZVBpY2tlckt5S0csXG59O1xuXG5jb25zdCBkYXRlUGlja2VySWRJRCA9IHtcbiAgICBEYXRlOiAnVGFuZ2dhbCcsXG4gICAgJ01NL0REL1lZWVknOiAnREQuTU0uWVlZWScsXG4gICAgJ05leHQgbW9udGgnOiAnQnVsYW4gZGVwYW4nLFxuICAgICdQcmV2aW91cyBtb250aCc6ICdCdWxhbiBzZWJlbHVtbnlhJyxcbiAgICAnQ2hvb3NlIERhdGUnOiAnUGlsaWggdGFuZ2dhbCcsXG59O1xuXG5jb25zdCBjYWxlbmRhcklkSUQgPSB7XG4gICAgVG9kYXk6ICdIYXJpIEluaScsXG4gICAgTW9udGg6ICdCdWxhbicsXG4gICAgV2VlazogJ01pbmdndScsXG4gICAgRGF5OiAnSGFyaScsXG4gICAgTGlzdDogJ0RhZnRhcicsXG4gICAgJ1NlbGVjdCBWaWV3JzogJ1BpbGloIHRhbXBpbGFuJyxcbiAgICAnKyB7e259fSBldmVudHMnOiAnKyB7e259fSBBY2FyYScsXG4gICAgJysgMSBldmVudCc6ICcrIDEgQWNhcmEnLFxuICAgICdObyBldmVudHMnOiAnVGlkYWsgYWRhIGFjYXJhJyxcbiAgICAnTmV4dCBwZXJpb2QnOiAnUGVyaW9kZSBzZWxhbmp1dG55YScsXG4gICAgJ1ByZXZpb3VzIHBlcmlvZCc6ICdQZXJpb2RlIHNlYmVsdW1ueWEnLFxuICAgIHRvOiAnc2FtcGFpJywgLy8gYXMgaW4gMi8xLzIwMjAgdG8gMi8yLzIwMjBcbiAgICAnRnVsbCBkYXktIGFuZCBtdWx0aXBsZSBkYXkgZXZlbnRzJzogJ1NlcGFuamFuZyBoYXJpIGRhbiBhY2FyYSBiZWJlcmFwYSBoYXJpICcsXG4gICAgJ0xpbmsgdG8ge3tufX0gbW9yZSBldmVudHMgb24ge3tkYXRlfX0nOiAnVGF1dGFuIGtlIHt7bn19IGFjYXJhIGxhaW5ueWEgcGFkYSB7e2RhdGV9fScsXG4gICAgJ0xpbmsgdG8gMSBtb3JlIGV2ZW50IG9uIHt7ZGF0ZX19JzogJ1RhdXRhbiBrZSAxIGFjYXJhIGxhaW5ueWEgcGFkYSB7e2RhdGV9fScsXG4gICAgQ1c6ICdNaW5nZ3Uge3t3ZWVrfX0nLFxuICAgIFZpZXc6ICdUYW1waWxhbicsXG59O1xuXG5jb25zdCB0aW1lUGlja2VySWRJRCA9IHtcbiAgICBUaW1lOiAnV2FrdHUnLFxuICAgIEFNOiAnQU0nLFxuICAgIFBNOiAnUE0nLFxuICAgIENhbmNlbDogJ0JhdGFsa2FuJyxcbiAgICBPSzogJ09LJyxcbiAgICAnU2VsZWN0IHRpbWUnOiAnUGlsaWggd2FrdHUnLFxufTtcblxuY29uc3QgaWRJRCA9IHtcbiAgICAuLi5kYXRlUGlja2VySWRJRCxcbiAgICAuLi5jYWxlbmRhcklkSUQsXG4gICAgLi4udGltZVBpY2tlcklkSUQsXG59O1xuXG5jb25zdCBkYXRlUGlja2VyQ3NDWiA9IHtcbiAgICBEYXRlOiAnRGF0dW0nLFxuICAgICdNTS9ERC9ZWVlZJzogJ0REL01NL1lZWVknLFxuICAgICdOZXh0IG1vbnRoJzogJ0RhbMWhw60gbcSbc8OtYycsXG4gICAgJ1ByZXZpb3VzIG1vbnRoJzogJ1DFmWVkY2hvesOtIG3Em3PDrWMnLFxuICAgICdDaG9vc2UgRGF0ZSc6ICdWeWJlcnRlIGRhdHVtJyxcbn07XG5cbmNvbnN0IGNhbGVuZGFyQ3NDWiA9IHtcbiAgICBUb2RheTogJ0RuZXMnLFxuICAgIE1vbnRoOiAnTcSbc8OtYycsXG4gICAgV2VlazogJ1TDvWRlbicsXG4gICAgRGF5OiAnRGVuJyxcbiAgICBMaXN0OiAnU2V6bmFtJyxcbiAgICAnU2VsZWN0IFZpZXcnOiAnVnliZXJ0ZSB6b2JyYXplbsOtJyxcbiAgICAnKyB7e259fSBldmVudHMnOiAnKyB7e259fSB1ZMOhbG9zdGknLFxuICAgICcrIDEgZXZlbnQnOiAnKyAxIHVkw6Fsb3N0JyxcbiAgICAnTm8gZXZlbnRzJzogJ8W9w6FkbsOpIHVkw6Fsb3N0aScsXG4gICAgJ05leHQgcGVyaW9kJzogJ1DFmcOtxaF0w60gb2Jkb2LDrScsXG4gICAgJ1ByZXZpb3VzIHBlcmlvZCc6ICdQxZllZGNob3rDrSBvYmRvYsOtJyxcbiAgICB0bzogJ2RvJywgLy8gYXMgaW4gMi8xLzIwMjAgdG8gMi8yLzIwMjBcbiAgICAnRnVsbCBkYXktIGFuZCBtdWx0aXBsZSBkYXkgZXZlbnRzJzogJ0NlbG9kZW5uw60gYSB2w61jZWRlbm7DrSB1ZMOhbG9zdGknLFxuICAgICdMaW5rIHRvIHt7bn19IG1vcmUgZXZlbnRzIG9uIHt7ZGF0ZX19JzogJ09ka2F6IG5hIHt7bn19IGRhbMWhw61jaCB1ZMOhbG9zdMOtIGRuZSB7e2RhdGV9fScsXG4gICAgJ0xpbmsgdG8gMSBtb3JlIGV2ZW50IG9uIHt7ZGF0ZX19JzogJ09ka2F6IG5hIDEgZGFsxaHDrSB1ZMOhbG9zdCBkbmUge3tkYXRlfX0nLFxuICAgIENXOiAnVMO9ZGVuIHt7d2Vla319JyxcbiAgICBWaWV3OiAnWm9icmF6ZW7DrScsXG59O1xuXG5jb25zdCB0aW1lUGlja2VyQ3NDWiA9IHtcbiAgICBUaW1lOiAnxIxhcycsXG4gICAgQU06ICdEb3BvbGVkbmUnLFxuICAgIFBNOiAnT2Rwb2xlZG5lJyxcbiAgICBDYW5jZWw6ICdacnXFoWl0JyxcbiAgICBPSzogJ09LJyxcbiAgICAnU2VsZWN0IHRpbWUnOiAnVnliZXJ0ZSDEjWFzJyxcbn07XG5cbmNvbnN0IGNzQ1ogPSB7XG4gICAgLi4uZGF0ZVBpY2tlckNzQ1osXG4gICAgLi4uY2FsZW5kYXJDc0NaLFxuICAgIC4uLnRpbWVQaWNrZXJDc0NaLFxufTtcblxuY29uc3QgZGF0ZVBpY2tlckV0RUUgPSB7XG4gICAgRGF0ZTogJ0t1dXDDpGV2JyxcbiAgICAnTU0vREQvWVlZWSc6ICdQUC5LSy5BQUFBJyxcbiAgICAnTmV4dCBtb250aCc6ICdKw6RyZ21pbmUga3V1JyxcbiAgICAnUHJldmlvdXMgbW9udGgnOiAnRWVsbWluZSBrdXUnLFxuICAgICdDaG9vc2UgRGF0ZSc6ICdWYWxpIGt1dXDDpGV2Jyxcbn07XG5cbmNvbnN0IGNhbGVuZGFyRXRFRSA9IHtcbiAgICBUb2RheTogJ1TDpG5hJyxcbiAgICBNb250aDogJ0t1dScsXG4gICAgV2VlazogJ07DpGRhbCcsXG4gICAgRGF5OiAnUMOkZXYnLFxuICAgIExpc3Q6ICdOaW1la2lyaScsXG4gICAgJ1NlbGVjdCBWaWV3JzogJ1ZhbGkgdmFhZGUnLFxuICAgICcrIHt7bn19IGV2ZW50cyc6ICcrIHt7bn19IHPDvG5kbXVzZWQnLFxuICAgICcrIDEgZXZlbnQnOiAnKyAxIHPDvG5kbXVzJyxcbiAgICAnTm8gZXZlbnRzJzogJ1BvbGUgc8O8bmRtdXNpJyxcbiAgICAnTmV4dCBwZXJpb2QnOiAnSsOkcmdtaW5lIHBlcmlvb2QnLFxuICAgICdQcmV2aW91cyBwZXJpb2QnOiAnRWVsbWluZSBwZXJpb29kJyxcbiAgICB0bzogJ2t1bmknLFxuICAgICdGdWxsIGRheS0gYW5kIG11bHRpcGxlIGRheSBldmVudHMnOiAnVMOkaXNww6RldmEtIGphIG1pdG1lcMOkZXZhc8O8bmRtdXNlZCcsXG4gICAgJ0xpbmsgdG8ge3tufX0gbW9yZSBldmVudHMgb24ge3tkYXRlfX0nOiAnTGluayB7e259fSByb2hrZW1hdGVsZSBzw7xuZG11c3RlbGUga3V1cMOkZXZhbCB7e2RhdGV9fScsXG4gICAgJ0xpbmsgdG8gMSBtb3JlIGV2ZW50IG9uIHt7ZGF0ZX19JzogJ0xpbmsgw7xoZWxlIGxpc2Fzw7xuZG11c2VsZSBrdXVww6RldmFsIHt7ZGF0ZX19JyxcbiAgICBDVzogJ07DpGRhbGEgbnVtYmVyIHt7d2Vla319JyxcbiAgICBWaWV3OiAnVmFhZGUnLFxufTtcblxuY29uc3QgdGltZVBpY2tlckV0RUUgPSB7XG4gICAgVGltZTogJ0FlZycsXG4gICAgQU06ICdBTScsXG4gICAgUE06ICdQTScsXG4gICAgQ2FuY2VsOiAnTG9vYnUnLFxuICAgIE9LOiAnT0snLFxuICAgICdTZWxlY3QgdGltZSc6ICdWYWxpIGFlZycsXG59O1xuXG5jb25zdCBldEVFID0ge1xuICAgIC4uLmRhdGVQaWNrZXJFdEVFLFxuICAgIC4uLmNhbGVuZGFyRXRFRSxcbiAgICAuLi50aW1lUGlja2VyRXRFRSxcbn07XG5cbmNvbnN0IGRhdGVQaWNrZXJVa1VBID0ge1xuICAgIERhdGU6ICfQlNCw0YLQsCcsXG4gICAgJ01NL0REL1lZWVknOiAn0JzQnC/QlNCUL9Cg0KDQoNCgJyxcbiAgICAnTmV4dCBtb250aCc6ICfQndCw0YHRgtGD0L/QvdC40Lkg0LzRltGB0Y/RhtGMJyxcbiAgICAnUHJldmlvdXMgbW9udGgnOiAn0JzQuNC90YPQu9C40Lkg0LzRltGB0Y/RhtGMJyxcbiAgICAnQ2hvb3NlIERhdGUnOiAn0JLQuNCx0LXRgNGW0YLRjCDQtNCw0YLRgycsXG59O1xuXG5jb25zdCBjYWxlbmRhclVrVUEgPSB7XG4gICAgVG9kYXk6ICfQodGM0L7Qs9C+0LTQvdGWJyxcbiAgICBNb250aDogJ9Cc0ZbRgdGP0YbRjCcsXG4gICAgV2VlazogJ9Ci0LjQttC00LXQvdGMJyxcbiAgICBEYXk6ICfQlNC10L3RjCcsXG4gICAgTGlzdDogJ9Ch0L/QuNGB0L7QuicsXG4gICAgJ1NlbGVjdCBWaWV3JzogJ9CS0LjQsdC10YDRltGC0Ywg0LLQuNCz0LvRj9C0JyxcbiAgICAnKyB7e259fSBldmVudHMnOiAnKyB7e259fSDQv9C+0LTRltGXJyxcbiAgICAnKyAxIGV2ZW50JzogJysgMSDQv9C+0LTRltGPJyxcbiAgICAnTm8gZXZlbnRzJzogJ9Cd0LXQvNCw0ZQg0L/QvtC00ZbQuScsXG4gICAgJ05leHQgcGVyaW9kJzogJ9Cd0LDRgdGC0YPQv9C90LjQuSDQv9C10YDRltC+0LQnLFxuICAgICdQcmV2aW91cyBwZXJpb2QnOiAn0JzQuNC90YPQu9C40Lkg0L/QtdGA0ZbQvtC0JyxcbiAgICB0bzogJ9C/0L4nLCAvLyBhcyBpbiAyLzEvMjAyMCB0byAyLzIvMjAyMFxuICAgICdGdWxsIGRheS0gYW5kIG11bHRpcGxlIGRheSBldmVudHMnOiAn0J/QvtC00ZbRlyDQvdCwINGG0ZbQu9C40Lkg0LTQtdC90Ywg0ZYg0LrRltC70YzQutCwINC00L3RltCyINC/0L7RgdC/0ZbQu9GMJyxcbiAgICAnTGluayB0byB7e259fSBtb3JlIGV2ZW50cyBvbiB7e2RhdGV9fSc6ICfQn9C+0YHQuNC70LDQvdC90Y8g0L3QsCB7e259fSDQtNC+0LTQsNGC0LrQvtCy0ZYg0L/QvtC00ZbRlyDQvdCwIHt7ZGF0ZX19JyxcbiAgICAnTGluayB0byAxIG1vcmUgZXZlbnQgb24ge3tkYXRlfX0nOiAn0J/QvtGB0LjQu9Cw0L3QvdGPINC90LAgMSDQtNC+0LTQsNGC0LrQvtCy0YMg0L/QvtC00ZbRjiDQvdCwIHt7ZGF0ZX19JyxcbiAgICBDVzogJ9Ci0LjQttC00LXQvdGMIHt7d2Vla319JyxcbiAgICBWaWV3OiAn0JLQuNCz0LvRj9C0Jyxcbn07XG5cbmNvbnN0IHRpbWVQaWNrZXJVa1VBID0ge1xuICAgIFRpbWU6ICfQp9Cw0YEnLFxuICAgIEFNOiAnQU0nLFxuICAgIFBNOiAnUE0nLFxuICAgIENhbmNlbDogJ9Ch0LrQsNGB0YPQstCw0YLQuCcsXG4gICAgT0s6ICfQk9Cw0YDQsNC30LQnLFxuICAgICdTZWxlY3QgdGltZSc6ICfQktC40LHQtdGA0ZbRgtGMINGH0LDRgScsXG59O1xuXG5jb25zdCB1a1VBID0ge1xuICAgIC4uLmRhdGVQaWNrZXJVa1VBLFxuICAgIC4uLmNhbGVuZGFyVWtVQSxcbiAgICAuLi50aW1lUGlja2VyVWtVQSxcbn07XG5cbmNvbnN0IGRhdGVQaWNrZXJTckxhdG5SUyA9IHtcbiAgICBEYXRlOiAnRGF0dW0nLFxuICAgICdNTS9ERC9ZWVlZJzogJ0REL01NL1lZWVknLFxuICAgICdOZXh0IG1vbnRoJzogJ1NsZWRlxIdpIG1lc2VjJyxcbiAgICAnUHJldmlvdXMgbW9udGgnOiAnUHJldGhvZG5pIG1lc2VjJyxcbiAgICAnQ2hvb3NlIERhdGUnOiAnSXphYmVyaXRlIGRhdHVtJyxcbn07XG5cbmNvbnN0IGNhbGVuZGFyU3JMYXRuUlMgPSB7XG4gICAgVG9kYXk6ICdEYW5hcycsXG4gICAgTW9udGg6ICdNZXNlYycsXG4gICAgV2VlazogJ05lZGVsamEnLFxuICAgIERheTogJ0RhbicsXG4gICAgTGlzdDogJ0xpc3RhJyxcbiAgICAnU2VsZWN0IFZpZXcnOiAnT2RhYmVyaXRlIHByZWdsZWQnLFxuICAgICcrIHt7bn19IGV2ZW50cyc6ICcrIHt7bn19IERvZ2HEkWFqaScsXG4gICAgJysgMSBldmVudCc6ICcrIDEgRG9nYcSRYWonLFxuICAgICdObyBldmVudHMnOiAnTmVtYSBkb2dhxJFhamEnLFxuICAgICdOZXh0IHBlcmlvZCc6ICdOYXJlZG5pIHBlcmlvZCcsXG4gICAgJ1ByZXZpb3VzIHBlcmlvZCc6ICdQcmV0aG9kbmkgcGVyaW9kJyxcbiAgICB0bzogJ2RvJywgLy8gYXMgaW4gMi8xLzIwMjAgdG8gMi8yLzIwMjBcbiAgICAnRnVsbCBkYXktIGFuZCBtdWx0aXBsZSBkYXkgZXZlbnRzJzogJ0NlbG9kbmV2bmkgaSB2acWhZWRuZXZuaSBkb2dhxJFhamknLFxuICAgICdMaW5rIHRvIHt7bn19IG1vcmUgZXZlbnRzIG9uIHt7ZGF0ZX19JzogJ0xpbmsgZG8gam/FoSB7e259fSBkb2dhxJFhamEgbmEge3tkYXRlfX0nLFxuICAgICdMaW5rIHRvIDEgbW9yZSBldmVudCBvbiB7e2RhdGV9fSc6ICdMaW5rIGRvIGplZG5vZyBkb2dhxJFhamEgbmEge3tkYXRlfX0nLFxuICAgIENXOiAnTmVkZWxqYSB7e3dlZWt9fScsXG4gICAgVmlldzogJ1ByZWdsZWQnLFxufTtcblxuY29uc3QgdGltZVBpY2tlclNyTGF0blJTID0ge1xuICAgIFRpbWU6ICdWcmlqZW1lJyxcbiAgICBBTTogJ0FNJyxcbiAgICBQTTogJ1BNJyxcbiAgICBDYW5jZWw6ICdPdGthxb5pJyxcbiAgICBPSzogJ1UgcmVkdScsXG4gICAgJ1NlbGVjdCB0aW1lJzogJ09kYWJlcmkgdnJpamVtZScsXG59O1xuXG5jb25zdCBzckxhdG5SUyA9IHtcbiAgICAuLi5kYXRlUGlja2VyU3JMYXRuUlMsXG4gICAgLi4uY2FsZW5kYXJTckxhdG5SUyxcbiAgICAuLi50aW1lUGlja2VyU3JMYXRuUlMsXG59O1xuXG5jb25zdCBkYXRlUGlja2VyQ2FFUyA9IHtcbiAgICBEYXRlOiAnRGF0YScsXG4gICAgJ01NL0REL1lZWVknOiAnREQvTU0vWVlZWScsXG4gICAgJ05leHQgbW9udGgnOiAnU2Vnw7xlbnQgbWVzJyxcbiAgICAnUHJldmlvdXMgbW9udGgnOiAnTWVzIGFudGVyaW9yJyxcbiAgICAnQ2hvb3NlIERhdGUnOiAnU2VsZWNjaW9uYSB1bmEgZGF0YScsXG59O1xuXG5jb25zdCBjYWxlbmRhckNhRVMgPSB7XG4gICAgVG9kYXk6ICdBdnVpJyxcbiAgICBNb250aDogJ01lcycsXG4gICAgV2VlazogJ1NldG1hbmEnLFxuICAgIERheTogJ0RpYScsXG4gICAgTGlzdDogJ0xsaXN0YScsXG4gICAgJ1NlbGVjdCBWaWV3JzogJ1NlbGVjY2lvbmEgdW5hIHZpc3RhJyxcbiAgICAnKyB7e259fSBldmVudHMnOiAnKyB7e259fSBFc2RldmVuaW1lbnRzJyxcbiAgICAnKyAxIGV2ZW50JzogJysgMSBFc2RldmVuaW1lbnQnLFxuICAgICdObyBldmVudHMnOiAnU2Vuc2UgZXNkZXZlbmltZW50cycsXG4gICAgJ05leHQgcGVyaW9kJzogJ1NlZ8O8ZW50IHBlcsOtb2RlJyxcbiAgICAnUHJldmlvdXMgcGVyaW9kJzogJ1BlcsOtb2RlIGFudGVyaW9yJyxcbiAgICB0bzogJ2EnLCAvLyBhcyBpbiAyLzEvMjAyMCB0byAyLzIvMjAyMFxuICAgICdGdWxsIGRheS0gYW5kIG11bHRpcGxlIGRheSBldmVudHMnOiAnRXNkZXZlbmltZW50cyBkZSBkaWEgY29tcGxldCBpIGRlIG3Dumx0aXBsZXMgZGllcycsXG4gICAgJ0xpbmsgdG8ge3tufX0gbW9yZSBldmVudHMgb24ge3tkYXRlfX0nOiAnRW5sbGHDpyBhIHt7bn19IGVzZGV2ZW5pbWVudHMgbcOpcyBlbCB7e2RhdGV9fScsXG4gICAgJ0xpbmsgdG8gMSBtb3JlIGV2ZW50IG9uIHt7ZGF0ZX19JzogJ0VubGxhw6cgYSAxIGVzZGV2ZW5pbWVudCBtw6lzIGVsIHt7ZGF0ZX19JyxcbiAgICBDVzogJ1NldG1hbmEge3t3ZWVrfX0nLFxuICAgIFZpZXc6ICdWaXN0YScsXG59O1xuXG5jb25zdCB0aW1lUGlja2VyQ2FFUyA9IHtcbiAgICBUaW1lOiAnSG9yYScsXG4gICAgQU06ICdBTScsXG4gICAgUE06ICdQTScsXG4gICAgQ2FuY2VsOiAnQ2FuY2VswrdsYXInLFxuICAgIE9LOiAnQWNjZXB0YXInLFxuICAgICdTZWxlY3QgdGltZSc6ICdTZWxlY2Npb25hIHVuYSBob3JhJyxcbn07XG5cbmNvbnN0IGNhRVMgPSB7XG4gICAgLi4uZGF0ZVBpY2tlckNhRVMsXG4gICAgLi4uY2FsZW5kYXJDYUVTLFxuICAgIC4uLnRpbWVQaWNrZXJDYUVTLFxufTtcblxuY29uc3QgZGF0ZVBpY2tlclNyUlMgPSB7XG4gICAgRGF0ZTogJ9CU0LDRgtGD0LwnLFxuICAgICdNTS9ERC9ZWVlZJzogJ0REL01NL1lZWVknLFxuICAgICdOZXh0IG1vbnRoJzogJ9Ch0LvQtdC00LXRm9C4INC80LXRgdC10YYnLFxuICAgICdQcmV2aW91cyBtb250aCc6ICfQn9GA0LXRgtGF0L7QtNC90Lgg0LzQtdGB0LXRhicsXG4gICAgJ0Nob29zZSBEYXRlJzogJ9CY0LfQsNCx0LXRgNC40YLQtSDQlNCw0YLRg9C8Jyxcbn07XG5cbmNvbnN0IGNhbGVuZGFyU3JSUyA9IHtcbiAgICBUb2RheTogJ9CU0LDQvdCw0YEnLFxuICAgIE1vbnRoOiAn0JzQtdGB0LXRhicsXG4gICAgV2VlazogJ9Cd0LXQtNC10ZnQsCcsXG4gICAgRGF5OiAn0JTQsNC9JyxcbiAgICBMaXN0OiAn0JvQuNGB0YLQsCcsXG4gICAgJ1NlbGVjdCBWaWV3JzogJ9CY0LfQsNCx0LXRgNC40YLQtSDQv9GA0LXQs9C70LXQtCcsXG4gICAgJysge3tufX0gZXZlbnRzJzogJysge3tufX0g0JTQvtCz0LDRktCw0ZjQuCcsXG4gICAgJysgMSBldmVudCc6ICcrIDEg0JTQvtCz0LDRktCw0ZgnLFxuICAgICdObyBldmVudHMnOiAn0J3QtdC80LAg0LTQvtCz0LDRktCw0ZjQsCcsXG4gICAgJ05leHQgcGVyaW9kJzogJ9Ch0LvQtdC00LXRm9C4INC/0LXRgNC40L7QtCcsXG4gICAgJ1ByZXZpb3VzIHBlcmlvZCc6ICfQn9GA0LXRgtGF0L7QtNC90Lgg0L/QtdGA0LjQvtC0JyxcbiAgICB0bzogJ9C00LAnLCAvLyBhcyBpbiAyLzEvMjAyMCB0byAyLzIvMjAyMFxuICAgICdGdWxsIGRheS0gYW5kIG11bHRpcGxlIGRheSBldmVudHMnOiAn0KbQtdC70L7QtNC90LXQstC90Lgg0Lgg0LLQuNGI0LXQtNC90LXQstC90Lgg0LTQvtCz0LDRktCw0ZjQuCcsXG4gICAgJ0xpbmsgdG8ge3tufX0gbW9yZSBldmVudHMgb24ge3tkYXRlfX0nOiAn0JvQuNC90Log0LTQviDRmNC+0Ygge3tufX0g0LTQvtCz0LDRktCw0ZjQsCDQvdCwIHt7ZGF0ZX19JyxcbiAgICAnTGluayB0byAxIG1vcmUgZXZlbnQgb24ge3tkYXRlfX0nOiAn0JvQuNC90Log0LTQviDRmNC+0YggMSDQtNC+0LPQsNGS0LDRmNCwIHt7ZGF0ZX19JyxcbiAgICBDVzogJ9Cd0LXQtNC10ZnQsCB7e3dlZWt9fScsXG4gICAgVmlldzogJ9Cf0YDQtdCz0LvQtdC0Jyxcbn07XG5cbmNvbnN0IHRpbWVQaWNrZXJTclJTID0ge1xuICAgIFRpbWU6ICfQktGA0LXQvNC1JyxcbiAgICBBTTogJ0FNJyxcbiAgICBQTTogJ1BNJyxcbiAgICBDYW5jZWw6ICfQntGC0LrQsNC20LgnLFxuICAgIE9LOiAn0KMg0YDQtdC00YMnLFxuICAgICdTZWxlY3QgdGltZSc6ICfQmNC30LDQsdC10YDQuCDQstGA0LXQvNC1Jyxcbn07XG5cbmNvbnN0IHNyUlMgPSB7XG4gICAgLi4uZGF0ZVBpY2tlclNyUlMsXG4gICAgLi4uY2FsZW5kYXJTclJTLFxuICAgIC4uLnRpbWVQaWNrZXJTclJTLFxufTtcblxuY29uc3QgZGF0ZVBpY2tlckx0TFQgPSB7XG4gICAgRGF0ZTogJ0RhdGEnLFxuICAgICdNTS9ERC9ZWVlZJzogJ01NTU0tTU0tREQnLFxuICAgICdOZXh0IG1vbnRoJzogJ0tpdGFzIG3El251bycsXG4gICAgJ1ByZXZpb3VzIG1vbnRoJzogJ0Fua3N0ZXNuaXMgbcSXbnVvJyxcbiAgICAnQ2hvb3NlIERhdGUnOiAnUGFzaXJpbmtpdGUgZGF0xIUnLFxufTtcblxuY29uc3QgY2FsZW5kYXJMdExUID0ge1xuICAgIFRvZGF5OiAnxaBpYW5kaWVuJyxcbiAgICBNb250aDogJ03El251bycsXG4gICAgV2VlazogJ1NhdmFpdMSXJyxcbiAgICBEYXk6ICdEaWVuYScsXG4gICAgTGlzdDogJ1PEhXJhxaFhcycsXG4gICAgJ1NlbGVjdCBWaWV3JzogJ1Bhc2lyaW5raXRlIHZhaXpkxIUnLFxuICAgICcrIHt7bn19IGV2ZW50cyc6ICcrIHt7bn19IMSvdnlraWFpJyxcbiAgICAnKyAxIGV2ZW50JzogJysgMSDEr3Z5a2lzJyxcbiAgICAnTm8gZXZlbnRzJzogJ8SudnlracWzIG7El3JhJyxcbiAgICAnTmV4dCBwZXJpb2QnOiAnS2l0YXMgbGFpa290YXJwaXMnLFxuICAgICdQcmV2aW91cyBwZXJpb2QnOiAnQW5rc3Rlc25pcyBsYWlrb3RhcnBpcycsXG4gICAgdG86ICdpa2knLCAvLyBhcyBpbiAyLzEvMjAyMCB0byAyLzIvMjAyMFxuICAgICdGdWxsIGRheS0gYW5kIG11bHRpcGxlIGRheSBldmVudHMnOiAnVmlzb3MgZGllbm9zIGlyIGtlbGnFsyBkaWVuxbMgxK92eWtpYWknLFxuICAgICdMaW5rIHRvIHt7bn19IG1vcmUgZXZlbnRzIG9uIHt7ZGF0ZX19JzogJ051b3JvZGEgxK8gZGFyIHt7bn19IMSvdnlraXVzIHt7ZGF0ZX19JyxcbiAgICAnTGluayB0byAxIG1vcmUgZXZlbnQgb24ge3tkYXRlfX0nOiAnTnVvcm9kYSDEryBkYXIgMSB2aWVuxIUgxK92eWvEryB7e2RhdGV9fScsXG4gICAgQ1c6ICd7e3dlZWt9fSBzYXZhaXTElycsXG4gICAgVmlldzogJ1ZhaXpkYXMnLFxufTtcblxuY29uc3QgdGltZVBpY2tlckx0TFQgPSB7XG4gICAgVGltZTogJ0xhaWthcycsXG4gICAgQU06ICdBTScsXG4gICAgUE06ICdQTScsXG4gICAgQ2FuY2VsOiAnQXTFoWF1a3RpJyxcbiAgICBPSzogJ0dlcmFpJyxcbiAgICAnU2VsZWN0IHRpbWUnOiAnUGFzaXJpbmtpdGUgbGFpa8SFJyxcbn07XG5cbmNvbnN0IGx0TFQgPSB7XG4gICAgLi4uZGF0ZVBpY2tlckx0TFQsXG4gICAgLi4uY2FsZW5kYXJMdExULFxuICAgIC4uLnRpbWVQaWNrZXJMdExULFxufTtcblxuY29uc3QgZGF0ZVBpY2tlckhySFIgPSB7XG4gICAgRGF0ZTogJ0RhdHVtJyxcbiAgICAnTU0vREQvWVlZWSc6ICdERC9NTS9ZWVlZJyxcbiAgICAnTmV4dCBtb250aCc6ICdTbGplZGXEh2kgbWplc2VjJyxcbiAgICAnUHJldmlvdXMgbW9udGgnOiAnUHJldGhvZG5pIG1qZXNlYycsXG4gICAgJ0Nob29zZSBEYXRlJzogJ0l6YWJlcml0ZSBkYXR1bScsXG59O1xuXG5jb25zdCBjYWxlbmRhckhySFIgPSB7XG4gICAgVG9kYXk6ICdEYW5hcycsXG4gICAgTW9udGg6ICdNamVzZWMnLFxuICAgIFdlZWs6ICdOZWRqZWxqYScsXG4gICAgRGF5OiAnRGFuJyxcbiAgICBMaXN0OiAnTGlzdGEnLFxuICAgICdTZWxlY3QgVmlldyc6ICdPZGFiZXJpdGUgcHJlZ2xlZCcsXG4gICAgJysge3tufX0gZXZlbnRzJzogJysge3tufX0gRG9nYcSRYWppJyxcbiAgICAnKyAxIGV2ZW50JzogJysgMSBEb2dhxJFhaicsXG4gICAgJ05vIGV2ZW50cyc6ICdOZW1hIGRvZ2HEkWFqYScsXG4gICAgJ05leHQgcGVyaW9kJzogJ1NsamVkZcSHaSBwZXJpb2QnLFxuICAgICdQcmV2aW91cyBwZXJpb2QnOiAnUHJldGhvZG5pIHBlcmlvZCcsXG4gICAgdG86ICdkbycsIC8vIGFzIGluIDIvMS8yMDIwIHRvIDIvMi8yMDIwXG4gICAgJ0Z1bGwgZGF5LSBhbmQgbXVsdGlwbGUgZGF5IGV2ZW50cyc6ICdDamVsb2RuZXZuaSBpIHZpxaFlZG5ldm5pIGRvZ2HEkWFqaScsXG4gICAgJ0xpbmsgdG8ge3tufX0gbW9yZSBldmVudHMgb24ge3tkYXRlfX0nOiAnTGluayBkbyBqb8WhIHt7bn19IGRvZ2HEkWFqYSBuYSB7e2RhdGV9fScsXG4gICAgJ0xpbmsgdG8gMSBtb3JlIGV2ZW50IG9uIHt7ZGF0ZX19JzogJ0xpbmsgZG8gam/FoSBqZWRub2cgZG9nYcSRYWphIG5hIHt7ZGF0ZX19JyxcbiAgICBDVzogJ3t7d2Vla319LiB0amVkYW4nLFxuICAgIFZpZXc6ICdQcmVnbGVkJyxcbn07XG5cbmNvbnN0IHRpbWVQaWNrZXJIckhSID0ge1xuICAgIFRpbWU6ICdWcmlqZW1lJyxcbiAgICBBTTogJ0FNJyxcbiAgICBQTTogJ1BNJyxcbiAgICBDYW5jZWw6ICdPdGthxb5pJyxcbiAgICBPSzogJ1UgcmVkdScsXG4gICAgJ1NlbGVjdCB0aW1lJzogJ09kYWJlcmkgdnJpamVtZScsXG59O1xuXG5jb25zdCBockhSID0ge1xuICAgIC4uLmRhdGVQaWNrZXJIckhSLFxuICAgIC4uLmNhbGVuZGFySHJIUixcbiAgICAuLi50aW1lUGlja2VySHJIUixcbn07XG5cbmNvbnN0IGRhdGVQaWNrZXJTbFNJID0ge1xuICAgIERhdGU6ICdEYXR1bScsXG4gICAgJ01NL0REL1lZWVknOiAnTU0uREQuWVlZWScsXG4gICAgJ05leHQgbW9udGgnOiAnTmFzbGVkbmppIG1lc2VjJyxcbiAgICAnUHJldmlvdXMgbW9udGgnOiAnUHJlasWhbmppIG1lc2VjJyxcbiAgICAnQ2hvb3NlIERhdGUnOiAnSXpiZXJpIGRhdHVtJyxcbn07XG5cbmNvbnN0IGNhbGVuZGFyU2xTSSA9IHtcbiAgICBUb2RheTogJ0RhbmVzJyxcbiAgICBNb250aDogJ01lc2VjJyxcbiAgICBXZWVrOiAnVGVkZW4nLFxuICAgIERheTogJ0RhbicsXG4gICAgTGlzdDogJ1Nlem5hbScsXG4gICAgJ1NlbGVjdCBWaWV3JzogJ0l6YmVyaSBwb2dsZWQnLFxuICAgICcrIHt7bn19IGV2ZW50cyc6ICcrIHt7bn19IGRvZ29ka2knLFxuICAgICcrIDEgZXZlbnQnOiAnKyAxIGRvZ29kZWsnLFxuICAgICdObyBldmVudHMnOiAnTmkgZG9nb2Rrb3YnLFxuICAgICdOZXh0IHBlcmlvZCc6ICdOYXNsZWRuamkgZG9nb2RlaycsXG4gICAgJ1ByZXZpb3VzIHBlcmlvZCc6ICdQcmVqxaFuamkgZG9nb2RlaycsXG4gICAgdG86ICdkbycsIC8vIGFzIGluIDIvMS8yMDIwIHRvIDIvMi8yMDIwXG4gICAgJ0Z1bGwgZGF5LSBhbmQgbXVsdGlwbGUgZGF5IGV2ZW50cyc6ICdDZWxvZG5ldm5pIGluIHZlxI1kbmV2bmkgZG9nb2RraScsXG4gICAgJ0xpbmsgdG8ge3tufX0gbW9yZSBldmVudHMgb24ge3tkYXRlfX0nOiAnUG92ZXphdmEgZG8ge3tufX0gZHJ1Z2loIGRvZ29ka292IGRuZSB7e2RhdGV9fScsXG4gICAgJ0xpbmsgdG8gMSBtb3JlIGV2ZW50IG9uIHt7ZGF0ZX19JzogJ1BvdmV6YXZhIGRvIMWhZSBlbmVnYSBkb2dvZGthIGRuZSB7e2RhdGV9fScsXG4gICAgQ1c6ICdUZWRlbiB7e3dlZWt9fScsXG4gICAgVmlldzogJ1BvZ2xlZCcsXG59O1xuXG5jb25zdCB0aW1lUGlja2VyU2xTSSA9IHtcbiAgICBUaW1lOiAnxIxhcycsXG4gICAgQU06ICdBTScsXG4gICAgUE06ICdQTScsXG4gICAgQ2FuY2VsOiAnUHJla2xpxI1pJyxcbiAgICBPSzogJ1YgcmVkdScsXG4gICAgJ1NlbGVjdCB0aW1lJzogJ0l6YmVyaXRlIMSNYXMnLFxufTtcblxuY29uc3Qgc2xTSSA9IHtcbiAgICAuLi5kYXRlUGlja2VyU2xTSSxcbiAgICAuLi5jYWxlbmRhclNsU0ksXG4gICAgLi4udGltZVBpY2tlclNsU0ksXG59O1xuXG5jb25zdCBkYXRlUGlja2VyRmlGSSA9IHtcbiAgICBEYXRlOiAnUMOkaXbDpG3DpMOkcsOkJyxcbiAgICAnTU0vREQvWVlZWSc6ICdWVlZWLUtLLVBQJyxcbiAgICAnTmV4dCBtb250aCc6ICdTZXVyYWF2YSBrdXVrYXVzaScsXG4gICAgJ1ByZXZpb3VzIG1vbnRoJzogJ0VkZWxsaW5lbiBrdXVrYXVzaScsXG4gICAgJ0Nob29zZSBEYXRlJzogJ1ZhbGl0c2UgcMOkaXbDpG3DpMOkcsOkJyxcbn07XG5cbmNvbnN0IGNhbGVuZGFyRmlGSSA9IHtcbiAgICBUb2RheTogJ1TDpG7DpMOkbicsXG4gICAgTW9udGg6ICdLdXVrYXVzaScsXG4gICAgV2VlazogJ1ZpaWtrbycsXG4gICAgRGF5OiAnUMOkaXbDpCcsXG4gICAgTGlzdDogJ0xpc3RhJyxcbiAgICAnU2VsZWN0IFZpZXcnOiAnVmFsaXRzZSBuw6RreW3DpCcsXG4gICAgJysge3tufX0gZXZlbnRzJzogJysge3tufX0gdGFwYWh0dW1hYScsXG4gICAgJysgMSBldmVudCc6ICcrIDEgdGFwYWh0dW1hJyxcbiAgICAnTm8gZXZlbnRzJzogJ0VpIHRhcGFodHVtaWEnLFxuICAgICdOZXh0IHBlcmlvZCc6ICdTZXVyYWF2YSBhamFuamFrc28nLFxuICAgICdQcmV2aW91cyBwZXJpb2QnOiAnRWRlbGxpbmVuIGFqYW5qYWtzbycsXG4gICAgdG86ICctJywgLy8gYXMgaW4gMi8xLzIwMjAgdG8gMi8yLzIwMjBcbiAgICAnRnVsbCBkYXktIGFuZCBtdWx0aXBsZSBkYXkgZXZlbnRzJzogJ0tva28gamEgdXNlYW4gcMOkaXbDpG4gdGFwYWh0dW1hdCcsXG4gICAgJ0xpbmsgdG8ge3tufX0gbW9yZSBldmVudHMgb24ge3tkYXRlfX0nOiAnTGlua2tpIHt7bn19IGxpc8OkdGFwYWh0dW1hYW4gcMOkaXbDpG3DpMOkcsOkbGzDpCB7e2RhdGV9fScsXG4gICAgJ0xpbmsgdG8gMSBtb3JlIGV2ZW50IG9uIHt7ZGF0ZX19JzogJ0xpbmtraSAxIGxpc8OkdGFwYWh0dW1hYW4gcMOkaXbDpG3DpMOkcsOkbGzDpCB7e2RhdGV9fScsXG4gICAgQ1c6ICdWaWlra28ge3t3ZWVrfX0nLFxuICAgIFZpZXc6ICdOw6RreW3DpCcsXG59O1xuXG5jb25zdCB0aW1lUGlja2VyRmlGSSA9IHtcbiAgICBUaW1lOiAnQWlrYScsXG4gICAgQU06ICdhcC4nLFxuICAgIFBNOiAnaXAuJyxcbiAgICBDYW5jZWw6ICdQZXJ1dXRhJyxcbiAgICBPSzogJ09LJyxcbiAgICAnU2VsZWN0IHRpbWUnOiAnVmFsaXRzZSBhaWthJyxcbn07XG5cbmNvbnN0IGZpRkkgPSB7XG4gICAgLi4uZGF0ZVBpY2tlckZpRkksXG4gICAgLi4uY2FsZW5kYXJGaUZJLFxuICAgIC4uLnRpbWVQaWNrZXJGaUZJLFxufTtcblxuY29uc3QgZGF0ZVBpY2tlclJvUk8gPSB7XG4gICAgRGF0ZTogJ0RhdGEnLFxuICAgICdNTS9ERC9ZWVlZJzogJ0xML1paL0FBQUEnLFxuICAgICdOZXh0IG1vbnRoJzogJ0x1bmEgdXJtxIN0b2FyZScsXG4gICAgJ1ByZXZpb3VzIG1vbnRoJzogJ0x1bmEgYW50ZXJpb2FyxIMnLFxuICAgICdDaG9vc2UgRGF0ZSc6ICdBbGVnZSBkYXRhJyxcbn07XG5cbmNvbnN0IGNhbGVuZGFyUm9STyA9IHtcbiAgICBUb2RheTogJ0FzdMSDemknLFxuICAgIE1vbnRoOiAnTHVuxIMnLFxuICAgIFdlZWs6ICdTxINwdMSDbcOibsSDJyxcbiAgICBEYXk6ICdaaScsXG4gICAgTGlzdDogJ0xpc3TEgycsXG4gICAgJ1NlbGVjdCBWaWV3JzogJ1NlbGVjdGVhesSDIHZpenVhbGl6YXJlYScsXG4gICAgJysge3tufX0gZXZlbnRzJzogJysge3tufX0gZXZlbmltZW50ZScsXG4gICAgJysgMSBldmVudCc6ICcrIDEgZXZlbmltZW50JyxcbiAgICAnTm8gZXZlbnRzJzogJ0bEg3LEgyBldmVuaW1lbnRlJyxcbiAgICAnTmV4dCBwZXJpb2QnOiAnUGVyaW9hZGEgdXJtxIN0b2FyZScsXG4gICAgJ1ByZXZpb3VzIHBlcmlvZCc6ICdQZXJpb2FkYSBhbnRlcmlvYXLEgycsXG4gICAgdG86ICdww6JuxIMgbGEnLCAvLyBhcyBpbiAyLzEvMjAyMCB0byAyLzIvMjAyMFxuICAgICdGdWxsIGRheS0gYW5kIG11bHRpcGxlIGRheSBldmVudHMnOiAnRXZlbmltZW50ZSBwZSBkdXJhdGEgw65udHJlZ2lpIHppbGUgyJlpIHBlIGR1cmF0YSBtYWkgbXVsdG9yIHppbGUnLFxuICAgICdMaW5rIHRvIHt7bn19IG1vcmUgZXZlbnRzIG9uIHt7ZGF0ZX19JzogJ0xpbmsgY8SDdHJlIHt7bn19IGV2ZW5pbWVudGUgc3VwbGltZW50YXJlIHBlIHt7ZGF0ZX19JyxcbiAgICAnTGluayB0byAxIG1vcmUgZXZlbnQgb24ge3tkYXRlfX0nOiAnTGluayBjxIN0cmUgMSBldmVuaW1lbnQgc3VwbGltZW50YXIgcGUge3tkYXRlfX0nLFxuICAgIENXOiAnU8SDcHTEg23Dom5hIHt7d2Vla319JyxcbiAgICBWaWV3OiAnVml6dWFsaXphcmUnLFxufTtcblxuY29uc3QgdGltZVBpY2tlclJvUk8gPSB7XG4gICAgVGltZTogJ1RpbXAnLFxuICAgIEFNOiAnQU0nLFxuICAgIFBNOiAnUE0nLFxuICAgIENhbmNlbDogJ0FudWxlYXrEgycsXG4gICAgT0s6ICdPSycsXG4gICAgJ1NlbGVjdCB0aW1lJzogJ1NlbGVjdGHIm2kgb3JhJyxcbn07XG5cbmNvbnN0IHJvUk8gPSB7XG4gICAgLi4uZGF0ZVBpY2tlclJvUk8sXG4gICAgLi4uY2FsZW5kYXJSb1JPLFxuICAgIC4uLnRpbWVQaWNrZXJSb1JPLFxufTtcblxuY29uc3QgZGF0ZVBpY2tlckZhSVIgPSB7XG4gICAgRGF0ZTogJ9iq2KfYsduM2K4nLFxuICAgICdNTS9ERC9ZWVlZJzogJ01NL0REL1lZWVknLFxuICAgICdOZXh0IG1vbnRoJzogJ9mF2KfZhyDYqNi52K8nLFxuICAgICdQcmV2aW91cyBtb250aCc6ICfZhdin2Ycg2YLYqNmEJyxcbiAgICAnQ2hvb3NlIERhdGUnOiAn2KfZhtiq2K7Yp9ioINiq2KfYsduM2K4nLFxufTtcblxuY29uc3QgY2FsZW5kYXJGYUlSID0ge1xuICAgIFRvZGF5OiAn2KfZhdix2YjYsicsXG4gICAgTW9udGg6ICfZhdin2YcnLFxuICAgIFdlZWs6ICfZh9mB2KrZhycsXG4gICAgRGF5OiAn2LHZiNiyJyxcbiAgICBMaXN0OiAn2YTbjNiz2KonLFxuICAgICdTZWxlY3QgVmlldyc6ICfYp9mG2KrYrtin2Kgg2YbZhdinJyxcbiAgICAnKyB7e259fSBldmVudHMnOiAnKyB7e259fSDYsdmI24zYr9in2K/Zh9inJyxcbiAgICAnKyAxIGV2ZW50JzogJysgMSDYsdmI24zYr9in2K8nLFxuICAgICdObyBldmVudHMnOiAn2LHZiNuM2K/Yp9iv24wg2YjYrNmI2K8g2YbYr9in2LHYrycsXG4gICAgJ05leHQgcGVyaW9kJzogJ9iv2YjYsdmHINio2LnYr9uMJyxcbiAgICAnUHJldmlvdXMgcGVyaW9kJzogJ9iv2YjYsdmHINmC2KjZhNuMJyxcbiAgICB0bzogJ9iq2KcnLFxuICAgICdGdWxsIGRheS0gYW5kIG11bHRpcGxlIGRheSBldmVudHMnOiAn2LHZiNuM2K/Yp9iv2YfYp9uMINiq2YXYp9mFINix2YjYsiDZiCDahtmG2K8g2LHZiNiy2YcnLFxuICAgICdMaW5rIHRvIHt7bn19IG1vcmUgZXZlbnRzIG9uIHt7ZGF0ZX19JzogJ9mE24zZhtqpINio2Ycge3tufX0g2LHZiNuM2K/Yp9ivINio24zYtNiq2LEg2K/YsSDYqtin2LHbjNiuIHt7ZGF0ZX19JyxcbiAgICAnTGluayB0byAxIG1vcmUgZXZlbnQgb24ge3tkYXRlfX0nOiAn2YTbjNmG2qkg2KjZhyAxINix2YjbjNiv2KfYryDYqNuM2LTYqtixINiv2LEg2KrYp9ix24zYriB7e2RhdGV9fScsXG4gICAgQ1c6ICfZh9mB2KrZhyB7e3dlZWt9fScsXG4gICAgVmlldzogJ9mG2YXYp9uM2LQnLFxufTtcblxuY29uc3QgdGltZVBpY2tlckZhSVIgPSB7XG4gICAgVGltZTogJ9iy2YXYp9mGJyxcbiAgICBBTTogJ9mCLti4JyxcbiAgICBQTTogJ9ioLti4JyxcbiAgICBDYW5jZWw6ICfZhNi62YgnLFxuICAgIE9LOiAn2KrYp9uM24zYrycsXG4gICAgJ1NlbGVjdCB0aW1lJzogJ9in2YbYqtiu2KfYqCDYstmF2KfZhicsXG59O1xuXG5jb25zdCBmYUlSID0ge1xuICAgIC4uLmRhdGVQaWNrZXJGYUlSLFxuICAgIC4uLmNhbGVuZGFyRmFJUixcbiAgICAuLi50aW1lUGlja2VyRmFJUixcbn07XG5cbmNsYXNzIEludmFsaWRMb2NhbGVFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgICBjb25zdHJ1Y3Rvcihsb2NhbGUpIHtcbiAgICAgICAgc3VwZXIoYEludmFsaWQgbG9jYWxlOiAke2xvY2FsZX1gKTtcbiAgICB9XG59XG5cbmNvbnN0IHRyYW5zbGF0ZSA9IChsb2NhbGUsIGxhbmd1YWdlcykgPT4gKGtleSwgdHJhbnNsYXRpb25WYXJpYWJsZXMpID0+IHtcbiAgICBpZiAoIS9eW2Etel17Mn0tW0EtWl17Mn0kLy50ZXN0KGxvY2FsZS52YWx1ZSkgJiZcbiAgICAgICAgJ3NyLUxhdG4tUlMnICE9PSBsb2NhbGUudmFsdWUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEludmFsaWRMb2NhbGVFcnJvcihsb2NhbGUudmFsdWUpO1xuICAgIH1cbiAgICBjb25zdCBkZUh5cGhlbmF0ZWRMb2NhbGUgPSBsb2NhbGUudmFsdWUucmVwbGFjZUFsbCgnLScsICcnKTtcbiAgICBjb25zdCBsYW5ndWFnZSA9IGxhbmd1YWdlcy52YWx1ZVtkZUh5cGhlbmF0ZWRMb2NhbGVdO1xuICAgIGlmICghbGFuZ3VhZ2UpXG4gICAgICAgIHJldHVybiBrZXk7XG4gICAgbGV0IHRyYW5zbGF0aW9uID0gbGFuZ3VhZ2Vba2V5XSB8fCBrZXk7XG4gICAgT2JqZWN0LmtleXModHJhbnNsYXRpb25WYXJpYWJsZXMgfHwge30pLmZvckVhY2goKHZhcmlhYmxlKSA9PiB7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gU3RyaW5nKHRyYW5zbGF0aW9uVmFyaWFibGVzID09PSBudWxsIHx8IHRyYW5zbGF0aW9uVmFyaWFibGVzID09PSB2b2lkIDAgPyB2b2lkIDAgOiB0cmFuc2xhdGlvblZhcmlhYmxlc1t2YXJpYWJsZV0pO1xuICAgICAgICBpZiAoIXZhbHVlKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0cmFuc2xhdGlvbiA9IHRyYW5zbGF0aW9uLnJlcGxhY2UoYHt7JHt2YXJpYWJsZX19fWAsIHZhbHVlKTtcbiAgICB9KTtcbiAgICByZXR1cm4gdHJhbnNsYXRpb247XG59O1xuXG5jb25zdCBkYXRlUGlja2VySGVJTCA9IHtcbiAgICBEYXRlOiAn16rWt9eQ1rLXqNa015nXmicsXG4gICAgJ01NL0REL1lZWVknOiAnTU0vREQvWVlZWScsXG4gICAgJ05leHQgbW9udGgnOiAn15fXldeT16kg15TXkdeQJyxcbiAgICAnUHJldmlvdXMgbW9udGgnOiAn15fXldeT16kg16fXldeT150nLFxuICAgICdDaG9vc2UgRGF0ZSc6ICfXkdeX16gg16rXkNeo15nXmicsXG59O1xuXG5jb25zdCBjYWxlbmRhckhlSUwgPSB7XG4gICAgVG9kYXk6ICfXlNa315nXlda5150nLFxuICAgIE1vbnRoOiAn15fXlda515PWttep14EnLFxuICAgIFdlZWs6ICfXqdeB1rjXkdeV1rzXota3JyxcbiAgICBEYXk6ICfXmdeV1rnXnScsXG4gICAgTGlzdDogJ9eo16nXmdee15QnLFxuICAgICdTZWxlY3QgVmlldyc6ICfXkdeX16gg16rXpteV15LXlCcsXG4gICAgJysge3tufX0gZXZlbnRzJzogJysge3tufX0g15DXmdeo15XXoteZ150nLFxuICAgICcrIDEgZXZlbnQnOiAnKyAxINeQ15nXqNeV16InLFxuICAgICdObyBldmVudHMnOiAn15DXmdefINeQ15nXqNeV16LXmdedJyxcbiAgICAnTmV4dCBwZXJpb2QnOiAn16rXp9eV16TXlCDXlNeR15DXlCcsXG4gICAgJ1ByZXZpb3VzIHBlcmlvZCc6ICfXqten15XXpNeUINen15XXk9ee16onLFxuICAgIHRvOiAn16LXkycsIC8vIGFzIGluIDIvMS8yMDIwIHRvIDIvMi8yMDIwXG4gICAgJ0Z1bGwgZGF5LSBhbmQgbXVsdGlwbGUgZGF5IGV2ZW50cyc6ICfXkNeZ16jXldei15nXnSDXnNeb15wg15TXmdeV150g15XXnNee16HXpNeoINeZ157XmdedJyxcbiAgICAnTGluayB0byB7e259fSBtb3JlIGV2ZW50cyBvbiB7e2RhdGV9fSc6ICfXp9eZ16nXldeoINec16LXldeTIHt7bn19INeQ15nXqNeV16LXmdedINeRLXt7ZGF0ZX19JyxcbiAgICAnTGluayB0byAxIG1vcmUgZXZlbnQgb24ge3tkYXRlfX0nOiAn16fXmdep15XXqCDXnNeQ15nXqNeV16Ig16DXldeh16Mg15Ete3tkYXRlfX0nLFxuICAgIENXOiAne3t3ZWVrfX0g16nXgda415HXlda816LWtycsXG4gICAgVmlldzogJ9eq16bXldeS15QnLFxufTtcblxuY29uc3QgdGltZVBpY2tlckhlSUwgPSB7XG4gICAgVGltZTogJ9ep16LXlCcsXG4gICAgQU06ICfXnNek16DXlFwi16YnLFxuICAgIFBNOiAn15DXl9eUXCLXpicsXG4gICAgQ2FuY2VsOiAn15HXmdeY15XXnCcsXG4gICAgT0s6ICfXkNeZ16nXldeoJyxcbiAgICAnU2VsZWN0IHRpbWUnOiAn15HXl9eoINep16LXlCcsXG59O1xuXG5jb25zdCBoZUlMID0ge1xuICAgIC4uLmRhdGVQaWNrZXJIZUlMLFxuICAgIC4uLmNhbGVuZGFySGVJTCxcbiAgICAuLi50aW1lUGlja2VySGVJTCxcbn07XG5cbmNvbnN0IHRyYW5zbGF0aW9ucyA9IHtcbiAgICBkZURFLFxuICAgIGVuVVMsXG4gICAgaXRJVCxcbiAgICBlbkdCLFxuICAgIHN2U0UsXG4gICAgemhDTixcbiAgICB6aFRXLFxuICAgIGphSlAsXG4gICAgcnVSVSxcbiAgICBrb0tSLFxuICAgIGZyRlIsXG4gICAgZGFESyxcbiAgICBta01LLFxuICAgIG5iTk8sXG4gICAgcGxQTCxcbiAgICBoZUlMLFxuICAgIGVzRVMsXG4gICAgbmxOTCxcbiAgICBwdEJSLFxuICAgIHNrU0ssXG4gICAgdHJUUixcbiAgICBreUtHLFxuICAgIGlkSUQsXG4gICAgY3NDWixcbiAgICBldEVFLFxuICAgIHVrVUEsXG4gICAgY2FFUyxcbiAgICBzckxhdG5SUyxcbiAgICBzclJTLFxuICAgIGx0TFQsXG4gICAgaHJIUixcbiAgICBzbFNJLFxuICAgIGZpRkksXG4gICAgcm9STyxcbiAgICBmYUlSLFxuICAgIGFyRUcsXG59O1xuXG5jbGFzcyBFdmVudENvbG9ycyB7XG4gICAgY29uc3RydWN0b3IoY29uZmlnKSB7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImNvbmZpZ1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogY29uZmlnXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZXRMaWdodCgpIHtcbiAgICAgICAgT2JqZWN0LmVudHJpZXModGhpcy5jb25maWcuY2FsZW5kYXJzLnZhbHVlIHx8IHt9KS5mb3JFYWNoKChbY2FsZW5kYXJOYW1lLCBjYWxlbmRhcl0pID0+IHtcbiAgICAgICAgICAgIGlmICghY2FsZW5kYXIubGlnaHRDb2xvcnMpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYE5vIGxpZ2h0IGNvbG9ycyBkZWZpbmVkIGZvciBjYWxlbmRhciAke2NhbGVuZGFyTmFtZX1gKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNldENvbG9ycyhjYWxlbmRhci5jb2xvck5hbWUsIGNhbGVuZGFyLmxpZ2h0Q29sb3JzKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHNldERhcmsoKSB7XG4gICAgICAgIE9iamVjdC5lbnRyaWVzKHRoaXMuY29uZmlnLmNhbGVuZGFycy52YWx1ZSB8fCB7fSkuZm9yRWFjaCgoW2NhbGVuZGFyTmFtZSwgY2FsZW5kYXJdKSA9PiB7XG4gICAgICAgICAgICBpZiAoIWNhbGVuZGFyLmRhcmtDb2xvcnMpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYE5vIGRhcmsgY29sb3JzIGRlZmluZWQgZm9yIGNhbGVuZGFyICR7Y2FsZW5kYXJOYW1lfWApO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2V0Q29sb3JzKGNhbGVuZGFyLmNvbG9yTmFtZSwgY2FsZW5kYXIuZGFya0NvbG9ycyk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZXRDb2xvcnMoY29sb3JOYW1lLCBjb2xvckRlZmluaXRpb24pIHtcbiAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KGAtLXN4LWNvbG9yLSR7Y29sb3JOYW1lfWAsIGNvbG9yRGVmaW5pdGlvbi5tYWluKTtcbiAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KGAtLXN4LWNvbG9yLSR7Y29sb3JOYW1lfS1jb250YWluZXJgLCBjb2xvckRlZmluaXRpb24uY29udGFpbmVyKTtcbiAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KGAtLXN4LWNvbG9yLW9uLSR7Y29sb3JOYW1lfS1jb250YWluZXJgLCBjb2xvckRlZmluaXRpb24ub25Db250YWluZXIpO1xuICAgIH1cbn1cblxuY29uc3QgY3JlYXRlQ2FsZW5kYXJTdGF0ZSA9IChjYWxlbmRhckNvbmZpZywgdGltZVVuaXRzSW1wbCwgc2VsZWN0ZWREYXRlKSA9PiB7XG4gICAgdmFyIF9hO1xuICAgIGNvbnN0IF92aWV3ID0gc2lnbmFsKCgoX2EgPSBjYWxlbmRhckNvbmZpZy52aWV3cy52YWx1ZS5maW5kKCh2aWV3KSA9PiB2aWV3Lm5hbWUgPT09IGNhbGVuZGFyQ29uZmlnLmRlZmF1bHRWaWV3KSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLm5hbWUpIHx8IGNhbGVuZGFyQ29uZmlnLnZpZXdzLnZhbHVlWzBdLm5hbWUpO1xuICAgIGNvbnN0IHZpZXcgPSBjb21wdXRlZCgoKSA9PiB7XG4gICAgICAgIHJldHVybiBfdmlldy52YWx1ZTtcbiAgICB9KTtcbiAgICBjb25zdCByYW5nZSA9IHNpZ25hbChudWxsKTtcbiAgICBsZXQgd2FzSW5pdGlhbGl6ZWQgPSBmYWxzZTtcbiAgICBsZXQgbGFzdFJhbmdlRW1pdHRlZF9fTkVFREVEX1RPX1BSRVZFTlRfUkVDVVJTSU9OX0lOX0VWRU5UX1JFQ1VSUkVOQ0VfUEFDS0FHRV9XSElDSF9DQVVTRVNfUkFOR0VfVE9fVVBEQVRFX0FORF9USFVTX0NBVVNFU19BX0NZQ0xFID0gbnVsbDtcbiAgICBjb25zdCBjYWxsT25SYW5nZVVwZGF0ZSA9IChfcmFuZ2UpID0+IHtcbiAgICAgICAgY29uc3QgbGFzdFJhbmdlID0gbGFzdFJhbmdlRW1pdHRlZF9fTkVFREVEX1RPX1BSRVZFTlRfUkVDVVJTSU9OX0lOX0VWRU5UX1JFQ1VSUkVOQ0VfUEFDS0FHRV9XSElDSF9DQVVTRVNfUkFOR0VfVE9fVVBEQVRFX0FORF9USFVTX0NBVVNFU19BX0NZQ0xFO1xuICAgICAgICBpZiAoIV9yYW5nZS52YWx1ZSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgaWYgKChsYXN0UmFuZ2UgPT09IG51bGwgfHwgbGFzdFJhbmdlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBsYXN0UmFuZ2Uuc3RhcnQudG9TdHJpbmcoKSkgPT09IF9yYW5nZS52YWx1ZS5zdGFydC50b1N0cmluZygpICYmXG4gICAgICAgICAgICAobGFzdFJhbmdlID09PSBudWxsIHx8IGxhc3RSYW5nZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogbGFzdFJhbmdlLmVuZC50b1N0cmluZygpKSA9PT0gX3JhbmdlLnZhbHVlLmVuZC50b1N0cmluZygpKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBpZiAoIXdhc0luaXRpYWxpemVkKVxuICAgICAgICAgICAgcmV0dXJuICh3YXNJbml0aWFsaXplZCA9IHRydWUpO1xuICAgICAgICBpZiAoY2FsZW5kYXJDb25maWcuY2FsbGJhY2tzLm9uUmFuZ2VVcGRhdGUgJiYgX3JhbmdlLnZhbHVlKSB7XG4gICAgICAgICAgICBjYWxlbmRhckNvbmZpZy5jYWxsYmFja3Mub25SYW5nZVVwZGF0ZShfcmFuZ2UudmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIE9iamVjdC52YWx1ZXMoY2FsZW5kYXJDb25maWcucGx1Z2lucyB8fCB7fSkuZm9yRWFjaCgocGx1Z2luKSA9PiB7XG4gICAgICAgICAgICB2YXIgX2E7XG4gICAgICAgICAgICAoX2EgPSBwbHVnaW4gPT09IG51bGwgfHwgcGx1Z2luID09PSB2b2lkIDAgPyB2b2lkIDAgOiBwbHVnaW4ub25SYW5nZVVwZGF0ZSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmNhbGwocGx1Z2luLCBfcmFuZ2UudmFsdWUpO1xuICAgICAgICAgICAgbGFzdFJhbmdlRW1pdHRlZF9fTkVFREVEX1RPX1BSRVZFTlRfUkVDVVJTSU9OX0lOX0VWRU5UX1JFQ1VSUkVOQ0VfUEFDS0FHRV9XSElDSF9DQVVTRVNfUkFOR0VfVE9fVVBEQVRFX0FORF9USFVTX0NBVVNFU19BX0NZQ0xFID1cbiAgICAgICAgICAgICAgICBfcmFuZ2UudmFsdWU7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgZWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKHJhbmdlLnZhbHVlKSB7XG4gICAgICAgICAgICBjYWxsT25SYW5nZVVwZGF0ZShyYW5nZSk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBjb25zdCBzZXRSYW5nZSA9IChkYXRlKSA9PiB7XG4gICAgICAgIHZhciBfYSwgX2I7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkVmlldyA9IGNhbGVuZGFyQ29uZmlnLnZpZXdzLnZhbHVlLmZpbmQoKGF2YWlsYWJsZVZpZXcpID0+IGF2YWlsYWJsZVZpZXcubmFtZSA9PT0gX3ZpZXcudmFsdWUpO1xuICAgICAgICBjb25zdCBuZXdSYW5nZSA9IHNlbGVjdGVkVmlldy5zZXREYXRlUmFuZ2Uoe1xuICAgICAgICAgICAgY2FsZW5kYXJDb25maWcsXG4gICAgICAgICAgICBkYXRlLFxuICAgICAgICAgICAgcmFuZ2UsXG4gICAgICAgICAgICB0aW1lVW5pdHNJbXBsLFxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKG5ld1JhbmdlLnN0YXJ0LnRvU3RyaW5nKCkgPT09ICgoX2EgPSByYW5nZS52YWx1ZSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnN0YXJ0LnRvU3RyaW5nKCkpICYmXG4gICAgICAgICAgICBuZXdSYW5nZS5lbmQudG9TdHJpbmcoKSA9PT0gKChfYiA9IHJhbmdlLnZhbHVlKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuZW5kLnRvU3RyaW5nKCkpKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICByYW5nZS52YWx1ZSA9IG5ld1JhbmdlO1xuICAgIH07XG4gICAgLy8gb25lIGluaXRpYWwgY2FsbCBmb3Igc2V0dGluZyB0aGUgcmFuZ2VcbiAgICBzZXRSYW5nZShzZWxlY3RlZERhdGUgfHxcbiAgICAgICAgVGVtcG9yYWwuUGxhaW5EYXRlLmZyb20oVGVtcG9yYWwuTm93LnBsYWluRGF0ZUlTTyhjYWxlbmRhckNvbmZpZy50aW1lem9uZS52YWx1ZSkpKTtcbiAgICBjb25zdCBpc0NhbGVuZGFyU21hbGwgPSBzaWduYWwodW5kZWZpbmVkKTtcbiAgICBjb25zdCBpc0RhcmsgPSBzaWduYWwoY2FsZW5kYXJDb25maWcuaXNEYXJrLnZhbHVlIHx8IGZhbHNlKTtcbiAgICBlZmZlY3QoKCkgPT4ge1xuICAgICAgICBjb25zdCBldmVudENvbG9ycyA9IG5ldyBFdmVudENvbG9ycyhjYWxlbmRhckNvbmZpZyk7XG4gICAgICAgIGlmIChpc0RhcmsudmFsdWUpIHtcbiAgICAgICAgICAgIGV2ZW50Q29sb3JzLnNldERhcmsoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGV2ZW50Q29sb3JzLnNldExpZ2h0KCk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4ge1xuICAgICAgICB2aWV3LFxuICAgICAgICBpc0RhcmssXG4gICAgICAgIHNldFJhbmdlLFxuICAgICAgICByYW5nZSxcbiAgICAgICAgaXNDYWxlbmRhclNtYWxsLFxuICAgICAgICBzZXRWaWV3OiAobmV3Vmlldywgc2VsZWN0ZWREYXRlKSA9PiB7XG4gICAgICAgICAgICBiYXRjaCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgX3ZpZXcudmFsdWUgPSBuZXdWaWV3O1xuICAgICAgICAgICAgICAgIHNldFJhbmdlKHNlbGVjdGVkRGF0ZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICB9O1xufTtcblxuY29uc3QgY3JlYXRlQ2FsZW5kYXJFdmVudHNJbXBsID0gKGV2ZW50cywgYmFja2dyb3VuZEV2ZW50cywgY29uZmlnKSA9PiB7XG4gICAgY29uc3QgbGlzdCA9IHNpZ25hbChldmVudHMubWFwKChldmVudCkgPT4ge1xuICAgICAgICByZXR1cm4gZXh0ZXJuYWxFdmVudFRvSW50ZXJuYWwoZXZlbnQsIGNvbmZpZyk7XG4gICAgfSkpO1xuICAgIGNvbnN0IGZpbHRlclByZWRpY2F0ZSA9IHNpZ25hbCh1bmRlZmluZWQpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGxpc3QsXG4gICAgICAgIGZpbHRlclByZWRpY2F0ZSxcbiAgICAgICAgYmFja2dyb3VuZEV2ZW50czogc2lnbmFsKGJhY2tncm91bmRFdmVudHMpLFxuICAgIH07XG59O1xuXG5jb25zdCB0aW1lUG9pbnRzUGVyRGF5ID0gKGRheVN0YXJ0LCBkYXlFbmQsIGlzSHlicmlkRGF5KSA9PiB7XG4gICAgaWYgKGRheVN0YXJ0ID09PSBkYXlFbmQpXG4gICAgICAgIHJldHVybiAyNDAwO1xuICAgIGlmIChpc0h5YnJpZERheSlcbiAgICAgICAgcmV0dXJuIDI0MDAgLSBkYXlTdGFydCArIGRheUVuZDtcbiAgICByZXR1cm4gZGF5RW5kIC0gZGF5U3RhcnQ7XG59O1xuXG5jb25zdCBnZXREaXJlY3Rpb24gPSAoKSA9PiB7XG4gICAgY29uc3QgaHRtbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2h0bWwnKTtcbiAgICBpZiAoIWh0bWwpIHtcbiAgICAgICAgcmV0dXJuICdsdHInO1xuICAgIH1cbiAgICBjb25zdCBkaXJlY3Rpb24gPSBodG1sLmdldEF0dHJpYnV0ZSgnZGlyJyk7XG4gICAgaWYgKGRpcmVjdGlvbiA9PT0gJ3J0bCcpIHtcbiAgICAgICAgcmV0dXJuICdydGwnO1xuICAgIH1cbiAgICByZXR1cm4gJ2x0cic7XG59O1xuXG5jbGFzcyBDYWxlbmRhckNvbmZpZ0ltcGwge1xuICAgIGNvbnN0cnVjdG9yKGxvY2FsZSA9IERFRkFVTFRfTE9DQUxFLCBmaXJzdERheU9mV2VlayA9IERFRkFVTFRfRklSU1RfREFZX09GX1dFRUssIGRlZmF1bHRWaWV3ID0gSW50ZXJuYWxWaWV3TmFtZS5XZWVrLCB2aWV3cyA9IFtdLCBkYXlCb3VuZGFyaWVzID0gREVGQVVMVF9EQVlfQk9VTkRBUklFUywgd2Vla09wdGlvbnMsIGNhbGVuZGFycyA9IHt9LCBwbHVnaW5zID0ge30sIGlzRGFyayA9IGZhbHNlLCBpc1Jlc3BvbnNpdmUgPSB0cnVlLCBjYWxsYmFja3MgPSB7fSwgX2N1c3RvbUNvbXBvbmVudEZucyA9IHt9LCBtaW5EYXRlID0gdW5kZWZpbmVkLCBtYXhEYXRlID0gdW5kZWZpbmVkLCBtb250aEdyaWRPcHRpb25zID0ge1xuICAgICAgICBuRXZlbnRzUGVyRGF5OiA0LFxuICAgIH0sIHRoZW1lID0gdW5kZWZpbmVkLCB0cmFuc2xhdGlvbnMgPSB7fSwgc2hvd1dlZWtOdW1iZXJzID0gZmFsc2UsIHRpbWV6b25lID0gJ1VUQycpIHtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiZGVmYXVsdFZpZXdcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IGRlZmF1bHRWaWV3XG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJwbHVnaW5zXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBwbHVnaW5zXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJpc1Jlc3BvbnNpdmVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IGlzUmVzcG9uc2l2ZVxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiY2FsbGJhY2tzXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBjYWxsYmFja3NcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl9jdXN0b21Db21wb25lbnRGbnNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IF9jdXN0b21Db21wb25lbnRGbnNcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImZpcnN0RGF5T2ZXZWVrXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInZpZXdzXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImRheUJvdW5kYXJpZXNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwid2Vla09wdGlvbnNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiY2FsZW5kYXJzXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImlzRGFya1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJtaW5EYXRlXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm1heERhdGVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwibW9udGhHcmlkT3B0aW9uc1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJsb2NhbGVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHNpZ25hbChERUZBVUxUX0xPQ0FMRSlcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInRoZW1lXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInRyYW5zbGF0aW9uc1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJzaG93V2Vla051bWJlcnNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHNpZ25hbChmYWxzZSlcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImRpcmVjdGlvblwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogJ2x0cidcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInRpbWV6b25lXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl9kZXN0cm95Q3VzdG9tQ29tcG9uZW50SW5zdGFuY2VcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5sb2NhbGUgPSBzaWduYWwobG9jYWxlKTtcbiAgICAgICAgdGhpcy5maXJzdERheU9mV2VlayA9IHNpZ25hbChmaXJzdERheU9mV2Vlayk7XG4gICAgICAgIHRoaXMudmlld3MgPSBzaWduYWwodmlld3MpO1xuICAgICAgICB0aGlzLmRheUJvdW5kYXJpZXMgPSBzaWduYWwoZGF5Qm91bmRhcmllcyk7XG4gICAgICAgIHRoaXMud2Vla09wdGlvbnMgPSBzaWduYWwod2Vla09wdGlvbnMpO1xuICAgICAgICB0aGlzLmNhbGVuZGFycyA9IHNpZ25hbChjYWxlbmRhcnMpO1xuICAgICAgICB0aGlzLmlzRGFyayA9IHNpZ25hbChpc0RhcmspO1xuICAgICAgICB0aGlzLm1pbkRhdGUgPSBzaWduYWwobWluRGF0ZSk7XG4gICAgICAgIHRoaXMubWF4RGF0ZSA9IHNpZ25hbChtYXhEYXRlKTtcbiAgICAgICAgdGhpcy5tb250aEdyaWRPcHRpb25zID0gc2lnbmFsKG1vbnRoR3JpZE9wdGlvbnMpO1xuICAgICAgICB0aGlzLnRoZW1lID0gdGhlbWU7XG4gICAgICAgIHRoaXMudHJhbnNsYXRpb25zID0gc2lnbmFsKHRyYW5zbGF0aW9ucyk7XG4gICAgICAgIHRoaXMuc2hvd1dlZWtOdW1iZXJzID0gc2lnbmFsKHNob3dXZWVrTnVtYmVycyk7XG4gICAgICAgIHRoaXMuZGlyZWN0aW9uID0gZ2V0RGlyZWN0aW9uKCk7XG4gICAgICAgIHRoaXMudGltZXpvbmUgPSBzaWduYWwodGltZXpvbmUpO1xuICAgIH1cbiAgICBnZXQgaXNIeWJyaWREYXkoKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5kYXlCb3VuZGFyaWVzLnZhbHVlLnN0YXJ0ID4gdGhpcy5kYXlCb3VuZGFyaWVzLnZhbHVlLmVuZCB8fFxuICAgICAgICAgICAgKHRoaXMuZGF5Qm91bmRhcmllcy52YWx1ZS5zdGFydCAhPT0gMCAmJlxuICAgICAgICAgICAgICAgIHRoaXMuZGF5Qm91bmRhcmllcy52YWx1ZS5zdGFydCA9PT0gdGhpcy5kYXlCb3VuZGFyaWVzLnZhbHVlLmVuZCkpO1xuICAgIH1cbiAgICBnZXQgdGltZVBvaW50c1BlckRheSgpIHtcbiAgICAgICAgcmV0dXJuIHRpbWVQb2ludHNQZXJEYXkodGhpcy5kYXlCb3VuZGFyaWVzLnZhbHVlLnN0YXJ0LCB0aGlzLmRheUJvdW5kYXJpZXMudmFsdWUuZW5kLCB0aGlzLmlzSHlicmlkRGF5KTtcbiAgICB9XG59XG5cbmNsYXNzIENhbGVuZGFyQ29uZmlnQnVpbGRlciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImxvY2FsZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJmaXJzdERheU9mV2Vla1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJkZWZhdWx0Vmlld1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJ2aWV3c1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJkYXlCb3VuZGFyaWVzXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIndlZWtPcHRpb25zXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB7XG4gICAgICAgICAgICAgICAgZ3JpZEhlaWdodDogREVGQVVMVF9XRUVLX0dSSURfSEVJR0hULFxuICAgICAgICAgICAgICAgIG5EYXlzOiA3LFxuICAgICAgICAgICAgICAgIGV2ZW50V2lkdGg6IDEwMCxcbiAgICAgICAgICAgICAgICB0aW1lQXhpc0Zvcm1hdE9wdGlvbnM6IHsgaG91cjogJ251bWVyaWMnIH0sXG4gICAgICAgICAgICAgICAgZXZlbnRPdmVybGFwOiB0cnVlLFxuICAgICAgICAgICAgICAgIGdyaWRTdGVwOiA2MCxcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm1vbnRoR3JpZE9wdGlvbnNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiY2FsZW5kYXJzXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInBsdWdpbnNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHt9XG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJpc0RhcmtcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJpc1Jlc3BvbnNpdmVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImNhbGxiYWNrc1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJtaW5EYXRlXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm1heERhdGVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiYmFja2dyb3VuZEV2ZW50c1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJ0aW1lem9uZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJ0aGVtZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICAvLyBUT0RPOiBDaGFuZ2UgZm9yIFYzLiBTaG91bGQgb25seSBiZSBjb25maWd1cmVkIGZyb20gb3V0c2lkZVxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJ0cmFuc2xhdGlvbnNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwic2hvd1dlZWtOdW1iZXJzXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGJ1aWxkKCkge1xuICAgICAgICBjb25zdCBtaW5EYXRlID0gdGhpcy5taW5EYXRlXG4gICAgICAgICAgICA/IFRlbXBvcmFsLlBsYWluRGF0ZS5mcm9tKHRoaXMubWluRGF0ZSlcbiAgICAgICAgICAgIDogdW5kZWZpbmVkO1xuICAgICAgICBjb25zdCBtYXhEYXRlID0gdGhpcy5tYXhEYXRlXG4gICAgICAgICAgICA/IFRlbXBvcmFsLlBsYWluRGF0ZS5mcm9tKHRoaXMubWF4RGF0ZSlcbiAgICAgICAgICAgIDogdW5kZWZpbmVkO1xuICAgICAgICByZXR1cm4gbmV3IENhbGVuZGFyQ29uZmlnSW1wbCh0aGlzLmxvY2FsZSB8fCBERUZBVUxUX0xPQ0FMRSwgdHlwZW9mIHRoaXMuZmlyc3REYXlPZldlZWsgPT09ICdudW1iZXInXG4gICAgICAgICAgICA/IHRoaXMuZmlyc3REYXlPZldlZWtcbiAgICAgICAgICAgIDogREVGQVVMVF9GSVJTVF9EQVlfT0ZfV0VFSywgdGhpcy5kZWZhdWx0VmlldyB8fCBJbnRlcm5hbFZpZXdOYW1lLldlZWssIHRoaXMudmlld3MgfHwgW10sIHRoaXMuZGF5Qm91bmRhcmllcyB8fCBERUZBVUxUX0RBWV9CT1VOREFSSUVTLCB0aGlzLndlZWtPcHRpb25zLCB0aGlzLmNhbGVuZGFycywgdGhpcy5wbHVnaW5zLCB0aGlzLmlzRGFyaywgdGhpcy5pc1Jlc3BvbnNpdmUsIHRoaXMuY2FsbGJhY2tzLCB7fSwgbWluRGF0ZSwgbWF4RGF0ZSwgdGhpcy5tb250aEdyaWRPcHRpb25zLCB0aGlzLnRoZW1lLCB0aGlzLnRyYW5zbGF0aW9ucywgdGhpcy5zaG93V2Vla051bWJlcnMsIHRoaXMudGltZXpvbmUpO1xuICAgIH1cbiAgICB3aXRoTG9jYWxlKGxvY2FsZSkge1xuICAgICAgICB0aGlzLmxvY2FsZSA9IGxvY2FsZTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHdpdGhUcmFuc2xhdGlvbnModHJhbnNsYXRpb24pIHtcbiAgICAgICAgdGhpcy50cmFuc2xhdGlvbnMgPSB0cmFuc2xhdGlvbjtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHdpdGhGaXJzdERheU9mV2VlayhmaXJzdERheU9mV2Vlaykge1xuICAgICAgICB0aGlzLmZpcnN0RGF5T2ZXZWVrID0gZmlyc3REYXlPZldlZWs7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICB3aXRoRGVmYXVsdFZpZXcoZGVmYXVsdFZpZXcpIHtcbiAgICAgICAgdGhpcy5kZWZhdWx0VmlldyA9IGRlZmF1bHRWaWV3O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgd2l0aFZpZXdzKHZpZXdzKSB7XG4gICAgICAgIHRoaXMudmlld3MgPSB2aWV3cztcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHdpdGhEYXlCb3VuZGFyaWVzKGRheUJvdW5kYXJpZXMpIHtcbiAgICAgICAgaWYgKCFkYXlCb3VuZGFyaWVzKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIHRoaXMuZGF5Qm91bmRhcmllcyA9IHtcbiAgICAgICAgICAgIHN0YXJ0OiB0aW1lUG9pbnRzRnJvbVN0cmluZyhkYXlCb3VuZGFyaWVzLnN0YXJ0KSxcbiAgICAgICAgICAgIGVuZDogdGltZVBvaW50c0Zyb21TdHJpbmcoZGF5Qm91bmRhcmllcy5lbmQpLFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgd2l0aFdlZWtPcHRpb25zKHVzZXJEZWZpbmVkV2Vla09wdGlvbnMpIHtcbiAgICAgICAgdGhpcy53ZWVrT3B0aW9ucyA9IHtcbiAgICAgICAgICAgIC4uLnRoaXMud2Vla09wdGlvbnMsXG4gICAgICAgICAgICAuLi51c2VyRGVmaW5lZFdlZWtPcHRpb25zLFxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy53ZWVrT3B0aW9ucy5ncmlkU3RlcCAhPT0gNjAgJiZcbiAgICAgICAgICAgICh1c2VyRGVmaW5lZFdlZWtPcHRpb25zID09PSBudWxsIHx8IHVzZXJEZWZpbmVkV2Vla09wdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHVzZXJEZWZpbmVkV2Vla09wdGlvbnMudGltZUF4aXNGb3JtYXRPcHRpb25zKSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLndlZWtPcHRpb25zLnRpbWVBeGlzRm9ybWF0T3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICBob3VyOiAnbnVtZXJpYycsXG4gICAgICAgICAgICAgICAgbWludXRlOiAnbnVtZXJpYycsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICB3aXRoQ2FsZW5kYXJzKGNhbGVuZGFycykge1xuICAgICAgICB0aGlzLmNhbGVuZGFycyA9IGNhbGVuZGFycztcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHdpdGhQbHVnaW5zKHBsdWdpbnMpIHtcbiAgICAgICAgaWYgKCFwbHVnaW5zKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIHBsdWdpbnMuZm9yRWFjaCgocGx1Z2luKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnBsdWdpbnNbcGx1Z2luLm5hbWVdID0gcGx1Z2luO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHdpdGhJc0RhcmsoaXNEYXJrKSB7XG4gICAgICAgIHRoaXMuaXNEYXJrID0gaXNEYXJrO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgd2l0aElzUmVzcG9uc2l2ZShpc1Jlc3BvbnNpdmUpIHtcbiAgICAgICAgdGhpcy5pc1Jlc3BvbnNpdmUgPSBpc1Jlc3BvbnNpdmU7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICB3aXRoQ2FsbGJhY2tzKGxpc3RlbmVycykge1xuICAgICAgICB0aGlzLmNhbGxiYWNrcyA9IGxpc3RlbmVycztcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHdpdGhNaW5EYXRlKG1pbkRhdGUpIHtcbiAgICAgICAgdGhpcy5taW5EYXRlID0gbWluRGF0ZTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHdpdGhNYXhEYXRlKG1heERhdGUpIHtcbiAgICAgICAgdGhpcy5tYXhEYXRlID0gbWF4RGF0ZTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHdpdGhNb250aEdyaWRPcHRpb25zKG1vbnRoT3B0aW9ucykge1xuICAgICAgICB0aGlzLm1vbnRoR3JpZE9wdGlvbnMgPSBtb250aE9wdGlvbnM7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICB3aXRoQmFja2dyb3VuZEV2ZW50cyhiYWNrZ3JvdW5kRXZlbnRzKSB7XG4gICAgICAgIHRoaXMuYmFja2dyb3VuZEV2ZW50cyA9IGJhY2tncm91bmRFdmVudHM7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICB3aXRoVGhlbWUodGhlbWUpIHtcbiAgICAgICAgdGhpcy50aGVtZSA9IHRoZW1lO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgd2l0aFdlZWtOdW1iZXJzKHNob3dXZWVrTnVtYmVycykge1xuICAgICAgICB0aGlzLnNob3dXZWVrTnVtYmVycyA9IHNob3dXZWVrTnVtYmVycztcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHdpdGhUaW1lem9uZSh0aW1lem9uZSkge1xuICAgICAgICB0aGlzLnRpbWV6b25lID0gdGltZXpvbmU7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbn1cblxuY29uc3QgY3JlYXRlSW50ZXJuYWxDb25maWcgPSAoY29uZmlnLCBwbHVnaW5zKSA9PiB7XG4gICAgcmV0dXJuIG5ldyBDYWxlbmRhckNvbmZpZ0J1aWxkZXIoKVxuICAgICAgICAud2l0aExvY2FsZShjb25maWcubG9jYWxlKVxuICAgICAgICAud2l0aEZpcnN0RGF5T2ZXZWVrKGNvbmZpZy5maXJzdERheU9mV2VlaylcbiAgICAgICAgLndpdGhEZWZhdWx0Vmlldyhjb25maWcuZGVmYXVsdFZpZXcpXG4gICAgICAgIC53aXRoVmlld3MoY29uZmlnLnZpZXdzKVxuICAgICAgICAud2l0aERheUJvdW5kYXJpZXMoY29uZmlnLmRheUJvdW5kYXJpZXMpXG4gICAgICAgIC53aXRoV2Vla09wdGlvbnMoY29uZmlnLndlZWtPcHRpb25zKVxuICAgICAgICAud2l0aENhbGVuZGFycyhjb25maWcuY2FsZW5kYXJzKVxuICAgICAgICAud2l0aFBsdWdpbnMocGx1Z2lucylcbiAgICAgICAgLndpdGhJc0RhcmsoY29uZmlnLmlzRGFyaylcbiAgICAgICAgLndpdGhJc1Jlc3BvbnNpdmUoY29uZmlnLmlzUmVzcG9uc2l2ZSlcbiAgICAgICAgLndpdGhDYWxsYmFja3MoY29uZmlnLmNhbGxiYWNrcylcbiAgICAgICAgLndpdGhNaW5EYXRlKGNvbmZpZy5taW5EYXRlID8gY29uZmlnLm1pbkRhdGUudG9TdHJpbmcoKSA6IHVuZGVmaW5lZClcbiAgICAgICAgLndpdGhNYXhEYXRlKGNvbmZpZy5tYXhEYXRlID8gY29uZmlnLm1heERhdGUudG9TdHJpbmcoKSA6IHVuZGVmaW5lZClcbiAgICAgICAgLndpdGhNb250aEdyaWRPcHRpb25zKGNvbmZpZy5tb250aEdyaWRPcHRpb25zKVxuICAgICAgICAud2l0aEJhY2tncm91bmRFdmVudHMoY29uZmlnLmJhY2tncm91bmRFdmVudHMpXG4gICAgICAgIC53aXRoVGhlbWUoY29uZmlnLnRoZW1lKVxuICAgICAgICAud2l0aFRyYW5zbGF0aW9ucyhjb25maWcudHJhbnNsYXRpb25zIHx8IHRyYW5zbGF0aW9ucylcbiAgICAgICAgLndpdGhXZWVrTnVtYmVycyhjb25maWcuc2hvd1dlZWtOdW1iZXJzKVxuICAgICAgICAud2l0aFRpbWV6b25lKGNvbmZpZy50aW1lem9uZSlcbiAgICAgICAgLmJ1aWxkKCk7XG59O1xuXG52YXIgTW9udGg7XG4oZnVuY3Rpb24gKE1vbnRoKSB7XG4gICAgTW9udGhbTW9udGhbXCJKQU5VQVJZXCJdID0gMV0gPSBcIkpBTlVBUllcIjtcbiAgICBNb250aFtNb250aFtcIkZFQlJVQVJZXCJdID0gMl0gPSBcIkZFQlJVQVJZXCI7XG4gICAgTW9udGhbTW9udGhbXCJNQVJDSFwiXSA9IDNdID0gXCJNQVJDSFwiO1xuICAgIE1vbnRoW01vbnRoW1wiQVBSSUxcIl0gPSA0XSA9IFwiQVBSSUxcIjtcbiAgICBNb250aFtNb250aFtcIk1BWVwiXSA9IDVdID0gXCJNQVlcIjtcbiAgICBNb250aFtNb250aFtcIkpVTkVcIl0gPSA2XSA9IFwiSlVORVwiO1xuICAgIE1vbnRoW01vbnRoW1wiSlVMWVwiXSA9IDddID0gXCJKVUxZXCI7XG4gICAgTW9udGhbTW9udGhbXCJBVUdVU1RcIl0gPSA4XSA9IFwiQVVHVVNUXCI7XG4gICAgTW9udGhbTW9udGhbXCJTRVBURU1CRVJcIl0gPSA5XSA9IFwiU0VQVEVNQkVSXCI7XG4gICAgTW9udGhbTW9udGhbXCJPQ1RPQkVSXCJdID0gMTBdID0gXCJPQ1RPQkVSXCI7XG4gICAgTW9udGhbTW9udGhbXCJOT1ZFTUJFUlwiXSA9IDExXSA9IFwiTk9WRU1CRVJcIjtcbiAgICBNb250aFtNb250aFtcIkRFQ0VNQkVSXCJdID0gMTJdID0gXCJERUNFTUJFUlwiO1xufSkoTW9udGggfHwgKE1vbnRoID0ge30pKTtcblxuY2xhc3MgTm9ZZWFyWmVyb0Vycm9yIGV4dGVuZHMgRXJyb3Ige1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcignWWVhciB6ZXJvIGRvZXMgbm90IGV4aXN0IGluIHRoZSBHcmVnb3JpYW4gY2FsZW5kYXIuJyk7XG4gICAgfVxufVxuXG5jbGFzcyBUaW1lVW5pdHNJbXBsIHtcbiAgICBjb25zdHJ1Y3Rvcihjb25maWcpIHtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiY29uZmlnXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBjb25maWdcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGdldCBmaXJzdERheU9mV2VlaygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29uZmlnLmZpcnN0RGF5T2ZXZWVrLnZhbHVlO1xuICAgIH1cbiAgICBzZXQgZmlyc3REYXlPZldlZWsoZmlyc3REYXlPZldlZWspIHtcbiAgICAgICAgdGhpcy5jb25maWcuZmlyc3REYXlPZldlZWsudmFsdWUgPSBmaXJzdERheU9mV2VlaztcbiAgICB9XG4gICAgZ2V0TW9udGgoeWVhciwgbW9udGgpIHtcbiAgICAgICAgaWYgKHllYXIgPT09IDApXG4gICAgICAgICAgICB0aHJvdyBuZXcgTm9ZZWFyWmVyb0Vycm9yKCk7XG4gICAgICAgIGNvbnN0IGZpcnN0RGF0ZU9mTW9udGggPSBUZW1wb3JhbC5QbGFpbkRhdGUuZnJvbSh7XG4gICAgICAgICAgICB5ZWFyLFxuICAgICAgICAgICAgbW9udGg6IG1vbnRoLFxuICAgICAgICAgICAgZGF5OiAxLFxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgbGFzdERhdGVPZk1vbnRoID0gZmlyc3REYXRlT2ZNb250aFxuICAgICAgICAgICAgLnRvUGxhaW5ZZWFyTW9udGgoKVxuICAgICAgICAgICAgLnRvUGxhaW5EYXRlKHsgZGF5OiBmaXJzdERhdGVPZk1vbnRoLnRvUGxhaW5ZZWFyTW9udGgoKS5kYXlzSW5Nb250aCB9KTtcbiAgICAgICAgY29uc3QgZGF0ZXMgPSBbXTtcbiAgICAgICAgbGV0IGN1cnJlbnREYXRlID0gZmlyc3REYXRlT2ZNb250aDtcbiAgICAgICAgd2hpbGUgKFRlbXBvcmFsLlBsYWluRGF0ZS5jb21wYXJlKGN1cnJlbnREYXRlLCBsYXN0RGF0ZU9mTW9udGgpIDw9IDApIHtcbiAgICAgICAgICAgIGRhdGVzLnB1c2goY3VycmVudERhdGUudG9ab25lZERhdGVUaW1lKHRoaXMuY29uZmlnLnRpbWV6b25lLnZhbHVlKSk7XG4gICAgICAgICAgICBjdXJyZW50RGF0ZSA9IGN1cnJlbnREYXRlLmFkZCh7IGRheXM6IDEgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRhdGVzO1xuICAgIH1cbiAgICBnZXRNb250aFdpdGhUcmFpbGluZ0FuZExlYWRpbmdEYXlzKHllYXIsIG1vbnRoKSB7XG4gICAgICAgIGlmICh5ZWFyID09PSAwKVxuICAgICAgICAgICAgdGhyb3cgbmV3IE5vWWVhclplcm9FcnJvcigpO1xuICAgICAgICBjb25zdCBmaXJzdERhdGVPZk1vbnRoID0gVGVtcG9yYWwuUGxhaW5EYXRlLmZyb20oe1xuICAgICAgICAgICAgeWVhcixcbiAgICAgICAgICAgIG1vbnRoOiBtb250aCxcbiAgICAgICAgICAgIGRheTogMSxcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IG1vbnRoV2l0aERhdGVzID0gW3RoaXMuZ2V0V2Vla0ZvclRlbXBvcmFsKGZpcnN0RGF0ZU9mTW9udGgpXTtcbiAgICAgICAgbGV0IGlzSW5Nb250aCA9IHRydWU7XG4gICAgICAgIGxldCBjdXJyZW50V2Vla1N0YXJ0ID0gbW9udGhXaXRoRGF0ZXNbMF1bMF07IC8vIGZpcnN0IGRheSBvZiBmaXJzdCB3ZWVrIG9mIG1vbnRoXG4gICAgICAgIHdoaWxlIChpc0luTW9udGgpIHtcbiAgICAgICAgICAgIGNvbnN0IG5leHRXZWVrU3RhcnQgPSBjdXJyZW50V2Vla1N0YXJ0LmFkZCh7IGRheXM6IDcgfSk7XG4gICAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgbmV4dCB3ZWVrIGNvbnRhaW5zIGFueSBkYXRlcyBmcm9tIHRoZSB0YXJnZXQgbW9udGhcbiAgICAgICAgICAgIGNvbnN0IG5leHRXZWVrRGF0ZXMgPSB0aGlzLmdldFdlZWtGb3JUZW1wb3JhbChuZXh0V2Vla1N0YXJ0KTtcbiAgICAgICAgICAgIGNvbnN0IGhhc0RhdGVzSW5UYXJnZXRNb250aCA9IG5leHRXZWVrRGF0ZXMuc29tZSgoZGF0ZSkgPT4gZGF0ZS5tb250aCA9PT0gbW9udGgpO1xuICAgICAgICAgICAgaWYgKGhhc0RhdGVzSW5UYXJnZXRNb250aCkge1xuICAgICAgICAgICAgICAgIG1vbnRoV2l0aERhdGVzLnB1c2gobmV4dFdlZWtEYXRlcyk7XG4gICAgICAgICAgICAgICAgY3VycmVudFdlZWtTdGFydCA9IG5leHRXZWVrU3RhcnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpc0luTW9udGggPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBDb252ZXJ0IFRlbXBvcmFsLlBsYWluRGF0ZSBhcnJheXMgdG8gVGVtcG9yYWwuWm9uZWREYXRlVGltZSBhcnJheXNcbiAgICAgICAgcmV0dXJuIG1vbnRoV2l0aERhdGVzLm1hcCgod2VlaykgPT4gd2Vlay5tYXAoKHBsYWluRGF0ZSkgPT4gcGxhaW5EYXRlLnRvWm9uZWREYXRlVGltZSh0aGlzLmNvbmZpZy50aW1lem9uZS52YWx1ZSkpKTtcbiAgICB9XG4gICAgZ2V0V2Vla0ZvcihkYXRlKSB7XG4gICAgICAgIGNvbnN0IHBsYWluRGF0ZSA9IGRhdGUgaW5zdGFuY2VvZiBUZW1wb3JhbC5QbGFpbkRhdGUgPyBkYXRlIDogZGF0ZS50b1BsYWluRGF0ZSgpO1xuICAgICAgICBjb25zdCB3ZWVrID0gW1xuICAgICAgICAgICAgdGhpcy5nZXRGaXJzdERhdGVPZldlZWtUZW1wb3JhbChwbGFpbkRhdGUpLnRvWm9uZWREYXRlVGltZSh0aGlzLmNvbmZpZy50aW1lem9uZS52YWx1ZSksXG4gICAgICAgIF07XG4gICAgICAgIHdoaWxlICh3ZWVrLmxlbmd0aCA8IDcpIHtcbiAgICAgICAgICAgIGNvbnN0IGxhc3REYXRlT2ZXZWVrID0gd2Vla1t3ZWVrLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgY29uc3QgbmV4dERhdGVPZldlZWsgPSBsYXN0RGF0ZU9mV2Vlay5hZGQoeyBkYXlzOiAxIH0pO1xuICAgICAgICAgICAgd2Vlay5wdXNoKG5leHREYXRlT2ZXZWVrKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gd2VlaztcbiAgICB9XG4gICAgZ2V0TW9udGhzRm9yKHllYXIpIHtcbiAgICAgICAgaWYgKHllYXIgPT09IDApXG4gICAgICAgICAgICB0aHJvdyBuZXcgTm9ZZWFyWmVyb0Vycm9yKCk7XG4gICAgICAgIHJldHVybiBPYmplY3QudmFsdWVzKE1vbnRoKVxuICAgICAgICAgICAgLmZpbHRlcigobW9udGgpID0+ICFpc05hTihOdW1iZXIobW9udGgpKSlcbiAgICAgICAgICAgIC5tYXAoKG1vbnRoKSA9PiBUZW1wb3JhbC5QbGFpbkRhdGUuZnJvbSh7IHllYXIsIG1vbnRoOiBOdW1iZXIobW9udGgpLCBkYXk6IDEgfSkpO1xuICAgIH1cbiAgICBnZXRXZWVrRm9yVGVtcG9yYWwoZGF0ZSkge1xuICAgICAgICBjb25zdCB3ZWVrID0gW3RoaXMuZ2V0Rmlyc3REYXRlT2ZXZWVrVGVtcG9yYWwoZGF0ZSldO1xuICAgICAgICB3aGlsZSAod2Vlay5sZW5ndGggPCA3KSB7XG4gICAgICAgICAgICBjb25zdCBsYXN0RGF0ZU9mV2VlayA9IHdlZWtbd2Vlay5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIGNvbnN0IG5leHREYXRlT2ZXZWVrID0gbGFzdERhdGVPZldlZWsuYWRkKHsgZGF5czogMSB9KTtcbiAgICAgICAgICAgIHdlZWsucHVzaChuZXh0RGF0ZU9mV2Vlayk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHdlZWs7XG4gICAgfVxuICAgIGdldEZpcnN0RGF0ZU9mV2Vla1RlbXBvcmFsKGRhdGUpIHtcbiAgICAgICAgY29uc3QgZGF0ZUlzTnRoRGF5T2ZXZWVrID0gZGF0ZS5kYXlPZldlZWsgLSB0aGlzLmZpcnN0RGF5T2ZXZWVrO1xuICAgICAgICBpZiAoZGF0ZUlzTnRoRGF5T2ZXZWVrID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gZGF0ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkYXRlSXNOdGhEYXlPZldlZWsgPiAwKSB7XG4gICAgICAgICAgICByZXR1cm4gZGF0ZS5zdWJ0cmFjdCh7IGRheXM6IGRhdGVJc050aERheU9mV2VlayB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBkYXRlLnN1YnRyYWN0KHsgZGF5czogNyArIGRhdGVJc050aERheU9mV2VlayB9KTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuY2xhc3MgVGltZVVuaXRzQnVpbGRlciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImNvbmZpZ1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBidWlsZCgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBUaW1lVW5pdHNJbXBsKHRoaXMuY29uZmlnKTtcbiAgICB9XG4gICAgd2l0aENvbmZpZyhjb25maWcpIHtcbiAgICAgICAgdGhpcy5jb25maWcgPSBjb25maWc7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbn1cblxuY29uc3QgY3JlYXRlVGltZVVuaXRzSW1wbCA9IChpbnRlcm5hbENvbmZpZykgPT4ge1xuICAgIHJldHVybiBuZXcgVGltZVVuaXRzQnVpbGRlcigpLndpdGhDb25maWcoaW50ZXJuYWxDb25maWcpLmJ1aWxkKCk7XG59O1xuXG52YXIgUGxhY2VtZW50O1xuKGZ1bmN0aW9uIChQbGFjZW1lbnQpIHtcbiAgICBQbGFjZW1lbnRbXCJUT1BfU1RBUlRcIl0gPSBcInRvcC1zdGFydFwiO1xuICAgIFBsYWNlbWVudFtcIlRPUF9FTkRcIl0gPSBcInRvcC1lbmRcIjtcbiAgICBQbGFjZW1lbnRbXCJCT1RUT01fU1RBUlRcIl0gPSBcImJvdHRvbS1zdGFydFwiO1xuICAgIFBsYWNlbWVudFtcIkJPVFRPTV9FTkRcIl0gPSBcImJvdHRvbS1lbmRcIjtcbn0pKFBsYWNlbWVudCB8fCAoUGxhY2VtZW50ID0ge30pKTtcblxuY2xhc3MgQ29uZmlnSW1wbCB7XG4gICAgY29uc3RydWN0b3IobG9jYWxlID0gREVGQVVMVF9MT0NBTEUsIGZpcnN0RGF5T2ZXZWVrID0gREVGQVVMVF9GSVJTVF9EQVlfT0ZfV0VFSywgdGltZXpvbmUgPSAnVVRDJywgbWluID0gVGVtcG9yYWwuUGxhaW5EYXRlLmZyb20oe1xuICAgICAgICB5ZWFyOiAxOTcwLFxuICAgICAgICBtb250aDogMSxcbiAgICAgICAgZGF5OiAxLFxuICAgIH0pLCBtYXggPSBUZW1wb3JhbC5QbGFpbkRhdGUuZnJvbSh7XG4gICAgICAgIHllYXI6IG5ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKSArIDUwLFxuICAgICAgICBtb250aDogMTEsXG4gICAgICAgIGRheTogMzEsXG4gICAgfSksIHBsYWNlbWVudCA9IFBsYWNlbWVudC5CT1RUT01fU1RBUlQsIGxpc3RlbmVycyA9IHt9LCBzdHlsZSA9IHt9LCB0ZWxlcG9ydFRvLCBsYWJlbCwgbmFtZSwgZGlzYWJsZWQsIGhhc1BsYWNlaG9sZGVyKSB7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm1pblwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogbWluXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJtYXhcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IG1heFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwicGxhY2VtZW50XCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBwbGFjZW1lbnRcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImxpc3RlbmVyc1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogbGlzdGVuZXJzXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJzdHlsZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogc3R5bGVcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInRlbGVwb3J0VG9cIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHRlbGVwb3J0VG9cbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImxhYmVsXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBsYWJlbFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwibmFtZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogbmFtZVxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiZGlzYWJsZWRcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IGRpc2FibGVkXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJoYXNQbGFjZWhvbGRlclwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogaGFzUGxhY2Vob2xkZXJcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImxvY2FsZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJmaXJzdERheU9mV2Vla1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJ0aW1lem9uZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmxvY2FsZSA9IHNpZ25hbChsb2NhbGUpO1xuICAgICAgICB0aGlzLmZpcnN0RGF5T2ZXZWVrID0gc2lnbmFsKGZpcnN0RGF5T2ZXZWVrKTtcbiAgICAgICAgdGhpcy50aW1lem9uZSA9IHNpZ25hbCh0aW1lem9uZSk7XG4gICAgfVxufVxuXG5jbGFzcyBDb25maWdCdWlsZGVyIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwibG9jYWxlXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImZpcnN0RGF5T2ZXZWVrXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInRpbWV6b25lXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm1pblwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJtYXhcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwicGxhY2VtZW50XCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImxpc3RlbmVyc1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJzdHlsZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJ0ZWxlcG9ydFRvXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImxhYmVsXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm5hbWVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiZGlzYWJsZWRcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiaGFzUGxhY2Vob2xkZXJcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgYnVpbGQoKSB7XG4gICAgICAgIHJldHVybiBuZXcgQ29uZmlnSW1wbCh0aGlzLmxvY2FsZSwgdGhpcy5maXJzdERheU9mV2VlaywgdGhpcy50aW1lem9uZSwgdGhpcy5taW4sIHRoaXMubWF4LCB0aGlzLnBsYWNlbWVudCwgdGhpcy5saXN0ZW5lcnMsIHRoaXMuc3R5bGUsIHRoaXMudGVsZXBvcnRUbywgdGhpcy5sYWJlbCwgdGhpcy5uYW1lLCB0aGlzLmRpc2FibGVkLCB0aGlzLmhhc1BsYWNlaG9sZGVyKTtcbiAgICB9XG4gICAgd2l0aExvY2FsZShsb2NhbGUpIHtcbiAgICAgICAgdGhpcy5sb2NhbGUgPSBsb2NhbGU7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICB3aXRoRmlyc3REYXlPZldlZWsoZmlyc3REYXlPZldlZWspIHtcbiAgICAgICAgdGhpcy5maXJzdERheU9mV2VlayA9IGZpcnN0RGF5T2ZXZWVrO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgd2l0aFRpbWV6b25lKHRpbWV6b25lKSB7XG4gICAgICAgIHRoaXMudGltZXpvbmUgPSB0aW1lem9uZTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHdpdGhNaW4obWluKSB7XG4gICAgICAgIHRoaXMubWluID0gbWluO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgd2l0aE1heChtYXgpIHtcbiAgICAgICAgdGhpcy5tYXggPSBtYXg7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICB3aXRoUGxhY2VtZW50KHBsYWNlbWVudCkge1xuICAgICAgICB0aGlzLnBsYWNlbWVudCA9IHBsYWNlbWVudDtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHdpdGhMaXN0ZW5lcnMobGlzdGVuZXJzKSB7XG4gICAgICAgIHRoaXMubGlzdGVuZXJzID0gbGlzdGVuZXJzO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgd2l0aFN0eWxlKHN0eWxlKSB7XG4gICAgICAgIHRoaXMuc3R5bGUgPSBzdHlsZTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHdpdGhUZWxlcG9ydFRvKHRlbGVwb3J0VG8pIHtcbiAgICAgICAgdGhpcy50ZWxlcG9ydFRvID0gdGVsZXBvcnRUbztcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHdpdGhMYWJlbChsYWJlbCkge1xuICAgICAgICB0aGlzLmxhYmVsID0gbGFiZWw7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICB3aXRoTmFtZShuYW1lKSB7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICB3aXRoRGlzYWJsZWQoZGlzYWJsZWQpIHtcbiAgICAgICAgdGhpcy5kaXNhYmxlZCA9IGRpc2FibGVkO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgd2l0aEhhc1BsYWNlaG9sZGVyKGhhc1BsYWNlaG9sZGVyKSB7XG4gICAgICAgIHRoaXMuaGFzUGxhY2Vob2xkZXIgPSBoYXNQbGFjZWhvbGRlcjtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxufVxuXG5jb25zdCBjcmVhdGVEYXRlUGlja2VyQ29uZmlnID0gKGNvbmZpZywgZGF0ZVNlbGVjdGlvbkNhbGxiYWNrKSA9PiB7XG4gICAgdmFyIF9hLCBfYjtcbiAgICBsZXQgdGVsZXBvcnRUbztcbiAgICBpZiAoKF9hID0gY29uZmlnLmRhdGVQaWNrZXIpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS50ZWxlcG9ydFRvKSB7XG4gICAgICAgIHRlbGVwb3J0VG8gPSBjb25maWcuZGF0ZVBpY2tlci50ZWxlcG9ydFRvO1xuICAgIH1cbiAgICBjb25zdCBkeW5hbWljUGxhY2VtZW50ID0gKGRhdGVQaWNrZXJXcmFwcGVyKSA9PiB7XG4gICAgICAgIGlmIChkYXRlUGlja2VyV3JhcHBlcikge1xuICAgICAgICAgICAgY29uc3QgcmVjdCA9IGRhdGVQaWNrZXJXcmFwcGVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICAgICAgY29uc3Qgdmlld3BvcnRDZW50ZXJYID0gd2luZG93LmlubmVyV2lkdGggLyAyO1xuICAgICAgICAgICAgY29uc3QgaXNNb3JlT25MZWZ0U2lkZSA9IHJlY3QueCArIHJlY3Qud2lkdGggLyAyIDw9IHZpZXdwb3J0Q2VudGVyWDtcbiAgICAgICAgICAgIHJldHVybiBpc01vcmVPbkxlZnRTaWRlID8gUGxhY2VtZW50LkJPVFRPTV9TVEFSVCA6IFBsYWNlbWVudC5CT1RUT01fRU5EO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQbGFjZW1lbnQuQk9UVE9NX0VORDtcbiAgICB9O1xuICAgIHJldHVybiBuZXcgQ29uZmlnQnVpbGRlcigpXG4gICAgICAgIC53aXRoTG9jYWxlKGNvbmZpZy5sb2NhbGUpXG4gICAgICAgIC53aXRoRmlyc3REYXlPZldlZWsoY29uZmlnLmZpcnN0RGF5T2ZXZWVrKVxuICAgICAgICAud2l0aFRpbWV6b25lKGNvbmZpZy50aW1lem9uZSlcbiAgICAgICAgLndpdGhNaW4oY29uZmlnLm1pbkRhdGUpXG4gICAgICAgIC53aXRoTWF4KGNvbmZpZy5tYXhEYXRlKVxuICAgICAgICAud2l0aFRlbGVwb3J0VG8odGVsZXBvcnRUbylcbiAgICAgICAgLndpdGhTdHlsZSgoX2IgPSBjb25maWcuZGF0ZVBpY2tlcikgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLnN0eWxlKVxuICAgICAgICAud2l0aFBsYWNlbWVudChkeW5hbWljUGxhY2VtZW50KVxuICAgICAgICAud2l0aExpc3RlbmVycyh7IG9uQ2hhbmdlOiBkYXRlU2VsZWN0aW9uQ2FsbGJhY2sgfSlcbiAgICAgICAgLmJ1aWxkKCk7XG59O1xuXG5jb25zdCBjcmVhdGVEYXRlU2VsZWN0aW9uQ2FsbGJhY2sgPSAoY2FsZW5kYXJTdGF0ZSwgY29uZmlnKSA9PiB7XG4gICAgbGV0IGxhc3RFbWl0dGVkRGF0ZSA9IG51bGw7XG4gICAgcmV0dXJuIChkYXRlKSA9PiB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgY2FsZW5kYXJTdGF0ZS5zZXRSYW5nZShkYXRlKTtcbiAgICAgICAgaWYgKCgoX2EgPSBjb25maWcuY2FsbGJhY2tzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Eub25TZWxlY3RlZERhdGVVcGRhdGUpICYmXG4gICAgICAgICAgICBkYXRlLnRvU3RyaW5nKCkgIT09IChsYXN0RW1pdHRlZERhdGUgPT09IG51bGwgfHwgbGFzdEVtaXR0ZWREYXRlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBsYXN0RW1pdHRlZERhdGUudG9TdHJpbmcoKSkpIHtcbiAgICAgICAgICAgIGxhc3RFbWl0dGVkRGF0ZSA9IGRhdGU7XG4gICAgICAgICAgICBjb25maWcuY2FsbGJhY2tzLm9uU2VsZWN0ZWREYXRlVXBkYXRlKGRhdGUpO1xuICAgICAgICB9XG4gICAgfTtcbn07XG5cbi8qKlxuICogVE9ETyB2MzogcmVtb3ZlIHRoaXMgd2hlbiByZW1vdmluZyBwbHVnaW4gb3ZlciB0aGUgY29uZmlnIG9iamVjdFxuICogKi9cbmNvbnN0IHZhbGlkYXRlUGx1Z2lucyA9IChjb25maWdQbHVnaW5zLCBwbHVnaW5BcmcpID0+IHtcbiAgICBpZiAoY29uZmlnUGx1Z2lucyAmJiBwbHVnaW5BcmcpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdZb3UgY2Fubm90IHByb3ZpZGUgcGx1Z2lucyBvdmVyIHRoZSBjb25maWcgb2JqZWN0IGFuZCBhcyBhbiBhcmd1bWVudCB0byBjcmVhdGVDYWxlbmRhci4nKTtcbiAgICB9XG59O1xuXG5jb25zdCB2YWxpZGF0ZUNvbmZpZyA9IChjb25maWcpID0+IHtcbiAgICB2YXIgX2EsIF9iLCBfYywgX2Q7XG4gICAgaWYgKGNvbmZpZy5zZWxlY3RlZERhdGUgJiZcbiAgICAgICAgIShjb25maWcuc2VsZWN0ZWREYXRlIGluc3RhbmNlb2YgVGVtcG9yYWwuUGxhaW5EYXRlKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tTY2hlZHVsZS1YIGVycm9yXTogc2VsZWN0ZWREYXRlIG11c3QgaGF2ZSB0aGUgZm9ybWF0IFlZWVktTU0tREQnKTtcbiAgICB9XG4gICAgaWYgKGNvbmZpZy5taW5EYXRlICYmICEoY29uZmlnLm1pbkRhdGUgaW5zdGFuY2VvZiBUZW1wb3JhbC5QbGFpbkRhdGUpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignW1NjaGVkdWxlLVggZXJyb3JdOiBtaW5EYXRlIG11c3QgYmUgYSB0ZW1wb3JhbCBwbGFpbiBkYXRlJyk7XG4gICAgfVxuICAgIGlmIChjb25maWcubWF4RGF0ZSAmJiAhKGNvbmZpZy5tYXhEYXRlIGluc3RhbmNlb2YgVGVtcG9yYWwuUGxhaW5EYXRlKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tTY2hlZHVsZS1YIGVycm9yXTogbWF4RGF0ZSBtdXN0IGJlIGEgdGVtcG9yYWwgcGxhaW4gZGF0ZScpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGNvbmZpZy5maXJzdERheU9mV2VlayAhPT0gJ3VuZGVmaW5lZCcgJiZcbiAgICAgICAgKGNvbmZpZy5maXJzdERheU9mV2VlayA8IDEgfHwgY29uZmlnLmZpcnN0RGF5T2ZXZWVrID4gNykpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdbU2NoZWR1bGUtWCBlcnJvcl06IGZpcnN0RGF5T2ZXZWVrIG11c3QgYmUgYSBudW1iZXIgYmV0d2VlbiAxIGFuZCA3Jyk7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgKChfYSA9IGNvbmZpZy53ZWVrT3B0aW9ucykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmdyaWRIZWlnaHQpICE9PSAndW5kZWZpbmVkJyAmJlxuICAgICAgICBjb25maWcud2Vla09wdGlvbnMuZ3JpZEhlaWdodCA8IDApIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdbU2NoZWR1bGUtWCBlcnJvcl06IHdlZWtPcHRpb25zLmdyaWRIZWlnaHQgbXVzdCBiZSBhIHBvc2l0aXZlIG51bWJlcicpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mICgoX2IgPSBjb25maWcud2Vla09wdGlvbnMpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5uRGF5cykgIT09ICd1bmRlZmluZWQnICYmXG4gICAgICAgIChjb25maWcud2Vla09wdGlvbnMubkRheXMgPCAxIHx8IGNvbmZpZy53ZWVrT3B0aW9ucy5uRGF5cyA+IDcpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignW1NjaGVkdWxlLVggZXJyb3JdOiB3ZWVrT3B0aW9ucy5uRGF5cyBtdXN0IGJlIGEgbnVtYmVyIGJldHdlZW4gMSBhbmQgNycpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mICgoX2MgPSBjb25maWcud2Vla09wdGlvbnMpID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy5ldmVudFdpZHRoKSAhPT0gJ3VuZGVmaW5lZCcgJiZcbiAgICAgICAgKGNvbmZpZy53ZWVrT3B0aW9ucy5ldmVudFdpZHRoIDwgMSB8fCBjb25maWcud2Vla09wdGlvbnMuZXZlbnRXaWR0aCA+IDEwMCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdbU2NoZWR1bGUtWCBlcnJvcl06IHdlZWtPcHRpb25zLmV2ZW50V2lkdGggbXVzdCBiZSBhbiBpbnRlZ2VyIGJldHdlZW4gMSBhbmQgMTAwJyk7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgKChfZCA9IGNvbmZpZy5tb250aEdyaWRPcHRpb25zKSA9PT0gbnVsbCB8fCBfZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2QubkV2ZW50c1BlckRheSkgIT09ICd1bmRlZmluZWQnICYmXG4gICAgICAgIGNvbmZpZy5tb250aEdyaWRPcHRpb25zLm5FdmVudHNQZXJEYXkgPCAwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignW1NjaGVkdWxlLVggZXJyb3JdOiBtb250aEdyaWRPcHRpb25zLm5FdmVudHNQZXJEYXkgbXVzdCBiZSBhIHBvc2l0aXZlIG51bWJlcicpO1xuICAgIH1cbiAgICBjb25zdCBkYXlCb3VuZGFyeVBhdHRlcm4gPSAvXlxcZHsyfTowMCQvO1xuICAgIGlmICh0eXBlb2YgY29uZmlnLmRheUJvdW5kYXJpZXMgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIGNvbnN0IHN0YXJ0Rm9ybWF0SXNJbnZhbGlkID0gIWRheUJvdW5kYXJ5UGF0dGVybi50ZXN0KGNvbmZpZy5kYXlCb3VuZGFyaWVzLnN0YXJ0KTtcbiAgICAgICAgY29uc3QgZW5kRm9ybWF0SXNJbnZhbGlkID0gIWRheUJvdW5kYXJ5UGF0dGVybi50ZXN0KGNvbmZpZy5kYXlCb3VuZGFyaWVzLmVuZCk7XG4gICAgICAgIGlmIChzdGFydEZvcm1hdElzSW52YWxpZCB8fCBlbmRGb3JtYXRJc0ludmFsaWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignW1NjaGVkdWxlLVggZXJyb3JdOiBkYXlCb3VuZGFyaWVzIG11c3QgYmUgYW4gb2JqZWN0IHdpdGggXCJzdGFydFwiLSBhbmQgXCJlbmRcIiBwcm9wZXJ0aWVzLCBlYWNoIHdpdGggdGhlIGZvcm1hdCBISDptbScpO1xuICAgICAgICB9XG4gICAgfVxufTtcblxuY29uc3QgdmFsaWRhdGVFdmVudHMgPSAoZXZlbnRzID0gW10pID0+IHtcbiAgICBldmVudHMgPT09IG51bGwgfHwgZXZlbnRzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBldmVudHMuZm9yRWFjaCgoZXZlbnQpID0+IHtcbiAgICAgICAgaWYgKCEoZXZlbnQuc3RhcnQgaW5zdGFuY2VvZiBUZW1wb3JhbC5ab25lZERhdGVUaW1lKSAmJlxuICAgICAgICAgICAgIShldmVudC5zdGFydCBpbnN0YW5jZW9mIFRlbXBvcmFsLlBsYWluRGF0ZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgW1NjaGVkdWxlLVggZXJyb3JdOiBFdmVudCBzdGFydCB0aW1lIG5lZWRzIHRvIGJlIGEgVGVtcG9yYWwuWm9uZWREYXRlVGltZSBvciBUZW1wb3JhbC5QbGFpbkRhdGUuYCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCEoZXZlbnQuZW5kIGluc3RhbmNlb2YgVGVtcG9yYWwuWm9uZWREYXRlVGltZSkgJiZcbiAgICAgICAgICAgICEoZXZlbnQuZW5kIGluc3RhbmNlb2YgVGVtcG9yYWwuUGxhaW5EYXRlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBbU2NoZWR1bGUtWCBlcnJvcl06IEV2ZW50IGVuZCB0aW1lIG5lZWRzIHRvIGJlIGEgVGVtcG9yYWwuWm9uZWREYXRlVGltZSBvciBUZW1wb3JhbC5QbGFpbkRhdGUuYCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaXNJZERlY2ltYWxOdW1iZXIgPSB0eXBlb2YgZXZlbnQuaWQgPT09ICdudW1iZXInICYmIGV2ZW50LmlkICUgMSAhPT0gMDtcbiAgICAgICAgaWYgKGlzSWREZWNpbWFsTnVtYmVyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFtTY2hlZHVsZS1YIGVycm9yXTogRXZlbnQgaWQgJHtldmVudC5pZH0gaXMgbm90IGEgdmFsaWQgaWQuIE9ubHkgbm9uLXVuaWNvZGUgY2hhcmFjdGVycyB0aGF0IGNhbiBiZSB1c2VkIGJ5IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IgaXMgYWxsb3dlZCwgc2VlOiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9DU1MvaWRlbnQuIFdlIHJlY29tbWVuZCB1c2luZyB1dWlkcyBvciBpbnRlZ2Vycy5gKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBvbmx5IGFsbG93IG5vbi11bmljb2RlIGNoYXJhY3RlcnMgdGhhdCBjYW4gYmUgdXNlZCBieSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yOiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9DU1MvaWRlbnRcbiAgICAgICAgaWYgKHR5cGVvZiBldmVudC5pZCA9PT0gJ3N0cmluZycgJiYgIS9eW2EtekEtWjAtOV8tXSokLy50ZXN0KGV2ZW50LmlkKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBbU2NoZWR1bGUtWCBlcnJvcl06IEV2ZW50IGlkICR7ZXZlbnQuaWR9IGlzIG5vdCBhIHZhbGlkIGlkLiBPbmx5IG5vbi11bmljb2RlIGNoYXJhY3RlcnMgdGhhdCBjYW4gYmUgdXNlZCBieSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yIGlzIGFsbG93ZWQsIHNlZTogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQ1NTL2lkZW50LiBXZSByZWNvbW1lbmQgdXNpbmcgdXVpZHMgb3IgaW50ZWdlcnMuYCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBldmVudC5pZCAhPT0gJ3N0cmluZycgJiYgdHlwZW9mIGV2ZW50LmlkICE9PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBbU2NoZWR1bGUtWCBlcnJvcl06IEV2ZW50IGlkICR7ZXZlbnQuaWR9IGlzIG5vdCBhIHZhbGlkIGlkLiBPbmx5IG5vbi11bmljb2RlIGNoYXJhY3RlcnMgdGhhdCBjYW4gYmUgdXNlZCBieSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yIGlzIGFsbG93ZWQsIHNlZTogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQ1NTL2lkZW50LiBXZSByZWNvbW1lbmQgdXNpbmcgdXVpZHMgb3IgaW50ZWdlcnMuYCk7XG4gICAgICAgIH1cbiAgICB9KTtcbn07XG5cbmNvbnN0IGNyZWF0ZUNhbGVuZGFyQXBwU2luZ2xldG9uID0gKGNvbmZpZywgcGx1Z2lucykgPT4ge1xuICAgIHZhciBfYTtcbiAgICBjb25zdCBpbnRlcm5hbENvbmZpZyA9IGNyZWF0ZUludGVybmFsQ29uZmlnKGNvbmZpZywgcGx1Z2lucyk7XG4gICAgY29uc3QgdGltZVVuaXRzSW1wbCA9IGNyZWF0ZVRpbWVVbml0c0ltcGwoaW50ZXJuYWxDb25maWcpO1xuICAgIGNvbnN0IGNhbGVuZGFyU3RhdGUgPSBjcmVhdGVDYWxlbmRhclN0YXRlKGludGVybmFsQ29uZmlnLCB0aW1lVW5pdHNJbXBsLCBjb25maWcuc2VsZWN0ZWREYXRlKTtcbiAgICBjb25zdCBkYXRlU2VsZWN0aW9uQ2FsbGJhY2sgPSBjcmVhdGVEYXRlU2VsZWN0aW9uQ2FsbGJhY2soY2FsZW5kYXJTdGF0ZSwgY29uZmlnKTtcbiAgICBjb25zdCBkYXRlUGlja2VyQ29uZmlnID0gY3JlYXRlRGF0ZVBpY2tlckNvbmZpZyhjb25maWcsIChkYXRlKSA9PiBkYXRlU2VsZWN0aW9uQ2FsbGJhY2soZGF0ZSkpO1xuICAgIGNvbnN0IGRhdGVQaWNrZXJTdGF0ZSA9IGNyZWF0ZURhdGVQaWNrZXJTdGF0ZShkYXRlUGlja2VyQ29uZmlnLCBjb25maWcuc2VsZWN0ZWREYXRlIHx8ICgoX2EgPSBjb25maWcuZGF0ZVBpY2tlcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnNlbGVjdGVkRGF0ZSkpO1xuICAgIGNvbnN0IGNhbGVuZGFyRXZlbnRzID0gY3JlYXRlQ2FsZW5kYXJFdmVudHNJbXBsKGNvbmZpZy5ldmVudHMgfHwgW10sIGNvbmZpZy5iYWNrZ3JvdW5kRXZlbnRzIHx8IFtdLCBpbnRlcm5hbENvbmZpZyk7XG4gICAgcmV0dXJuIG5ldyBDYWxlbmRhckFwcFNpbmdsZXRvbkJ1aWxkZXIoKVxuICAgICAgICAud2l0aENvbmZpZyhpbnRlcm5hbENvbmZpZylcbiAgICAgICAgLndpdGhUaW1lVW5pdHNJbXBsKHRpbWVVbml0c0ltcGwpXG4gICAgICAgIC53aXRoRGF0ZVBpY2tlclN0YXRlKGRhdGVQaWNrZXJTdGF0ZSlcbiAgICAgICAgLndpdGhDYWxlbmRhckV2ZW50cyhjYWxlbmRhckV2ZW50cylcbiAgICAgICAgLndpdGhEYXRlUGlja2VyQ29uZmlnKGRhdGVQaWNrZXJDb25maWcpXG4gICAgICAgIC53aXRoQ2FsZW5kYXJTdGF0ZShjYWxlbmRhclN0YXRlKVxuICAgICAgICAud2l0aFRyYW5zbGF0ZSh0cmFuc2xhdGUoaW50ZXJuYWxDb25maWcubG9jYWxlLCBpbnRlcm5hbENvbmZpZy50cmFuc2xhdGlvbnMpKVxuICAgICAgICAuYnVpbGQoKTtcbn07XG5jb25zdCBjcmVhdGVDYWxlbmRhciA9IChjb25maWcsIHBsdWdpbnMpID0+IHtcbiAgICB2YWxpZGF0ZVBsdWdpbnMoY29uZmlnLnBsdWdpbnMsIHBsdWdpbnMpO1xuICAgIGlmIChjb25maWcuc2tpcFZhbGlkYXRpb24gIT09IHRydWUpIHtcbiAgICAgICAgdmFsaWRhdGVFdmVudHMoY29uZmlnLmV2ZW50cyk7XG4gICAgICAgIHZhbGlkYXRlQ29uZmlnKGNvbmZpZyk7XG4gICAgfVxuICAgIHJldHVybiBuZXcgQ2FsZW5kYXJBcHAoY3JlYXRlQ2FsZW5kYXJBcHBTaW5nbGV0b24oY29uZmlnLCBwbHVnaW5zIHx8IGNvbmZpZy5wbHVnaW5zIHx8IFtdKSk7XG59O1xuXG5jb25zdCBjcmVhdGVXZWVrRm9yTW9udGggPSAod2VlaywgZGF5KSA9PiB7XG4gICAgd2Vlay5wdXNoKHtcbiAgICAgICAgZGF0ZTogVGVtcG9yYWwuWm9uZWREYXRlVGltZS5mcm9tKGRheS50b1N0cmluZygpKS50b1BsYWluRGF0ZSgpLFxuICAgICAgICBldmVudHM6IHt9LFxuICAgICAgICBiYWNrZ3JvdW5kRXZlbnRzOiBbXSxcbiAgICB9KTtcbiAgICByZXR1cm4gd2Vlaztcbn07XG5jb25zdCBjcmVhdGVNb250aCA9IChkYXRlLCB0aW1lVW5pdHNJbXBsKSA9PiB7XG4gICAgY29uc3QgbW9udGhXaXRoRGF0ZXMgPSB0aW1lVW5pdHNJbXBsLmdldE1vbnRoV2l0aFRyYWlsaW5nQW5kTGVhZGluZ0RheXMoZGF0ZS55ZWFyLCBkYXRlLm1vbnRoKTtcbiAgICBjb25zdCBtb250aCA9IFtdO1xuICAgIGZvciAoY29uc3Qgd2VlayBvZiBtb250aFdpdGhEYXRlcykge1xuICAgICAgICBtb250aC5wdXNoKHdlZWsucmVkdWNlKGNyZWF0ZVdlZWtGb3JNb250aCwgW10pKTtcbiAgICB9XG4gICAgcmV0dXJuIG1vbnRoO1xufTtcblxuZnVuY3Rpb24gTW9udGhHcmlkRXZlbnQoeyBncmlkUm93LCBjYWxlbmRhckV2ZW50LCBkYXRlLCBpc0ZpcnN0V2VlaywgaXNMYXN0V2VlaywgfSkge1xuICAgIHZhciBfYSwgX2IsIF9jLCBfZCwgX2U7XG4gICAgY29uc3QgJGFwcCA9IHVzZUNvbnRleHQoQXBwQ29udGV4dCk7XG4gICAgY29uc3QgaGFzT3ZlcmZsb3dMZWZ0ID0gaXNGaXJzdFdlZWsgJiZcbiAgICAgICAgKChfYSA9ICRhcHAuY2FsZW5kYXJTdGF0ZS5yYW5nZS52YWx1ZSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnN0YXJ0KSAmJlxuICAgICAgICBjYWxlbmRhckV2ZW50LnN0YXJ0LnRvU3RyaW5nKCkgPFxuICAgICAgICAgICAgJGFwcC5jYWxlbmRhclN0YXRlLnJhbmdlLnZhbHVlLnN0YXJ0LnRvU3RyaW5nKCk7XG4gICAgY29uc3QgaGFzT3ZlcmZsb3dSaWdodCA9IGlzTGFzdFdlZWsgJiZcbiAgICAgICAgKChfYiA9ICRhcHAuY2FsZW5kYXJTdGF0ZS5yYW5nZS52YWx1ZSkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmVuZCkgJiZcbiAgICAgICAgY2FsZW5kYXJFdmVudC5lbmQudG9TdHJpbmcoKSA+ICRhcHAuY2FsZW5kYXJTdGF0ZS5yYW5nZS52YWx1ZS5lbmQudG9TdHJpbmcoKTtcbiAgICBjb25zdCB7IGNyZWF0ZURyYWdTdGFydFRpbWVvdXQsIHNldENsaWNrZWRFdmVudElmTm90RHJhZ2dpbmcsIHNldENsaWNrZWRFdmVudCwgfSA9IHVzZUV2ZW50SW50ZXJhY3Rpb25zKCRhcHApO1xuICAgIGNvbnN0IHBsYWluRGF0ZSA9IFRlbXBvcmFsLlBsYWluRGF0ZS5mcm9tKGRhdGUpLnRvU3RyaW5nKCk7XG4gICAgY29uc3QgaGFzU3RhcnREYXRlID0gZGF0ZUZyb21EYXRlVGltZShjYWxlbmRhckV2ZW50LnN0YXJ0LnRvU3RyaW5nKCkpID09PSBwbGFpbkRhdGU7XG4gICAgY29uc3QgbkRheXMgPSBjYWxlbmRhckV2ZW50Ll9ldmVudEZyYWdtZW50c1tkYXRlXTtcbiAgICBjb25zdCBldmVudENTU1ZhcmlhYmxlcyA9IHtcbiAgICAgICAgYm9yZGVySW5saW5lU3RhcnQ6IGhhc1N0YXJ0RGF0ZVxuICAgICAgICAgICAgPyBgNHB4IHNvbGlkIHZhcigtLXN4LWNvbG9yLSR7Y2FsZW5kYXJFdmVudC5fY29sb3J9KWBcbiAgICAgICAgICAgIDogdW5kZWZpbmVkLFxuICAgICAgICBjb2xvcjogYHZhcigtLXN4LWNvbG9yLW9uLSR7Y2FsZW5kYXJFdmVudC5fY29sb3J9LWNvbnRhaW5lcilgLFxuICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IGB2YXIoLS1zeC1jb2xvci0ke2NhbGVuZGFyRXZlbnQuX2NvbG9yfS1jb250YWluZXIpYCxcbiAgICAgICAgLy8gQ09SUkVMQVRJT04gSUQ6IDIgKDEwcHggc3VidHJhY3RlZCBmcm9tIHdpZHRoKVxuICAgICAgICAvLyBuRGF5cyAqIDEwMCUgZm9yIHRoZSB3aWR0aCBvZiBlYWNoIGRheSArIDFweCBmb3IgYm9yZGVyIC0gMTAgcHggZm9yIGhvcml6b250YWwgZ2FwIGJldHdlZW4gZXZlbnRzXG4gICAgICAgIHdpZHRoOiBgY2FsYygke25EYXlzICogMTAwICsgJyUnfSArICR7bkRheXN9cHggLSAxMHB4KWAsXG4gICAgfTtcbiAgICBjb25zdCBoYW5kbGVTdGFydERyYWcgPSAodWlFdmVudCkgPT4ge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGlmIChpc1VJRXZlbnRUb3VjaEV2ZW50KHVpRXZlbnQpKVxuICAgICAgICAgICAgdWlFdmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBpZiAoIXVpRXZlbnQudGFyZ2V0KVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBpZiAoISRhcHAuY29uZmlnLnBsdWdpbnMuZHJhZ0FuZERyb3AgfHwgKChfYSA9IGNhbGVuZGFyRXZlbnQuX29wdGlvbnMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5kaXNhYmxlRE5EKSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgJGFwcC5jb25maWcucGx1Z2lucy5kcmFnQW5kRHJvcC5jcmVhdGVNb250aEdyaWREcmFnSGFuZGxlcihjYWxlbmRhckV2ZW50LCAkYXBwKTtcbiAgICB9O1xuICAgIGNvbnN0IGN1c3RvbUNvbXBvbmVudCA9ICRhcHAuY29uZmlnLl9jdXN0b21Db21wb25lbnRGbnMubW9udGhHcmlkRXZlbnQ7XG4gICAgY29uc3QgY3VzdG9tQ29tcG9uZW50SWQgPSB1c2VSZWYkMShjdXN0b21Db21wb25lbnRcbiAgICAgICAgPyAnY3VzdG9tLW1vbnRoLWdyaWQtZXZlbnQtJyArIHJhbmRvbVN0cmluZ0lkKCkgLy8gbmVlZHMgYSB1bmlxdWUgc3RyaW5nIHRvIHN1cHBvcnQgZXZlbnQgcmVjdXJyZW5jZVxuICAgICAgICA6IHVuZGVmaW5lZCk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKCFjdXN0b21Db21wb25lbnQpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGN1c3RvbUNvbXBvbmVudChnZXRFbGVtZW50QnlDQ0lEKGN1c3RvbUNvbXBvbmVudElkLmN1cnJlbnQpLCB7XG4gICAgICAgICAgICBjYWxlbmRhckV2ZW50OiBjYWxlbmRhckV2ZW50Ll9nZXRFeHRlcm5hbEV2ZW50KCksXG4gICAgICAgICAgICBoYXNTdGFydERhdGUsXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgICAgIChfYiA9IChfYSA9ICRhcHAuY29uZmlnKS5fZGVzdHJveUN1c3RvbUNvbXBvbmVudEluc3RhbmNlKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuY2FsbChfYSwgY3VzdG9tQ29tcG9uZW50SWQuY3VycmVudCk7XG4gICAgICAgIH07XG4gICAgfSwgW2NhbGVuZGFyRXZlbnRdKTtcbiAgICBjb25zdCBoYW5kbGVPbkNsaWNrID0gKGUpID0+IHtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsgLy8gcHJldmVudCB0aGUgY2xpY2sgZnJvbSBidWJibGluZyB1cCB0byB0aGUgZGF5IGVsZW1lbnRcbiAgICAgICAgaW52b2tlT25FdmVudENsaWNrQ2FsbGJhY2soJGFwcCwgY2FsZW5kYXJFdmVudCwgZSk7XG4gICAgfTtcbiAgICBjb25zdCBoYW5kbGVPbkRvdWJsZUNsaWNrID0gKGUpID0+IHtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsgLy8gcHJldmVudCB0aGUgY2xpY2sgZnJvbSBidWJibGluZyB1cCB0byB0aGUgZGF5IGVsZW1lbnRcbiAgICAgICAgaW52b2tlT25FdmVudERvdWJsZUNsaWNrQ2FsbGJhY2soJGFwcCwgY2FsZW5kYXJFdmVudCwgZSk7XG4gICAgfTtcbiAgICBjb25zdCBoYW5kbGVLZXlEb3duID0gKGUpID0+IHtcbiAgICAgICAgaWYgKGUua2V5ID09PSAnRW50ZXInIHx8IGUua2V5ID09PSAnICcpIHtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICBzZXRDbGlja2VkRXZlbnQoZSwgY2FsZW5kYXJFdmVudCk7XG4gICAgICAgICAgICBpbnZva2VPbkV2ZW50Q2xpY2tDYWxsYmFjaygkYXBwLCBjYWxlbmRhckV2ZW50LCBlKTtcbiAgICAgICAgICAgIG5leHRUaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICBmb2N1c01vZGFsKCRhcHApO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IGNsYXNzTmFtZXMgPSBbXG4gICAgICAgICdzeF9fZXZlbnQnLFxuICAgICAgICAnc3hfX21vbnRoLWdyaWQtZXZlbnQnLFxuICAgICAgICAnc3hfX21vbnRoLWdyaWQtY2VsbCcsXG4gICAgXTtcbiAgICBpZiAoKF9jID0gY2FsZW5kYXJFdmVudC5fb3B0aW9ucykgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLmFkZGl0aW9uYWxDbGFzc2VzKSB7XG4gICAgICAgIGNsYXNzTmFtZXMucHVzaCguLi5jYWxlbmRhckV2ZW50Ll9vcHRpb25zLmFkZGl0aW9uYWxDbGFzc2VzKTtcbiAgICB9XG4gICAgaWYgKHdhc0V2ZW50QWRkZWRJbkxhc3RTZWNvbmQoY2FsZW5kYXJFdmVudCkpXG4gICAgICAgIGNsYXNzTmFtZXMucHVzaCgnaXMtZXZlbnQtbmV3Jyk7XG4gICAgaWYgKGhhc092ZXJmbG93TGVmdClcbiAgICAgICAgY2xhc3NOYW1lcy5wdXNoKCdzeF9fbW9udGgtZ3JpZC1ldmVudC0tb3ZlcmZsb3ctbGVmdCcpO1xuICAgIGlmIChoYXNPdmVyZmxvd1JpZ2h0KVxuICAgICAgICBjbGFzc05hbWVzLnB1c2goJ3N4X19tb250aC1ncmlkLWV2ZW50LS1vdmVyZmxvdy1yaWdodCcpO1xuICAgIGNvbnN0IGhhc0N1c3RvbUNvbnRlbnQgPSAoX2QgPSBjYWxlbmRhckV2ZW50Ll9jdXN0b21Db250ZW50KSA9PT0gbnVsbCB8fCBfZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2QubW9udGhHcmlkO1xuICAgIHJldHVybiAoanN4cyhcImRpdlwiLCB7IGRyYWdnYWJsZTogISEkYXBwLmNvbmZpZy5wbHVnaW5zLmRyYWdBbmREcm9wLCBcImRhdGEtZXZlbnQtaWRcIjogY2FsZW5kYXJFdmVudC5pZCwgXCJkYXRhLWNjaWRcIjogY3VzdG9tQ29tcG9uZW50SWQuY3VycmVudCwgb25Nb3VzZURvd246IChlKSA9PiBjcmVhdGVEcmFnU3RhcnRUaW1lb3V0KGhhbmRsZVN0YXJ0RHJhZywgZSksIG9uTW91c2VVcDogKGUpID0+IHNldENsaWNrZWRFdmVudElmTm90RHJhZ2dpbmcoY2FsZW5kYXJFdmVudCwgZSksIG9uVG91Y2hTdGFydDogKGUpID0+IGNyZWF0ZURyYWdTdGFydFRpbWVvdXQoaGFuZGxlU3RhcnREcmFnLCBlKSwgb25Ub3VjaEVuZDogKGUpID0+IHNldENsaWNrZWRFdmVudElmTm90RHJhZ2dpbmcoY2FsZW5kYXJFdmVudCwgZSksIG9uQ2xpY2s6IGhhbmRsZU9uQ2xpY2ssIG9uRGJsQ2xpY2s6IGhhbmRsZU9uRG91YmxlQ2xpY2ssIG9uS2V5RG93bjogaGFuZGxlS2V5RG93biwgY2xhc3NOYW1lOiBjbGFzc05hbWVzLmpvaW4oJyAnKSwgc3R5bGU6IHtcbiAgICAgICAgICAgIGdyaWRSb3csXG4gICAgICAgICAgICB3aWR0aDogZXZlbnRDU1NWYXJpYWJsZXMud2lkdGgsXG4gICAgICAgICAgICBwYWRkaW5nOiBjdXN0b21Db21wb25lbnQgPyAnMHB4JyA6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGJvcmRlcklubGluZVN0YXJ0OiBjdXN0b21Db21wb25lbnRcbiAgICAgICAgICAgICAgICA/IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgIDogZXZlbnRDU1NWYXJpYWJsZXMuYm9yZGVySW5saW5lU3RhcnQsXG4gICAgICAgICAgICBjb2xvcjogY3VzdG9tQ29tcG9uZW50ID8gdW5kZWZpbmVkIDogZXZlbnRDU1NWYXJpYWJsZXMuY29sb3IsXG4gICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IGN1c3RvbUNvbXBvbmVudFxuICAgICAgICAgICAgICAgID8gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgOiBldmVudENTU1ZhcmlhYmxlcy5iYWNrZ3JvdW5kQ29sb3IsXG4gICAgICAgIH0sIHRhYkluZGV4OiAwLCByb2xlOiBcImJ1dHRvblwiLCBjaGlsZHJlbjogWyFjdXN0b21Db21wb25lbnQgJiYgIWhhc0N1c3RvbUNvbnRlbnQgJiYgKGpzeHMoRnJhZ21lbnQsIHsgY2hpbGRyZW46IFtjYWxlbmRhckV2ZW50LnN0YXJ0IGluc3RhbmNlb2YgVGVtcG9yYWwuWm9uZWREYXRlVGltZSAmJiAoanN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X19tb250aC1ncmlkLWV2ZW50LXRpbWVcIiwgY2hpbGRyZW46IHRpbWVGbihjYWxlbmRhckV2ZW50LnN0YXJ0LCAkYXBwLmNvbmZpZy5sb2NhbGUudmFsdWUpIH0pKSwganN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X19tb250aC1ncmlkLWV2ZW50LXRpdGxlXCIsIGNoaWxkcmVuOiBjYWxlbmRhckV2ZW50LnRpdGxlIH0pXSB9KSksIGhhc0N1c3RvbUNvbnRlbnQgJiYgKGpzeChcImRpdlwiLCB7IGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MOiB7XG4gICAgICAgICAgICAgICAgICAgIF9faHRtbDogKChfZSA9IGNhbGVuZGFyRXZlbnQuX2N1c3RvbUNvbnRlbnQpID09PSBudWxsIHx8IF9lID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZS5tb250aEdyaWQpIHx8ICcnLFxuICAgICAgICAgICAgICAgIH0gfSkpXSB9KSk7XG59XG5cbmZ1bmN0aW9uIE1vbnRoR3JpZERheSh7IGRheSwgaXNGaXJzdFdlZWssIGlzTGFzdFdlZWsgfSkge1xuICAgIGNvbnN0ICRhcHAgPSB1c2VDb250ZXh0KEFwcENvbnRleHQpO1xuICAgIGNvbnN0IG5FdmVudHNJbkRheSA9IE9iamVjdC52YWx1ZXMoZGF5LmV2ZW50cykuZmlsdGVyKChldmVudCkgPT4gdHlwZW9mIGV2ZW50ID09PSAnb2JqZWN0JyB8fCBldmVudCA9PT0gREFURV9HUklEX0JMT0NLRVIpLmxlbmd0aDtcbiAgICBjb25zdCBnZXRFdmVudFRyYW5zbGF0aW9uU2luZ3VsYXJPclBsdXJhbCA9IChuT2ZBZGRpdGlvbmFsRXZlbnRzKSA9PiB7XG4gICAgICAgIGlmIChuT2ZBZGRpdGlvbmFsRXZlbnRzID09PSAxKVxuICAgICAgICAgICAgcmV0dXJuICRhcHAudHJhbnNsYXRlKCcrIDEgZXZlbnQnKTtcbiAgICAgICAgcmV0dXJuICRhcHAudHJhbnNsYXRlKCcrIHt7bn19IGV2ZW50cycsIHsgbjogbk9mQWRkaXRpb25hbEV2ZW50cyB9KTtcbiAgICB9O1xuICAgIGNvbnN0IGdldEFyaWFMYWJlbFNpbmd1bGFyT3JQbHVyYWwgPSAobk9mQWRkaXRpb25hbEV2ZW50cykgPT4ge1xuICAgICAgICBpZiAobk9mQWRkaXRpb25hbEV2ZW50cyA9PT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuICRhcHAudHJhbnNsYXRlKCdMaW5rIHRvIDEgbW9yZSBldmVudCBvbiB7e2RhdGV9fScsIHtcbiAgICAgICAgICAgICAgICBkYXRlOiBnZXRMb2NhbGl6ZWREYXRlJDEoZGF5LmRhdGUsICRhcHAuY29uZmlnLmxvY2FsZS52YWx1ZSksXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gJGFwcC50cmFuc2xhdGUoJ0xpbmsgdG8ge3tufX0gbW9yZSBldmVudHMgb24ge3tkYXRlfX0nLCB7XG4gICAgICAgICAgICBkYXRlOiBnZXRMb2NhbGl6ZWREYXRlJDEoZGF5LmRhdGUsICRhcHAuY29uZmlnLmxvY2FsZS52YWx1ZSksXG4gICAgICAgICAgICBuOiBuRXZlbnRzSW5EYXkgLSAkYXBwLmNvbmZpZy5tb250aEdyaWRPcHRpb25zLnZhbHVlLm5FdmVudHNQZXJEYXksXG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgY29uc3QgaGFuZGxlQ2xpY2tBZGRpdGlvbmFsRXZlbnRzID0gKGUpID0+IHtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgaWYgKCRhcHAuY29uZmlnLmNhbGxiYWNrcy5vbkNsaWNrUGx1c0V2ZW50cylcbiAgICAgICAgICAgICRhcHAuY29uZmlnLmNhbGxiYWNrcy5vbkNsaWNrUGx1c0V2ZW50cyhkYXkuZGF0ZSwgZSk7XG4gICAgICAgIGlmICghJGFwcC5jb25maWcudmlld3MudmFsdWUuZmluZCgodmlldykgPT4gdmlldy5uYW1lID09PSBJbnRlcm5hbFZpZXdOYW1lLkRheSkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIC8vIFRpbWVvdXQgdG8gZGlzcGxheSB0aGUgcmlwcGxlIGVmZmVjdFxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICRhcHAuZGF0ZVBpY2tlclN0YXRlLnNlbGVjdGVkRGF0ZS52YWx1ZSA9IGRheS5kYXRlO1xuICAgICAgICAgICAgJGFwcC5jYWxlbmRhclN0YXRlLnNldFZpZXcoSW50ZXJuYWxWaWV3TmFtZS5EYXksIGRheS5kYXRlKTtcbiAgICAgICAgfSwgMjUwKTtcbiAgICB9O1xuICAgIGNvbnN0IGRhdGVDbGFzc05hbWVzID0gWydzeF9fbW9udGgtZ3JpZC1kYXlfX2hlYWRlci1kYXRlJ107XG4gICAgY29uc3QgZGF5RGF0ZSA9IGRheS5kYXRlO1xuICAgIGlmIChpc1RvZGF5KGRheURhdGUudG9ab25lZERhdGVUaW1lKCRhcHAuY29uZmlnLnRpbWV6b25lLnZhbHVlKSwgJGFwcC5jb25maWcudGltZXpvbmUudmFsdWUpKVxuICAgICAgICBkYXRlQ2xhc3NOYW1lcy5wdXNoKCdzeF9faXMtdG9kYXknKTtcbiAgICBjb25zdCBzZWxlY3RlZERhdGVNb250aCA9ICRhcHAuZGF0ZVBpY2tlclN0YXRlLnNlbGVjdGVkRGF0ZS52YWx1ZS5tb250aDtcbiAgICBjb25zdCBkYXlNb250aCA9IGRheS5kYXRlLm1vbnRoO1xuICAgIGNvbnN0IGJhc2VDbGFzc2VzID0gW1xuICAgICAgICAnc3hfX21vbnRoLWdyaWQtZGF5JyxcbiAgICAgICAgZ2V0Q2xhc3NOYW1lRm9yV2Vla2RheShkYXlEYXRlLmRheU9mV2VlayksXG4gICAgXTtcbiAgICBjb25zdCBbd3JhcHBlckNsYXNzZXMsIHNldFdyYXBwZXJDbGFzc2VzXSA9IHVzZVN0YXRlKGJhc2VDbGFzc2VzKTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBjb25zdCBjbGFzc2VzID0gWy4uLmJhc2VDbGFzc2VzXTtcbiAgICAgICAgaWYgKGRheU1vbnRoICE9PSBzZWxlY3RlZERhdGVNb250aClcbiAgICAgICAgICAgIGNsYXNzZXMucHVzaCgnaXMtbGVhZGluZy1vci10cmFpbGluZycpO1xuICAgICAgICBpZiAoaXNTYW1lRGF5KCRhcHAuZGF0ZVBpY2tlclN0YXRlLnNlbGVjdGVkRGF0ZS52YWx1ZSwgZGF5LmRhdGUpKVxuICAgICAgICAgICAgY2xhc3Nlcy5wdXNoKCdpcy1zZWxlY3RlZCcpO1xuICAgICAgICBzZXRXcmFwcGVyQ2xhc3NlcyhjbGFzc2VzKTtcbiAgICB9LCBbJGFwcC5kYXRlUGlja2VyU3RhdGUuc2VsZWN0ZWREYXRlLnZhbHVlXSk7XG4gICAgY29uc3QgZ2V0TnVtYmVyT2ZOb25EaXNwbGF5ZWRFdmVudHMgPSAoKSA9PiB7XG4gICAgICAgIHJldHVybiBPYmplY3QudmFsdWVzKGRheS5ldmVudHMpXG4gICAgICAgICAgICAuc2xpY2UoJGFwcC5jb25maWcubW9udGhHcmlkT3B0aW9ucy52YWx1ZS5uRXZlbnRzUGVyRGF5KVxuICAgICAgICAgICAgLmZpbHRlcigoZXZlbnQpID0+IGV2ZW50ID09PSBEQVRFX0dSSURfQkxPQ0tFUiB8fCB0eXBlb2YgZXZlbnQgPT09ICdvYmplY3QnKS5sZW5ndGg7XG4gICAgfTtcbiAgICBjb25zdCBudW1iZXJPZk5vbkRpc3BsYXllZEV2ZW50cyA9IGdldE51bWJlck9mTm9uRGlzcGxheWVkRXZlbnRzKCk7XG4gICAgY29uc3QgZGF5U3RhcnREYXRlVGltZSA9IFRlbXBvcmFsLlpvbmVkRGF0ZVRpbWUuZnJvbSh7XG4gICAgICAgIHllYXI6IGRheS5kYXRlLnllYXIsXG4gICAgICAgIG1vbnRoOiBkYXkuZGF0ZS5tb250aCxcbiAgICAgICAgZGF5OiBkYXkuZGF0ZS5kYXksXG4gICAgICAgIGhvdXI6IDAsXG4gICAgICAgIG1pbnV0ZTogMCxcbiAgICAgICAgc2Vjb25kOiAwLFxuICAgICAgICB0aW1lWm9uZTogJGFwcC5jb25maWcudGltZXpvbmUudmFsdWUsXG4gICAgfSk7XG4gICAgY29uc3QgZGF5RW5kRGF0ZVRpbWUgPSBUZW1wb3JhbC5ab25lZERhdGVUaW1lLmZyb20oe1xuICAgICAgICB5ZWFyOiBkYXkuZGF0ZS55ZWFyLFxuICAgICAgICBtb250aDogZGF5LmRhdGUubW9udGgsXG4gICAgICAgIGRheTogZGF5LmRhdGUuZGF5LFxuICAgICAgICBob3VyOiAyMyxcbiAgICAgICAgbWludXRlOiA1OSxcbiAgICAgICAgc2Vjb25kOiA1OSxcbiAgICAgICAgdGltZVpvbmU6ICRhcHAuY29uZmlnLnRpbWV6b25lLnZhbHVlLFxuICAgIH0pO1xuICAgIGNvbnN0IGZ1bGxEYXlCYWNrZ3JvdW5kRXZlbnQgPSBkYXkuYmFja2dyb3VuZEV2ZW50cy5maW5kKChldmVudCkgPT4ge1xuICAgICAgICBjb25zdCBldmVudFN0YXJ0V2l0aFRpbWUgPSBldmVudC5zdGFydCBpbnN0YW5jZW9mIFRlbXBvcmFsLlBsYWluRGF0ZVxuICAgICAgICAgICAgPyBldmVudC5zdGFydC50b1pvbmVkRGF0ZVRpbWUoJGFwcC5jb25maWcudGltZXpvbmUudmFsdWUpXG4gICAgICAgICAgICA6IGV2ZW50LnN0YXJ0O1xuICAgICAgICBjb25zdCBldmVudEVuZFdpdGhUaW1lID0gZXZlbnQuZW5kIGluc3RhbmNlb2YgVGVtcG9yYWwuUGxhaW5EYXRlXG4gICAgICAgICAgICA/IGV2ZW50LmVuZC50b1pvbmVkRGF0ZVRpbWUoJGFwcC5jb25maWcudGltZXpvbmUudmFsdWUpLndpdGgoe1xuICAgICAgICAgICAgICAgIGhvdXI6IDIzLFxuICAgICAgICAgICAgICAgIG1pbnV0ZTogNTksXG4gICAgICAgICAgICAgICAgc2Vjb25kOiA1OSxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICA6IGV2ZW50LmVuZDtcbiAgICAgICAgcmV0dXJuIChldmVudFN0YXJ0V2l0aFRpbWUudG9TdHJpbmcoKSA8PSBkYXlTdGFydERhdGVUaW1lLnRvU3RyaW5nKCkgJiZcbiAgICAgICAgICAgIGV2ZW50RW5kV2l0aFRpbWUudG9TdHJpbmcoKSA+PSBkYXlFbmREYXRlVGltZS50b1N0cmluZygpKTtcbiAgICB9KTtcbiAgICBjb25zdCBoYW5kbGVNb3VzZURvd24gPSAoZSkgPT4ge1xuICAgICAgICBjb25zdCB0YXJnZXQgPSBlLnRhcmdldDtcbiAgICAgICAgaWYgKCF0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdzeF9fbW9udGgtZ3JpZC1kYXknKSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgY29uc3QgY2FsbGJhY2sgPSAkYXBwLmNvbmZpZy5jYWxsYmFja3Mub25Nb3VzZURvd25Nb250aEdyaWREYXRlO1xuICAgICAgICBpZiAoY2FsbGJhY2spXG4gICAgICAgICAgICBjYWxsYmFjayhkYXkuZGF0ZSwgZSk7XG4gICAgfTtcbiAgICBjb25zdCBtb250aEdyaWREYXlOYW1lQ3VzdG9tQ29tcG9uZW50ID0gJGFwcC5jb25maWcuX2N1c3RvbUNvbXBvbmVudEZucy5tb250aEdyaWREYXlOYW1lO1xuICAgIGNvbnN0IG1vbnRoR3JpZERheU5hbWVDQ0lEID0gdXNlU3RhdGUobW9udGhHcmlkRGF5TmFtZUN1c3RvbUNvbXBvbmVudCA/IHJhbmRvbVN0cmluZ0lkKCkgOiAnJylbMF07XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKCFtb250aEdyaWREYXlOYW1lQ3VzdG9tQ29tcG9uZW50KVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBjb25zdCBkYXlOYW1lRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBbZGF0YS1jY2lkPVwiJHttb250aEdyaWREYXlOYW1lQ0NJRH1cIl1gKTtcbiAgICAgICAgaWYgKCEoZGF5TmFtZUVsIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgbW9udGhHcmlkRGF5TmFtZUN1c3RvbUNvbXBvbmVudChkYXlOYW1lRWwsIHtcbiAgICAgICAgICAgIGRheTogdG9KU0RhdGUoZGF5LmRhdGUudG9TdHJpbmcoKSkuZ2V0RGF5KCksXG4gICAgICAgIH0pO1xuICAgIH0sIFtkYXldKTtcbiAgICBjb25zdCBtb250aEdyaWREYXRlQ3VzdG9tQ29tcG9uZW50ID0gJGFwcC5jb25maWcuX2N1c3RvbUNvbXBvbmVudEZucy5tb250aEdyaWREYXRlO1xuICAgIGNvbnN0IG1vbnRoR3JpZERhdGVDQ0lEID0gdXNlU3RhdGUobW9udGhHcmlkRGF0ZUN1c3RvbUNvbXBvbmVudCA/IHJhbmRvbVN0cmluZ0lkKCkgOiAnJylbMF07XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKCFtb250aEdyaWREYXRlQ3VzdG9tQ29tcG9uZW50KVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBjb25zdCBkYXRlRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBbZGF0YS1jY2lkPVwiJHttb250aEdyaWREYXRlQ0NJRH1cIl1gKTtcbiAgICAgICAgaWYgKCEoZGF0ZUVsIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBtb250aEdyaWREYXRlQ3VzdG9tQ29tcG9uZW50KGRhdGVFbCwge1xuICAgICAgICAgICAgZGF0ZTogdG9KU0RhdGUoZGF5LmRhdGUudG9TdHJpbmcoKSkuZ2V0RGF0ZSgpLFxuICAgICAgICAgICAganNEYXRlOiB0b0pTRGF0ZShkYXkuZGF0ZS50b1N0cmluZygpKSxcbiAgICAgICAgfSk7XG4gICAgfSwgW2RheV0pO1xuICAgIHJldHVybiAoanN4cyhcImRpdlwiLCB7IGNsYXNzTmFtZTogd3JhcHBlckNsYXNzZXMuam9pbignICcpLCBcImRhdGEtZGF0ZVwiOiB0b0RhdGVTdHJpbmckMShkYXkuZGF0ZSksIG9uQ2xpY2s6IChlKSA9PiAkYXBwLmNvbmZpZy5jYWxsYmFja3Mub25DbGlja0RhdGUgJiZcbiAgICAgICAgICAgICRhcHAuY29uZmlnLmNhbGxiYWNrcy5vbkNsaWNrRGF0ZShkYXkuZGF0ZSwgZSksIFwiYXJpYS1sYWJlbFwiOiBnZXRMb2NhbGl6ZWREYXRlJDEoZGF5LmRhdGUsICRhcHAuY29uZmlnLmxvY2FsZS52YWx1ZSksIG9uRGJsQ2xpY2s6IChlKSA9PiB7IHZhciBfYSwgX2I7IHJldHVybiAoX2IgPSAoX2EgPSAkYXBwLmNvbmZpZy5jYWxsYmFja3MpLm9uRG91YmxlQ2xpY2tEYXRlKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuY2FsbChfYSwgZGF5LmRhdGUsIGUpOyB9LCBvbk1vdXNlRG93bjogaGFuZGxlTW91c2VEb3duLCBjaGlsZHJlbjogW2Z1bGxEYXlCYWNrZ3JvdW5kRXZlbnQgJiYgKGpzeChGcmFnbWVudCwgeyBjaGlsZHJlbjoganN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X19tb250aC1ncmlkLWJhY2tncm91bmQtZXZlbnRcIiwgdGl0bGU6IGZ1bGxEYXlCYWNrZ3JvdW5kRXZlbnQudGl0bGUsIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAuLi5mdWxsRGF5QmFja2dyb3VuZEV2ZW50LnN0eWxlLFxuICAgICAgICAgICAgICAgICAgICB9IH0pIH0pKSwganN4cyhcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJzeF9fbW9udGgtZ3JpZC1kYXlfX2hlYWRlclwiLCBjaGlsZHJlbjogW2lzRmlyc3RXZWVrID8gKGpzeChGcmFnbWVudCwgeyBjaGlsZHJlbjogbW9udGhHcmlkRGF5TmFtZUN1c3RvbUNvbXBvbmVudCA/IChqc3goXCJkaXZcIiwgeyBcImRhdGEtY2NpZFwiOiBtb250aEdyaWREYXlOYW1lQ0NJRCB9KSkgOiAoanN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X19tb250aC1ncmlkLWRheV9faGVhZGVyLWRheS1uYW1lXCIsIGNoaWxkcmVuOiBnZXREYXlOYW1lU2hvcnQoZGF5RGF0ZSwgJGFwcC5jb25maWcubG9jYWxlLnZhbHVlKSB9KSkgfSkpIDogbnVsbCwgbW9udGhHcmlkRGF0ZUNDSUQgPyAoanN4KFwiZGl2XCIsIHsgXCJkYXRhLWNjaWRcIjogbW9udGhHcmlkRGF0ZUNDSUQgfSkpIDogKGpzeChcImRpdlwiLCB7IGNsYXNzTmFtZTogZGF0ZUNsYXNzTmFtZXMuam9pbignICcpLCBjaGlsZHJlbjogZGF5RGF0ZS5kYXkgfSkpXSB9KSwganN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X19tb250aC1ncmlkLWRheV9fZXZlbnRzXCIsIGNoaWxkcmVuOiBPYmplY3QudmFsdWVzKGRheS5ldmVudHMpXG4gICAgICAgICAgICAgICAgICAgIC5zbGljZSgwLCAkYXBwLmNvbmZpZy5tb250aEdyaWRPcHRpb25zLnZhbHVlLm5FdmVudHNQZXJEYXkpXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoKGV2ZW50LCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGV2ZW50ICE9PSAnb2JqZWN0JylcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoanN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X19tb250aC1ncmlkLWJsb2NrZXIgc3hfX21vbnRoLWdyaWQtY2VsbFwiLCBzdHlsZTogeyBncmlkUm93OiBpbmRleCArIDEgfSB9KSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoanN4KE1vbnRoR3JpZEV2ZW50LCB7IGdyaWRSb3c6IGluZGV4ICsgMSwgY2FsZW5kYXJFdmVudDogZXZlbnQsIGRhdGU6IGRheS5kYXRlLnRvU3RyaW5nKCksIGlzRmlyc3RXZWVrOiBpc0ZpcnN0V2VlaywgaXNMYXN0V2VlazogaXNMYXN0V2VlayB9KSk7XG4gICAgICAgICAgICAgICAgfSkgfSksIG51bWJlck9mTm9uRGlzcGxheWVkRXZlbnRzID4gMCA/IChqc3goXCJidXR0b25cIiwgeyB0eXBlOiBcImJ1dHRvblwiLCBjbGFzc05hbWU6IFwic3hfX2J1dHRvbiBzeF9fbW9udGgtZ3JpZC1kYXlfX2V2ZW50cy1tb3JlIHN4X19yaXBwbGUtLXdpZGVcIiwgXCJhcmlhLWxhYmVsXCI6IGdldEFyaWFMYWJlbFNpbmd1bGFyT3JQbHVyYWwobnVtYmVyT2ZOb25EaXNwbGF5ZWRFdmVudHMpLCBvbkNsaWNrOiBoYW5kbGVDbGlja0FkZGl0aW9uYWxFdmVudHMsIGNoaWxkcmVuOiBnZXRFdmVudFRyYW5zbGF0aW9uU2luZ3VsYXJPclBsdXJhbChudW1iZXJPZk5vbkRpc3BsYXllZEV2ZW50cykgfSkpIDogbnVsbF0gfSkpO1xufVxuXG5mdW5jdGlvbiBNb250aEdyaWRXZWVrKHsgd2VlaywgaXNGaXJzdFdlZWssIGlzTGFzdFdlZWssIH0pIHtcbiAgICBjb25zdCAkYXBwID0gdXNlQ29udGV4dChBcHBDb250ZXh0KTtcbiAgICByZXR1cm4gKGpzeHMoXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic3hfX21vbnRoLWdyaWQtd2Vla1wiLCBjaGlsZHJlbjogWyRhcHAuY29uZmlnLnNob3dXZWVrTnVtYmVycy52YWx1ZSAmJiAoanN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X19tb250aC1ncmlkLXdlZWtfX3dlZWstbnVtYmVyXCIsIGNoaWxkcmVuOiBnZXRXZWVrTnVtYmVyKHdlZWtbMF0uZGF0ZSwgJGFwcC5jb25maWcuZmlyc3REYXlPZldlZWsudmFsdWUpIH0pKSwgd2Vlay5tYXAoKGRheSkgPT4ge1xuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIFRoZSBkYXkgY29tcG9uZW50IGtlZXBzIGludGVybmFsIHN0YXRlLCBhbmQgbmVlZHMgdG8gYmUgdGhyb3duIGF3YXkgb25jZSB0aGUgZGF5IGNoYW5nZXMuXG4gICAgICAgICAgICAgICAgICogKi9cbiAgICAgICAgICAgICAgICByZXR1cm4gKGpzeChNb250aEdyaWREYXksIHsgZGF5OiBkYXksIGlzRmlyc3RXZWVrOiBpc0ZpcnN0V2VlaywgaXNMYXN0V2VlazogaXNMYXN0V2VlayB9LCB0b0RhdGVTdHJpbmckMShkYXkuZGF0ZSkpKTtcbiAgICAgICAgICAgIH0pXSB9KSk7XG59XG5cbmNvbnN0IHBvc2l0aW9uSW5Nb250aFdlZWsgPSAoc29ydGVkRXZlbnRzLCB3ZWVrKSA9PiB7XG4gICAgY29uc3Qgd2Vla0RhdGVzID0gT2JqZWN0LmtleXMod2Vlaykuc29ydCgpO1xuICAgIGNvbnN0IGZpcnN0RGF0ZU9mV2VlayA9IHdlZWtEYXRlc1swXTtcbiAgICBjb25zdCBsYXN0RGF0ZU9mV2VlayA9IHdlZWtEYXRlc1t3ZWVrRGF0ZXMubGVuZ3RoIC0gMV07XG4gICAgY29uc3Qgb2NjdXBpZWRMZXZlbHMgPSBuZXcgU2V0KCk7XG4gICAgZm9yIChjb25zdCBldmVudCBvZiBzb3J0ZWRFdmVudHMpIHtcbiAgICAgICAgY29uc3QgZXZlbnRPcmlnaW5hbFN0YXJ0RGF0ZSA9IGRhdGVGcm9tRGF0ZVRpbWUoZXZlbnQuc3RhcnQudG9TdHJpbmcoKSk7XG4gICAgICAgIGNvbnN0IGV2ZW50T3JpZ2luYWxFbmREYXRlID0gZGF0ZUZyb21EYXRlVGltZShldmVudC5lbmQudG9TdHJpbmcoKSk7XG4gICAgICAgIGNvbnN0IGlzRXZlbnRTdGFydEluV2VlayA9ICEhd2Vla1tldmVudE9yaWdpbmFsU3RhcnREYXRlXTtcbiAgICAgICAgbGV0IGlzRXZlbnRJbldlZWsgPSBpc0V2ZW50U3RhcnRJbldlZWs7XG4gICAgICAgIGlmICghaXNFdmVudFN0YXJ0SW5XZWVrICYmXG4gICAgICAgICAgICBldmVudE9yaWdpbmFsU3RhcnREYXRlIDwgZmlyc3REYXRlT2ZXZWVrICYmXG4gICAgICAgICAgICBldmVudE9yaWdpbmFsRW5kRGF0ZSA+PSBmaXJzdERhdGVPZldlZWspIHtcbiAgICAgICAgICAgIGlzRXZlbnRJbldlZWsgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICghaXNFdmVudEluV2VlaylcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICBjb25zdCBmaXJzdERhdGVPZkV2ZW50ID0gaXNFdmVudFN0YXJ0SW5XZWVrXG4gICAgICAgICAgICA/IGV2ZW50T3JpZ2luYWxTdGFydERhdGVcbiAgICAgICAgICAgIDogZmlyc3REYXRlT2ZXZWVrO1xuICAgICAgICBjb25zdCBsYXN0RGF0ZU9mRXZlbnQgPSBldmVudE9yaWdpbmFsRW5kRGF0ZSA8PSBsYXN0RGF0ZU9mV2Vla1xuICAgICAgICAgICAgPyBldmVudE9yaWdpbmFsRW5kRGF0ZVxuICAgICAgICAgICAgOiBsYXN0RGF0ZU9mV2VlaztcbiAgICAgICAgY29uc3QgZXZlbnREYXlzID0gT2JqZWN0LnZhbHVlcyh3ZWVrKS5maWx0ZXIoKGRheSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcGxhaW5EYXRlID0gVGVtcG9yYWwuUGxhaW5EYXRlLmZyb20oZGF5LmRhdGUpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICByZXR1cm4gcGxhaW5EYXRlID49IGZpcnN0RGF0ZU9mRXZlbnQgJiYgcGxhaW5EYXRlIDw9IGxhc3REYXRlT2ZFdmVudDtcbiAgICAgICAgfSk7XG4gICAgICAgIGxldCBsZXZlbEluV2Vla0ZvckV2ZW50O1xuICAgICAgICBsZXQgdGVzdExldmVsID0gMDtcbiAgICAgICAgd2hpbGUgKGxldmVsSW5XZWVrRm9yRXZlbnQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY29uc3QgaXNMZXZlbEZyZWUgPSBldmVudERheXMuZXZlcnkoKGRheSkgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiAhZGF5LmV2ZW50c1t0ZXN0TGV2ZWxdO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoaXNMZXZlbEZyZWUpIHtcbiAgICAgICAgICAgICAgICBsZXZlbEluV2Vla0ZvckV2ZW50ID0gdGVzdExldmVsO1xuICAgICAgICAgICAgICAgIG9jY3VwaWVkTGV2ZWxzLmFkZCh0ZXN0TGV2ZWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHRlc3RMZXZlbCsrO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgW2V2ZW50RGF5SW5kZXgsIGV2ZW50RGF5XSBvZiBldmVudERheXMuZW50cmllcygpKSB7XG4gICAgICAgICAgICBpZiAoZXZlbnREYXlJbmRleCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGV2ZW50Ll9ldmVudEZyYWdtZW50c1tmaXJzdERhdGVPZkV2ZW50XSA9IGV2ZW50RGF5cy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgZXZlbnREYXkuZXZlbnRzW2xldmVsSW5XZWVrRm9yRXZlbnRdID0gZXZlbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBldmVudERheS5ldmVudHNbbGV2ZWxJbldlZWtGb3JFdmVudF0gPSBEQVRFX0dSSURfQkxPQ0tFUjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBmb3IgKGNvbnN0IGxldmVsIG9mIEFycmF5LmZyb20ob2NjdXBpZWRMZXZlbHMpKSB7XG4gICAgICAgIGZvciAoY29uc3QgWywgZGF5XSBvZiBPYmplY3QuZW50cmllcyh3ZWVrKSkge1xuICAgICAgICAgICAgaWYgKCFkYXkuZXZlbnRzW2xldmVsXSkge1xuICAgICAgICAgICAgICAgIGRheS5ldmVudHNbbGV2ZWxdID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB3ZWVrO1xufTtcbmNvbnN0IHBvc2l0aW9uSW5Nb250aCA9IChtb250aCwgc29ydGVkRXZlbnRzKSA9PiB7XG4gICAgY29uc3Qgd2Vla3MgPSBbXTtcbiAgICBtb250aC5mb3JFYWNoKCh3ZWVrKSA9PiB7XG4gICAgICAgIGNvbnN0IHdlZWtNYXAgPSB7fTtcbiAgICAgICAgd2Vlay5mb3JFYWNoKChkYXkpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHBsYWluRGF0ZSA9IFRlbXBvcmFsLlBsYWluRGF0ZS5mcm9tKGRheS5kYXRlKTtcbiAgICAgICAgICAgIHdlZWtNYXBbcGxhaW5EYXRlLnRvU3RyaW5nKCldID0gZGF5O1xuICAgICAgICB9KTtcbiAgICAgICAgd2Vla3MucHVzaCh3ZWVrTWFwKTtcbiAgICB9KTtcbiAgICB3ZWVrcy5mb3JFYWNoKCh3ZWVrKSA9PiBwb3NpdGlvbkluTW9udGhXZWVrKHNvcnRlZEV2ZW50cywgd2VlaykpO1xuICAgIHJldHVybiBtb250aDtcbn07XG5cbmNvbnN0IE1vbnRoR3JpZFdyYXBwZXIgPSAoeyAkYXBwLCBpZCB9KSA9PiB7XG4gICAgY29uc3QgW21vbnRoLCBzZXRNb250aF0gPSB1c2VTdGF0ZShbXSk7XG4gICAgdXNlU2lnbmFsRWZmZWN0KCgpID0+IHtcbiAgICAgICAgJGFwcC5jYWxlbmRhckV2ZW50cy5saXN0LnZhbHVlLmZvckVhY2goKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBldmVudC5fZXZlbnRGcmFnbWVudHMgPSB7fTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IG5ld01vbnRoID0gY3JlYXRlTW9udGgoVGVtcG9yYWwuUGxhaW5EYXRlLmZyb20oJGFwcC5kYXRlUGlja2VyU3RhdGUuc2VsZWN0ZWREYXRlLnZhbHVlKSwgJGFwcC50aW1lVW5pdHNJbXBsKTtcbiAgICAgICAgbmV3TW9udGguZm9yRWFjaCgod2VlaykgPT4ge1xuICAgICAgICAgICAgd2Vlay5mb3JFYWNoKChkYXkpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBwbGFpbkRhdGUgPSBUZW1wb3JhbC5QbGFpbkRhdGUuZnJvbShkYXkuZGF0ZSk7XG4gICAgICAgICAgICAgICAgY29uc3QgcmFuZ2VTdGFydERhdGVUaW1lID0gVGVtcG9yYWwuWm9uZWREYXRlVGltZS5mcm9tKHtcbiAgICAgICAgICAgICAgICAgICAgeWVhcjogcGxhaW5EYXRlLnllYXIsXG4gICAgICAgICAgICAgICAgICAgIG1vbnRoOiBwbGFpbkRhdGUubW9udGgsXG4gICAgICAgICAgICAgICAgICAgIGRheTogcGxhaW5EYXRlLmRheSxcbiAgICAgICAgICAgICAgICAgICAgaG91cjogMCxcbiAgICAgICAgICAgICAgICAgICAgbWludXRlOiAwLFxuICAgICAgICAgICAgICAgICAgICBzZWNvbmQ6IDAsXG4gICAgICAgICAgICAgICAgICAgIHRpbWVab25lOiAkYXBwLmNvbmZpZy50aW1lem9uZS52YWx1ZSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBjb25zdCByYW5nZUVuZERhdGVUaW1lID0gVGVtcG9yYWwuWm9uZWREYXRlVGltZS5mcm9tKHtcbiAgICAgICAgICAgICAgICAgICAgeWVhcjogcGxhaW5EYXRlLnllYXIsXG4gICAgICAgICAgICAgICAgICAgIG1vbnRoOiBwbGFpbkRhdGUubW9udGgsXG4gICAgICAgICAgICAgICAgICAgIGRheTogcGxhaW5EYXRlLmRheSxcbiAgICAgICAgICAgICAgICAgICAgaG91cjogMjMsXG4gICAgICAgICAgICAgICAgICAgIG1pbnV0ZTogNTksXG4gICAgICAgICAgICAgICAgICAgIHNlY29uZDogNTksXG4gICAgICAgICAgICAgICAgICAgIHRpbWVab25lOiAkYXBwLmNvbmZpZy50aW1lem9uZS52YWx1ZSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBkYXkuYmFja2dyb3VuZEV2ZW50cyA9IGZpbHRlckJ5UmFuZ2UoJGFwcC5jYWxlbmRhckV2ZW50cy5iYWNrZ3JvdW5kRXZlbnRzLnZhbHVlLCB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0OiByYW5nZVN0YXJ0RGF0ZVRpbWUsXG4gICAgICAgICAgICAgICAgICAgIGVuZDogcmFuZ2VFbmREYXRlVGltZSxcbiAgICAgICAgICAgICAgICB9LCAkYXBwLmNvbmZpZy50aW1lem9uZS52YWx1ZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGZpbHRlcmVkRXZlbnRzID0gJGFwcC5jYWxlbmRhckV2ZW50cy5maWx0ZXJQcmVkaWNhdGUudmFsdWVcbiAgICAgICAgICAgID8gJGFwcC5jYWxlbmRhckV2ZW50cy5saXN0LnZhbHVlLmZpbHRlcigkYXBwLmNhbGVuZGFyRXZlbnRzLmZpbHRlclByZWRpY2F0ZS52YWx1ZSlcbiAgICAgICAgICAgIDogJGFwcC5jYWxlbmRhckV2ZW50cy5saXN0LnZhbHVlO1xuICAgICAgICBzZXRNb250aChwb3NpdGlvbkluTW9udGgobmV3TW9udGgsIGZpbHRlcmVkRXZlbnRzLnNvcnQoc29ydEV2ZW50c0Zvck1vbnRoR3JpZCkpKTtcbiAgICB9KTtcbiAgICByZXR1cm4gKGpzeChBcHBDb250ZXh0LlByb3ZpZGVyLCB7IHZhbHVlOiAkYXBwLCBjaGlsZHJlbjoganN4KFwiZGl2XCIsIHsgaWQ6IGlkLCBjbGFzc05hbWU6IFwic3hfX21vbnRoLWdyaWQtd3JhcHBlclwiLCBjaGlsZHJlbjogbW9udGgubWFwKCh3ZWVrLCBpbmRleCkgPT4gKGpzeChNb250aEdyaWRXZWVrLCB7IHdlZWs6IHdlZWssIGlzRmlyc3RXZWVrOiBpbmRleCA9PT0gMCwgaXNMYXN0V2VlazogaW5kZXggPT09IG1vbnRoLmxlbmd0aCAtIDEgfSwgaW5kZXgpKSkgfSkgfSkpO1xufTtcblxuY29uc3QgY29uZmlnJDIgPSB7XG4gICAgbmFtZTogSW50ZXJuYWxWaWV3TmFtZS5Nb250aEdyaWQsXG4gICAgbGFiZWw6ICdNb250aCcsXG4gICAgc2V0RGF0ZVJhbmdlOiBzZXRSYW5nZUZvck1vbnRoLFxuICAgIENvbXBvbmVudDogTW9udGhHcmlkV3JhcHBlcixcbiAgICBoYXNXaWRlU2NyZWVuQ29tcGF0OiB0cnVlLFxuICAgIGhhc1NtYWxsU2NyZWVuQ29tcGF0OiBmYWxzZSxcbiAgICBiYWNrd2FyZEZvcndhcmRGbjogYWRkTW9udGhzLFxuICAgIGJhY2t3YXJkRm9yd2FyZFVuaXRzOiAxLFxufTtcbmNvbnN0IHZpZXdNb250aEdyaWQgPSBjcmVhdGVQcmVhY3RWaWV3KGNvbmZpZyQyKTtcbmNvbnN0IGNyZWF0ZVZpZXdNb250aEdyaWQgPSAoKSA9PiBjcmVhdGVQcmVhY3RWaWV3KGNvbmZpZyQyKTtcblxuY29uc3QgY3JlYXRlQWdlbmRhTW9udGggPSAoZGF0ZSwgdGltZVVuaXRzSW1wbCkgPT4ge1xuICAgIGNvbnN0IG1vbnRoV2l0aERhdGVzID0gdGltZVVuaXRzSW1wbC5nZXRNb250aFdpdGhUcmFpbGluZ0FuZExlYWRpbmdEYXlzKGRhdGUueWVhciwgZGF0ZS5tb250aCk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgd2Vla3M6IG1vbnRoV2l0aERhdGVzLm1hcCgod2VlaykgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHdlZWsubWFwKChkYXRlKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0ZTogVGVtcG9yYWwuUGxhaW5EYXRlLmZyb20oZGF0ZSksXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50czogW10sXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KSxcbiAgICB9O1xufTtcblxuZnVuY3Rpb24gTW9udGhBZ2VuZGFEYXkoeyBkYXksIGlzQWN0aXZlLCBzZXRBY3RpdmVEYXRlLCB9KSB7XG4gICAgY29uc3QgJGFwcCA9IHVzZUNvbnRleHQoQXBwQ29udGV4dCk7XG4gICAgY29uc3QgbW9udGhTZWxlY3RlZCA9ICRhcHAuZGF0ZVBpY2tlclN0YXRlLnNlbGVjdGVkRGF0ZS52YWx1ZS5tb250aDtcbiAgICBjb25zdCBtb250aE9mRGF5ID0gZGF5LmRhdGUubW9udGg7XG4gICAgY29uc3QgZGF5Q2xhc3NlcyA9IFtcbiAgICAgICAgJ3N4X19tb250aC1hZ2VuZGEtZGF5JyxcbiAgICAgICAgZ2V0Q2xhc3NOYW1lRm9yV2Vla2RheShkYXkuZGF0ZS5kYXlPZldlZWspLFxuICAgIF07XG4gICAgaWYgKGlzQWN0aXZlKVxuICAgICAgICBkYXlDbGFzc2VzLnB1c2goJ3N4X19tb250aC1hZ2VuZGEtZGF5LS1hY3RpdmUnKTtcbiAgICBpZiAobW9udGhPZkRheSAhPT0gbW9udGhTZWxlY3RlZClcbiAgICAgICAgZGF5Q2xhc3Nlcy5wdXNoKCdpcy1sZWFkaW5nLW9yLXRyYWlsaW5nJyk7XG4gICAgY29uc3QgaGFuZGxlQ2xpY2sgPSAoZSwgY2FsbGJhY2spID0+IHtcbiAgICAgICAgc2V0QWN0aXZlRGF0ZShkYXkuZGF0ZSk7XG4gICAgICAgIGlmICghY2FsbGJhY2spXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGNhbGxiYWNrKGRheS5kYXRlLCBlKTtcbiAgICB9O1xuICAgIGNvbnN0IGhhc0ZvY3VzID0gKHdlZWtEYXkpID0+IHdlZWtEYXkuZGF0ZS50b1N0cmluZygpID09PVxuICAgICAgICAkYXBwLmRhdGVQaWNrZXJTdGF0ZS5zZWxlY3RlZERhdGUudmFsdWUudG9TdHJpbmcoKTtcbiAgICBjb25zdCBoYW5kbGVLZXlEb3duID0gKGV2ZW50KSA9PiB7XG4gICAgICAgIGNvbnN0IGtleU1hcERheXNUb0FkZCA9IG5ldyBNYXAoW1xuICAgICAgICAgICAgWydBcnJvd0Rvd24nLCA3XSxcbiAgICAgICAgICAgIFsnQXJyb3dVcCcsIC03XSxcbiAgICAgICAgICAgIFsnQXJyb3dMZWZ0JywgLTFdLFxuICAgICAgICAgICAgWydBcnJvd1JpZ2h0JywgMV0sXG4gICAgICAgIF0pO1xuICAgICAgICAkYXBwLmRhdGVQaWNrZXJTdGF0ZS5zZWxlY3RlZERhdGUudmFsdWUgPSBUZW1wb3JhbC5QbGFpbkRhdGUuZnJvbShhZGREYXlzKCRhcHAuZGF0ZVBpY2tlclN0YXRlLnNlbGVjdGVkRGF0ZS52YWx1ZSwga2V5TWFwRGF5c1RvQWRkLmdldChldmVudC5rZXkpIHx8IDApKTtcbiAgICB9O1xuICAgIGNvbnN0IGlzQmVmb3JlTWluRGF0ZSA9ICEhKCRhcHAuY29uZmlnLm1pbkRhdGUudmFsdWUgJiZcbiAgICAgICAgZGF5LmRhdGUudG9TdHJpbmcoKSA8ICRhcHAuY29uZmlnLm1pbkRhdGUudmFsdWUudG9TdHJpbmcoKSk7XG4gICAgY29uc3QgaXNQYXN0TWF4RGF0ZSA9ICEhKCRhcHAuY29uZmlnLm1heERhdGUudmFsdWUgJiZcbiAgICAgICAgZGF5LmRhdGUudG9TdHJpbmcoKSA+ICRhcHAuY29uZmlnLm1heERhdGUudmFsdWUudG9TdHJpbmcoKSk7XG4gICAgcmV0dXJuIChqc3hzKFwiYnV0dG9uXCIsIHsgdHlwZTogXCJidXR0b25cIiwgY2xhc3NOYW1lOiBgc3hfX2J1dHRvbiAke2RheUNsYXNzZXMuam9pbignICcpfWAsIG9uQ2xpY2s6IChlKSA9PiBoYW5kbGVDbGljayhlLCAkYXBwLmNvbmZpZy5jYWxsYmFja3Mub25DbGlja0FnZW5kYURhdGUpLCBvbkRibENsaWNrOiAoZSkgPT4gaGFuZGxlQ2xpY2soZSwgJGFwcC5jb25maWcuY2FsbGJhY2tzLm9uRG91YmxlQ2xpY2tBZ2VuZGFEYXRlKSwgZGlzYWJsZWQ6IGlzQmVmb3JlTWluRGF0ZSB8fCBpc1Bhc3RNYXhEYXRlLCBcImFyaWEtbGFiZWxcIjogZ2V0TG9jYWxpemVkRGF0ZSQxKGRheS5kYXRlLCAkYXBwLmNvbmZpZy5sb2NhbGUudmFsdWUpLCB0YWJJbmRleDogaGFzRm9jdXMoZGF5KSA/IDAgOiAtMSwgXCJkYXRhLWFnZW5kYS1mb2N1c1wiOiBoYXNGb2N1cyhkYXkpID8gJ3RydWUnIDogdW5kZWZpbmVkLCBvbktleURvd246IGhhbmRsZUtleURvd24sIGNoaWxkcmVuOiBbanN4KFwiZGl2XCIsIHsgY2hpbGRyZW46IGRheS5kYXRlLmRheSB9KSwganN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X19tb250aC1hZ2VuZGEtZGF5X19ldmVudC1pY29uc1wiLCBjaGlsZHJlbjogZGF5LmV2ZW50cy5zbGljZSgwLCAzKS5tYXAoKGV2ZW50KSA9PiAoanN4KFwiZGl2XCIsIHsgc3R5bGU6IHsgYmFja2dyb3VuZENvbG9yOiBgdmFyKC0tc3gtY29sb3ItJHtldmVudC5fY29sb3J9KWAgfSwgY2xhc3NOYW1lOiBcInN4X19tb250aC1hZ2VuZGEtZGF5X19ldmVudC1pY29uXCIgfSkpKSB9KV0gfSkpO1xufVxuXG5mdW5jdGlvbiBNb250aEFnZW5kYVdlZWsoeyB3ZWVrLCBzZXRBY3RpdmVEYXRlLCBhY3RpdmVEYXRlLCB9KSB7XG4gICAgY29uc3QgJGFwcCA9IHVzZUNvbnRleHQoQXBwQ29udGV4dCk7XG4gICAgcmV0dXJuIChqc3hzKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X19tb250aC1hZ2VuZGEtd2Vla1wiLCBjaGlsZHJlbjogWyRhcHAuY29uZmlnLnNob3dXZWVrTnVtYmVycy52YWx1ZSAmJiAoanN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X19tb250aC1hZ2VuZGEtd2Vla19fd2Vlay1udW1iZXJcIiwgY2hpbGRyZW46IGdldFdlZWtOdW1iZXIoVGVtcG9yYWwuUGxhaW5EYXRlLmZyb20od2Vla1swXS5kYXRlKSwgJGFwcC5jb25maWcuZmlyc3REYXlPZldlZWsudmFsdWUpIH0pKSwgd2Vlay5tYXAoKGRheSwgaW5kZXgpID0+IChqc3goTW9udGhBZ2VuZGFEYXksIHsgc2V0QWN0aXZlRGF0ZTogc2V0QWN0aXZlRGF0ZSwgZGF5OiBkYXksIGlzQWN0aXZlOiBpc1NhbWVEYXkoYWN0aXZlRGF0ZSwgZGF5LmRhdGUpIH0sIGluZGV4ICsgZGF5LmRhdGUudG9TdHJpbmcoKSkpKV0gfSkpO1xufVxuXG5mdW5jdGlvbiBNb250aEFnZW5kYURheU5hbWVzKHsgd2VlayB9KSB7XG4gICAgY29uc3QgJGFwcCA9IHVzZUNvbnRleHQoQXBwQ29udGV4dCk7XG4gICAgY29uc3QgbG9jYWxpemVkU2hvcnREYXlOYW1lcyA9IGdldE9uZUxldHRlck9yU2hvcnREYXlOYW1lcyh3ZWVrLm1hcCgoZGF5KSA9PiBkYXkuZGF0ZSksICRhcHAuY29uZmlnLmxvY2FsZS52YWx1ZSk7XG4gICAgY29uc3QgY2xhc3NOYW1lcyA9IHVzZU1lbW8oKCkgPT4ge1xuICAgICAgICBjb25zdCByZXQgPSBbJ3N4X19tb250aC1hZ2VuZGEtZGF5LW5hbWVzJ107XG4gICAgICAgIGlmICgkYXBwLmNvbmZpZy5zaG93V2Vla051bWJlcnMudmFsdWUpIHtcbiAgICAgICAgICAgIHJldC5wdXNoKCdzeF9faGFzLXdlZWstbnVtYmVycycpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXQuam9pbignICcpO1xuICAgIH0sIFskYXBwLmNvbmZpZy5zaG93V2Vla051bWJlcnMudmFsdWVdKTtcbiAgICByZXR1cm4gKGpzeChcImRpdlwiLCB7IGNsYXNzTmFtZTogY2xhc3NOYW1lcywgY2hpbGRyZW46IGxvY2FsaXplZFNob3J0RGF5TmFtZXMubWFwKChvbmVMZXR0ZXJEYXlOYW1lKSA9PiAoanN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X19tb250aC1hZ2VuZGEtZGF5LW5hbWVcIiwgY2hpbGRyZW46IG9uZUxldHRlckRheU5hbWUgfSkpKSB9KSk7XG59XG5cbmNvbnN0IGdldEFsbEV2ZW50RGF0ZXMgPSAoc3RhcnREYXRlLCBlbmREYXRlKSA9PiB7XG4gICAgbGV0IGN1cnJlbnREYXRlID0gc3RhcnREYXRlO1xuICAgIGNvbnN0IGRhdGVzID0gW2N1cnJlbnREYXRlXTtcbiAgICB3aGlsZSAoY3VycmVudERhdGUgPCBlbmREYXRlKSB7XG4gICAgICAgIGN1cnJlbnREYXRlID0gYWRkRGF5cyhUZW1wb3JhbC5QbGFpbkRhdGUuZnJvbShjdXJyZW50RGF0ZSksIDEpLnRvU3RyaW5nKCk7XG4gICAgICAgIGRhdGVzLnB1c2goY3VycmVudERhdGUpO1xuICAgIH1cbiAgICByZXR1cm4gZGF0ZXM7XG59O1xuY29uc3QgcGxhY2VFdmVudEluRGF5ID0gKGFsbERheXNNYXApID0+IChldmVudCkgPT4ge1xuICAgIGdldEFsbEV2ZW50RGF0ZXMoZGF0ZUZyb21EYXRlVGltZShldmVudC5zdGFydC50b1N0cmluZygpKSwgZGF0ZUZyb21EYXRlVGltZShldmVudC5lbmQudG9TdHJpbmcoKSkpLmZvckVhY2goKGRhdGUpID0+IHtcbiAgICAgICAgaWYgKGFsbERheXNNYXBbZGF0ZV0pIHtcbiAgICAgICAgICAgIGFsbERheXNNYXBbZGF0ZV0uZXZlbnRzLnB1c2goZXZlbnQpO1xuICAgICAgICB9XG4gICAgfSk7XG59O1xuY29uc3QgcG9zaXRpb25FdmVudHNJbkFnZW5kYSA9IChhZ2VuZGFNb250aCwgZXZlbnRzU29ydGVkQnlTdGFydCkgPT4ge1xuICAgIGNvbnN0IGFsbERheXNNYXAgPSBhZ2VuZGFNb250aC53ZWVrcy5yZWR1Y2UoKGFjYywgd2VlaykgPT4ge1xuICAgICAgICB3ZWVrLmZvckVhY2goKGRheSkgPT4ge1xuICAgICAgICAgICAgYWNjW2RheS5kYXRlLnRvU3RyaW5nKCldID0gZGF5O1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGFjYztcbiAgICB9LCB7fSk7XG4gICAgZXZlbnRzU29ydGVkQnlTdGFydC5mb3JFYWNoKHBsYWNlRXZlbnRJbkRheShhbGxEYXlzTWFwKSk7XG4gICAgcmV0dXJuIGFnZW5kYU1vbnRoO1xufTtcblxuZnVuY3Rpb24gTW9udGhBZ2VuZGFFdmVudCh7IGNhbGVuZGFyRXZlbnQgfSkge1xuICAgIHZhciBfYSwgX2I7XG4gICAgY29uc3QgJGFwcCA9IHVzZUNvbnRleHQoQXBwQ29udGV4dCk7XG4gICAgY29uc3QgeyBzZXRDbGlja2VkRXZlbnQgfSA9IHVzZUV2ZW50SW50ZXJhY3Rpb25zKCRhcHApO1xuICAgIGNvbnN0IGV2ZW50Q1NTVmFyaWFibGVzID0ge1xuICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IGB2YXIoLS1zeC1jb2xvci0ke2NhbGVuZGFyRXZlbnQuX2NvbG9yfS1jb250YWluZXIpYCxcbiAgICAgICAgY29sb3I6IGB2YXIoLS1zeC1jb2xvci1vbi0ke2NhbGVuZGFyRXZlbnQuX2NvbG9yfS1jb250YWluZXIpYCxcbiAgICAgICAgYm9yZGVySW5saW5lU3RhcnQ6IGA0cHggc29saWQgdmFyKC0tc3gtY29sb3ItJHtjYWxlbmRhckV2ZW50Ll9jb2xvcn0pYCxcbiAgICB9O1xuICAgIGNvbnN0IGN1c3RvbUNvbXBvbmVudCA9ICRhcHAuY29uZmlnLl9jdXN0b21Db21wb25lbnRGbnMubW9udGhBZ2VuZGFFdmVudDtcbiAgICBjb25zdCBjdXN0b21Db21wb25lbnRJZCA9IHVzZVJlZiQxKGN1c3RvbUNvbXBvbmVudFxuICAgICAgICA/ICdjdXN0b20tbW9udGgtYWdlbmRhLWV2ZW50LScgKyByYW5kb21TdHJpbmdJZCgpXG4gICAgICAgIDogdW5kZWZpbmVkKTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAoIWN1c3RvbUNvbXBvbmVudClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgY3VzdG9tQ29tcG9uZW50KGdldEVsZW1lbnRCeUNDSUQoY3VzdG9tQ29tcG9uZW50SWQuY3VycmVudCksIHtcbiAgICAgICAgICAgIGNhbGVuZGFyRXZlbnQ6IGNhbGVuZGFyRXZlbnQuX2dldEV4dGVybmFsRXZlbnQoKSxcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICAgICAgKF9iID0gKF9hID0gJGFwcC5jb25maWcpLl9kZXN0cm95Q3VzdG9tQ29tcG9uZW50SW5zdGFuY2UpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5jYWxsKF9hLCBjdXN0b21Db21wb25lbnRJZC5jdXJyZW50KTtcbiAgICAgICAgfTtcbiAgICB9LCBbY2FsZW5kYXJFdmVudF0pO1xuICAgIGNvbnN0IG9uQ2xpY2sgPSAoZSkgPT4ge1xuICAgICAgICBzZXRDbGlja2VkRXZlbnQoZSwgY2FsZW5kYXJFdmVudCk7XG4gICAgICAgIGludm9rZU9uRXZlbnRDbGlja0NhbGxiYWNrKCRhcHAsIGNhbGVuZGFyRXZlbnQsIGUpO1xuICAgIH07XG4gICAgY29uc3Qgb25Eb3VibGVDbGljayA9IChlKSA9PiB7XG4gICAgICAgIHNldENsaWNrZWRFdmVudChlLCBjYWxlbmRhckV2ZW50KTtcbiAgICAgICAgaW52b2tlT25FdmVudERvdWJsZUNsaWNrQ2FsbGJhY2soJGFwcCwgY2FsZW5kYXJFdmVudCwgZSk7XG4gICAgfTtcbiAgICBjb25zdCBvbktleURvd24gPSAoZSkgPT4ge1xuICAgICAgICBpZiAoZS5rZXkgPT09ICdFbnRlcicgfHwgZS5rZXkgPT09ICcgJykge1xuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgIHNldENsaWNrZWRFdmVudChlLCBjYWxlbmRhckV2ZW50KTtcbiAgICAgICAgICAgIGludm9rZU9uRXZlbnRDbGlja0NhbGxiYWNrKCRhcHAsIGNhbGVuZGFyRXZlbnQsIGUpO1xuICAgICAgICAgICAgbmV4dFRpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgIGZvY3VzTW9kYWwoJGFwcCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3QgaGFzQ3VzdG9tQ29udGVudCA9IChfYSA9IGNhbGVuZGFyRXZlbnQuX2N1c3RvbUNvbnRlbnQpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5tb250aEFnZW5kYTtcbiAgICBjb25zdCBjbGFzc05hbWVzID0gWydzeF9fZXZlbnQnLCAnc3hfX21vbnRoLWFnZW5kYS1ldmVudCddO1xuICAgIGlmICh3YXNFdmVudEFkZGVkSW5MYXN0U2Vjb25kKGNhbGVuZGFyRXZlbnQpKVxuICAgICAgICBjbGFzc05hbWVzLnB1c2goJ2lzLWV2ZW50LW5ldycpO1xuICAgIHJldHVybiAoanN4cyhcImRpdlwiLCB7IGNsYXNzTmFtZTogY2xhc3NOYW1lcy5qb2luKCcgJyksIFwiZGF0YS1jY2lkXCI6IGN1c3RvbUNvbXBvbmVudElkLmN1cnJlbnQsIFwiZGF0YS1ldmVudC1pZFwiOiBjYWxlbmRhckV2ZW50LmlkLCBzdHlsZToge1xuICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiBjdXN0b21Db21wb25lbnRcbiAgICAgICAgICAgICAgICA/IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgIDogZXZlbnRDU1NWYXJpYWJsZXMuYmFja2dyb3VuZENvbG9yLFxuICAgICAgICAgICAgY29sb3I6IGN1c3RvbUNvbXBvbmVudCA/IHVuZGVmaW5lZCA6IGV2ZW50Q1NTVmFyaWFibGVzLmNvbG9yLFxuICAgICAgICAgICAgYm9yZGVySW5saW5lU3RhcnQ6IGN1c3RvbUNvbXBvbmVudFxuICAgICAgICAgICAgICAgID8gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgOiBldmVudENTU1ZhcmlhYmxlcy5ib3JkZXJJbmxpbmVTdGFydCxcbiAgICAgICAgICAgIHBhZGRpbmc6IGN1c3RvbUNvbXBvbmVudCA/ICcwcHgnIDogdW5kZWZpbmVkLFxuICAgICAgICB9LCBvbkNsaWNrOiAoZSkgPT4gb25DbGljayhlKSwgb25EYmxDbGljazogKGUpID0+IG9uRG91YmxlQ2xpY2soZSksIG9uS2V5RG93bjogb25LZXlEb3duLCB0YWJJbmRleDogMCwgcm9sZTogXCJidXR0b25cIiwgY2hpbGRyZW46IFshY3VzdG9tQ29tcG9uZW50ICYmICFoYXNDdXN0b21Db250ZW50ICYmIChqc3hzKEZyYWdtZW50JDEsIHsgY2hpbGRyZW46IFtqc3goXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic3hfX21vbnRoLWFnZW5kYS1ldmVudF9fdGl0bGVcIiwgY2hpbGRyZW46IGNhbGVuZGFyRXZlbnQudGl0bGUgfSksIGpzeHMoXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic3hfX21vbnRoLWFnZW5kYS1ldmVudF9fdGltZSBzeF9fbW9udGgtYWdlbmRhLWV2ZW50X19oYXMtaWNvblwiLCBjaGlsZHJlbjogW2pzeChUaW1lSWNvbiwgeyBzdHJva2VDb2xvcjogYHZhcigtLXN4LWNvbG9yLW9uLSR7Y2FsZW5kYXJFdmVudC5fY29sb3J9LWNvbnRhaW5lcilgIH0pLCBqc3goXCJkaXZcIiwgeyBkYW5nZXJvdXNseVNldElubmVySFRNTDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX19odG1sOiBnZXRUaW1lU3RhbXAoY2FsZW5kYXJFdmVudCwgJGFwcC5jb25maWcubG9jYWxlLnZhbHVlKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSB9KV0gfSldIH0pKSwgaGFzQ3VzdG9tQ29udGVudCAmJiAoanN4KFwiZGl2XCIsIHsgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw6IHtcbiAgICAgICAgICAgICAgICAgICAgX19odG1sOiAoKF9iID0gY2FsZW5kYXJFdmVudC5fY3VzdG9tQ29udGVudCkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLm1vbnRoQWdlbmRhKSB8fCAnJyxcbiAgICAgICAgICAgICAgICB9IH0pKV0gfSkpO1xufVxuXG5mdW5jdGlvbiBNb250aEFnZW5kYUV2ZW50cyh7IGV2ZW50cyB9KSB7XG4gICAgY29uc3QgJGFwcCA9IHVzZUNvbnRleHQoQXBwQ29udGV4dCk7XG4gICAgcmV0dXJuIChqc3goXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic3hfX21vbnRoLWFnZW5kYS1ldmVudHNcIiwgY2hpbGRyZW46IGV2ZW50cy5sZW5ndGggPyAoZXZlbnRzLm1hcCgoZXZlbnQpID0+IChqc3goTW9udGhBZ2VuZGFFdmVudCwgeyBjYWxlbmRhckV2ZW50OiBldmVudCB9LCBldmVudC5pZCkpKSkgOiAoanN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X19tb250aC1hZ2VuZGEtZXZlbnRzX19lbXB0eVwiLCBjaGlsZHJlbjogJGFwcC50cmFuc2xhdGUoJ05vIGV2ZW50cycpIH0pKSB9KSk7XG59XG5cbmNvbnN0IE1vbnRoQWdlbmRhV3JhcHBlciA9ICh7ICRhcHAsIGlkIH0pID0+IHtcbiAgICB2YXIgX2E7XG4gICAgY29uc3QgZ2V0TW9udGggPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGZpbHRlcmVkRXZlbnRzID0gJGFwcC5jYWxlbmRhckV2ZW50cy5maWx0ZXJQcmVkaWNhdGUudmFsdWVcbiAgICAgICAgICAgID8gJGFwcC5jYWxlbmRhckV2ZW50cy5saXN0LnZhbHVlLmZpbHRlcigkYXBwLmNhbGVuZGFyRXZlbnRzLmZpbHRlclByZWRpY2F0ZS52YWx1ZSlcbiAgICAgICAgICAgIDogJGFwcC5jYWxlbmRhckV2ZW50cy5saXN0LnZhbHVlO1xuICAgICAgICByZXR1cm4gcG9zaXRpb25FdmVudHNJbkFnZW5kYShjcmVhdGVBZ2VuZGFNb250aCgkYXBwLmRhdGVQaWNrZXJTdGF0ZS5zZWxlY3RlZERhdGUudmFsdWUudG9ab25lZERhdGVUaW1lKCRhcHAuY29uZmlnLnRpbWV6b25lLnZhbHVlKSwgJGFwcC50aW1lVW5pdHNJbXBsKSwgZmlsdGVyZWRFdmVudHMuc29ydChzb3J0RXZlbnRzQnlTdGFydEFuZEVuZCkpO1xuICAgIH07XG4gICAgY29uc3QgW2FnZW5kYU1vbnRoLCBzZXRBZ2VuZGFNb250aF0gPSB1c2VTdGF0ZShnZXRNb250aCgpKTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBzZXRBZ2VuZGFNb250aChnZXRNb250aCgpKTtcbiAgICB9LCBbXG4gICAgICAgICRhcHAuZGF0ZVBpY2tlclN0YXRlLnNlbGVjdGVkRGF0ZS52YWx1ZSxcbiAgICAgICAgJGFwcC5jYWxlbmRhckV2ZW50cy5saXN0LnZhbHVlLFxuICAgICAgICAkYXBwLmNhbGVuZGFyRXZlbnRzLmZpbHRlclByZWRpY2F0ZS52YWx1ZSxcbiAgICBdKTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBjb25zdCBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKChtdXRhdGlvbnMpID0+IHtcbiAgICAgICAgICAgIG11dGF0aW9ucy5mb3JFYWNoKChtdXRhdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IG11dGF0ZWRFbGVtZW50ID0gbXV0YXRpb24udGFyZ2V0O1xuICAgICAgICAgICAgICAgIGlmIChtdXRhdGVkRWxlbWVudC5kYXRhc2V0LmFnZW5kYUZvY3VzID09PSAndHJ1ZScpXG4gICAgICAgICAgICAgICAgICAgIG11dGF0ZWRFbGVtZW50LmZvY3VzKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IG1vbnRoVmlld0VsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XG4gICAgICAgIG9ic2VydmVyLm9ic2VydmUobW9udGhWaWV3RWxlbWVudCwge1xuICAgICAgICAgICAgY2hpbGRMaXN0OiB0cnVlLFxuICAgICAgICAgICAgc3VidHJlZTogdHJ1ZSxcbiAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHRydWUsXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gKCkgPT4gb2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICAgIH0sIFtdKTtcbiAgICByZXR1cm4gKGpzeChBcHBDb250ZXh0LlByb3ZpZGVyLCB7IHZhbHVlOiAkYXBwLCBjaGlsZHJlbjoganN4cyhcImRpdlwiLCB7IGlkOiBpZCwgY2xhc3NOYW1lOiBcInN4X19tb250aC1hZ2VuZGEtd3JhcHBlclwiLCBjaGlsZHJlbjogW2pzeChNb250aEFnZW5kYURheU5hbWVzLCB7IHdlZWs6IGFnZW5kYU1vbnRoLndlZWtzWzBdIH0pLCBqc3goXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic3hfX21vbnRoLWFnZW5kYS13ZWVrc1wiLCBjaGlsZHJlbjogYWdlbmRhTW9udGgud2Vla3MubWFwKCh3ZWVrLCBpbmRleCkgPT4gKGpzeChNb250aEFnZW5kYVdlZWssIHsgd2Vlazogd2Vlaywgc2V0QWN0aXZlRGF0ZTogKGRhdGUpID0+ICgkYXBwLmRhdGVQaWNrZXJTdGF0ZS5zZWxlY3RlZERhdGUudmFsdWUgPSBkYXRlKSwgYWN0aXZlRGF0ZTogJGFwcC5kYXRlUGlja2VyU3RhdGUuc2VsZWN0ZWREYXRlLnZhbHVlIH0sIGluZGV4KSkpIH0pLCBqc3goTW9udGhBZ2VuZGFFdmVudHMsIHsgZXZlbnRzOiAoKF9hID0gYWdlbmRhTW9udGgud2Vla3NcbiAgICAgICAgICAgICAgICAgICAgICAgIC5mbGF0KClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kKChkYXkpID0+IGlzU2FtZURheShkYXkuZGF0ZSwgJGFwcC5kYXRlUGlja2VyU3RhdGUuc2VsZWN0ZWREYXRlLnZhbHVlKSkpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5ldmVudHMpIHx8IFtdIH0sICRhcHAuZGF0ZVBpY2tlclN0YXRlLnNlbGVjdGVkRGF0ZS52YWx1ZSldIH0pIH0pKTtcbn07XG5cbmNvbnN0IGNvbmZpZyQxID0ge1xuICAgIG5hbWU6IEludGVybmFsVmlld05hbWUuTW9udGhBZ2VuZGEsXG4gICAgbGFiZWw6ICdNb250aCcsXG4gICAgc2V0RGF0ZVJhbmdlOiBzZXRSYW5nZUZvck1vbnRoLFxuICAgIENvbXBvbmVudDogTW9udGhBZ2VuZGFXcmFwcGVyLFxuICAgIGhhc1NtYWxsU2NyZWVuQ29tcGF0OiB0cnVlLFxuICAgIGhhc1dpZGVTY3JlZW5Db21wYXQ6IGZhbHNlLFxuICAgIGJhY2t3YXJkRm9yd2FyZEZuOiBhZGRNb250aHMsXG4gICAgYmFja3dhcmRGb3J3YXJkVW5pdHM6IDEsXG59O1xuY29uc3Qgdmlld01vbnRoQWdlbmRhID0gY3JlYXRlUHJlYWN0Vmlldyhjb25maWckMSk7XG5jb25zdCBjcmVhdGVWaWV3TW9udGhBZ2VuZGEgPSAoKSA9PiBjcmVhdGVQcmVhY3RWaWV3KGNvbmZpZyQxKTtcblxuY29uc3Qgc2Nyb2xsT25EYXRlU2VsZWN0aW9uID0gKCRhcHAsIHdyYXBwZXJSZWYpID0+IHtcbiAgICBpZiAoIXdyYXBwZXJSZWYuY3VycmVudClcbiAgICAgICAgcmV0dXJuO1xuICAgIGNvbnN0IHNlbGVjdGVkRGF0ZSA9ICRhcHAuZGF0ZVBpY2tlclN0YXRlLnNlbGVjdGVkRGF0ZS52YWx1ZTtcbiAgICBjb25zdCBzZWxlY3RlZERheUVsZW1lbnQgPSB3cmFwcGVyUmVmLmN1cnJlbnQucXVlcnlTZWxlY3RvcihgLnN4X19saXN0LWRheVtkYXRhLWRhdGU9XCIke3NlbGVjdGVkRGF0ZX1cIl1gKTtcbiAgICBpZiAoc2VsZWN0ZWREYXlFbGVtZW50IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcbiAgICAgICAgICAgIHNlbGVjdGVkRGF5RWxlbWVudC5zY3JvbGxJbnRvVmlldyh7XG4gICAgICAgICAgICAgICAgYmVoYXZpb3I6ICdpbnN0YW50JyxcbiAgICAgICAgICAgICAgICBibG9jazogJ3N0YXJ0JyxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG59O1xuXG5jb25zdCBMaXN0V3JhcHBlciA9ICh7ICRhcHAsIGlkLCB9KSA9PiB7XG4gICAgY29uc3QgW2RheXNXaXRoRXZlbnRzLCBzZXREYXlzV2l0aEV2ZW50c10gPSB1c2VTdGF0ZShbXSk7XG4gICAgY29uc3Qgd3JhcHBlclJlZiA9IHVzZVJlZiQxKG51bGwpO1xuICAgIGNvbnN0IHsgc2V0Q2xpY2tlZEV2ZW50IH0gPSB1c2VFdmVudEludGVyYWN0aW9ucygkYXBwKTtcbiAgICAvKipcbiAgICAgKiBcImhhY2tcIiBmb3IgcHJldmVudGluZyB0aGUgb25TY3JvbGxEYXlJbnRvVmlldyBjYWxsYmFjayBmcm9tIGJlaW5nIGNhbGxlZCBqdXN0IGFmdGVyIGV2ZW50cyBoYXZlIGNoYW5nZWRcbiAgICAgKiBhbnkgaWRlYXMgZm9yIGhvdyB0byBpbXByb3ZlIHRoaXMgYXJlIHdlbGNvbWVcbiAgICAgKiAqL1xuICAgIGNvbnN0IGJsb2NrT25TY3JvbGxEYXlJbnRvVmlld0NhbGxiYWNrID0gdXNlUmVmJDEoZmFsc2UpO1xuICAgIGNvbnN0IGJsb2NrVGltZW91dFJlZiA9IHVzZVJlZiQxKG51bGwpO1xuICAgIGNvbnN0IG1pbkRhdGUgPSAkYXBwLmNvbmZpZy5taW5EYXRlLnZhbHVlXG4gICAgICAgID8gZGF0ZUZyb21EYXRlVGltZSgkYXBwLmNvbmZpZy5taW5EYXRlLnZhbHVlLnRvU3RyaW5nKCkpXG4gICAgICAgIDogbnVsbDtcbiAgICBjb25zdCBtYXhEYXRlID0gJGFwcC5jb25maWcubWF4RGF0ZS52YWx1ZVxuICAgICAgICA/IGRhdGVGcm9tRGF0ZVRpbWUoJGFwcC5jb25maWcubWF4RGF0ZS52YWx1ZS50b1N0cmluZygpKVxuICAgICAgICA6IG51bGw7XG4gICAgY29uc3QgdXBkYXRlRGF5c1dpdGhFdmVudHMgPSAoZXZlbnRzKSA9PiB7XG4gICAgICAgIGNvbnN0IGRheXNXaXRoRXZlbnRzTWFwID0gZXZlbnRzLnJlZHVjZSgoYWNjLCBldmVudCkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc3RhcnREYXRlID0gZGF0ZUZyb21EYXRlVGltZShldmVudC5zdGFydC50b1N0cmluZygpKTtcbiAgICAgICAgICAgIGNvbnN0IGVuZERhdGUgPSBkYXRlRnJvbURhdGVUaW1lKGV2ZW50LmVuZC50b1N0cmluZygpKTtcbiAgICAgICAgICAgIGxldCBjdXJyZW50RGF0ZSA9IHN0YXJ0RGF0ZTtcbiAgICAgICAgICAgIHdoaWxlIChjdXJyZW50RGF0ZSA8PSBlbmREYXRlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFhY2NbY3VycmVudERhdGVdKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjY1tjdXJyZW50RGF0ZV0gPSBbXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYWNjW2N1cnJlbnREYXRlXS5wdXNoKGV2ZW50KTtcbiAgICAgICAgICAgICAgICBjdXJyZW50RGF0ZSA9IGFkZERheXMoVGVtcG9yYWwuUGxhaW5EYXRlLmZyb20oY3VycmVudERhdGUpLCAxKS50b1N0cmluZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgfSwge30pO1xuICAgICAgICBjb25zdCBzb3J0ZWREYXlzID0gT2JqZWN0LmVudHJpZXMoZGF5c1dpdGhFdmVudHNNYXApXG4gICAgICAgICAgICAubWFwKChbZGF0ZSwgZXZlbnRzXSkgPT4gKHtcbiAgICAgICAgICAgIGRhdGUsXG4gICAgICAgICAgICBldmVudHM6IGV2ZW50cy5zb3J0KChhLCBiKSA9PiBhLnN0YXJ0LnRvU3RyaW5nKCkubG9jYWxlQ29tcGFyZShiLnN0YXJ0LnRvU3RyaW5nKCkpKSxcbiAgICAgICAgfSkpXG4gICAgICAgICAgICAuc29ydCgoYSwgYikgPT4gYS5kYXRlLmxvY2FsZUNvbXBhcmUoYi5kYXRlKSk7XG4gICAgICAgIHNldERheXNXaXRoRXZlbnRzKHNvcnRlZERheXMpO1xuICAgICAgICBpZiAoYmxvY2tUaW1lb3V0UmVmLmN1cnJlbnQpIHtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dChibG9ja1RpbWVvdXRSZWYuY3VycmVudCk7XG4gICAgICAgIH1cbiAgICAgICAgYmxvY2tUaW1lb3V0UmVmLmN1cnJlbnQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGJsb2NrT25TY3JvbGxEYXlJbnRvVmlld0NhbGxiYWNrLmN1cnJlbnQgPSBmYWxzZTtcbiAgICAgICAgICAgIGJsb2NrVGltZW91dFJlZi5jdXJyZW50ID0gbnVsbDtcbiAgICAgICAgfSwgMTAwKTtcbiAgICB9O1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBvblNjcm9sbERheUludG9WaWV3IGNhbiBuZXZlciBiZSBhbGxvd2VkIHRvIGJlIGNhbGxlZCBhcyBhIHNpZGUgZWZmZWN0IG9mIGV2ZW50cyBjaGFuZ2luZy5cbiAgICAgICAgICogT3RoZXJ3aXNlLCBpbXBsZW1lbnRlcnMgd2lsbCBoYXZlIHRvIHdyaXRlIGN1c3RvbSBsb2dpYyB0byBwcmV2ZW50IGluZmluaXRlIHJlY3Vyc2lvbi5cbiAgICAgICAgICpcbiAgICAgICAgICogT3BlbiB0byBhbnkgaWRlYXMgZm9yIGhvdyB0byBpbXByb3ZlIHRoaXMgYW5kIG1ha2UgZG8gd2l0aG91dCBhIHRpbWVvdXQuXG4gICAgICAgICAqICovXG4gICAgICAgIGNvbnN0IGZpbHRlcmVkRXZlbnRzID0gJGFwcC5jYWxlbmRhckV2ZW50cy5saXN0LnZhbHVlLmZpbHRlcigoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IGRhdGVGcm9tRGF0ZVRpbWUoZXZlbnQuc3RhcnQudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICBjb25zdCBlbmREYXRlID0gZGF0ZUZyb21EYXRlVGltZShldmVudC5lbmQudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICBpZiAobWluRGF0ZSAmJiBlbmREYXRlIDwgbWluRGF0ZSlcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICBpZiAobWF4RGF0ZSAmJiBzdGFydERhdGUgPiBtYXhEYXRlKVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcbiAgICAgICAgYmxvY2tPblNjcm9sbERheUludG9WaWV3Q2FsbGJhY2suY3VycmVudCA9IHRydWU7XG4gICAgICAgIHVwZGF0ZURheXNXaXRoRXZlbnRzKGZpbHRlcmVkRXZlbnRzKTtcbiAgICB9LCBbJGFwcC5jYWxlbmRhckV2ZW50cy5saXN0LnZhbHVlXSk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgY29uc3QgaGFuZGxlU2Nyb2xsID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKGJsb2NrVGltZW91dFJlZi5jdXJyZW50KSB7XG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KGJsb2NrVGltZW91dFJlZi5jdXJyZW50KTtcbiAgICAgICAgICAgICAgICBibG9ja1RpbWVvdXRSZWYuY3VycmVudCA9IG51bGw7XG4gICAgICAgICAgICAgICAgYmxvY2tPblNjcm9sbERheUludG9WaWV3Q2FsbGJhY2suY3VycmVudCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBjb25zdCB3cmFwcGVyID0gd3JhcHBlclJlZi5jdXJyZW50O1xuICAgICAgICBpZiAod3JhcHBlcikge1xuICAgICAgICAgICAgd3JhcHBlci5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBoYW5kbGVTY3JvbGwpO1xuICAgICAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgICAgICB3cmFwcGVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIGhhbmRsZVNjcm9sbCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSwgW10pO1xuICAgIGNvbnN0IFtpbnRlclNlY3Rpb25PYnNlcnZlciwgc2V0SW50ZXJzZWN0aW9uT2JzZXJ2ZXJdID0gdXNlU3RhdGUobnVsbCk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKCF3cmFwcGVyUmVmLmN1cnJlbnQgfHwgISRhcHAuY29uZmlnLmNhbGxiYWNrcy5vblNjcm9sbERheUludG9WaWV3KVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBjb25zdCBfb2JzZXJ2ZXIgPSBpbnRlclNlY3Rpb25PYnNlcnZlciB8fFxuICAgICAgICAgICAgbmV3IEludGVyc2VjdGlvbk9ic2VydmVyKChlbnRyaWVzKSA9PiB7XG4gICAgICAgICAgICAgICAgZW50cmllcy5mb3JFYWNoKChlbnRyeSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZW50cnkuaXNJbnRlcnNlY3RpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGUgPSBlbnRyeS50YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLWRhdGUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRlICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGFwcC5jb25maWcuY2FsbGJhY2tzLm9uU2Nyb2xsRGF5SW50b1ZpZXcgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhYmxvY2tPblNjcm9sbERheUludG9WaWV3Q2FsbGJhY2suY3VycmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRhcHAuY29uZmlnLmNhbGxiYWNrcy5vblNjcm9sbERheUludG9WaWV3KFRlbXBvcmFsLlBsYWluRGF0ZS5mcm9tKGRhdGUpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIHJvb3Q6IHdyYXBwZXJSZWYuY3VycmVudCxcbiAgICAgICAgICAgICAgICByb290TWFyZ2luOiAnMHB4JyxcbiAgICAgICAgICAgICAgICB0aHJlc2hvbGQ6IDAuMSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICBjb25zdCBkYXlFbGVtZW50cyA9IHdyYXBwZXJSZWYuY3VycmVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc3hfX2xpc3QtZGF5Jyk7XG4gICAgICAgIGRheUVsZW1lbnRzLmZvckVhY2goKGRheUVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgIF9vYnNlcnZlci5vYnNlcnZlKGRheUVsZW1lbnQpO1xuICAgICAgICB9KTtcbiAgICAgICAgc2V0SW50ZXJzZWN0aW9uT2JzZXJ2ZXIoX29ic2VydmVyKTtcbiAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgIF9vYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gICAgICAgIH07XG4gICAgfSwgW2RheXNXaXRoRXZlbnRzXSk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgc2Nyb2xsT25EYXRlU2VsZWN0aW9uKCRhcHAsIHdyYXBwZXJSZWYpO1xuICAgIH0sIFtkYXlzV2l0aEV2ZW50cywgJGFwcC5kYXRlUGlja2VyU3RhdGUuc2VsZWN0ZWREYXRlLnZhbHVlXSk7XG4gICAgY29uc3QgcmVuZGVyRXZlbnRUaW1lcyA9IChldmVudCwgZGF5RGF0ZSkgPT4ge1xuICAgICAgICBjb25zdCBldmVudFN0YXJ0RGF0ZSA9IGRhdGVGcm9tRGF0ZVRpbWUoZXZlbnQuc3RhcnQudG9TdHJpbmcoKSk7XG4gICAgICAgIGNvbnN0IGV2ZW50RW5kRGF0ZSA9IGRhdGVGcm9tRGF0ZVRpbWUoZXZlbnQuZW5kLnRvU3RyaW5nKCkpO1xuICAgICAgICBjb25zdCBpc0ZpcnN0RGF5ID0gZXZlbnRTdGFydERhdGUgPT09IGRheURhdGU7XG4gICAgICAgIGNvbnN0IGlzTGFzdERheSA9IGV2ZW50RW5kRGF0ZSA9PT0gZGF5RGF0ZTtcbiAgICAgICAgY29uc3QgaXNNdWx0aURheSA9IGV2ZW50U3RhcnREYXRlICE9PSBldmVudEVuZERhdGU7XG4gICAgICAgIGNvbnN0IHRpbWVPcHRpb25zID0ge1xuICAgICAgICAgICAgaG91cjogJ251bWVyaWMnLFxuICAgICAgICAgICAgbWludXRlOiAnbnVtZXJpYycsXG4gICAgICAgICAgICBob3VyMTI6ICRhcHAuY29uZmlnLmxvY2FsZS52YWx1ZSA9PT0gJ2VuLVVTJyxcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3Qgc3RhcnRaRFQgPSBUZW1wb3JhbC5ab25lZERhdGVUaW1lLmZyb20oe1xuICAgICAgICAgICAgeWVhcjogZXZlbnQuc3RhcnQueWVhcixcbiAgICAgICAgICAgIG1vbnRoOiBldmVudC5zdGFydC5tb250aCxcbiAgICAgICAgICAgIGRheTogZXZlbnQuc3RhcnQuZGF5LFxuICAgICAgICAgICAgaG91cjogZXZlbnQuc3RhcnQgaW5zdGFuY2VvZiBUZW1wb3JhbC5ab25lZERhdGVUaW1lID8gZXZlbnQuc3RhcnQuaG91ciA6IDAsXG4gICAgICAgICAgICBtaW51dGU6IGV2ZW50LnN0YXJ0IGluc3RhbmNlb2YgVGVtcG9yYWwuWm9uZWREYXRlVGltZSA/IGV2ZW50LnN0YXJ0Lm1pbnV0ZSA6IDAsXG4gICAgICAgICAgICB0aW1lWm9uZTogJGFwcC5jb25maWcudGltZXpvbmUudmFsdWUsXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBlbmRaRFQgPSBUZW1wb3JhbC5ab25lZERhdGVUaW1lLmZyb20oe1xuICAgICAgICAgICAgeWVhcjogZXZlbnQuZW5kLnllYXIsXG4gICAgICAgICAgICBtb250aDogZXZlbnQuZW5kLm1vbnRoLFxuICAgICAgICAgICAgZGF5OiBldmVudC5lbmQuZGF5LFxuICAgICAgICAgICAgaG91cjogZXZlbnQuZW5kIGluc3RhbmNlb2YgVGVtcG9yYWwuWm9uZWREYXRlVGltZSA/IGV2ZW50LmVuZC5ob3VyIDogMCxcbiAgICAgICAgICAgIG1pbnV0ZTogZXZlbnQuZW5kIGluc3RhbmNlb2YgVGVtcG9yYWwuWm9uZWREYXRlVGltZSA/IGV2ZW50LmVuZC5taW51dGUgOiAwLFxuICAgICAgICAgICAgdGltZVpvbmU6ICRhcHAuY29uZmlnLnRpbWV6b25lLnZhbHVlLFxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKCFpc011bHRpRGF5KSB7XG4gICAgICAgICAgICByZXR1cm4gKGpzeHMoRnJhZ21lbnQsIHsgY2hpbGRyZW46IFtqc3goXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic3hfX2xpc3QtZXZlbnQtc3RhcnQtdGltZVwiLCBjaGlsZHJlbjogc3RhcnRaRFQudG9Mb2NhbGVTdHJpbmcoJGFwcC5jb25maWcubG9jYWxlLnZhbHVlLCB0aW1lT3B0aW9ucykgfSksIGV2ZW50LmVuZCAmJiAoanN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X19saXN0LWV2ZW50LWVuZC10aW1lXCIsIGNoaWxkcmVuOiBlbmRaRFQudG9Mb2NhbGVTdHJpbmcoJGFwcC5jb25maWcubG9jYWxlLnZhbHVlLCB0aW1lT3B0aW9ucykgfSkpXSB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzRmlyc3REYXkpIHtcbiAgICAgICAgICAgIHJldHVybiAoanN4cyhGcmFnbWVudCwgeyBjaGlsZHJlbjogW2pzeChcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJzeF9fbGlzdC1ldmVudC1zdGFydC10aW1lXCIsIGNoaWxkcmVuOiBzdGFydFpEVC50b0xvY2FsZVN0cmluZygkYXBwLmNvbmZpZy5sb2NhbGUudmFsdWUsIHRpbWVPcHRpb25zKSB9KSwganN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X19saXN0LWV2ZW50LWFycm93XCIsIGNoaWxkcmVuOiBcIlxcdTIxOTJcIiB9KV0gfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc0xhc3REYXkpIHtcbiAgICAgICAgICAgIHJldHVybiAoanN4cyhGcmFnbWVudCwgeyBjaGlsZHJlbjogW2pzeChcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJzeF9fbGlzdC1ldmVudC1hcnJvd1wiLCBjaGlsZHJlbjogXCJcXHUyMTkwXCIgfSksIGpzeChcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJzeF9fbGlzdC1ldmVudC1lbmQtdGltZVwiLCBjaGlsZHJlbjogZW5kWkRULnRvTG9jYWxlU3RyaW5nKCRhcHAuY29uZmlnLmxvY2FsZS52YWx1ZSwgdGltZU9wdGlvbnMpIH0pXSB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGpzeChcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJzeF9fbGlzdC1ldmVudC1hcnJvd1wiLCBjaGlsZHJlbjogXCJcXHUyMTk0XCIgfSk7XG4gICAgfTtcbiAgICBjb25zdCBoYW5kbGVFdmVudENsaWNrID0gKGUsIGV2ZW50KSA9PiB7XG4gICAgICAgIHNldENsaWNrZWRFdmVudChlLCBldmVudCk7XG4gICAgICAgIGludm9rZU9uRXZlbnRDbGlja0NhbGxiYWNrKCRhcHAsIGV2ZW50LCBlKTtcbiAgICB9O1xuICAgIGNvbnN0IGhhbmRsZUV2ZW50RG91YmxlQ2xpY2sgPSAoZSwgZXZlbnQpID0+IHtcbiAgICAgICAgc2V0Q2xpY2tlZEV2ZW50KGUsIGV2ZW50KTtcbiAgICAgICAgaW52b2tlT25FdmVudERvdWJsZUNsaWNrQ2FsbGJhY2soJGFwcCwgZXZlbnQsIGUpO1xuICAgIH07XG4gICAgY29uc3QgaGFuZGxlRXZlbnRLZXlEb3duID0gKGUsIGV2ZW50KSA9PiB7XG4gICAgICAgIGlmIChlLmtleSA9PT0gJ0VudGVyJyB8fCBlLmtleSA9PT0gJyAnKSB7XG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgc2V0Q2xpY2tlZEV2ZW50KGUsIGV2ZW50KTtcbiAgICAgICAgICAgIGludm9rZU9uRXZlbnRDbGlja0NhbGxiYWNrKCRhcHAsIGV2ZW50LCBlKTtcbiAgICAgICAgICAgIG5leHRUaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICBmb2N1c01vZGFsKCRhcHApO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiAoanN4KEFwcENvbnRleHQuUHJvdmlkZXIsIHsgdmFsdWU6ICRhcHAsIGNoaWxkcmVuOiBqc3goXCJkaXZcIiwgeyBpZDogaWQsIGNsYXNzTmFtZTogXCJzeF9fbGlzdC13cmFwcGVyXCIsIHJlZjogd3JhcHBlclJlZiwgY2hpbGRyZW46IGRheXNXaXRoRXZlbnRzLmxlbmd0aCA9PT0gMCA/IChqc3goXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic3hfX2xpc3Qtbm8tZXZlbnRzXCIsIGNoaWxkcmVuOiAkYXBwLnRyYW5zbGF0ZSgnTm8gZXZlbnRzJykgfSkpIDogKGRheXNXaXRoRXZlbnRzLm1hcCgoZGF5KSA9PiAoanN4cyhcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJzeF9fbGlzdC1kYXlcIiwgXCJkYXRhLWRhdGVcIjogZGF5LmRhdGUsIGNoaWxkcmVuOiBbanN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X19saXN0LWRheS1oZWFkZXJcIiwgY2hpbGRyZW46IGpzeChcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJzeF9fbGlzdC1kYXktZGF0ZVwiLCBjaGlsZHJlbjogdG9KU0RhdGUoZGF5LmRhdGUpLnRvTG9jYWxlRGF0ZVN0cmluZygkYXBwLmNvbmZpZy5sb2NhbGUudmFsdWUsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2Vla2RheTogJ2xvbmcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ZWFyOiAnbnVtZXJpYycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vbnRoOiAnbG9uZycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRheTogJ251bWVyaWMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pIH0pIH0pLCBqc3goXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic3hfX2xpc3QtZGF5LWV2ZW50c1wiLCBjaGlsZHJlbjogZGF5LmV2ZW50cy5tYXAoKGV2ZW50KSA9PiAoanN4cyhcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJzeF9fZXZlbnQgc3hfX2xpc3QtZXZlbnRcIiwgb25DbGljazogKGUpID0+IGhhbmRsZUV2ZW50Q2xpY2soZSwgZXZlbnQpLCBvbkRibENsaWNrOiAoZSkgPT4gaGFuZGxlRXZlbnREb3VibGVDbGljayhlLCBldmVudCksIG9uS2V5RG93bjogKGUpID0+IGhhbmRsZUV2ZW50S2V5RG93bihlLCBldmVudCksIHRhYkluZGV4OiAwLCByb2xlOiBcImJ1dHRvblwiLCBjaGlsZHJlbjogW2pzeChcImRpdlwiLCB7IGNsYXNzTmFtZTogYHN4X19saXN0LWV2ZW50LWNvbG9yLWxpbmVgLCBzdHlsZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogYHZhcigtLXN4LWNvbG9yLSR7ZXZlbnQuX2NvbG9yfSlgLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSB9KSwganN4cyhcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJzeF9fbGlzdC1ldmVudC1jb250ZW50XCIsIGNoaWxkcmVuOiBbanN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X19saXN0LWV2ZW50LXRpdGxlXCIsIGNoaWxkcmVuOiBldmVudC50aXRsZSB9KSwganN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X19saXN0LWV2ZW50LXRpbWVzXCIsIGNoaWxkcmVuOiByZW5kZXJFdmVudFRpbWVzKGV2ZW50LCBkYXkuZGF0ZSkgfSldIH0pXSB9LCBldmVudC5pZCkpKSB9KSwganN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X19saXN0LWRheS1tYXJnaW5cIiB9KV0gfSwgZGF5LmRhdGUpKSkpIH0pIH0pKTtcbn07XG5cbmNvbnN0IGNvbmZpZyA9IHtcbiAgICBuYW1lOiBJbnRlcm5hbFZpZXdOYW1lLkxpc3QsXG4gICAgbGFiZWw6ICdMaXN0JyxcbiAgICBzZXREYXRlUmFuZ2U6IHNldFJhbmdlRm9yTW9udGgsXG4gICAgQ29tcG9uZW50OiBMaXN0V3JhcHBlcixcbiAgICBoYXNTbWFsbFNjcmVlbkNvbXBhdDogdHJ1ZSxcbiAgICBoYXNXaWRlU2NyZWVuQ29tcGF0OiB0cnVlLFxuICAgIGJhY2t3YXJkRm9yd2FyZEZuOiBhZGRNb250aHMsXG4gICAgYmFja3dhcmRGb3J3YXJkVW5pdHM6IDEsXG59O1xuY29uc3Qgdmlld0xpc3QgPSBjcmVhdGVQcmVhY3RWaWV3KGNvbmZpZyk7XG5jb25zdCBjcmVhdGVWaWV3TGlzdCA9ICgpID0+IGNyZWF0ZVByZWFjdFZpZXcoY29uZmlnKTtcblxuZXhwb3J0IHsgQXBwQ29udGV4dCwgQ2FsZW5kYXJBcHAsIERhdGVHcmlkRGF5LCBUaW1lQXhpcywgVGltZUdyaWREYXksIGNyZWF0ZUNhbGVuZGFyLCBjcmVhdGVQcmVhY3RWaWV3LCBjcmVhdGVWaWV3RGF5LCBjcmVhdGVWaWV3TGlzdCwgY3JlYXRlVmlld01vbnRoQWdlbmRhLCBjcmVhdGVWaWV3TW9udGhHcmlkLCBjcmVhdGVWaWV3V2VlaywgZXh0ZXJuYWxFdmVudFRvSW50ZXJuYWwsIHNldFJhbmdlRm9yRGF5LCBzZXRSYW5nZUZvck1vbnRoLCBzZXRSYW5nZUZvcldlZWssIHNvcnRFdmVudHNGb3JXZWVrVmlldywgdG9EYXRlU3RyaW5nJDEgYXMgdG9EYXRlU3RyaW5nLCB0b0RhdGVUaW1lU3RyaW5nLCB0b0pTRGF0ZSwgdG9UaW1lU3RyaW5nLCB2aWV3RGF5LCB2aWV3TGlzdCwgdmlld01vbnRoQWdlbmRhLCB2aWV3TW9udGhHcmlkLCB2aWV3V2VlayB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@schedule-x/calendar/dist/core.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@schedule-x/current-time/dist/core.js":
/*!************************************************************!*\
  !*** ./node_modules/@schedule-x/current-time/dist/core.js ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createCurrentTimePlugin: () => (/* binding */ createCurrentTimePlugin)\n/* harmony export */ });\nclass NumberRangeError extends Error {\n    constructor(min, max) {\n        super(`Number must be between ${min} and ${max}.`);\n        Object.defineProperty(this, \"min\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: min\n        });\n        Object.defineProperty(this, \"max\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: max\n        });\n    }\n}\n\nconst doubleDigit = (number) => {\n    if (number < 0 || number > 99)\n        throw new NumberRangeError(0, 99);\n    return String(number).padStart(2, '0');\n};\n\nconst toDateString = (date) => {\n    return `${date.year}-${doubleDigit(date.month)}-${doubleDigit(date.day)}`;\n};\n\nconst timePointToPercentage = (timePointsInDay, dayBoundaries, timePoint) => {\n    if (timePoint < dayBoundaries.start) {\n        const firstDayTimePoints = 2400 - dayBoundaries.start;\n        return ((timePoint + firstDayTimePoints) / timePointsInDay) * 100;\n    }\n    return ((timePoint - dayBoundaries.start) / timePointsInDay) * 100;\n};\n\nclass InvalidTimeStringError extends Error {\n    constructor(timeString) {\n        super(`Invalid time string: ${timeString}`);\n    }\n}\n\n// regex for strings between 00:00 and 23:59\nconst timeStringRegex = /^(0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]/;\n\nconst minuteTimePointMultiplier = 1.6666666666666667; // 100 / 60\nconst timePointsFromString = (timeString) => {\n    if (!timeStringRegex.test(timeString) && timeString !== '24:00')\n        throw new InvalidTimeStringError(timeString);\n    const [hoursInt, minutesInt] = timeString\n        .split(':')\n        .map((time) => parseInt(time, 10));\n    let minutePoints = (minutesInt * minuteTimePointMultiplier).toString();\n    if (minutePoints.split('.')[0].length < 2)\n        minutePoints = `0${minutePoints}`;\n    return Number(hoursInt + minutePoints);\n};\n\nconst timeFromDateTime = (dateTime) => {\n    return dateTime.slice(11);\n};\n\nconst getYCoordinateInTimeGrid = (dateTime, dayBoundaries, pointsPerDay) => {\n    return timePointToPercentage(pointsPerDay, dayBoundaries, timePointsFromString(timeFromDateTime(dateTime.toString())));\n};\n\nconst definePlugin = (name, definition) => {\n    definition.name = name;\n    return definition;\n};\n\nclass CurrentTimePluginImpl {\n    constructor(config = {}) {\n        Object.defineProperty(this, \"config\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: config\n        });\n        Object.defineProperty(this, \"name\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 'currentTime'\n        });\n        Object.defineProperty(this, \"$app\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"observer\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: null\n        });\n        Object.defineProperty(this, \"timeout\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: null\n        });\n        Object.defineProperty(this, \"currentTimeIndicator\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: null\n        });\n    }\n    onRender($app) {\n        this.$app = $app;\n        this.observer = new MutationObserver((mutationList) => {\n            for (const mutation of mutationList) {\n                if (mutation.type === 'childList') {\n                    this.setIndicator();\n                }\n            }\n        });\n        const calendarWrapper = $app.elements.calendarWrapper;\n        if (!calendarWrapper) {\n            throw new Error('Calendar wrapper not found');\n        }\n        this.observer.observe(calendarWrapper, {\n            childList: true,\n            subtree: true,\n        });\n    }\n    setIndicator(isRecursion = false) {\n        const todayDateString = toDateString(Temporal.Now.plainDateISO(this.$app.config.timezone.value));\n        const nowDateTime = Temporal.Now.zonedDateTimeISO(this.$app.config.timezone.value);\n        const todayElement = this.$app.elements.calendarWrapper.querySelector(`[data-time-grid-date=\"${todayDateString}\"]`);\n        if (!todayElement)\n            return;\n        const existingIndicator = todayElement.querySelector('.sx__current-time-indicator');\n        if (existingIndicator && isRecursion)\n            existingIndicator.remove();\n        if (todayElement && !existingIndicator) {\n            this.currentTimeIndicator = document.createElement('div');\n            this.currentTimeIndicator.classList.add('sx__current-time-indicator');\n            const top = getYCoordinateInTimeGrid(nowDateTime, this.$app.config.dayBoundaries.value, this.$app.config.timePointsPerDay) + '%';\n            this.currentTimeIndicator.style.top = top;\n            todayElement.appendChild(this.currentTimeIndicator);\n            if (this.config.fullWeekWidth) {\n                this.createFullWidthIndicator(top);\n            }\n            this.timeout = setTimeout(this.setIndicator.bind(this, true), 60000 - (Date.now() % 60000));\n        }\n    }\n    createFullWidthIndicator(top) {\n        const fullWeekTimeIndicator = document.createElement('div');\n        fullWeekTimeIndicator.classList.add('sx__current-time-indicator-full-week');\n        fullWeekTimeIndicator.style.top = top;\n        const weekGridWrapper = document.querySelector('.sx__week-grid');\n        const existingFullWeekIndicator = weekGridWrapper === null || weekGridWrapper === void 0 ? void 0 : weekGridWrapper.querySelector('.sx__current-time-indicator-full-week');\n        if (existingFullWeekIndicator) {\n            existingFullWeekIndicator.remove();\n        }\n        if (weekGridWrapper) {\n            weekGridWrapper.appendChild(fullWeekTimeIndicator);\n        }\n    }\n    destroy() {\n        if (this.observer) {\n            this.observer.disconnect();\n        }\n        if (this.timeout) {\n            clearTimeout(this.timeout);\n        }\n        if (this.currentTimeIndicator) {\n            this.currentTimeIndicator.remove();\n            this.currentTimeIndicator = null;\n        }\n    }\n    onTimezoneChange() {\n        this.resetIndicator();\n    }\n    onDayBoundariesChange() {\n        this.resetIndicator();\n    }\n    resetIndicator() {\n        var _a;\n        (_a = this.currentTimeIndicator) === null || _a === void 0 ? void 0 : _a.remove();\n        this.currentTimeIndicator = null;\n        if (this.timeout) {\n            clearTimeout(this.timeout);\n        }\n        this.setIndicator();\n    }\n}\nconst createCurrentTimePlugin = (config) => {\n    return definePlugin('currentTime', new CurrentTimePluginImpl(config));\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNjaGVkdWxlLXgvY3VycmVudC10aW1lL2Rpc3QvY29yZS5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBLHdDQUF3QyxLQUFLLE1BQU0sSUFBSTtBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsY0FBYyxVQUFVLEdBQUcsd0JBQXdCLEdBQUcsc0JBQXNCO0FBQzVFOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxzQ0FBc0MsV0FBVztBQUNqRDtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsc0RBQXNEO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsYUFBYTtBQUN4QztBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSwyQkFBMkI7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUdBQXVHLGdCQUFnQjtBQUN2SDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFbUMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9uaWtpdGEvRGVza3RvcC9mb2N1c3BoZXJlL25vZGVfbW9kdWxlcy9Ac2NoZWR1bGUteC9jdXJyZW50LXRpbWUvZGlzdC9jb3JlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIE51bWJlclJhbmdlRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IobWluLCBtYXgpIHtcbiAgICAgICAgc3VwZXIoYE51bWJlciBtdXN0IGJlIGJldHdlZW4gJHttaW59IGFuZCAke21heH0uYCk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm1pblwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogbWluXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJtYXhcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IG1heFxuICAgICAgICB9KTtcbiAgICB9XG59XG5cbmNvbnN0IGRvdWJsZURpZ2l0ID0gKG51bWJlcikgPT4ge1xuICAgIGlmIChudW1iZXIgPCAwIHx8IG51bWJlciA+IDk5KVxuICAgICAgICB0aHJvdyBuZXcgTnVtYmVyUmFuZ2VFcnJvcigwLCA5OSk7XG4gICAgcmV0dXJuIFN0cmluZyhudW1iZXIpLnBhZFN0YXJ0KDIsICcwJyk7XG59O1xuXG5jb25zdCB0b0RhdGVTdHJpbmcgPSAoZGF0ZSkgPT4ge1xuICAgIHJldHVybiBgJHtkYXRlLnllYXJ9LSR7ZG91YmxlRGlnaXQoZGF0ZS5tb250aCl9LSR7ZG91YmxlRGlnaXQoZGF0ZS5kYXkpfWA7XG59O1xuXG5jb25zdCB0aW1lUG9pbnRUb1BlcmNlbnRhZ2UgPSAodGltZVBvaW50c0luRGF5LCBkYXlCb3VuZGFyaWVzLCB0aW1lUG9pbnQpID0+IHtcbiAgICBpZiAodGltZVBvaW50IDwgZGF5Qm91bmRhcmllcy5zdGFydCkge1xuICAgICAgICBjb25zdCBmaXJzdERheVRpbWVQb2ludHMgPSAyNDAwIC0gZGF5Qm91bmRhcmllcy5zdGFydDtcbiAgICAgICAgcmV0dXJuICgodGltZVBvaW50ICsgZmlyc3REYXlUaW1lUG9pbnRzKSAvIHRpbWVQb2ludHNJbkRheSkgKiAxMDA7XG4gICAgfVxuICAgIHJldHVybiAoKHRpbWVQb2ludCAtIGRheUJvdW5kYXJpZXMuc3RhcnQpIC8gdGltZVBvaW50c0luRGF5KSAqIDEwMDtcbn07XG5cbmNsYXNzIEludmFsaWRUaW1lU3RyaW5nRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IodGltZVN0cmluZykge1xuICAgICAgICBzdXBlcihgSW52YWxpZCB0aW1lIHN0cmluZzogJHt0aW1lU3RyaW5nfWApO1xuICAgIH1cbn1cblxuLy8gcmVnZXggZm9yIHN0cmluZ3MgYmV0d2VlbiAwMDowMCBhbmQgMjM6NTlcbmNvbnN0IHRpbWVTdHJpbmdSZWdleCA9IC9eKDBbMC05XXwxWzAtOV18MlswLTNdKTpbMC01XVswLTldLztcblxuY29uc3QgbWludXRlVGltZVBvaW50TXVsdGlwbGllciA9IDEuNjY2NjY2NjY2NjY2NjY2NzsgLy8gMTAwIC8gNjBcbmNvbnN0IHRpbWVQb2ludHNGcm9tU3RyaW5nID0gKHRpbWVTdHJpbmcpID0+IHtcbiAgICBpZiAoIXRpbWVTdHJpbmdSZWdleC50ZXN0KHRpbWVTdHJpbmcpICYmIHRpbWVTdHJpbmcgIT09ICcyNDowMCcpXG4gICAgICAgIHRocm93IG5ldyBJbnZhbGlkVGltZVN0cmluZ0Vycm9yKHRpbWVTdHJpbmcpO1xuICAgIGNvbnN0IFtob3Vyc0ludCwgbWludXRlc0ludF0gPSB0aW1lU3RyaW5nXG4gICAgICAgIC5zcGxpdCgnOicpXG4gICAgICAgIC5tYXAoKHRpbWUpID0+IHBhcnNlSW50KHRpbWUsIDEwKSk7XG4gICAgbGV0IG1pbnV0ZVBvaW50cyA9IChtaW51dGVzSW50ICogbWludXRlVGltZVBvaW50TXVsdGlwbGllcikudG9TdHJpbmcoKTtcbiAgICBpZiAobWludXRlUG9pbnRzLnNwbGl0KCcuJylbMF0ubGVuZ3RoIDwgMilcbiAgICAgICAgbWludXRlUG9pbnRzID0gYDAke21pbnV0ZVBvaW50c31gO1xuICAgIHJldHVybiBOdW1iZXIoaG91cnNJbnQgKyBtaW51dGVQb2ludHMpO1xufTtcblxuY29uc3QgdGltZUZyb21EYXRlVGltZSA9IChkYXRlVGltZSkgPT4ge1xuICAgIHJldHVybiBkYXRlVGltZS5zbGljZSgxMSk7XG59O1xuXG5jb25zdCBnZXRZQ29vcmRpbmF0ZUluVGltZUdyaWQgPSAoZGF0ZVRpbWUsIGRheUJvdW5kYXJpZXMsIHBvaW50c1BlckRheSkgPT4ge1xuICAgIHJldHVybiB0aW1lUG9pbnRUb1BlcmNlbnRhZ2UocG9pbnRzUGVyRGF5LCBkYXlCb3VuZGFyaWVzLCB0aW1lUG9pbnRzRnJvbVN0cmluZyh0aW1lRnJvbURhdGVUaW1lKGRhdGVUaW1lLnRvU3RyaW5nKCkpKSk7XG59O1xuXG5jb25zdCBkZWZpbmVQbHVnaW4gPSAobmFtZSwgZGVmaW5pdGlvbikgPT4ge1xuICAgIGRlZmluaXRpb24ubmFtZSA9IG5hbWU7XG4gICAgcmV0dXJuIGRlZmluaXRpb247XG59O1xuXG5jbGFzcyBDdXJyZW50VGltZVBsdWdpbkltcGwge1xuICAgIGNvbnN0cnVjdG9yKGNvbmZpZyA9IHt9KSB7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImNvbmZpZ1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogY29uZmlnXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJuYW1lXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiAnY3VycmVudFRpbWUnXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCIkYXBwXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm9ic2VydmVyXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBudWxsXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJ0aW1lb3V0XCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBudWxsXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJjdXJyZW50VGltZUluZGljYXRvclwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogbnVsbFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgb25SZW5kZXIoJGFwcCkge1xuICAgICAgICB0aGlzLiRhcHAgPSAkYXBwO1xuICAgICAgICB0aGlzLm9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKG11dGF0aW9uTGlzdCkgPT4ge1xuICAgICAgICAgICAgZm9yIChjb25zdCBtdXRhdGlvbiBvZiBtdXRhdGlvbkxpc3QpIHtcbiAgICAgICAgICAgICAgICBpZiAobXV0YXRpb24udHlwZSA9PT0gJ2NoaWxkTGlzdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRJbmRpY2F0b3IoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBjYWxlbmRhcldyYXBwZXIgPSAkYXBwLmVsZW1lbnRzLmNhbGVuZGFyV3JhcHBlcjtcbiAgICAgICAgaWYgKCFjYWxlbmRhcldyYXBwZXIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ2FsZW5kYXIgd3JhcHBlciBub3QgZm91bmQnKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm9ic2VydmVyLm9ic2VydmUoY2FsZW5kYXJXcmFwcGVyLCB7XG4gICAgICAgICAgICBjaGlsZExpc3Q6IHRydWUsXG4gICAgICAgICAgICBzdWJ0cmVlOiB0cnVlLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgc2V0SW5kaWNhdG9yKGlzUmVjdXJzaW9uID0gZmFsc2UpIHtcbiAgICAgICAgY29uc3QgdG9kYXlEYXRlU3RyaW5nID0gdG9EYXRlU3RyaW5nKFRlbXBvcmFsLk5vdy5wbGFpbkRhdGVJU08odGhpcy4kYXBwLmNvbmZpZy50aW1lem9uZS52YWx1ZSkpO1xuICAgICAgICBjb25zdCBub3dEYXRlVGltZSA9IFRlbXBvcmFsLk5vdy56b25lZERhdGVUaW1lSVNPKHRoaXMuJGFwcC5jb25maWcudGltZXpvbmUudmFsdWUpO1xuICAgICAgICBjb25zdCB0b2RheUVsZW1lbnQgPSB0aGlzLiRhcHAuZWxlbWVudHMuY2FsZW5kYXJXcmFwcGVyLnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLXRpbWUtZ3JpZC1kYXRlPVwiJHt0b2RheURhdGVTdHJpbmd9XCJdYCk7XG4gICAgICAgIGlmICghdG9kYXlFbGVtZW50KVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBjb25zdCBleGlzdGluZ0luZGljYXRvciA9IHRvZGF5RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuc3hfX2N1cnJlbnQtdGltZS1pbmRpY2F0b3InKTtcbiAgICAgICAgaWYgKGV4aXN0aW5nSW5kaWNhdG9yICYmIGlzUmVjdXJzaW9uKVxuICAgICAgICAgICAgZXhpc3RpbmdJbmRpY2F0b3IucmVtb3ZlKCk7XG4gICAgICAgIGlmICh0b2RheUVsZW1lbnQgJiYgIWV4aXN0aW5nSW5kaWNhdG9yKSB7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRUaW1lSW5kaWNhdG9yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRUaW1lSW5kaWNhdG9yLmNsYXNzTGlzdC5hZGQoJ3N4X19jdXJyZW50LXRpbWUtaW5kaWNhdG9yJyk7XG4gICAgICAgICAgICBjb25zdCB0b3AgPSBnZXRZQ29vcmRpbmF0ZUluVGltZUdyaWQobm93RGF0ZVRpbWUsIHRoaXMuJGFwcC5jb25maWcuZGF5Qm91bmRhcmllcy52YWx1ZSwgdGhpcy4kYXBwLmNvbmZpZy50aW1lUG9pbnRzUGVyRGF5KSArICclJztcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFRpbWVJbmRpY2F0b3Iuc3R5bGUudG9wID0gdG9wO1xuICAgICAgICAgICAgdG9kYXlFbGVtZW50LmFwcGVuZENoaWxkKHRoaXMuY3VycmVudFRpbWVJbmRpY2F0b3IpO1xuICAgICAgICAgICAgaWYgKHRoaXMuY29uZmlnLmZ1bGxXZWVrV2lkdGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZUZ1bGxXaWR0aEluZGljYXRvcih0b3ApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy50aW1lb3V0ID0gc2V0VGltZW91dCh0aGlzLnNldEluZGljYXRvci5iaW5kKHRoaXMsIHRydWUpLCA2MDAwMCAtIChEYXRlLm5vdygpICUgNjAwMDApKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjcmVhdGVGdWxsV2lkdGhJbmRpY2F0b3IodG9wKSB7XG4gICAgICAgIGNvbnN0IGZ1bGxXZWVrVGltZUluZGljYXRvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBmdWxsV2Vla1RpbWVJbmRpY2F0b3IuY2xhc3NMaXN0LmFkZCgnc3hfX2N1cnJlbnQtdGltZS1pbmRpY2F0b3ItZnVsbC13ZWVrJyk7XG4gICAgICAgIGZ1bGxXZWVrVGltZUluZGljYXRvci5zdHlsZS50b3AgPSB0b3A7XG4gICAgICAgIGNvbnN0IHdlZWtHcmlkV3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zeF9fd2Vlay1ncmlkJyk7XG4gICAgICAgIGNvbnN0IGV4aXN0aW5nRnVsbFdlZWtJbmRpY2F0b3IgPSB3ZWVrR3JpZFdyYXBwZXIgPT09IG51bGwgfHwgd2Vla0dyaWRXcmFwcGVyID09PSB2b2lkIDAgPyB2b2lkIDAgOiB3ZWVrR3JpZFdyYXBwZXIucXVlcnlTZWxlY3RvcignLnN4X19jdXJyZW50LXRpbWUtaW5kaWNhdG9yLWZ1bGwtd2VlaycpO1xuICAgICAgICBpZiAoZXhpc3RpbmdGdWxsV2Vla0luZGljYXRvcikge1xuICAgICAgICAgICAgZXhpc3RpbmdGdWxsV2Vla0luZGljYXRvci5yZW1vdmUoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAod2Vla0dyaWRXcmFwcGVyKSB7XG4gICAgICAgICAgICB3ZWVrR3JpZFdyYXBwZXIuYXBwZW5kQ2hpbGQoZnVsbFdlZWtUaW1lSW5kaWNhdG9yKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBkZXN0cm95KCkge1xuICAgICAgICBpZiAodGhpcy5vYnNlcnZlcikge1xuICAgICAgICAgICAgdGhpcy5vYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudGltZW91dCkge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY3VycmVudFRpbWVJbmRpY2F0b3IpIHtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFRpbWVJbmRpY2F0b3IucmVtb3ZlKCk7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRUaW1lSW5kaWNhdG9yID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBvblRpbWV6b25lQ2hhbmdlKCkge1xuICAgICAgICB0aGlzLnJlc2V0SW5kaWNhdG9yKCk7XG4gICAgfVxuICAgIG9uRGF5Qm91bmRhcmllc0NoYW5nZSgpIHtcbiAgICAgICAgdGhpcy5yZXNldEluZGljYXRvcigpO1xuICAgIH1cbiAgICByZXNldEluZGljYXRvcigpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICAoX2EgPSB0aGlzLmN1cnJlbnRUaW1lSW5kaWNhdG9yKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EucmVtb3ZlKCk7XG4gICAgICAgIHRoaXMuY3VycmVudFRpbWVJbmRpY2F0b3IgPSBudWxsO1xuICAgICAgICBpZiAodGhpcy50aW1lb3V0KSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldEluZGljYXRvcigpO1xuICAgIH1cbn1cbmNvbnN0IGNyZWF0ZUN1cnJlbnRUaW1lUGx1Z2luID0gKGNvbmZpZykgPT4ge1xuICAgIHJldHVybiBkZWZpbmVQbHVnaW4oJ2N1cnJlbnRUaW1lJywgbmV3IEN1cnJlbnRUaW1lUGx1Z2luSW1wbChjb25maWcpKTtcbn07XG5cbmV4cG9ydCB7IGNyZWF0ZUN1cnJlbnRUaW1lUGx1Z2luIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@schedule-x/current-time/dist/core.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@schedule-x/drag-and-drop/dist/core.js":
/*!*************************************************************!*\
  !*** ./node_modules/@schedule-x/drag-and-drop/dist/core.js ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createDragAndDropPlugin: () => (/* binding */ createDragAndDropPlugin)\n/* harmony export */ });\nvar PluginName;\n(function (PluginName) {\n    PluginName[\"DragAndDrop\"] = \"dragAndDrop\";\n    PluginName[\"EventModal\"] = \"eventModal\";\n    PluginName[\"ScrollController\"] = \"scrollController\";\n    PluginName[\"EventRecurrence\"] = \"eventRecurrence\";\n    PluginName[\"Resize\"] = \"resize\";\n    PluginName[\"CalendarControls\"] = \"calendarControls\";\n    PluginName[\"CurrentTime\"] = \"currentTime\";\n})(PluginName || (PluginName = {}));\n\nclass InvalidTimeStringError extends Error {\n    constructor(timeString) {\n        super(`Invalid time string: ${timeString}`);\n    }\n}\n\n// regex for strings between 00:00 and 23:59\nconst timeStringRegex = /^(0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]/;\n\nclass NumberRangeError extends Error {\n    constructor(min, max) {\n        super(`Number must be between ${min} and ${max}.`);\n        Object.defineProperty(this, \"min\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: min\n        });\n        Object.defineProperty(this, \"max\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: max\n        });\n    }\n}\n\nconst doubleDigit = (number) => {\n    if (number < 0 || number > 99)\n        throw new NumberRangeError(0, 99);\n    return String(number).padStart(2, '0');\n};\n\nconst minuteTimePointMultiplier = 1.6666666666666667; // 100 / 60\nconst timePointsFromString = (timeString) => {\n    if (!timeStringRegex.test(timeString) && timeString !== '24:00')\n        throw new InvalidTimeStringError(timeString);\n    const [hoursInt, minutesInt] = timeString\n        .split(':')\n        .map((time) => parseInt(time, 10));\n    let minutePoints = (minutesInt * minuteTimePointMultiplier).toString();\n    if (minutePoints.split('.')[0].length < 2)\n        minutePoints = `0${minutePoints}`;\n    return Number(hoursInt + minutePoints);\n};\nconst addTimePointsToDateTime = (dateTime, pointsToAdd) => {\n    const minutesToAdd = Math.round(pointsToAdd / minuteTimePointMultiplier);\n    const newDateTime = dateTime.add({ minutes: minutesToAdd });\n    return newDateTime;\n};\n\nconst toDateString = (date) => {\n    return `${date.year}-${doubleDigit(date.month)}-${doubleDigit(date.day)}`;\n};\n\nconst addDays = (to, nDays) => {\n    if (nDays < 0) {\n        return to.subtract({ days: -nDays });\n    }\n    return to.add({ days: nDays });\n};\n\nconst setDateInDateTime = (dateTime, newDate) => {\n    const updatedDateTime = dateTime.with({\n        year: newDate.year,\n        month: newDate.month,\n        day: newDate.day,\n    });\n    return updatedDateTime;\n};\n\nconst getTimeGridEventCopyElementId = (id) => {\n    return 'time-grid-event-copy-' + id;\n};\n\nconst updateRecurringEvent = ($app, eventCopy, startPreDrag) => {\n    var _a;\n    (_a = $app.config.plugins.eventRecurrence) === null || _a === void 0 ? void 0 : _a.updateRecurrenceDND(eventCopy.id, startPreDrag, eventCopy.start);\n};\nconst updateNonRecurringEvent = ($app, eventCopy) => {\n    const eventToUpdate = $app.calendarEvents.list.value.find((event) => event.id === eventCopy.id);\n    if (!eventToUpdate)\n        return;\n    eventToUpdate.start = eventCopy.start;\n    eventToUpdate.end = eventCopy.end;\n    $app.calendarEvents.list.value = [...$app.calendarEvents.list.value];\n};\nconst updateDraggedEvent = ($app, eventCopy, startPreDrag) => {\n    if ('rrule' in eventCopy._getForeignProperties() &&\n        $app.config.plugins.eventRecurrence) {\n        updateRecurringEvent($app, eventCopy, startPreDrag);\n    }\n    else {\n        updateNonRecurringEvent($app, eventCopy);\n    }\n    if ($app.config.callbacks.onEventUpdate) {\n        $app.config.callbacks.onEventUpdate(eventCopy._getExternalEvent());\n    }\n};\n\nconst isUIEventTouchEvent = (event) => {\n    return 'touches' in event && typeof event.touches === 'object';\n};\n\nconst getEventCoordinates = (uiEvent) => {\n    const actualEvent = isUIEventTouchEvent(uiEvent)\n        ? uiEvent.touches[0]\n        : uiEvent;\n    return {\n        clientX: actualEvent.clientX,\n        clientY: actualEvent.clientY,\n    };\n};\n\nconst getTimePointsPerPixel = ($app) => {\n    return $app.config.timePointsPerDay / $app.config.weekOptions.value.gridHeight;\n};\n\nconst testIfShouldAbort = async ($app, \n/**\n * For the month grid the original event is used, since there is no copy created for dragging.\n * For other views, a copy is used, hence the name of this parameter.\n * */\neventCopyOrOriginalEvent, originalStart, originalEnd, updateCopy) => {\n    const onBeforeEventUpdate = $app.config.callbacks.onBeforeEventUpdateAsync ||\n        $app.config.callbacks.onBeforeEventUpdate;\n    if (onBeforeEventUpdate) {\n        const oldEvent = eventCopyOrOriginalEvent._getExternalEvent();\n        oldEvent.start = originalStart;\n        oldEvent.end = originalEnd;\n        const newEvent = eventCopyOrOriginalEvent._getExternalEvent();\n        const validationResult = await onBeforeEventUpdate(oldEvent, newEvent, $app);\n        if (!validationResult) {\n            updateCopy === null || updateCopy === void 0 ? void 0 : updateCopy(undefined);\n            return true; // abort\n        }\n    }\n    return false;\n};\n\nclass TimeGridDragHandlerImpl {\n    constructor($app, eventCoordinates, eventCopy, updateCopy, dayBoundariesDateTime, CHANGE_THRESHOLD_IN_TIME_POINTS) {\n        Object.defineProperty(this, \"$app\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: $app\n        });\n        Object.defineProperty(this, \"eventCoordinates\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: eventCoordinates\n        });\n        Object.defineProperty(this, \"eventCopy\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: eventCopy\n        });\n        Object.defineProperty(this, \"updateCopy\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: updateCopy\n        });\n        Object.defineProperty(this, \"dayBoundariesDateTime\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: dayBoundariesDateTime\n        });\n        Object.defineProperty(this, \"CHANGE_THRESHOLD_IN_TIME_POINTS\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: CHANGE_THRESHOLD_IN_TIME_POINTS\n        });\n        Object.defineProperty(this, \"dayWidth\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"startY\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"startX\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"lastIntervalDiff\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 0\n        });\n        Object.defineProperty(this, \"lastDaysDiff\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 0\n        });\n        Object.defineProperty(this, \"originalStart\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"originalEnd\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"handleMouseOrTouchMove\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: (uiEvent) => {\n                const { clientX, clientY } = getEventCoordinates(uiEvent);\n                const pixelDiffY = clientY - this.startY;\n                const timePointsDiffY = pixelDiffY * this.timePointsPerPixel();\n                const currentIntervalDiff = Math.round(timePointsDiffY / this.CHANGE_THRESHOLD_IN_TIME_POINTS);\n                const pixelDiffX = clientX - this.startX;\n                const currentDaysDiff = Math.round(pixelDiffX / this.dayWidth);\n                this.handleVerticalMouseOrTouchMove(currentIntervalDiff);\n                this.handleHorizontalMouseOrTouchMove(currentDaysDiff);\n            }\n        });\n        Object.defineProperty(this, \"handleMouseUpOrTouchEnd\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: async () => {\n                document.removeEventListener('mousemove', this.handleMouseOrTouchMove);\n                document.removeEventListener('touchmove', this.handleMouseOrTouchMove);\n                document.removeEventListener('mouseup', this.handleMouseUpOrTouchEnd);\n                document.removeEventListener('touchend', this.handleMouseUpOrTouchEnd);\n                this.updateCopy(undefined);\n                const shouldAbort = await testIfShouldAbort(this.$app, this.eventCopy, this.originalStart, this.originalEnd, this.updateCopy);\n                if (shouldAbort)\n                    return;\n                this.updateOriginalEvent();\n            }\n        });\n        this.dayWidth = $app.elements.calendarWrapper.querySelector('.sx__time-grid-day').clientWidth;\n        this.startY = this.eventCoordinates.clientY;\n        this.startX = this.eventCoordinates.clientX;\n        this.originalStart = Temporal.ZonedDateTime.from(this.eventCopy.start.toString());\n        this.originalEnd = Temporal.ZonedDateTime.from(this.eventCopy.end.toString());\n        this.init();\n    }\n    init() {\n        document.addEventListener('mousemove', this.handleMouseOrTouchMove);\n        document.addEventListener('mouseup', this.handleMouseUpOrTouchEnd);\n        document.addEventListener('touchmove', this.handleMouseOrTouchMove, {\n            passive: false,\n        });\n        document.addEventListener('touchend', this.handleMouseUpOrTouchEnd);\n    }\n    timePointsPerPixel() {\n        return getTimePointsPerPixel(this.$app);\n    }\n    handleVerticalMouseOrTouchMove(currentIntervalDiff) {\n        if (currentIntervalDiff === this.lastIntervalDiff)\n            return;\n        const pointsToAdd = currentIntervalDiff > this.lastIntervalDiff\n            ? this.CHANGE_THRESHOLD_IN_TIME_POINTS *\n                (currentIntervalDiff - this.lastIntervalDiff)\n            : -this.CHANGE_THRESHOLD_IN_TIME_POINTS *\n                (this.lastIntervalDiff - currentIntervalDiff);\n        this.setTimeForEventCopy(pointsToAdd);\n        this.lastIntervalDiff = currentIntervalDiff;\n    }\n    setTimeForEventCopy(pointsToAdd) {\n        const newStart = addTimePointsToDateTime(this.eventCopy.start, pointsToAdd);\n        const newEnd = addTimePointsToDateTime(this.eventCopy.end, pointsToAdd);\n        let currentDiff = this.lastDaysDiff;\n        if (this.$app.config.direction === 'rtl') {\n            currentDiff = -currentDiff;\n        }\n        if (newStart.epochNanoseconds <\n            addDays(this.dayBoundariesDateTime.start, currentDiff).epochNanoseconds)\n            return;\n        if (newEnd.epochNanoseconds >\n            addDays(this.dayBoundariesDateTime.end, currentDiff).epochNanoseconds)\n            return;\n        this.eventCopy.start = newStart;\n        this.eventCopy.end = newEnd;\n        this.updateCopy(this.eventCopy);\n    }\n    handleHorizontalMouseOrTouchMove(totalDaysDiff) {\n        if (totalDaysDiff === this.lastDaysDiff)\n            return;\n        let diffToAdd = totalDaysDiff - this.lastDaysDiff;\n        if (this.$app.config.direction === 'rtl')\n            diffToAdd = -diffToAdd;\n        const newStartDate = addDays(this.eventCopy.start, diffToAdd);\n        const newEndDate = addDays(this.eventCopy.end, diffToAdd);\n        const newStart = setDateInDateTime(this.eventCopy.start, newStartDate);\n        const newEnd = setDateInDateTime(this.eventCopy.end, newEndDate);\n        if (newStart.epochNanoseconds <\n            this.$app.calendarState.range.value.start.epochNanoseconds)\n            return;\n        if (newEnd.epochNanoseconds >\n            this.$app.calendarState.range.value.end.epochNanoseconds)\n            return;\n        this.setDateForEventCopy(newStart, newEnd);\n        this.transformEventCopyPosition(totalDaysDiff);\n        this.lastDaysDiff = totalDaysDiff;\n    }\n    setDateForEventCopy(newStart, newEnd) {\n        this.eventCopy.start = newStart;\n        this.eventCopy.end = newEnd;\n        this.updateCopy(this.eventCopy);\n    }\n    transformEventCopyPosition(totalDaysDiff) {\n        const copyElement = this.$app.elements.calendarWrapper.querySelector('#' + getTimeGridEventCopyElementId(this.eventCopy.id));\n        copyElement.style.transform = `translateX(calc(${totalDaysDiff * 100}% + ${totalDaysDiff}px))`;\n    }\n    updateOriginalEvent() {\n        if (this.lastIntervalDiff === 0 && this.lastDaysDiff === 0)\n            return;\n        const dayIsSame = this.lastDaysDiff === 0;\n        const eventElement = document.querySelector(`[data-event-id=\"${this.eventCopy.id}\"]`);\n        const shouldHideEventToPreventFlickering = !dayIsSame && eventElement instanceof HTMLElement;\n        if (shouldHideEventToPreventFlickering)\n            eventElement.style.display = 'none';\n        updateDraggedEvent(this.$app, this.eventCopy, this.originalStart);\n    }\n}\n\nconst getTimeGridDayWidth = ($app) => {\n    return $app.elements.calendarWrapper.querySelector('.sx__time-grid-day').clientWidth;\n};\n\nconst getDateGridEventCopy = ($app, eventCopy) => {\n    return $app.elements.calendarWrapper.querySelector('#' + getTimeGridEventCopyElementId(eventCopy.id));\n};\n\nclass DateGridDragHandlerImpl {\n    constructor($app, eventCoordinates, eventCopy, updateCopy) {\n        Object.defineProperty(this, \"$app\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: $app\n        });\n        Object.defineProperty(this, \"eventCopy\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: eventCopy\n        });\n        Object.defineProperty(this, \"updateCopy\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: updateCopy\n        });\n        Object.defineProperty(this, \"startX\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"dayWidth\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"originalStart\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"originalEnd\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"rangeStartDate\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"rangeEndDate\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"lastDaysDiff\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 0\n        });\n        Object.defineProperty(this, \"handleMouseOrTouchMove\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: (uiEvent) => {\n                const { clientX } = getEventCoordinates(uiEvent);\n                const pixelDiffX = clientX - this.startX;\n                let currentDaysDiff = Math.round(pixelDiffX / this.dayWidth);\n                if (this.$app.config.direction === 'rtl')\n                    currentDaysDiff *= -1;\n                if (currentDaysDiff === this.lastDaysDiff)\n                    return;\n                const newStart = addDays(this.originalStart, currentDaysDiff);\n                const newStartDate = Temporal.PlainDate.from(newStart).toString();\n                const newEnd = addDays(this.originalEnd, currentDaysDiff);\n                const newEndDate = Temporal.PlainDate.from(newEnd).toString();\n                if (newStartDate > this.rangeEndDate.toString())\n                    return;\n                if (newEndDate < this.rangeStartDate.toString())\n                    return;\n                this.eventCopy.start = newStart;\n                this.eventCopy.end = newEnd;\n                const newStartIsInWeek = newStart.toString() >= this.rangeStartDate.toString() &&\n                    newStart.toString() <= this.rangeEndDate.toString();\n                const firstDateInGrid = newStartIsInWeek\n                    ? newStart.toString()\n                    : this.rangeStartDate;\n                const lastDateIsInGrid = newEnd.toString() >= this.rangeStartDate.toString() &&\n                    newEnd.toString() <= this.rangeEndDate.toString();\n                const lastDateInGrid = lastDateIsInGrid\n                    ? newEnd.toString()\n                    : this.rangeEndDate.toString();\n                this.eventCopy._nDaysInGrid =\n                    Math.round(Temporal.PlainDate.from(firstDateInGrid)\n                        .until(Temporal.PlainDate.from(lastDateInGrid))\n                        .total('days')) + 1;\n                /**\n                 * Transitioning the position sideways is not necessary as long as the start date is earlier than the first date in the grid.\n                 * While moving an event during a state as such, it will optically look as if its position is transitioned, since the event width is increased and decreased\n                 * as the event is moved.\n                 * */\n                if (newStart.toString() >= this.rangeStartDate.toString())\n                    this.transformEventCopyPosition(newStart.toString());\n                this.updateCopy(this.eventCopy);\n                this.lastDaysDiff = currentDaysDiff;\n            }\n        });\n        Object.defineProperty(this, \"handleMouseUpOrTouchEnd\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: async () => {\n                document.removeEventListener('mousemove', this.handleMouseOrTouchMove);\n                document.removeEventListener('touchmove', this.handleMouseOrTouchMove);\n                const shouldAbort = await testIfShouldAbort(this.$app, this.eventCopy, this.originalStart, this.originalEnd, this.updateCopy);\n                if (shouldAbort)\n                    return;\n                this.updateOriginalEvent();\n                setTimeout(() => {\n                    this.updateCopy(undefined);\n                }, 10); // Timeout needed to prevent the original from being displayed for a split second, before being removed from DOM.\n            }\n        });\n        this.startX = eventCoordinates.clientX;\n        this.dayWidth = getTimeGridDayWidth(this.$app);\n        this.originalStart =\n            this.eventCopy.start instanceof Temporal.PlainDate\n                ? Temporal.PlainDate.from(this.eventCopy.start.toString())\n                : Temporal.ZonedDateTime.from(this.eventCopy.start.toString()).withTimeZone(this.$app.config.timezone.value);\n        this.originalEnd =\n            this.eventCopy.end instanceof Temporal.PlainDate\n                ? Temporal.PlainDate.from(this.eventCopy.end.toString())\n                : Temporal.ZonedDateTime.from(this.eventCopy.end.toString()).withTimeZone(this.$app.config.timezone.value);\n        this.rangeStartDate = Temporal.PlainDate.from(this.$app.calendarState.range.value.start);\n        this.rangeEndDate = Temporal.PlainDate.from(addDays(this.rangeStartDate, $app.config.weekOptions.value.nDays - 1));\n        this.init();\n    }\n    init() {\n        document.addEventListener('mousemove', this.handleMouseOrTouchMove);\n        document.addEventListener('mouseup', this.handleMouseUpOrTouchEnd, {\n            once: true,\n        });\n        document.addEventListener('touchmove', this.handleMouseOrTouchMove, {\n            passive: false,\n        });\n        document.addEventListener('touchend', this.handleMouseUpOrTouchEnd, {\n            once: true,\n        });\n    }\n    transformEventCopyPosition(newStartDate) {\n        const originalStartDate = this.originalStart.toString();\n        const originalStartInGrid = originalStartDate >= this.rangeStartDate.toString()\n            ? originalStartDate\n            : this.rangeStartDate.toString();\n        let daysToShift = Math.round(Temporal.PlainDate.from(originalStartInGrid)\n            .until(Temporal.PlainDate.from(newStartDate))\n            .total('days'));\n        if (this.$app.config.direction === 'rtl')\n            daysToShift *= -1;\n        getDateGridEventCopy(this.$app, this.eventCopy).style.transform =\n            `translateX(calc(${daysToShift * this.dayWidth}px + ${daysToShift}px))`;\n    }\n    updateOriginalEvent() {\n        if (this.lastDaysDiff === 0)\n            return;\n        updateDraggedEvent(this.$app, this.eventCopy, this.originalStart);\n    }\n}\n\nconst calculateDaysDifference = (startDate, endDate) => {\n    return Temporal.PlainDate.from(startDate)\n        .until(Temporal.PlainDate.from(endDate))\n        .total('days');\n};\n\nconst dateFromDateTime = (dateTime) => {\n    return dateTime.slice(0, 10);\n};\nconst timeFromDateTime = (dateTime) => {\n    return dateTime.slice(11);\n};\n\nvar WeekDay;\n(function (WeekDay) {\n    WeekDay[WeekDay[\"MONDAY\"] = 1] = \"MONDAY\";\n    WeekDay[WeekDay[\"TUESDAY\"] = 2] = \"TUESDAY\";\n    WeekDay[WeekDay[\"WEDNESDAY\"] = 3] = \"WEDNESDAY\";\n    WeekDay[WeekDay[\"THURSDAY\"] = 4] = \"THURSDAY\";\n    WeekDay[WeekDay[\"FRIDAY\"] = 5] = \"FRIDAY\";\n    WeekDay[WeekDay[\"SATURDAY\"] = 6] = \"SATURDAY\";\n    WeekDay[WeekDay[\"SUNDAY\"] = 7] = \"SUNDAY\";\n})(WeekDay || (WeekDay = {}));\n\nWeekDay.MONDAY;\nconst DEFAULT_EVENT_COLOR_NAME = 'primary';\n\nclass CalendarEventImpl {\n    constructor(_config, id, _start, _end, title, people, location, description, calendarId, _options = undefined, _customContent = {}, _foreignProperties = {}) {\n        Object.defineProperty(this, \"_config\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: _config\n        });\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: id\n        });\n        Object.defineProperty(this, \"_start\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: _start\n        });\n        Object.defineProperty(this, \"_end\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: _end\n        });\n        Object.defineProperty(this, \"title\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: title\n        });\n        Object.defineProperty(this, \"people\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: people\n        });\n        Object.defineProperty(this, \"location\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: location\n        });\n        Object.defineProperty(this, \"description\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: description\n        });\n        Object.defineProperty(this, \"calendarId\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: calendarId\n        });\n        Object.defineProperty(this, \"_options\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: _options\n        });\n        Object.defineProperty(this, \"_customContent\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: _customContent\n        });\n        Object.defineProperty(this, \"_foreignProperties\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: _foreignProperties\n        });\n        Object.defineProperty(this, \"_previousConcurrentEvents\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_totalConcurrentEvents\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_maxConcurrentEvents\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_nDaysInGrid\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_createdAt\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_originalTimezone\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_eventFragments\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: {}\n        });\n        this._originalTimezone =\n            this._start instanceof Temporal.ZonedDateTime\n                ? this._start.timeZoneId\n                : undefined;\n    }\n    get start() {\n        if (this._start instanceof Temporal.PlainDate) {\n            return this._start;\n        }\n        return this._start.withTimeZone(this._config.timezone.value);\n    }\n    set start(value) {\n        this._start =\n            value instanceof Temporal.ZonedDateTime\n                ? value.withTimeZone(this._originalTimezone)\n                : value;\n    }\n    get end() {\n        if (this._end instanceof Temporal.PlainDate) {\n            return this._end;\n        }\n        return this._end.withTimeZone(this._config.timezone.value);\n    }\n    set end(value) {\n        this._end =\n            value instanceof Temporal.ZonedDateTime\n                ? value.withTimeZone(this._originalTimezone)\n                : value;\n    }\n    get _isSingleDayTimed() {\n        if (this.start instanceof Temporal.PlainDate ||\n            this.end instanceof Temporal.PlainDate)\n            return false;\n        const localStartDate = dateFromDateTime(this.start.toString());\n        const localEndDate = dateFromDateTime(this.end.toString());\n        return localStartDate === localEndDate;\n    }\n    get _isSingleDayFullDay() {\n        const startDate = dateFromDateTime(this.start.toString());\n        const endDate = dateFromDateTime(this.end.toString());\n        return (startDate === endDate &&\n            this.start instanceof Temporal.PlainDate &&\n            this.end instanceof Temporal.PlainDate);\n    }\n    get _isMultiDayTimed() {\n        if (this.start instanceof Temporal.PlainDate ||\n            this.end instanceof Temporal.PlainDate)\n            return false;\n        const startDate = dateFromDateTime(this.start.toString());\n        const endDate = dateFromDateTime(this.end.toString());\n        return startDate !== endDate;\n    }\n    get _isMultiDayFullDay() {\n        const startDate = dateFromDateTime(this.start.toString());\n        const endDate = dateFromDateTime(this.end.toString());\n        return (this.start instanceof Temporal.PlainDate &&\n            this.end instanceof Temporal.PlainDate &&\n            startDate !== endDate);\n    }\n    get _isSingleHybridDayTimed() {\n        if (!this._config.isHybridDay)\n            return false;\n        if (this.start instanceof Temporal.PlainDate ||\n            this.end instanceof Temporal.PlainDate)\n            return false;\n        const startDate = dateFromDateTime(this.start.toString());\n        const endDate = dateFromDateTime(this.end.toString());\n        const endDateMinusOneDay = toDateString(Temporal.PlainDate.from(endDate).subtract({ days: 1 }));\n        if (startDate !== endDate && startDate !== endDateMinusOneDay)\n            return false;\n        const dayBoundaries = this._config.dayBoundaries.value;\n        const eventStartTimePoints = timePointsFromString(timeFromDateTime(this.start.toString()));\n        const eventEndTimePoints = timePointsFromString(timeFromDateTime(this.end.toString()));\n        const eventIsFullyInFirstDayOfBoundary = eventEndTimePoints > eventStartTimePoints && startDate === endDate;\n        return ((eventStartTimePoints >= dayBoundaries.start &&\n            (eventEndTimePoints <= dayBoundaries.end ||\n                eventIsFullyInFirstDayOfBoundary)) ||\n            (eventStartTimePoints < dayBoundaries.end &&\n                eventEndTimePoints <= dayBoundaries.end));\n    }\n    get _color() {\n        if (this.calendarId &&\n            this._config.calendars.value &&\n            this.calendarId in this._config.calendars.value) {\n            return this._config.calendars.value[this.calendarId].colorName;\n        }\n        return DEFAULT_EVENT_COLOR_NAME;\n    }\n    _getForeignProperties() {\n        return this._foreignProperties;\n    }\n    _getExternalEvent() {\n        return {\n            id: this.id,\n            start: this._start,\n            end: this._end,\n            title: this.title,\n            people: this.people,\n            location: this.location,\n            description: this.description,\n            calendarId: this.calendarId,\n            _options: this._options,\n            ...this._getForeignProperties(),\n        };\n    }\n}\n\nclass CalendarEventBuilder {\n    constructor(_config, id, start, end) {\n        Object.defineProperty(this, \"_config\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: _config\n        });\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: id\n        });\n        Object.defineProperty(this, \"start\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: start\n        });\n        Object.defineProperty(this, \"end\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: end\n        });\n        Object.defineProperty(this, \"people\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"location\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"description\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"title\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"calendarId\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_foreignProperties\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: {}\n        });\n        Object.defineProperty(this, \"_options\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: undefined\n        });\n        Object.defineProperty(this, \"_customContent\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: {}\n        });\n    }\n    build() {\n        return new CalendarEventImpl(this._config, this.id, this.start, this.end, this.title, this.people, this.location, this.description, this.calendarId, this._options, this._customContent, this._foreignProperties);\n    }\n    withTitle(title) {\n        this.title = title;\n        return this;\n    }\n    withPeople(people) {\n        this.people = people;\n        return this;\n    }\n    withLocation(location) {\n        this.location = location;\n        return this;\n    }\n    withDescription(description) {\n        this.description = description;\n        return this;\n    }\n    withForeignProperties(foreignProperties) {\n        this._foreignProperties = foreignProperties;\n        return this;\n    }\n    withCalendarId(calendarId) {\n        this.calendarId = calendarId;\n        return this;\n    }\n    withOptions(options) {\n        this._options = options;\n        return this;\n    }\n    withCustomContent(customContent) {\n        this._customContent = customContent;\n        return this;\n    }\n}\n\nconst deepCloneEvent = (calendarEvent, $app) => {\n    const calendarEventInternal = new CalendarEventBuilder($app.config, calendarEvent.id, calendarEvent._start, calendarEvent._end)\n        .withTitle(calendarEvent.title)\n        .withPeople(calendarEvent.people)\n        .withCalendarId(calendarEvent.calendarId)\n        .withForeignProperties(JSON.parse(JSON.stringify(calendarEvent._getForeignProperties())))\n        .withLocation(calendarEvent.location)\n        .withDescription(calendarEvent.description)\n        .withOptions(calendarEvent._options)\n        .withCustomContent(calendarEvent._customContent)\n        .build();\n    calendarEventInternal._nDaysInGrid = calendarEvent._nDaysInGrid;\n    return calendarEventInternal;\n};\n\nclass MonthGridDragHandlerImpl {\n    constructor(calendarEvent, $app) {\n        Object.defineProperty(this, \"calendarEvent\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: calendarEvent\n        });\n        Object.defineProperty(this, \"$app\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: $app\n        });\n        Object.defineProperty(this, \"allDayElements\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"currentDragoverDate\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"eventNDays\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"originalStart\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"originalEnd\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"MONTH_DAY_CLASS_NAME\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 'sx__month-grid-day'\n        });\n        Object.defineProperty(this, \"MONTH_DAY_SELECTOR\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: `.${this.MONTH_DAY_CLASS_NAME}`\n        });\n        Object.defineProperty(this, \"DAY_DRAGOVER_CLASS_NAME\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 'sx__month-grid-day--dragover'\n        });\n        Object.defineProperty(this, \"handleDragOver\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: (e) => {\n                e.preventDefault();\n                let dayElement = e.target;\n                if (!(dayElement instanceof HTMLDivElement) ||\n                    !dayElement.classList.contains(this.MONTH_DAY_CLASS_NAME))\n                    dayElement = e.target.closest(this.MONTH_DAY_SELECTOR);\n                if (this.currentDragoverDate === dayElement.dataset.date)\n                    return;\n                this.currentDragoverDate = dayElement.dataset.date;\n                const newEndDate = addDays(Temporal.PlainDate.from(this.currentDragoverDate), this.eventNDays - 1);\n                this.allDayElements.forEach((el) => {\n                    const dayElementDate = el.dataset.date;\n                    if (dayElementDate >= this.currentDragoverDate &&\n                        dayElementDate <= newEndDate.toString()) {\n                        el.classList.add(this.DAY_DRAGOVER_CLASS_NAME);\n                    }\n                    else {\n                        el.classList.remove(this.DAY_DRAGOVER_CLASS_NAME);\n                    }\n                });\n            }\n        });\n        Object.defineProperty(this, \"handleDragEnd\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: async () => {\n                document.removeEventListener('mouseup', this.handleMouseUp);\n                this.allDayElements.forEach((el) => {\n                    el.removeEventListener('dragover', this.handleDragOver);\n                    el.classList.remove(this.DAY_DRAGOVER_CLASS_NAME);\n                });\n                this.setCalendarEventPointerEventsTo('auto');\n                const updatedEvent = this.createUpdatedEvent();\n                const shouldAbort = await testIfShouldAbort(this.$app, updatedEvent, this.originalStart, this.originalEnd);\n                if (shouldAbort)\n                    return;\n                this.updateCalendarEvent(updatedEvent);\n            }\n        });\n        Object.defineProperty(this, \"handleMouseUp\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: async () => {\n                document.removeEventListener('dragend', this.handleDragEnd);\n                this.setCalendarEventPointerEventsTo('auto');\n            }\n        });\n        Object.defineProperty(this, \"setCalendarEventPointerEventsTo\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: (pointerEvents) => {\n                var _a;\n                ((_a = this.$app.elements.calendarWrapper) === null || _a === void 0 ? void 0 : _a.querySelectorAll('.sx__event')).forEach((el) => {\n                    if (String(el.dataset.eventId) === String(this.calendarEvent.id))\n                        return;\n                    el.style.pointerEvents = pointerEvents;\n                });\n            }\n        });\n        Object.defineProperty(this, \"createUpdatedEvent\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: () => {\n                const eventCopy = deepCloneEvent(this.calendarEvent, this.$app);\n                const diffOldDateAndNewDate = calculateDaysDifference(Temporal.PlainDate.from(this.calendarEvent.start), Temporal.PlainDate.from(this.currentDragoverDate));\n                eventCopy.start = addDays(eventCopy.start, diffOldDateAndNewDate);\n                eventCopy.end = addDays(eventCopy.end, diffOldDateAndNewDate);\n                return eventCopy;\n            }\n        });\n        Object.defineProperty(this, \"updateCalendarEvent\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: (newEvent) => {\n                updateDraggedEvent(this.$app, newEvent, this.originalStart);\n            }\n        });\n        this.originalStart = this.calendarEvent.start;\n        this.originalEnd = this.calendarEvent.end;\n        this.allDayElements = $app.elements.calendarWrapper.querySelectorAll(this.MONTH_DAY_SELECTOR);\n        this.eventNDays =\n            calculateDaysDifference(this.calendarEvent.start, this.calendarEvent.end) + 1;\n        this.init();\n    }\n    init() {\n        document.addEventListener('dragend', this.handleDragEnd, { once: true });\n        document.addEventListener('mouseup', this.handleMouseUp, { once: true });\n        this.allDayElements.forEach((el) => {\n            el.addEventListener('dragover', this.handleDragOver);\n        });\n        this.setCalendarEventPointerEventsTo('none');\n    }\n}\n\nconst definePlugin = (name, definition) => {\n    definition.name = name;\n    return definition;\n};\n\nclass DragAndDropPluginImpl {\n    onRender($app) {\n        if (!$app.elements.calendarWrapper)\n            return;\n        $app.elements.calendarWrapper.dataset.hasDnd = 'true';\n    }\n    constructor(minutesPerInterval = 15) {\n        Object.defineProperty(this, \"minutesPerInterval\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: minutesPerInterval\n        });\n        Object.defineProperty(this, \"name\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: PluginName.DragAndDrop\n        });\n        this.minutesPerInterval = this.validateInterval(minutesPerInterval);\n    }\n    createTimeGridDragHandler(dependencies, dayBoundariesDateTime) {\n        return new TimeGridDragHandlerImpl(dependencies.$app, dependencies.eventCoordinates, dependencies.eventCopy, dependencies.updateCopy, dayBoundariesDateTime, this.getTimePointsForIntervalConfig());\n    }\n    getTimePointsForIntervalConfig() {\n        return (100 * this.minutesPerInterval) / 60;\n    }\n    validateInterval(minutes) {\n        if (minutes < 5) {\n            console.warn(`[Schedule-X warning]: Drag and drop plugin Interval must be at least 5 minutes. Setting to 5 minutes.`);\n            return 5;\n        }\n        if (minutes > 60) {\n            console.warn(`[Schedule-X warning]: Drag and drop plugin Interval cannot exceed 60 minutes. Setting to 60 minutes.`);\n            return 60;\n        }\n        return minutes;\n    }\n    setInterval(minutes) {\n        this.minutesPerInterval = this.validateInterval(minutes);\n    }\n    createDateGridDragHandler(dependencies) {\n        return new DateGridDragHandlerImpl(dependencies.$app, dependencies.eventCoordinates, dependencies.eventCopy, dependencies.updateCopy);\n    }\n    createMonthGridDragHandler(calendarEvent, $app) {\n        return new MonthGridDragHandlerImpl(calendarEvent, $app);\n    }\n}\nconst createDragAndDropPlugin = (minutesPerInterval = 15) => {\n    return definePlugin('dragAndDrop', new DragAndDropPluginImpl(minutesPerInterval));\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNjaGVkdWxlLXgvZHJhZy1hbmQtZHJvcC9kaXN0L2NvcmUuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsZ0NBQWdDOztBQUVqQztBQUNBO0FBQ0Esc0NBQXNDLFdBQVc7QUFDakQ7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSx3Q0FBd0MsS0FBSyxNQUFNLElBQUk7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxzREFBc0Q7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixhQUFhO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLHVCQUF1QjtBQUM5RDtBQUNBOztBQUVBO0FBQ0EsY0FBYyxVQUFVLEdBQUcsd0JBQXdCLEdBQUcsc0JBQXNCO0FBQzVFOztBQUVBO0FBQ0E7QUFDQSw2QkFBNkIsY0FBYztBQUMzQztBQUNBLG9CQUFvQixhQUFhO0FBQ2pDOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsbUJBQW1CO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBeUQsb0JBQW9CLE1BQU0sY0FBYztBQUNqRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUVBQXVFLGtCQUFrQjtBQUN6RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLFVBQVU7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsT0FBTztBQUN4QjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiw0QkFBNEIsT0FBTyxZQUFZO0FBQzlFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsMEJBQTBCOztBQUUzQjtBQUNBOztBQUVBO0FBQ0Esc0lBQXNJLHlCQUF5QjtBQUMvSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEZBQTRGLFNBQVM7QUFDckc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLDBCQUEwQjtBQUNqRCxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1FQUFtRSxZQUFZO0FBQy9FLG1FQUFtRSxZQUFZO0FBQy9FO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRW1DIiwic291cmNlcyI6WyIvVXNlcnMvbmlraXRhL0Rlc2t0b3AvZm9jdXNwaGVyZS9ub2RlX21vZHVsZXMvQHNjaGVkdWxlLXgvZHJhZy1hbmQtZHJvcC9kaXN0L2NvcmUuanMiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIFBsdWdpbk5hbWU7XG4oZnVuY3Rpb24gKFBsdWdpbk5hbWUpIHtcbiAgICBQbHVnaW5OYW1lW1wiRHJhZ0FuZERyb3BcIl0gPSBcImRyYWdBbmREcm9wXCI7XG4gICAgUGx1Z2luTmFtZVtcIkV2ZW50TW9kYWxcIl0gPSBcImV2ZW50TW9kYWxcIjtcbiAgICBQbHVnaW5OYW1lW1wiU2Nyb2xsQ29udHJvbGxlclwiXSA9IFwic2Nyb2xsQ29udHJvbGxlclwiO1xuICAgIFBsdWdpbk5hbWVbXCJFdmVudFJlY3VycmVuY2VcIl0gPSBcImV2ZW50UmVjdXJyZW5jZVwiO1xuICAgIFBsdWdpbk5hbWVbXCJSZXNpemVcIl0gPSBcInJlc2l6ZVwiO1xuICAgIFBsdWdpbk5hbWVbXCJDYWxlbmRhckNvbnRyb2xzXCJdID0gXCJjYWxlbmRhckNvbnRyb2xzXCI7XG4gICAgUGx1Z2luTmFtZVtcIkN1cnJlbnRUaW1lXCJdID0gXCJjdXJyZW50VGltZVwiO1xufSkoUGx1Z2luTmFtZSB8fCAoUGx1Z2luTmFtZSA9IHt9KSk7XG5cbmNsYXNzIEludmFsaWRUaW1lU3RyaW5nRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IodGltZVN0cmluZykge1xuICAgICAgICBzdXBlcihgSW52YWxpZCB0aW1lIHN0cmluZzogJHt0aW1lU3RyaW5nfWApO1xuICAgIH1cbn1cblxuLy8gcmVnZXggZm9yIHN0cmluZ3MgYmV0d2VlbiAwMDowMCBhbmQgMjM6NTlcbmNvbnN0IHRpbWVTdHJpbmdSZWdleCA9IC9eKDBbMC05XXwxWzAtOV18MlswLTNdKTpbMC01XVswLTldLztcblxuY2xhc3MgTnVtYmVyUmFuZ2VFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgICBjb25zdHJ1Y3RvcihtaW4sIG1heCkge1xuICAgICAgICBzdXBlcihgTnVtYmVyIG11c3QgYmUgYmV0d2VlbiAke21pbn0gYW5kICR7bWF4fS5gKTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwibWluXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBtaW5cbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm1heFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogbWF4XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuY29uc3QgZG91YmxlRGlnaXQgPSAobnVtYmVyKSA9PiB7XG4gICAgaWYgKG51bWJlciA8IDAgfHwgbnVtYmVyID4gOTkpXG4gICAgICAgIHRocm93IG5ldyBOdW1iZXJSYW5nZUVycm9yKDAsIDk5KTtcbiAgICByZXR1cm4gU3RyaW5nKG51bWJlcikucGFkU3RhcnQoMiwgJzAnKTtcbn07XG5cbmNvbnN0IG1pbnV0ZVRpbWVQb2ludE11bHRpcGxpZXIgPSAxLjY2NjY2NjY2NjY2NjY2Njc7IC8vIDEwMCAvIDYwXG5jb25zdCB0aW1lUG9pbnRzRnJvbVN0cmluZyA9ICh0aW1lU3RyaW5nKSA9PiB7XG4gICAgaWYgKCF0aW1lU3RyaW5nUmVnZXgudGVzdCh0aW1lU3RyaW5nKSAmJiB0aW1lU3RyaW5nICE9PSAnMjQ6MDAnKVxuICAgICAgICB0aHJvdyBuZXcgSW52YWxpZFRpbWVTdHJpbmdFcnJvcih0aW1lU3RyaW5nKTtcbiAgICBjb25zdCBbaG91cnNJbnQsIG1pbnV0ZXNJbnRdID0gdGltZVN0cmluZ1xuICAgICAgICAuc3BsaXQoJzonKVxuICAgICAgICAubWFwKCh0aW1lKSA9PiBwYXJzZUludCh0aW1lLCAxMCkpO1xuICAgIGxldCBtaW51dGVQb2ludHMgPSAobWludXRlc0ludCAqIG1pbnV0ZVRpbWVQb2ludE11bHRpcGxpZXIpLnRvU3RyaW5nKCk7XG4gICAgaWYgKG1pbnV0ZVBvaW50cy5zcGxpdCgnLicpWzBdLmxlbmd0aCA8IDIpXG4gICAgICAgIG1pbnV0ZVBvaW50cyA9IGAwJHttaW51dGVQb2ludHN9YDtcbiAgICByZXR1cm4gTnVtYmVyKGhvdXJzSW50ICsgbWludXRlUG9pbnRzKTtcbn07XG5jb25zdCBhZGRUaW1lUG9pbnRzVG9EYXRlVGltZSA9IChkYXRlVGltZSwgcG9pbnRzVG9BZGQpID0+IHtcbiAgICBjb25zdCBtaW51dGVzVG9BZGQgPSBNYXRoLnJvdW5kKHBvaW50c1RvQWRkIC8gbWludXRlVGltZVBvaW50TXVsdGlwbGllcik7XG4gICAgY29uc3QgbmV3RGF0ZVRpbWUgPSBkYXRlVGltZS5hZGQoeyBtaW51dGVzOiBtaW51dGVzVG9BZGQgfSk7XG4gICAgcmV0dXJuIG5ld0RhdGVUaW1lO1xufTtcblxuY29uc3QgdG9EYXRlU3RyaW5nID0gKGRhdGUpID0+IHtcbiAgICByZXR1cm4gYCR7ZGF0ZS55ZWFyfS0ke2RvdWJsZURpZ2l0KGRhdGUubW9udGgpfS0ke2RvdWJsZURpZ2l0KGRhdGUuZGF5KX1gO1xufTtcblxuY29uc3QgYWRkRGF5cyA9ICh0bywgbkRheXMpID0+IHtcbiAgICBpZiAobkRheXMgPCAwKSB7XG4gICAgICAgIHJldHVybiB0by5zdWJ0cmFjdCh7IGRheXM6IC1uRGF5cyB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHRvLmFkZCh7IGRheXM6IG5EYXlzIH0pO1xufTtcblxuY29uc3Qgc2V0RGF0ZUluRGF0ZVRpbWUgPSAoZGF0ZVRpbWUsIG5ld0RhdGUpID0+IHtcbiAgICBjb25zdCB1cGRhdGVkRGF0ZVRpbWUgPSBkYXRlVGltZS53aXRoKHtcbiAgICAgICAgeWVhcjogbmV3RGF0ZS55ZWFyLFxuICAgICAgICBtb250aDogbmV3RGF0ZS5tb250aCxcbiAgICAgICAgZGF5OiBuZXdEYXRlLmRheSxcbiAgICB9KTtcbiAgICByZXR1cm4gdXBkYXRlZERhdGVUaW1lO1xufTtcblxuY29uc3QgZ2V0VGltZUdyaWRFdmVudENvcHlFbGVtZW50SWQgPSAoaWQpID0+IHtcbiAgICByZXR1cm4gJ3RpbWUtZ3JpZC1ldmVudC1jb3B5LScgKyBpZDtcbn07XG5cbmNvbnN0IHVwZGF0ZVJlY3VycmluZ0V2ZW50ID0gKCRhcHAsIGV2ZW50Q29weSwgc3RhcnRQcmVEcmFnKSA9PiB7XG4gICAgdmFyIF9hO1xuICAgIChfYSA9ICRhcHAuY29uZmlnLnBsdWdpbnMuZXZlbnRSZWN1cnJlbmNlKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EudXBkYXRlUmVjdXJyZW5jZURORChldmVudENvcHkuaWQsIHN0YXJ0UHJlRHJhZywgZXZlbnRDb3B5LnN0YXJ0KTtcbn07XG5jb25zdCB1cGRhdGVOb25SZWN1cnJpbmdFdmVudCA9ICgkYXBwLCBldmVudENvcHkpID0+IHtcbiAgICBjb25zdCBldmVudFRvVXBkYXRlID0gJGFwcC5jYWxlbmRhckV2ZW50cy5saXN0LnZhbHVlLmZpbmQoKGV2ZW50KSA9PiBldmVudC5pZCA9PT0gZXZlbnRDb3B5LmlkKTtcbiAgICBpZiAoIWV2ZW50VG9VcGRhdGUpXG4gICAgICAgIHJldHVybjtcbiAgICBldmVudFRvVXBkYXRlLnN0YXJ0ID0gZXZlbnRDb3B5LnN0YXJ0O1xuICAgIGV2ZW50VG9VcGRhdGUuZW5kID0gZXZlbnRDb3B5LmVuZDtcbiAgICAkYXBwLmNhbGVuZGFyRXZlbnRzLmxpc3QudmFsdWUgPSBbLi4uJGFwcC5jYWxlbmRhckV2ZW50cy5saXN0LnZhbHVlXTtcbn07XG5jb25zdCB1cGRhdGVEcmFnZ2VkRXZlbnQgPSAoJGFwcCwgZXZlbnRDb3B5LCBzdGFydFByZURyYWcpID0+IHtcbiAgICBpZiAoJ3JydWxlJyBpbiBldmVudENvcHkuX2dldEZvcmVpZ25Qcm9wZXJ0aWVzKCkgJiZcbiAgICAgICAgJGFwcC5jb25maWcucGx1Z2lucy5ldmVudFJlY3VycmVuY2UpIHtcbiAgICAgICAgdXBkYXRlUmVjdXJyaW5nRXZlbnQoJGFwcCwgZXZlbnRDb3B5LCBzdGFydFByZURyYWcpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdXBkYXRlTm9uUmVjdXJyaW5nRXZlbnQoJGFwcCwgZXZlbnRDb3B5KTtcbiAgICB9XG4gICAgaWYgKCRhcHAuY29uZmlnLmNhbGxiYWNrcy5vbkV2ZW50VXBkYXRlKSB7XG4gICAgICAgICRhcHAuY29uZmlnLmNhbGxiYWNrcy5vbkV2ZW50VXBkYXRlKGV2ZW50Q29weS5fZ2V0RXh0ZXJuYWxFdmVudCgpKTtcbiAgICB9XG59O1xuXG5jb25zdCBpc1VJRXZlbnRUb3VjaEV2ZW50ID0gKGV2ZW50KSA9PiB7XG4gICAgcmV0dXJuICd0b3VjaGVzJyBpbiBldmVudCAmJiB0eXBlb2YgZXZlbnQudG91Y2hlcyA9PT0gJ29iamVjdCc7XG59O1xuXG5jb25zdCBnZXRFdmVudENvb3JkaW5hdGVzID0gKHVpRXZlbnQpID0+IHtcbiAgICBjb25zdCBhY3R1YWxFdmVudCA9IGlzVUlFdmVudFRvdWNoRXZlbnQodWlFdmVudClcbiAgICAgICAgPyB1aUV2ZW50LnRvdWNoZXNbMF1cbiAgICAgICAgOiB1aUV2ZW50O1xuICAgIHJldHVybiB7XG4gICAgICAgIGNsaWVudFg6IGFjdHVhbEV2ZW50LmNsaWVudFgsXG4gICAgICAgIGNsaWVudFk6IGFjdHVhbEV2ZW50LmNsaWVudFksXG4gICAgfTtcbn07XG5cbmNvbnN0IGdldFRpbWVQb2ludHNQZXJQaXhlbCA9ICgkYXBwKSA9PiB7XG4gICAgcmV0dXJuICRhcHAuY29uZmlnLnRpbWVQb2ludHNQZXJEYXkgLyAkYXBwLmNvbmZpZy53ZWVrT3B0aW9ucy52YWx1ZS5ncmlkSGVpZ2h0O1xufTtcblxuY29uc3QgdGVzdElmU2hvdWxkQWJvcnQgPSBhc3luYyAoJGFwcCwgXG4vKipcbiAqIEZvciB0aGUgbW9udGggZ3JpZCB0aGUgb3JpZ2luYWwgZXZlbnQgaXMgdXNlZCwgc2luY2UgdGhlcmUgaXMgbm8gY29weSBjcmVhdGVkIGZvciBkcmFnZ2luZy5cbiAqIEZvciBvdGhlciB2aWV3cywgYSBjb3B5IGlzIHVzZWQsIGhlbmNlIHRoZSBuYW1lIG9mIHRoaXMgcGFyYW1ldGVyLlxuICogKi9cbmV2ZW50Q29weU9yT3JpZ2luYWxFdmVudCwgb3JpZ2luYWxTdGFydCwgb3JpZ2luYWxFbmQsIHVwZGF0ZUNvcHkpID0+IHtcbiAgICBjb25zdCBvbkJlZm9yZUV2ZW50VXBkYXRlID0gJGFwcC5jb25maWcuY2FsbGJhY2tzLm9uQmVmb3JlRXZlbnRVcGRhdGVBc3luYyB8fFxuICAgICAgICAkYXBwLmNvbmZpZy5jYWxsYmFja3Mub25CZWZvcmVFdmVudFVwZGF0ZTtcbiAgICBpZiAob25CZWZvcmVFdmVudFVwZGF0ZSkge1xuICAgICAgICBjb25zdCBvbGRFdmVudCA9IGV2ZW50Q29weU9yT3JpZ2luYWxFdmVudC5fZ2V0RXh0ZXJuYWxFdmVudCgpO1xuICAgICAgICBvbGRFdmVudC5zdGFydCA9IG9yaWdpbmFsU3RhcnQ7XG4gICAgICAgIG9sZEV2ZW50LmVuZCA9IG9yaWdpbmFsRW5kO1xuICAgICAgICBjb25zdCBuZXdFdmVudCA9IGV2ZW50Q29weU9yT3JpZ2luYWxFdmVudC5fZ2V0RXh0ZXJuYWxFdmVudCgpO1xuICAgICAgICBjb25zdCB2YWxpZGF0aW9uUmVzdWx0ID0gYXdhaXQgb25CZWZvcmVFdmVudFVwZGF0ZShvbGRFdmVudCwgbmV3RXZlbnQsICRhcHApO1xuICAgICAgICBpZiAoIXZhbGlkYXRpb25SZXN1bHQpIHtcbiAgICAgICAgICAgIHVwZGF0ZUNvcHkgPT09IG51bGwgfHwgdXBkYXRlQ29weSA9PT0gdm9pZCAwID8gdm9pZCAwIDogdXBkYXRlQ29weSh1bmRlZmluZWQpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7IC8vIGFib3J0XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufTtcblxuY2xhc3MgVGltZUdyaWREcmFnSGFuZGxlckltcGwge1xuICAgIGNvbnN0cnVjdG9yKCRhcHAsIGV2ZW50Q29vcmRpbmF0ZXMsIGV2ZW50Q29weSwgdXBkYXRlQ29weSwgZGF5Qm91bmRhcmllc0RhdGVUaW1lLCBDSEFOR0VfVEhSRVNIT0xEX0lOX1RJTUVfUE9JTlRTKSB7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIiRhcHBcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6ICRhcHBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImV2ZW50Q29vcmRpbmF0ZXNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IGV2ZW50Q29vcmRpbmF0ZXNcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImV2ZW50Q29weVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogZXZlbnRDb3B5XG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJ1cGRhdGVDb3B5XCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB1cGRhdGVDb3B5XG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJkYXlCb3VuZGFyaWVzRGF0ZVRpbWVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IGRheUJvdW5kYXJpZXNEYXRlVGltZVxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiQ0hBTkdFX1RIUkVTSE9MRF9JTl9USU1FX1BPSU5UU1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogQ0hBTkdFX1RIUkVTSE9MRF9JTl9USU1FX1BPSU5UU1xuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiZGF5V2lkdGhcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwic3RhcnRZXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInN0YXJ0WFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJsYXN0SW50ZXJ2YWxEaWZmXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJsYXN0RGF5c0RpZmZcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm9yaWdpbmFsU3RhcnRcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwib3JpZ2luYWxFbmRcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiaGFuZGxlTW91c2VPclRvdWNoTW92ZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogKHVpRXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IGNsaWVudFgsIGNsaWVudFkgfSA9IGdldEV2ZW50Q29vcmRpbmF0ZXModWlFdmVudCk7XG4gICAgICAgICAgICAgICAgY29uc3QgcGl4ZWxEaWZmWSA9IGNsaWVudFkgLSB0aGlzLnN0YXJ0WTtcbiAgICAgICAgICAgICAgICBjb25zdCB0aW1lUG9pbnRzRGlmZlkgPSBwaXhlbERpZmZZICogdGhpcy50aW1lUG9pbnRzUGVyUGl4ZWwoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50SW50ZXJ2YWxEaWZmID0gTWF0aC5yb3VuZCh0aW1lUG9pbnRzRGlmZlkgLyB0aGlzLkNIQU5HRV9USFJFU0hPTERfSU5fVElNRV9QT0lOVFMpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHBpeGVsRGlmZlggPSBjbGllbnRYIC0gdGhpcy5zdGFydFg7XG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudERheXNEaWZmID0gTWF0aC5yb3VuZChwaXhlbERpZmZYIC8gdGhpcy5kYXlXaWR0aCk7XG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVWZXJ0aWNhbE1vdXNlT3JUb3VjaE1vdmUoY3VycmVudEludGVydmFsRGlmZik7XG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVIb3Jpem9udGFsTW91c2VPclRvdWNoTW92ZShjdXJyZW50RGF5c0RpZmYpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiaGFuZGxlTW91c2VVcE9yVG91Y2hFbmRcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLmhhbmRsZU1vdXNlT3JUb3VjaE1vdmUpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIHRoaXMuaGFuZGxlTW91c2VPclRvdWNoTW92ZSk7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHRoaXMuaGFuZGxlTW91c2VVcE9yVG91Y2hFbmQpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgdGhpcy5oYW5kbGVNb3VzZVVwT3JUb3VjaEVuZCk7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVDb3B5KHVuZGVmaW5lZCk7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2hvdWxkQWJvcnQgPSBhd2FpdCB0ZXN0SWZTaG91bGRBYm9ydCh0aGlzLiRhcHAsIHRoaXMuZXZlbnRDb3B5LCB0aGlzLm9yaWdpbmFsU3RhcnQsIHRoaXMub3JpZ2luYWxFbmQsIHRoaXMudXBkYXRlQ29weSk7XG4gICAgICAgICAgICAgICAgaWYgKHNob3VsZEFib3J0KVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVPcmlnaW5hbEV2ZW50KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmRheVdpZHRoID0gJGFwcC5lbGVtZW50cy5jYWxlbmRhcldyYXBwZXIucXVlcnlTZWxlY3RvcignLnN4X190aW1lLWdyaWQtZGF5JykuY2xpZW50V2lkdGg7XG4gICAgICAgIHRoaXMuc3RhcnRZID0gdGhpcy5ldmVudENvb3JkaW5hdGVzLmNsaWVudFk7XG4gICAgICAgIHRoaXMuc3RhcnRYID0gdGhpcy5ldmVudENvb3JkaW5hdGVzLmNsaWVudFg7XG4gICAgICAgIHRoaXMub3JpZ2luYWxTdGFydCA9IFRlbXBvcmFsLlpvbmVkRGF0ZVRpbWUuZnJvbSh0aGlzLmV2ZW50Q29weS5zdGFydC50b1N0cmluZygpKTtcbiAgICAgICAgdGhpcy5vcmlnaW5hbEVuZCA9IFRlbXBvcmFsLlpvbmVkRGF0ZVRpbWUuZnJvbSh0aGlzLmV2ZW50Q29weS5lbmQudG9TdHJpbmcoKSk7XG4gICAgICAgIHRoaXMuaW5pdCgpO1xuICAgIH1cbiAgICBpbml0KCkge1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLmhhbmRsZU1vdXNlT3JUb3VjaE1vdmUpO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgdGhpcy5oYW5kbGVNb3VzZVVwT3JUb3VjaEVuZCk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIHRoaXMuaGFuZGxlTW91c2VPclRvdWNoTW92ZSwge1xuICAgICAgICAgICAgcGFzc2l2ZTogZmFsc2UsXG4gICAgICAgIH0pO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIHRoaXMuaGFuZGxlTW91c2VVcE9yVG91Y2hFbmQpO1xuICAgIH1cbiAgICB0aW1lUG9pbnRzUGVyUGl4ZWwoKSB7XG4gICAgICAgIHJldHVybiBnZXRUaW1lUG9pbnRzUGVyUGl4ZWwodGhpcy4kYXBwKTtcbiAgICB9XG4gICAgaGFuZGxlVmVydGljYWxNb3VzZU9yVG91Y2hNb3ZlKGN1cnJlbnRJbnRlcnZhbERpZmYpIHtcbiAgICAgICAgaWYgKGN1cnJlbnRJbnRlcnZhbERpZmYgPT09IHRoaXMubGFzdEludGVydmFsRGlmZilcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgY29uc3QgcG9pbnRzVG9BZGQgPSBjdXJyZW50SW50ZXJ2YWxEaWZmID4gdGhpcy5sYXN0SW50ZXJ2YWxEaWZmXG4gICAgICAgICAgICA/IHRoaXMuQ0hBTkdFX1RIUkVTSE9MRF9JTl9USU1FX1BPSU5UUyAqXG4gICAgICAgICAgICAgICAgKGN1cnJlbnRJbnRlcnZhbERpZmYgLSB0aGlzLmxhc3RJbnRlcnZhbERpZmYpXG4gICAgICAgICAgICA6IC10aGlzLkNIQU5HRV9USFJFU0hPTERfSU5fVElNRV9QT0lOVFMgKlxuICAgICAgICAgICAgICAgICh0aGlzLmxhc3RJbnRlcnZhbERpZmYgLSBjdXJyZW50SW50ZXJ2YWxEaWZmKTtcbiAgICAgICAgdGhpcy5zZXRUaW1lRm9yRXZlbnRDb3B5KHBvaW50c1RvQWRkKTtcbiAgICAgICAgdGhpcy5sYXN0SW50ZXJ2YWxEaWZmID0gY3VycmVudEludGVydmFsRGlmZjtcbiAgICB9XG4gICAgc2V0VGltZUZvckV2ZW50Q29weShwb2ludHNUb0FkZCkge1xuICAgICAgICBjb25zdCBuZXdTdGFydCA9IGFkZFRpbWVQb2ludHNUb0RhdGVUaW1lKHRoaXMuZXZlbnRDb3B5LnN0YXJ0LCBwb2ludHNUb0FkZCk7XG4gICAgICAgIGNvbnN0IG5ld0VuZCA9IGFkZFRpbWVQb2ludHNUb0RhdGVUaW1lKHRoaXMuZXZlbnRDb3B5LmVuZCwgcG9pbnRzVG9BZGQpO1xuICAgICAgICBsZXQgY3VycmVudERpZmYgPSB0aGlzLmxhc3REYXlzRGlmZjtcbiAgICAgICAgaWYgKHRoaXMuJGFwcC5jb25maWcuZGlyZWN0aW9uID09PSAncnRsJykge1xuICAgICAgICAgICAgY3VycmVudERpZmYgPSAtY3VycmVudERpZmY7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5ld1N0YXJ0LmVwb2NoTmFub3NlY29uZHMgPFxuICAgICAgICAgICAgYWRkRGF5cyh0aGlzLmRheUJvdW5kYXJpZXNEYXRlVGltZS5zdGFydCwgY3VycmVudERpZmYpLmVwb2NoTmFub3NlY29uZHMpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGlmIChuZXdFbmQuZXBvY2hOYW5vc2Vjb25kcyA+XG4gICAgICAgICAgICBhZGREYXlzKHRoaXMuZGF5Qm91bmRhcmllc0RhdGVUaW1lLmVuZCwgY3VycmVudERpZmYpLmVwb2NoTmFub3NlY29uZHMpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMuZXZlbnRDb3B5LnN0YXJ0ID0gbmV3U3RhcnQ7XG4gICAgICAgIHRoaXMuZXZlbnRDb3B5LmVuZCA9IG5ld0VuZDtcbiAgICAgICAgdGhpcy51cGRhdGVDb3B5KHRoaXMuZXZlbnRDb3B5KTtcbiAgICB9XG4gICAgaGFuZGxlSG9yaXpvbnRhbE1vdXNlT3JUb3VjaE1vdmUodG90YWxEYXlzRGlmZikge1xuICAgICAgICBpZiAodG90YWxEYXlzRGlmZiA9PT0gdGhpcy5sYXN0RGF5c0RpZmYpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGxldCBkaWZmVG9BZGQgPSB0b3RhbERheXNEaWZmIC0gdGhpcy5sYXN0RGF5c0RpZmY7XG4gICAgICAgIGlmICh0aGlzLiRhcHAuY29uZmlnLmRpcmVjdGlvbiA9PT0gJ3J0bCcpXG4gICAgICAgICAgICBkaWZmVG9BZGQgPSAtZGlmZlRvQWRkO1xuICAgICAgICBjb25zdCBuZXdTdGFydERhdGUgPSBhZGREYXlzKHRoaXMuZXZlbnRDb3B5LnN0YXJ0LCBkaWZmVG9BZGQpO1xuICAgICAgICBjb25zdCBuZXdFbmREYXRlID0gYWRkRGF5cyh0aGlzLmV2ZW50Q29weS5lbmQsIGRpZmZUb0FkZCk7XG4gICAgICAgIGNvbnN0IG5ld1N0YXJ0ID0gc2V0RGF0ZUluRGF0ZVRpbWUodGhpcy5ldmVudENvcHkuc3RhcnQsIG5ld1N0YXJ0RGF0ZSk7XG4gICAgICAgIGNvbnN0IG5ld0VuZCA9IHNldERhdGVJbkRhdGVUaW1lKHRoaXMuZXZlbnRDb3B5LmVuZCwgbmV3RW5kRGF0ZSk7XG4gICAgICAgIGlmIChuZXdTdGFydC5lcG9jaE5hbm9zZWNvbmRzIDxcbiAgICAgICAgICAgIHRoaXMuJGFwcC5jYWxlbmRhclN0YXRlLnJhbmdlLnZhbHVlLnN0YXJ0LmVwb2NoTmFub3NlY29uZHMpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGlmIChuZXdFbmQuZXBvY2hOYW5vc2Vjb25kcyA+XG4gICAgICAgICAgICB0aGlzLiRhcHAuY2FsZW5kYXJTdGF0ZS5yYW5nZS52YWx1ZS5lbmQuZXBvY2hOYW5vc2Vjb25kcylcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy5zZXREYXRlRm9yRXZlbnRDb3B5KG5ld1N0YXJ0LCBuZXdFbmQpO1xuICAgICAgICB0aGlzLnRyYW5zZm9ybUV2ZW50Q29weVBvc2l0aW9uKHRvdGFsRGF5c0RpZmYpO1xuICAgICAgICB0aGlzLmxhc3REYXlzRGlmZiA9IHRvdGFsRGF5c0RpZmY7XG4gICAgfVxuICAgIHNldERhdGVGb3JFdmVudENvcHkobmV3U3RhcnQsIG5ld0VuZCkge1xuICAgICAgICB0aGlzLmV2ZW50Q29weS5zdGFydCA9IG5ld1N0YXJ0O1xuICAgICAgICB0aGlzLmV2ZW50Q29weS5lbmQgPSBuZXdFbmQ7XG4gICAgICAgIHRoaXMudXBkYXRlQ29weSh0aGlzLmV2ZW50Q29weSk7XG4gICAgfVxuICAgIHRyYW5zZm9ybUV2ZW50Q29weVBvc2l0aW9uKHRvdGFsRGF5c0RpZmYpIHtcbiAgICAgICAgY29uc3QgY29weUVsZW1lbnQgPSB0aGlzLiRhcHAuZWxlbWVudHMuY2FsZW5kYXJXcmFwcGVyLnF1ZXJ5U2VsZWN0b3IoJyMnICsgZ2V0VGltZUdyaWRFdmVudENvcHlFbGVtZW50SWQodGhpcy5ldmVudENvcHkuaWQpKTtcbiAgICAgICAgY29weUVsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoY2FsYygke3RvdGFsRGF5c0RpZmYgKiAxMDB9JSArICR7dG90YWxEYXlzRGlmZn1weCkpYDtcbiAgICB9XG4gICAgdXBkYXRlT3JpZ2luYWxFdmVudCgpIHtcbiAgICAgICAgaWYgKHRoaXMubGFzdEludGVydmFsRGlmZiA9PT0gMCAmJiB0aGlzLmxhc3REYXlzRGlmZiA9PT0gMClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgY29uc3QgZGF5SXNTYW1lID0gdGhpcy5sYXN0RGF5c0RpZmYgPT09IDA7XG4gICAgICAgIGNvbnN0IGV2ZW50RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLWV2ZW50LWlkPVwiJHt0aGlzLmV2ZW50Q29weS5pZH1cIl1gKTtcbiAgICAgICAgY29uc3Qgc2hvdWxkSGlkZUV2ZW50VG9QcmV2ZW50RmxpY2tlcmluZyA9ICFkYXlJc1NhbWUgJiYgZXZlbnRFbGVtZW50IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQ7XG4gICAgICAgIGlmIChzaG91bGRIaWRlRXZlbnRUb1ByZXZlbnRGbGlja2VyaW5nKVxuICAgICAgICAgICAgZXZlbnRFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIHVwZGF0ZURyYWdnZWRFdmVudCh0aGlzLiRhcHAsIHRoaXMuZXZlbnRDb3B5LCB0aGlzLm9yaWdpbmFsU3RhcnQpO1xuICAgIH1cbn1cblxuY29uc3QgZ2V0VGltZUdyaWREYXlXaWR0aCA9ICgkYXBwKSA9PiB7XG4gICAgcmV0dXJuICRhcHAuZWxlbWVudHMuY2FsZW5kYXJXcmFwcGVyLnF1ZXJ5U2VsZWN0b3IoJy5zeF9fdGltZS1ncmlkLWRheScpLmNsaWVudFdpZHRoO1xufTtcblxuY29uc3QgZ2V0RGF0ZUdyaWRFdmVudENvcHkgPSAoJGFwcCwgZXZlbnRDb3B5KSA9PiB7XG4gICAgcmV0dXJuICRhcHAuZWxlbWVudHMuY2FsZW5kYXJXcmFwcGVyLnF1ZXJ5U2VsZWN0b3IoJyMnICsgZ2V0VGltZUdyaWRFdmVudENvcHlFbGVtZW50SWQoZXZlbnRDb3B5LmlkKSk7XG59O1xuXG5jbGFzcyBEYXRlR3JpZERyYWdIYW5kbGVySW1wbCB7XG4gICAgY29uc3RydWN0b3IoJGFwcCwgZXZlbnRDb29yZGluYXRlcywgZXZlbnRDb3B5LCB1cGRhdGVDb3B5KSB7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIiRhcHBcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6ICRhcHBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImV2ZW50Q29weVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogZXZlbnRDb3B5XG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJ1cGRhdGVDb3B5XCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB1cGRhdGVDb3B5XG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJzdGFydFhcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiZGF5V2lkdGhcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwib3JpZ2luYWxTdGFydFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJvcmlnaW5hbEVuZFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJyYW5nZVN0YXJ0RGF0ZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJyYW5nZUVuZERhdGVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwibGFzdERheXNEaWZmXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJoYW5kbGVNb3VzZU9yVG91Y2hNb3ZlXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiAodWlFdmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgY2xpZW50WCB9ID0gZ2V0RXZlbnRDb29yZGluYXRlcyh1aUV2ZW50KTtcbiAgICAgICAgICAgICAgICBjb25zdCBwaXhlbERpZmZYID0gY2xpZW50WCAtIHRoaXMuc3RhcnRYO1xuICAgICAgICAgICAgICAgIGxldCBjdXJyZW50RGF5c0RpZmYgPSBNYXRoLnJvdW5kKHBpeGVsRGlmZlggLyB0aGlzLmRheVdpZHRoKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy4kYXBwLmNvbmZpZy5kaXJlY3Rpb24gPT09ICdydGwnKVxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50RGF5c0RpZmYgKj0gLTE7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnREYXlzRGlmZiA9PT0gdGhpcy5sYXN0RGF5c0RpZmYpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdTdGFydCA9IGFkZERheXModGhpcy5vcmlnaW5hbFN0YXJ0LCBjdXJyZW50RGF5c0RpZmYpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld1N0YXJ0RGF0ZSA9IFRlbXBvcmFsLlBsYWluRGF0ZS5mcm9tKG5ld1N0YXJ0KS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0VuZCA9IGFkZERheXModGhpcy5vcmlnaW5hbEVuZCwgY3VycmVudERheXNEaWZmKTtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdFbmREYXRlID0gVGVtcG9yYWwuUGxhaW5EYXRlLmZyb20obmV3RW5kKS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgIGlmIChuZXdTdGFydERhdGUgPiB0aGlzLnJhbmdlRW5kRGF0ZS50b1N0cmluZygpKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgaWYgKG5ld0VuZERhdGUgPCB0aGlzLnJhbmdlU3RhcnREYXRlLnRvU3RyaW5nKCkpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB0aGlzLmV2ZW50Q29weS5zdGFydCA9IG5ld1N0YXJ0O1xuICAgICAgICAgICAgICAgIHRoaXMuZXZlbnRDb3B5LmVuZCA9IG5ld0VuZDtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdTdGFydElzSW5XZWVrID0gbmV3U3RhcnQudG9TdHJpbmcoKSA+PSB0aGlzLnJhbmdlU3RhcnREYXRlLnRvU3RyaW5nKCkgJiZcbiAgICAgICAgICAgICAgICAgICAgbmV3U3RhcnQudG9TdHJpbmcoKSA8PSB0aGlzLnJhbmdlRW5kRGF0ZS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpcnN0RGF0ZUluR3JpZCA9IG5ld1N0YXJ0SXNJbldlZWtcbiAgICAgICAgICAgICAgICAgICAgPyBuZXdTdGFydC50b1N0cmluZygpXG4gICAgICAgICAgICAgICAgICAgIDogdGhpcy5yYW5nZVN0YXJ0RGF0ZTtcbiAgICAgICAgICAgICAgICBjb25zdCBsYXN0RGF0ZUlzSW5HcmlkID0gbmV3RW5kLnRvU3RyaW5nKCkgPj0gdGhpcy5yYW5nZVN0YXJ0RGF0ZS50b1N0cmluZygpICYmXG4gICAgICAgICAgICAgICAgICAgIG5ld0VuZC50b1N0cmluZygpIDw9IHRoaXMucmFuZ2VFbmREYXRlLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgbGFzdERhdGVJbkdyaWQgPSBsYXN0RGF0ZUlzSW5HcmlkXG4gICAgICAgICAgICAgICAgICAgID8gbmV3RW5kLnRvU3RyaW5nKClcbiAgICAgICAgICAgICAgICAgICAgOiB0aGlzLnJhbmdlRW5kRGF0ZS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgIHRoaXMuZXZlbnRDb3B5Ll9uRGF5c0luR3JpZCA9XG4gICAgICAgICAgICAgICAgICAgIE1hdGgucm91bmQoVGVtcG9yYWwuUGxhaW5EYXRlLmZyb20oZmlyc3REYXRlSW5HcmlkKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnVudGlsKFRlbXBvcmFsLlBsYWluRGF0ZS5mcm9tKGxhc3REYXRlSW5HcmlkKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50b3RhbCgnZGF5cycpKSArIDE7XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogVHJhbnNpdGlvbmluZyB0aGUgcG9zaXRpb24gc2lkZXdheXMgaXMgbm90IG5lY2Vzc2FyeSBhcyBsb25nIGFzIHRoZSBzdGFydCBkYXRlIGlzIGVhcmxpZXIgdGhhbiB0aGUgZmlyc3QgZGF0ZSBpbiB0aGUgZ3JpZC5cbiAgICAgICAgICAgICAgICAgKiBXaGlsZSBtb3ZpbmcgYW4gZXZlbnQgZHVyaW5nIGEgc3RhdGUgYXMgc3VjaCwgaXQgd2lsbCBvcHRpY2FsbHkgbG9vayBhcyBpZiBpdHMgcG9zaXRpb24gaXMgdHJhbnNpdGlvbmVkLCBzaW5jZSB0aGUgZXZlbnQgd2lkdGggaXMgaW5jcmVhc2VkIGFuZCBkZWNyZWFzZWRcbiAgICAgICAgICAgICAgICAgKiBhcyB0aGUgZXZlbnQgaXMgbW92ZWQuXG4gICAgICAgICAgICAgICAgICogKi9cbiAgICAgICAgICAgICAgICBpZiAobmV3U3RhcnQudG9TdHJpbmcoKSA+PSB0aGlzLnJhbmdlU3RhcnREYXRlLnRvU3RyaW5nKCkpXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudHJhbnNmb3JtRXZlbnRDb3B5UG9zaXRpb24obmV3U3RhcnQudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVDb3B5KHRoaXMuZXZlbnRDb3B5KTtcbiAgICAgICAgICAgICAgICB0aGlzLmxhc3REYXlzRGlmZiA9IGN1cnJlbnREYXlzRGlmZjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImhhbmRsZU1vdXNlVXBPclRvdWNoRW5kXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdGhpcy5oYW5kbGVNb3VzZU9yVG91Y2hNb3ZlKTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCB0aGlzLmhhbmRsZU1vdXNlT3JUb3VjaE1vdmUpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHNob3VsZEFib3J0ID0gYXdhaXQgdGVzdElmU2hvdWxkQWJvcnQodGhpcy4kYXBwLCB0aGlzLmV2ZW50Q29weSwgdGhpcy5vcmlnaW5hbFN0YXJ0LCB0aGlzLm9yaWdpbmFsRW5kLCB0aGlzLnVwZGF0ZUNvcHkpO1xuICAgICAgICAgICAgICAgIGlmIChzaG91bGRBYm9ydClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlT3JpZ2luYWxFdmVudCgpO1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUNvcHkodW5kZWZpbmVkKTtcbiAgICAgICAgICAgICAgICB9LCAxMCk7IC8vIFRpbWVvdXQgbmVlZGVkIHRvIHByZXZlbnQgdGhlIG9yaWdpbmFsIGZyb20gYmVpbmcgZGlzcGxheWVkIGZvciBhIHNwbGl0IHNlY29uZCwgYmVmb3JlIGJlaW5nIHJlbW92ZWQgZnJvbSBET00uXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnN0YXJ0WCA9IGV2ZW50Q29vcmRpbmF0ZXMuY2xpZW50WDtcbiAgICAgICAgdGhpcy5kYXlXaWR0aCA9IGdldFRpbWVHcmlkRGF5V2lkdGgodGhpcy4kYXBwKTtcbiAgICAgICAgdGhpcy5vcmlnaW5hbFN0YXJ0ID1cbiAgICAgICAgICAgIHRoaXMuZXZlbnRDb3B5LnN0YXJ0IGluc3RhbmNlb2YgVGVtcG9yYWwuUGxhaW5EYXRlXG4gICAgICAgICAgICAgICAgPyBUZW1wb3JhbC5QbGFpbkRhdGUuZnJvbSh0aGlzLmV2ZW50Q29weS5zdGFydC50b1N0cmluZygpKVxuICAgICAgICAgICAgICAgIDogVGVtcG9yYWwuWm9uZWREYXRlVGltZS5mcm9tKHRoaXMuZXZlbnRDb3B5LnN0YXJ0LnRvU3RyaW5nKCkpLndpdGhUaW1lWm9uZSh0aGlzLiRhcHAuY29uZmlnLnRpbWV6b25lLnZhbHVlKTtcbiAgICAgICAgdGhpcy5vcmlnaW5hbEVuZCA9XG4gICAgICAgICAgICB0aGlzLmV2ZW50Q29weS5lbmQgaW5zdGFuY2VvZiBUZW1wb3JhbC5QbGFpbkRhdGVcbiAgICAgICAgICAgICAgICA/IFRlbXBvcmFsLlBsYWluRGF0ZS5mcm9tKHRoaXMuZXZlbnRDb3B5LmVuZC50b1N0cmluZygpKVxuICAgICAgICAgICAgICAgIDogVGVtcG9yYWwuWm9uZWREYXRlVGltZS5mcm9tKHRoaXMuZXZlbnRDb3B5LmVuZC50b1N0cmluZygpKS53aXRoVGltZVpvbmUodGhpcy4kYXBwLmNvbmZpZy50aW1lem9uZS52YWx1ZSk7XG4gICAgICAgIHRoaXMucmFuZ2VTdGFydERhdGUgPSBUZW1wb3JhbC5QbGFpbkRhdGUuZnJvbSh0aGlzLiRhcHAuY2FsZW5kYXJTdGF0ZS5yYW5nZS52YWx1ZS5zdGFydCk7XG4gICAgICAgIHRoaXMucmFuZ2VFbmREYXRlID0gVGVtcG9yYWwuUGxhaW5EYXRlLmZyb20oYWRkRGF5cyh0aGlzLnJhbmdlU3RhcnREYXRlLCAkYXBwLmNvbmZpZy53ZWVrT3B0aW9ucy52YWx1ZS5uRGF5cyAtIDEpKTtcbiAgICAgICAgdGhpcy5pbml0KCk7XG4gICAgfVxuICAgIGluaXQoKSB7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMuaGFuZGxlTW91c2VPclRvdWNoTW92ZSk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCB0aGlzLmhhbmRsZU1vdXNlVXBPclRvdWNoRW5kLCB7XG4gICAgICAgICAgICBvbmNlOiB0cnVlLFxuICAgICAgICB9KTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgdGhpcy5oYW5kbGVNb3VzZU9yVG91Y2hNb3ZlLCB7XG4gICAgICAgICAgICBwYXNzaXZlOiBmYWxzZSxcbiAgICAgICAgfSk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgdGhpcy5oYW5kbGVNb3VzZVVwT3JUb3VjaEVuZCwge1xuICAgICAgICAgICAgb25jZTogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHRyYW5zZm9ybUV2ZW50Q29weVBvc2l0aW9uKG5ld1N0YXJ0RGF0ZSkge1xuICAgICAgICBjb25zdCBvcmlnaW5hbFN0YXJ0RGF0ZSA9IHRoaXMub3JpZ2luYWxTdGFydC50b1N0cmluZygpO1xuICAgICAgICBjb25zdCBvcmlnaW5hbFN0YXJ0SW5HcmlkID0gb3JpZ2luYWxTdGFydERhdGUgPj0gdGhpcy5yYW5nZVN0YXJ0RGF0ZS50b1N0cmluZygpXG4gICAgICAgICAgICA/IG9yaWdpbmFsU3RhcnREYXRlXG4gICAgICAgICAgICA6IHRoaXMucmFuZ2VTdGFydERhdGUudG9TdHJpbmcoKTtcbiAgICAgICAgbGV0IGRheXNUb1NoaWZ0ID0gTWF0aC5yb3VuZChUZW1wb3JhbC5QbGFpbkRhdGUuZnJvbShvcmlnaW5hbFN0YXJ0SW5HcmlkKVxuICAgICAgICAgICAgLnVudGlsKFRlbXBvcmFsLlBsYWluRGF0ZS5mcm9tKG5ld1N0YXJ0RGF0ZSkpXG4gICAgICAgICAgICAudG90YWwoJ2RheXMnKSk7XG4gICAgICAgIGlmICh0aGlzLiRhcHAuY29uZmlnLmRpcmVjdGlvbiA9PT0gJ3J0bCcpXG4gICAgICAgICAgICBkYXlzVG9TaGlmdCAqPSAtMTtcbiAgICAgICAgZ2V0RGF0ZUdyaWRFdmVudENvcHkodGhpcy4kYXBwLCB0aGlzLmV2ZW50Q29weSkuc3R5bGUudHJhbnNmb3JtID1cbiAgICAgICAgICAgIGB0cmFuc2xhdGVYKGNhbGMoJHtkYXlzVG9TaGlmdCAqIHRoaXMuZGF5V2lkdGh9cHggKyAke2RheXNUb1NoaWZ0fXB4KSlgO1xuICAgIH1cbiAgICB1cGRhdGVPcmlnaW5hbEV2ZW50KCkge1xuICAgICAgICBpZiAodGhpcy5sYXN0RGF5c0RpZmYgPT09IDApXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHVwZGF0ZURyYWdnZWRFdmVudCh0aGlzLiRhcHAsIHRoaXMuZXZlbnRDb3B5LCB0aGlzLm9yaWdpbmFsU3RhcnQpO1xuICAgIH1cbn1cblxuY29uc3QgY2FsY3VsYXRlRGF5c0RpZmZlcmVuY2UgPSAoc3RhcnREYXRlLCBlbmREYXRlKSA9PiB7XG4gICAgcmV0dXJuIFRlbXBvcmFsLlBsYWluRGF0ZS5mcm9tKHN0YXJ0RGF0ZSlcbiAgICAgICAgLnVudGlsKFRlbXBvcmFsLlBsYWluRGF0ZS5mcm9tKGVuZERhdGUpKVxuICAgICAgICAudG90YWwoJ2RheXMnKTtcbn07XG5cbmNvbnN0IGRhdGVGcm9tRGF0ZVRpbWUgPSAoZGF0ZVRpbWUpID0+IHtcbiAgICByZXR1cm4gZGF0ZVRpbWUuc2xpY2UoMCwgMTApO1xufTtcbmNvbnN0IHRpbWVGcm9tRGF0ZVRpbWUgPSAoZGF0ZVRpbWUpID0+IHtcbiAgICByZXR1cm4gZGF0ZVRpbWUuc2xpY2UoMTEpO1xufTtcblxudmFyIFdlZWtEYXk7XG4oZnVuY3Rpb24gKFdlZWtEYXkpIHtcbiAgICBXZWVrRGF5W1dlZWtEYXlbXCJNT05EQVlcIl0gPSAxXSA9IFwiTU9OREFZXCI7XG4gICAgV2Vla0RheVtXZWVrRGF5W1wiVFVFU0RBWVwiXSA9IDJdID0gXCJUVUVTREFZXCI7XG4gICAgV2Vla0RheVtXZWVrRGF5W1wiV0VETkVTREFZXCJdID0gM10gPSBcIldFRE5FU0RBWVwiO1xuICAgIFdlZWtEYXlbV2Vla0RheVtcIlRIVVJTREFZXCJdID0gNF0gPSBcIlRIVVJTREFZXCI7XG4gICAgV2Vla0RheVtXZWVrRGF5W1wiRlJJREFZXCJdID0gNV0gPSBcIkZSSURBWVwiO1xuICAgIFdlZWtEYXlbV2Vla0RheVtcIlNBVFVSREFZXCJdID0gNl0gPSBcIlNBVFVSREFZXCI7XG4gICAgV2Vla0RheVtXZWVrRGF5W1wiU1VOREFZXCJdID0gN10gPSBcIlNVTkRBWVwiO1xufSkoV2Vla0RheSB8fCAoV2Vla0RheSA9IHt9KSk7XG5cbldlZWtEYXkuTU9OREFZO1xuY29uc3QgREVGQVVMVF9FVkVOVF9DT0xPUl9OQU1FID0gJ3ByaW1hcnknO1xuXG5jbGFzcyBDYWxlbmRhckV2ZW50SW1wbCB7XG4gICAgY29uc3RydWN0b3IoX2NvbmZpZywgaWQsIF9zdGFydCwgX2VuZCwgdGl0bGUsIHBlb3BsZSwgbG9jYXRpb24sIGRlc2NyaXB0aW9uLCBjYWxlbmRhcklkLCBfb3B0aW9ucyA9IHVuZGVmaW5lZCwgX2N1c3RvbUNvbnRlbnQgPSB7fSwgX2ZvcmVpZ25Qcm9wZXJ0aWVzID0ge30pIHtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiX2NvbmZpZ1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogX2NvbmZpZ1xuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiaWRcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IGlkXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJfc3RhcnRcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IF9zdGFydFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiX2VuZFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogX2VuZFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwidGl0bGVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHRpdGxlXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJwZW9wbGVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHBlb3BsZVxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwibG9jYXRpb25cIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IGxvY2F0aW9uXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJkZXNjcmlwdGlvblwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogZGVzY3JpcHRpb25cbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImNhbGVuZGFySWRcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IGNhbGVuZGFySWRcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl9vcHRpb25zXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBfb3B0aW9uc1xuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiX2N1c3RvbUNvbnRlbnRcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IF9jdXN0b21Db250ZW50XG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJfZm9yZWlnblByb3BlcnRpZXNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IF9mb3JlaWduUHJvcGVydGllc1xuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiX3ByZXZpb3VzQ29uY3VycmVudEV2ZW50c1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJfdG90YWxDb25jdXJyZW50RXZlbnRzXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl9tYXhDb25jdXJyZW50RXZlbnRzXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl9uRGF5c0luR3JpZFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJfY3JlYXRlZEF0XCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl9vcmlnaW5hbFRpbWV6b25lXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl9ldmVudEZyYWdtZW50c1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZToge31cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX29yaWdpbmFsVGltZXpvbmUgPVxuICAgICAgICAgICAgdGhpcy5fc3RhcnQgaW5zdGFuY2VvZiBUZW1wb3JhbC5ab25lZERhdGVUaW1lXG4gICAgICAgICAgICAgICAgPyB0aGlzLl9zdGFydC50aW1lWm9uZUlkXG4gICAgICAgICAgICAgICAgOiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGdldCBzdGFydCgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3N0YXJ0IGluc3RhbmNlb2YgVGVtcG9yYWwuUGxhaW5EYXRlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc3RhcnQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX3N0YXJ0LndpdGhUaW1lWm9uZSh0aGlzLl9jb25maWcudGltZXpvbmUudmFsdWUpO1xuICAgIH1cbiAgICBzZXQgc3RhcnQodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fc3RhcnQgPVxuICAgICAgICAgICAgdmFsdWUgaW5zdGFuY2VvZiBUZW1wb3JhbC5ab25lZERhdGVUaW1lXG4gICAgICAgICAgICAgICAgPyB2YWx1ZS53aXRoVGltZVpvbmUodGhpcy5fb3JpZ2luYWxUaW1lem9uZSlcbiAgICAgICAgICAgICAgICA6IHZhbHVlO1xuICAgIH1cbiAgICBnZXQgZW5kKCkge1xuICAgICAgICBpZiAodGhpcy5fZW5kIGluc3RhbmNlb2YgVGVtcG9yYWwuUGxhaW5EYXRlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZW5kO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9lbmQud2l0aFRpbWVab25lKHRoaXMuX2NvbmZpZy50aW1lem9uZS52YWx1ZSk7XG4gICAgfVxuICAgIHNldCBlbmQodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fZW5kID1cbiAgICAgICAgICAgIHZhbHVlIGluc3RhbmNlb2YgVGVtcG9yYWwuWm9uZWREYXRlVGltZVxuICAgICAgICAgICAgICAgID8gdmFsdWUud2l0aFRpbWVab25lKHRoaXMuX29yaWdpbmFsVGltZXpvbmUpXG4gICAgICAgICAgICAgICAgOiB2YWx1ZTtcbiAgICB9XG4gICAgZ2V0IF9pc1NpbmdsZURheVRpbWVkKCkge1xuICAgICAgICBpZiAodGhpcy5zdGFydCBpbnN0YW5jZW9mIFRlbXBvcmFsLlBsYWluRGF0ZSB8fFxuICAgICAgICAgICAgdGhpcy5lbmQgaW5zdGFuY2VvZiBUZW1wb3JhbC5QbGFpbkRhdGUpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIGNvbnN0IGxvY2FsU3RhcnREYXRlID0gZGF0ZUZyb21EYXRlVGltZSh0aGlzLnN0YXJ0LnRvU3RyaW5nKCkpO1xuICAgICAgICBjb25zdCBsb2NhbEVuZERhdGUgPSBkYXRlRnJvbURhdGVUaW1lKHRoaXMuZW5kLnRvU3RyaW5nKCkpO1xuICAgICAgICByZXR1cm4gbG9jYWxTdGFydERhdGUgPT09IGxvY2FsRW5kRGF0ZTtcbiAgICB9XG4gICAgZ2V0IF9pc1NpbmdsZURheUZ1bGxEYXkoKSB7XG4gICAgICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IGRhdGVGcm9tRGF0ZVRpbWUodGhpcy5zdGFydC50b1N0cmluZygpKTtcbiAgICAgICAgY29uc3QgZW5kRGF0ZSA9IGRhdGVGcm9tRGF0ZVRpbWUodGhpcy5lbmQudG9TdHJpbmcoKSk7XG4gICAgICAgIHJldHVybiAoc3RhcnREYXRlID09PSBlbmREYXRlICYmXG4gICAgICAgICAgICB0aGlzLnN0YXJ0IGluc3RhbmNlb2YgVGVtcG9yYWwuUGxhaW5EYXRlICYmXG4gICAgICAgICAgICB0aGlzLmVuZCBpbnN0YW5jZW9mIFRlbXBvcmFsLlBsYWluRGF0ZSk7XG4gICAgfVxuICAgIGdldCBfaXNNdWx0aURheVRpbWVkKCkge1xuICAgICAgICBpZiAodGhpcy5zdGFydCBpbnN0YW5jZW9mIFRlbXBvcmFsLlBsYWluRGF0ZSB8fFxuICAgICAgICAgICAgdGhpcy5lbmQgaW5zdGFuY2VvZiBUZW1wb3JhbC5QbGFpbkRhdGUpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IGRhdGVGcm9tRGF0ZVRpbWUodGhpcy5zdGFydC50b1N0cmluZygpKTtcbiAgICAgICAgY29uc3QgZW5kRGF0ZSA9IGRhdGVGcm9tRGF0ZVRpbWUodGhpcy5lbmQudG9TdHJpbmcoKSk7XG4gICAgICAgIHJldHVybiBzdGFydERhdGUgIT09IGVuZERhdGU7XG4gICAgfVxuICAgIGdldCBfaXNNdWx0aURheUZ1bGxEYXkoKSB7XG4gICAgICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IGRhdGVGcm9tRGF0ZVRpbWUodGhpcy5zdGFydC50b1N0cmluZygpKTtcbiAgICAgICAgY29uc3QgZW5kRGF0ZSA9IGRhdGVGcm9tRGF0ZVRpbWUodGhpcy5lbmQudG9TdHJpbmcoKSk7XG4gICAgICAgIHJldHVybiAodGhpcy5zdGFydCBpbnN0YW5jZW9mIFRlbXBvcmFsLlBsYWluRGF0ZSAmJlxuICAgICAgICAgICAgdGhpcy5lbmQgaW5zdGFuY2VvZiBUZW1wb3JhbC5QbGFpbkRhdGUgJiZcbiAgICAgICAgICAgIHN0YXJ0RGF0ZSAhPT0gZW5kRGF0ZSk7XG4gICAgfVxuICAgIGdldCBfaXNTaW5nbGVIeWJyaWREYXlUaW1lZCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9jb25maWcuaXNIeWJyaWREYXkpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIGlmICh0aGlzLnN0YXJ0IGluc3RhbmNlb2YgVGVtcG9yYWwuUGxhaW5EYXRlIHx8XG4gICAgICAgICAgICB0aGlzLmVuZCBpbnN0YW5jZW9mIFRlbXBvcmFsLlBsYWluRGF0ZSlcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgY29uc3Qgc3RhcnREYXRlID0gZGF0ZUZyb21EYXRlVGltZSh0aGlzLnN0YXJ0LnRvU3RyaW5nKCkpO1xuICAgICAgICBjb25zdCBlbmREYXRlID0gZGF0ZUZyb21EYXRlVGltZSh0aGlzLmVuZC50b1N0cmluZygpKTtcbiAgICAgICAgY29uc3QgZW5kRGF0ZU1pbnVzT25lRGF5ID0gdG9EYXRlU3RyaW5nKFRlbXBvcmFsLlBsYWluRGF0ZS5mcm9tKGVuZERhdGUpLnN1YnRyYWN0KHsgZGF5czogMSB9KSk7XG4gICAgICAgIGlmIChzdGFydERhdGUgIT09IGVuZERhdGUgJiYgc3RhcnREYXRlICE9PSBlbmREYXRlTWludXNPbmVEYXkpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIGNvbnN0IGRheUJvdW5kYXJpZXMgPSB0aGlzLl9jb25maWcuZGF5Qm91bmRhcmllcy52YWx1ZTtcbiAgICAgICAgY29uc3QgZXZlbnRTdGFydFRpbWVQb2ludHMgPSB0aW1lUG9pbnRzRnJvbVN0cmluZyh0aW1lRnJvbURhdGVUaW1lKHRoaXMuc3RhcnQudG9TdHJpbmcoKSkpO1xuICAgICAgICBjb25zdCBldmVudEVuZFRpbWVQb2ludHMgPSB0aW1lUG9pbnRzRnJvbVN0cmluZyh0aW1lRnJvbURhdGVUaW1lKHRoaXMuZW5kLnRvU3RyaW5nKCkpKTtcbiAgICAgICAgY29uc3QgZXZlbnRJc0Z1bGx5SW5GaXJzdERheU9mQm91bmRhcnkgPSBldmVudEVuZFRpbWVQb2ludHMgPiBldmVudFN0YXJ0VGltZVBvaW50cyAmJiBzdGFydERhdGUgPT09IGVuZERhdGU7XG4gICAgICAgIHJldHVybiAoKGV2ZW50U3RhcnRUaW1lUG9pbnRzID49IGRheUJvdW5kYXJpZXMuc3RhcnQgJiZcbiAgICAgICAgICAgIChldmVudEVuZFRpbWVQb2ludHMgPD0gZGF5Qm91bmRhcmllcy5lbmQgfHxcbiAgICAgICAgICAgICAgICBldmVudElzRnVsbHlJbkZpcnN0RGF5T2ZCb3VuZGFyeSkpIHx8XG4gICAgICAgICAgICAoZXZlbnRTdGFydFRpbWVQb2ludHMgPCBkYXlCb3VuZGFyaWVzLmVuZCAmJlxuICAgICAgICAgICAgICAgIGV2ZW50RW5kVGltZVBvaW50cyA8PSBkYXlCb3VuZGFyaWVzLmVuZCkpO1xuICAgIH1cbiAgICBnZXQgX2NvbG9yKCkge1xuICAgICAgICBpZiAodGhpcy5jYWxlbmRhcklkICYmXG4gICAgICAgICAgICB0aGlzLl9jb25maWcuY2FsZW5kYXJzLnZhbHVlICYmXG4gICAgICAgICAgICB0aGlzLmNhbGVuZGFySWQgaW4gdGhpcy5fY29uZmlnLmNhbGVuZGFycy52YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbmZpZy5jYWxlbmRhcnMudmFsdWVbdGhpcy5jYWxlbmRhcklkXS5jb2xvck5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIERFRkFVTFRfRVZFTlRfQ09MT1JfTkFNRTtcbiAgICB9XG4gICAgX2dldEZvcmVpZ25Qcm9wZXJ0aWVzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZm9yZWlnblByb3BlcnRpZXM7XG4gICAgfVxuICAgIF9nZXRFeHRlcm5hbEV2ZW50KCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaWQ6IHRoaXMuaWQsXG4gICAgICAgICAgICBzdGFydDogdGhpcy5fc3RhcnQsXG4gICAgICAgICAgICBlbmQ6IHRoaXMuX2VuZCxcbiAgICAgICAgICAgIHRpdGxlOiB0aGlzLnRpdGxlLFxuICAgICAgICAgICAgcGVvcGxlOiB0aGlzLnBlb3BsZSxcbiAgICAgICAgICAgIGxvY2F0aW9uOiB0aGlzLmxvY2F0aW9uLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IHRoaXMuZGVzY3JpcHRpb24sXG4gICAgICAgICAgICBjYWxlbmRhcklkOiB0aGlzLmNhbGVuZGFySWQsXG4gICAgICAgICAgICBfb3B0aW9uczogdGhpcy5fb3B0aW9ucyxcbiAgICAgICAgICAgIC4uLnRoaXMuX2dldEZvcmVpZ25Qcm9wZXJ0aWVzKCksXG4gICAgICAgIH07XG4gICAgfVxufVxuXG5jbGFzcyBDYWxlbmRhckV2ZW50QnVpbGRlciB7XG4gICAgY29uc3RydWN0b3IoX2NvbmZpZywgaWQsIHN0YXJ0LCBlbmQpIHtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiX2NvbmZpZ1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogX2NvbmZpZ1xuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiaWRcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IGlkXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJzdGFydFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogc3RhcnRcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImVuZFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogZW5kXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJwZW9wbGVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwibG9jYXRpb25cIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiZGVzY3JpcHRpb25cIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwidGl0bGVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiY2FsZW5kYXJJZFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJfZm9yZWlnblByb3BlcnRpZXNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHt9XG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJfb3B0aW9uc1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdW5kZWZpbmVkXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJfY3VzdG9tQ29udGVudFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZToge31cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGJ1aWxkKCkge1xuICAgICAgICByZXR1cm4gbmV3IENhbGVuZGFyRXZlbnRJbXBsKHRoaXMuX2NvbmZpZywgdGhpcy5pZCwgdGhpcy5zdGFydCwgdGhpcy5lbmQsIHRoaXMudGl0bGUsIHRoaXMucGVvcGxlLCB0aGlzLmxvY2F0aW9uLCB0aGlzLmRlc2NyaXB0aW9uLCB0aGlzLmNhbGVuZGFySWQsIHRoaXMuX29wdGlvbnMsIHRoaXMuX2N1c3RvbUNvbnRlbnQsIHRoaXMuX2ZvcmVpZ25Qcm9wZXJ0aWVzKTtcbiAgICB9XG4gICAgd2l0aFRpdGxlKHRpdGxlKSB7XG4gICAgICAgIHRoaXMudGl0bGUgPSB0aXRsZTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHdpdGhQZW9wbGUocGVvcGxlKSB7XG4gICAgICAgIHRoaXMucGVvcGxlID0gcGVvcGxlO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgd2l0aExvY2F0aW9uKGxvY2F0aW9uKSB7XG4gICAgICAgIHRoaXMubG9jYXRpb24gPSBsb2NhdGlvbjtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHdpdGhEZXNjcmlwdGlvbihkZXNjcmlwdGlvbikge1xuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICB3aXRoRm9yZWlnblByb3BlcnRpZXMoZm9yZWlnblByb3BlcnRpZXMpIHtcbiAgICAgICAgdGhpcy5fZm9yZWlnblByb3BlcnRpZXMgPSBmb3JlaWduUHJvcGVydGllcztcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHdpdGhDYWxlbmRhcklkKGNhbGVuZGFySWQpIHtcbiAgICAgICAgdGhpcy5jYWxlbmRhcklkID0gY2FsZW5kYXJJZDtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHdpdGhPcHRpb25zKG9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy5fb3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICB3aXRoQ3VzdG9tQ29udGVudChjdXN0b21Db250ZW50KSB7XG4gICAgICAgIHRoaXMuX2N1c3RvbUNvbnRlbnQgPSBjdXN0b21Db250ZW50O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG59XG5cbmNvbnN0IGRlZXBDbG9uZUV2ZW50ID0gKGNhbGVuZGFyRXZlbnQsICRhcHApID0+IHtcbiAgICBjb25zdCBjYWxlbmRhckV2ZW50SW50ZXJuYWwgPSBuZXcgQ2FsZW5kYXJFdmVudEJ1aWxkZXIoJGFwcC5jb25maWcsIGNhbGVuZGFyRXZlbnQuaWQsIGNhbGVuZGFyRXZlbnQuX3N0YXJ0LCBjYWxlbmRhckV2ZW50Ll9lbmQpXG4gICAgICAgIC53aXRoVGl0bGUoY2FsZW5kYXJFdmVudC50aXRsZSlcbiAgICAgICAgLndpdGhQZW9wbGUoY2FsZW5kYXJFdmVudC5wZW9wbGUpXG4gICAgICAgIC53aXRoQ2FsZW5kYXJJZChjYWxlbmRhckV2ZW50LmNhbGVuZGFySWQpXG4gICAgICAgIC53aXRoRm9yZWlnblByb3BlcnRpZXMoSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjYWxlbmRhckV2ZW50Ll9nZXRGb3JlaWduUHJvcGVydGllcygpKSkpXG4gICAgICAgIC53aXRoTG9jYXRpb24oY2FsZW5kYXJFdmVudC5sb2NhdGlvbilcbiAgICAgICAgLndpdGhEZXNjcmlwdGlvbihjYWxlbmRhckV2ZW50LmRlc2NyaXB0aW9uKVxuICAgICAgICAud2l0aE9wdGlvbnMoY2FsZW5kYXJFdmVudC5fb3B0aW9ucylcbiAgICAgICAgLndpdGhDdXN0b21Db250ZW50KGNhbGVuZGFyRXZlbnQuX2N1c3RvbUNvbnRlbnQpXG4gICAgICAgIC5idWlsZCgpO1xuICAgIGNhbGVuZGFyRXZlbnRJbnRlcm5hbC5fbkRheXNJbkdyaWQgPSBjYWxlbmRhckV2ZW50Ll9uRGF5c0luR3JpZDtcbiAgICByZXR1cm4gY2FsZW5kYXJFdmVudEludGVybmFsO1xufTtcblxuY2xhc3MgTW9udGhHcmlkRHJhZ0hhbmRsZXJJbXBsIHtcbiAgICBjb25zdHJ1Y3RvcihjYWxlbmRhckV2ZW50LCAkYXBwKSB7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImNhbGVuZGFyRXZlbnRcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IGNhbGVuZGFyRXZlbnRcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIiRhcHBcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6ICRhcHBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImFsbERheUVsZW1lbnRzXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImN1cnJlbnREcmFnb3ZlckRhdGVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiZXZlbnRORGF5c1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJvcmlnaW5hbFN0YXJ0XCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm9yaWdpbmFsRW5kXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIk1PTlRIX0RBWV9DTEFTU19OQU1FXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiAnc3hfX21vbnRoLWdyaWQtZGF5J1xuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiTU9OVEhfREFZX1NFTEVDVE9SXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBgLiR7dGhpcy5NT05USF9EQVlfQ0xBU1NfTkFNRX1gXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJEQVlfRFJBR09WRVJfQ0xBU1NfTkFNRVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogJ3N4X19tb250aC1ncmlkLWRheS0tZHJhZ292ZXInXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJoYW5kbGVEcmFnT3ZlclwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogKGUpID0+IHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgbGV0IGRheUVsZW1lbnQgPSBlLnRhcmdldDtcbiAgICAgICAgICAgICAgICBpZiAoIShkYXlFbGVtZW50IGluc3RhbmNlb2YgSFRNTERpdkVsZW1lbnQpIHx8XG4gICAgICAgICAgICAgICAgICAgICFkYXlFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyh0aGlzLk1PTlRIX0RBWV9DTEFTU19OQU1FKSlcbiAgICAgICAgICAgICAgICAgICAgZGF5RWxlbWVudCA9IGUudGFyZ2V0LmNsb3Nlc3QodGhpcy5NT05USF9EQVlfU0VMRUNUT1IpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnREcmFnb3ZlckRhdGUgPT09IGRheUVsZW1lbnQuZGF0YXNldC5kYXRlKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50RHJhZ292ZXJEYXRlID0gZGF5RWxlbWVudC5kYXRhc2V0LmRhdGU7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3RW5kRGF0ZSA9IGFkZERheXMoVGVtcG9yYWwuUGxhaW5EYXRlLmZyb20odGhpcy5jdXJyZW50RHJhZ292ZXJEYXRlKSwgdGhpcy5ldmVudE5EYXlzIC0gMSk7XG4gICAgICAgICAgICAgICAgdGhpcy5hbGxEYXlFbGVtZW50cy5mb3JFYWNoKChlbCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXlFbGVtZW50RGF0ZSA9IGVsLmRhdGFzZXQuZGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRheUVsZW1lbnREYXRlID49IHRoaXMuY3VycmVudERyYWdvdmVyRGF0ZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgZGF5RWxlbWVudERhdGUgPD0gbmV3RW5kRGF0ZS50b1N0cmluZygpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbC5jbGFzc0xpc3QuYWRkKHRoaXMuREFZX0RSQUdPVkVSX0NMQVNTX05BTUUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLkRBWV9EUkFHT1ZFUl9DTEFTU19OQU1FKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiaGFuZGxlRHJhZ0VuZFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCB0aGlzLmhhbmRsZU1vdXNlVXApO1xuICAgICAgICAgICAgICAgIHRoaXMuYWxsRGF5RWxlbWVudHMuZm9yRWFjaCgoZWwpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignZHJhZ292ZXInLCB0aGlzLmhhbmRsZURyYWdPdmVyKTtcbiAgICAgICAgICAgICAgICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLkRBWV9EUkFHT1ZFUl9DTEFTU19OQU1FKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldENhbGVuZGFyRXZlbnRQb2ludGVyRXZlbnRzVG8oJ2F1dG8nKTtcbiAgICAgICAgICAgICAgICBjb25zdCB1cGRhdGVkRXZlbnQgPSB0aGlzLmNyZWF0ZVVwZGF0ZWRFdmVudCgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHNob3VsZEFib3J0ID0gYXdhaXQgdGVzdElmU2hvdWxkQWJvcnQodGhpcy4kYXBwLCB1cGRhdGVkRXZlbnQsIHRoaXMub3JpZ2luYWxTdGFydCwgdGhpcy5vcmlnaW5hbEVuZCk7XG4gICAgICAgICAgICAgICAgaWYgKHNob3VsZEFib3J0KVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVDYWxlbmRhckV2ZW50KHVwZGF0ZWRFdmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJoYW5kbGVNb3VzZVVwXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignZHJhZ2VuZCcsIHRoaXMuaGFuZGxlRHJhZ0VuZCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRDYWxlbmRhckV2ZW50UG9pbnRlckV2ZW50c1RvKCdhdXRvJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJzZXRDYWxlbmRhckV2ZW50UG9pbnRlckV2ZW50c1RvXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiAocG9pbnRlckV2ZW50cykgPT4ge1xuICAgICAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgICAgICAoKF9hID0gdGhpcy4kYXBwLmVsZW1lbnRzLmNhbGVuZGFyV3JhcHBlcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zeF9fZXZlbnQnKSkuZm9yRWFjaCgoZWwpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKFN0cmluZyhlbC5kYXRhc2V0LmV2ZW50SWQpID09PSBTdHJpbmcodGhpcy5jYWxlbmRhckV2ZW50LmlkKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgZWwuc3R5bGUucG9pbnRlckV2ZW50cyA9IHBvaW50ZXJFdmVudHM7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJjcmVhdGVVcGRhdGVkRXZlbnRcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6ICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBldmVudENvcHkgPSBkZWVwQ2xvbmVFdmVudCh0aGlzLmNhbGVuZGFyRXZlbnQsIHRoaXMuJGFwcCk7XG4gICAgICAgICAgICAgICAgY29uc3QgZGlmZk9sZERhdGVBbmROZXdEYXRlID0gY2FsY3VsYXRlRGF5c0RpZmZlcmVuY2UoVGVtcG9yYWwuUGxhaW5EYXRlLmZyb20odGhpcy5jYWxlbmRhckV2ZW50LnN0YXJ0KSwgVGVtcG9yYWwuUGxhaW5EYXRlLmZyb20odGhpcy5jdXJyZW50RHJhZ292ZXJEYXRlKSk7XG4gICAgICAgICAgICAgICAgZXZlbnRDb3B5LnN0YXJ0ID0gYWRkRGF5cyhldmVudENvcHkuc3RhcnQsIGRpZmZPbGREYXRlQW5kTmV3RGF0ZSk7XG4gICAgICAgICAgICAgICAgZXZlbnRDb3B5LmVuZCA9IGFkZERheXMoZXZlbnRDb3B5LmVuZCwgZGlmZk9sZERhdGVBbmROZXdEYXRlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZXZlbnRDb3B5O1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwidXBkYXRlQ2FsZW5kYXJFdmVudFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogKG5ld0V2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgdXBkYXRlRHJhZ2dlZEV2ZW50KHRoaXMuJGFwcCwgbmV3RXZlbnQsIHRoaXMub3JpZ2luYWxTdGFydCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLm9yaWdpbmFsU3RhcnQgPSB0aGlzLmNhbGVuZGFyRXZlbnQuc3RhcnQ7XG4gICAgICAgIHRoaXMub3JpZ2luYWxFbmQgPSB0aGlzLmNhbGVuZGFyRXZlbnQuZW5kO1xuICAgICAgICB0aGlzLmFsbERheUVsZW1lbnRzID0gJGFwcC5lbGVtZW50cy5jYWxlbmRhcldyYXBwZXIucXVlcnlTZWxlY3RvckFsbCh0aGlzLk1PTlRIX0RBWV9TRUxFQ1RPUik7XG4gICAgICAgIHRoaXMuZXZlbnRORGF5cyA9XG4gICAgICAgICAgICBjYWxjdWxhdGVEYXlzRGlmZmVyZW5jZSh0aGlzLmNhbGVuZGFyRXZlbnQuc3RhcnQsIHRoaXMuY2FsZW5kYXJFdmVudC5lbmQpICsgMTtcbiAgICAgICAgdGhpcy5pbml0KCk7XG4gICAgfVxuICAgIGluaXQoKSB7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdlbmQnLCB0aGlzLmhhbmRsZURyYWdFbmQsIHsgb25jZTogdHJ1ZSB9KTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHRoaXMuaGFuZGxlTW91c2VVcCwgeyBvbmNlOiB0cnVlIH0pO1xuICAgICAgICB0aGlzLmFsbERheUVsZW1lbnRzLmZvckVhY2goKGVsKSA9PiB7XG4gICAgICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIHRoaXMuaGFuZGxlRHJhZ092ZXIpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zZXRDYWxlbmRhckV2ZW50UG9pbnRlckV2ZW50c1RvKCdub25lJyk7XG4gICAgfVxufVxuXG5jb25zdCBkZWZpbmVQbHVnaW4gPSAobmFtZSwgZGVmaW5pdGlvbikgPT4ge1xuICAgIGRlZmluaXRpb24ubmFtZSA9IG5hbWU7XG4gICAgcmV0dXJuIGRlZmluaXRpb247XG59O1xuXG5jbGFzcyBEcmFnQW5kRHJvcFBsdWdpbkltcGwge1xuICAgIG9uUmVuZGVyKCRhcHApIHtcbiAgICAgICAgaWYgKCEkYXBwLmVsZW1lbnRzLmNhbGVuZGFyV3JhcHBlcilcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgJGFwcC5lbGVtZW50cy5jYWxlbmRhcldyYXBwZXIuZGF0YXNldC5oYXNEbmQgPSAndHJ1ZSc7XG4gICAgfVxuICAgIGNvbnN0cnVjdG9yKG1pbnV0ZXNQZXJJbnRlcnZhbCA9IDE1KSB7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm1pbnV0ZXNQZXJJbnRlcnZhbFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogbWludXRlc1BlckludGVydmFsXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJuYW1lXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBQbHVnaW5OYW1lLkRyYWdBbmREcm9wXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLm1pbnV0ZXNQZXJJbnRlcnZhbCA9IHRoaXMudmFsaWRhdGVJbnRlcnZhbChtaW51dGVzUGVySW50ZXJ2YWwpO1xuICAgIH1cbiAgICBjcmVhdGVUaW1lR3JpZERyYWdIYW5kbGVyKGRlcGVuZGVuY2llcywgZGF5Qm91bmRhcmllc0RhdGVUaW1lKSB7XG4gICAgICAgIHJldHVybiBuZXcgVGltZUdyaWREcmFnSGFuZGxlckltcGwoZGVwZW5kZW5jaWVzLiRhcHAsIGRlcGVuZGVuY2llcy5ldmVudENvb3JkaW5hdGVzLCBkZXBlbmRlbmNpZXMuZXZlbnRDb3B5LCBkZXBlbmRlbmNpZXMudXBkYXRlQ29weSwgZGF5Qm91bmRhcmllc0RhdGVUaW1lLCB0aGlzLmdldFRpbWVQb2ludHNGb3JJbnRlcnZhbENvbmZpZygpKTtcbiAgICB9XG4gICAgZ2V0VGltZVBvaW50c0ZvckludGVydmFsQ29uZmlnKCkge1xuICAgICAgICByZXR1cm4gKDEwMCAqIHRoaXMubWludXRlc1BlckludGVydmFsKSAvIDYwO1xuICAgIH1cbiAgICB2YWxpZGF0ZUludGVydmFsKG1pbnV0ZXMpIHtcbiAgICAgICAgaWYgKG1pbnV0ZXMgPCA1KSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oYFtTY2hlZHVsZS1YIHdhcm5pbmddOiBEcmFnIGFuZCBkcm9wIHBsdWdpbiBJbnRlcnZhbCBtdXN0IGJlIGF0IGxlYXN0IDUgbWludXRlcy4gU2V0dGluZyB0byA1IG1pbnV0ZXMuYCk7XG4gICAgICAgICAgICByZXR1cm4gNTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobWludXRlcyA+IDYwKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oYFtTY2hlZHVsZS1YIHdhcm5pbmddOiBEcmFnIGFuZCBkcm9wIHBsdWdpbiBJbnRlcnZhbCBjYW5ub3QgZXhjZWVkIDYwIG1pbnV0ZXMuIFNldHRpbmcgdG8gNjAgbWludXRlcy5gKTtcbiAgICAgICAgICAgIHJldHVybiA2MDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbWludXRlcztcbiAgICB9XG4gICAgc2V0SW50ZXJ2YWwobWludXRlcykge1xuICAgICAgICB0aGlzLm1pbnV0ZXNQZXJJbnRlcnZhbCA9IHRoaXMudmFsaWRhdGVJbnRlcnZhbChtaW51dGVzKTtcbiAgICB9XG4gICAgY3JlYXRlRGF0ZUdyaWREcmFnSGFuZGxlcihkZXBlbmRlbmNpZXMpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEYXRlR3JpZERyYWdIYW5kbGVySW1wbChkZXBlbmRlbmNpZXMuJGFwcCwgZGVwZW5kZW5jaWVzLmV2ZW50Q29vcmRpbmF0ZXMsIGRlcGVuZGVuY2llcy5ldmVudENvcHksIGRlcGVuZGVuY2llcy51cGRhdGVDb3B5KTtcbiAgICB9XG4gICAgY3JlYXRlTW9udGhHcmlkRHJhZ0hhbmRsZXIoY2FsZW5kYXJFdmVudCwgJGFwcCkge1xuICAgICAgICByZXR1cm4gbmV3IE1vbnRoR3JpZERyYWdIYW5kbGVySW1wbChjYWxlbmRhckV2ZW50LCAkYXBwKTtcbiAgICB9XG59XG5jb25zdCBjcmVhdGVEcmFnQW5kRHJvcFBsdWdpbiA9IChtaW51dGVzUGVySW50ZXJ2YWwgPSAxNSkgPT4ge1xuICAgIHJldHVybiBkZWZpbmVQbHVnaW4oJ2RyYWdBbmREcm9wJywgbmV3IERyYWdBbmREcm9wUGx1Z2luSW1wbChtaW51dGVzUGVySW50ZXJ2YWwpKTtcbn07XG5cbmV4cG9ydCB7IGNyZWF0ZURyYWdBbmREcm9wUGx1Z2luIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@schedule-x/drag-and-drop/dist/core.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@schedule-x/event-modal/dist/core.js":
/*!***********************************************************!*\
  !*** ./node_modules/@schedule-x/event-modal/dist/core.js ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createEventModalPlugin: () => (/* binding */ createEventModalPlugin)\n/* harmony export */ });\n/* harmony import */ var preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! preact/jsx-runtime */ \"(ssr)/./node_modules/preact/jsx-runtime/dist/jsxRuntime.mjs\");\n/* harmony import */ var preact_hooks__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! preact/hooks */ \"(ssr)/./node_modules/preact/hooks/dist/hooks.mjs\");\n/* harmony import */ var _preact_signals__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @preact/signals */ \"(ssr)/./node_modules/@preact/signals/dist/signals.mjs\");\n\n\n\n\nvar PluginName;\n(function (PluginName) {\n    PluginName[\"DragAndDrop\"] = \"dragAndDrop\";\n    PluginName[\"EventModal\"] = \"eventModal\";\n    PluginName[\"ScrollController\"] = \"scrollController\";\n    PluginName[\"EventRecurrence\"] = \"eventRecurrence\";\n    PluginName[\"Resize\"] = \"resize\";\n    PluginName[\"CalendarControls\"] = \"calendarControls\";\n    PluginName[\"CurrentTime\"] = \"currentTime\";\n})(PluginName || (PluginName = {}));\n\n/**\n * Can be used for generating a random id for an entity\n * Should, however, never be used in potentially resource intense loops,\n * since the performance cost of this compared to new Date().getTime() is ca x4 in v8\n * */\nconst randomStringId = () => 's' + Math.random().toString(36).substring(2, 11);\n\nconst createClickOutsideListener = ($app, modalId) => {\n    return function (e) {\n        if (!(e.target instanceof HTMLElement))\n            return;\n        if (e.target.closest(`#${modalId}`))\n            return;\n        $app.config.plugins.eventModal.close();\n    };\n};\n\nconst setPosition = (appDOMRect, eventDOMRect, modalHeight = 250) => {\n    const MODAL_WIDTH = 400;\n    const INLINE_SPACE_BETWEEN_MODAL_AND_EVENT = 10;\n    const WIDTH_NEEDED = MODAL_WIDTH + INLINE_SPACE_BETWEEN_MODAL_AND_EVENT;\n    const hasSpaceTop = eventDOMRect.bottom - appDOMRect.top > modalHeight;\n    const eventBottomLessThanAppBottom = eventDOMRect.bottom < appDOMRect.bottom;\n    const eventTopLessThanAppTop = eventDOMRect.top < appDOMRect.top;\n    let top = 0;\n    let left = 0;\n    let animationStart = '0%';\n    if (appDOMRect.bottom - eventDOMRect.top > modalHeight &&\n        !eventTopLessThanAppTop) {\n        top = eventDOMRect.top;\n    }\n    else if (hasSpaceTop && eventBottomLessThanAppBottom) {\n        top = eventDOMRect.bottom - modalHeight;\n    }\n    else if (hasSpaceTop && !eventBottomLessThanAppBottom) {\n        top = appDOMRect.bottom - modalHeight;\n    }\n    else {\n        top = appDOMRect.top;\n    }\n    if (appDOMRect.right - eventDOMRect.right > WIDTH_NEEDED) {\n        left = eventDOMRect.right + INLINE_SPACE_BETWEEN_MODAL_AND_EVENT;\n        animationStart = '-10%';\n    }\n    else if (eventDOMRect.left - appDOMRect.left > WIDTH_NEEDED) {\n        left = eventDOMRect.left - WIDTH_NEEDED;\n        animationStart = '10%';\n    }\n    else {\n        left = appDOMRect.left;\n    }\n    document.documentElement.style.setProperty('--sx-event-modal-animation-start', animationStart);\n    document.documentElement.style.setProperty('--sx-event-modal-top', `${top}px`);\n    document.documentElement.style.setProperty('--sx-event-modal-left', `${left}px`);\n};\n\n/**\n * Origin of SVG: https://www.svgrepo.com/svg/506771/time\n * License: PD License\n * Author Salah Elimam\n * Author website: https://www.figma.com/@salahelimam\n * */\nfunction TimeIcon({ strokeColor }) {\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(\"svg\", { className: \"sx__event-icon\", viewBox: \"0 0 24 24\", fill: \"none\", xmlns: \"http://www.w3.org/2000/svg\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"g\", { id: \"SVGRepo_bgCarrier\", \"stroke-width\": \"0\" }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"g\", { id: \"SVGRepo_tracerCarrier\", \"stroke-linecap\": \"round\", \"stroke-linejoin\": \"round\" }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(\"g\", { id: \"SVGRepo_iconCarrier\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"path\", { d: \"M12 8V12L15 15\", stroke: strokeColor, \"stroke-width\": \"2\", \"stroke-linecap\": \"round\" }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"circle\", { cx: \"12\", cy: \"12\", r: \"9\", stroke: strokeColor, \"stroke-width\": \"2\" })] })] }) }));\n}\n\n/**\n * Origin of SVG: https://www.svgrepo.com/svg/506772/user\n * License: PD License\n * Author Salah Elimam\n * Author website: https://www.figma.com/@salahelimam\n * */\nfunction UserIcon({ strokeColor }) {\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(\"svg\", { className: \"sx__event-icon\", viewBox: \"0 0 24 24\", fill: \"none\", xmlns: \"http://www.w3.org/2000/svg\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"g\", { id: \"SVGRepo_bgCarrier\", \"stroke-width\": \"0\" }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"g\", { id: \"SVGRepo_tracerCarrier\", \"stroke-linecap\": \"round\", \"stroke-linejoin\": \"round\" }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(\"g\", { id: \"SVGRepo_iconCarrier\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"path\", { d: \"M15 7C15 8.65685 13.6569 10 12 10C10.3431 10 9 8.65685 9 7C9 5.34315 10.3431 4 12 4C13.6569 4 15 5.34315 15 7Z\", stroke: strokeColor, \"stroke-width\": \"2\" }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"path\", { d: \"M5 19.5C5 15.9101 7.91015 13 11.5 13H12.5C16.0899 13 19 15.9101 19 19.5V20C19 20.5523 18.5523 21 18 21H6C5.44772 21 5 20.5523 5 20V19.5Z\", stroke: strokeColor, \"stroke-width\": \"2\" })] })] }) }));\n}\n\nconst concatenatePeople = (people) => {\n    return people.reduce((acc, person, index) => {\n        if (index === 0)\n            return person;\n        if (index === people.length - 1)\n            return `${acc} & ${person}`;\n        return `${acc}, ${person}`;\n    }, '');\n};\n\n/**\n * Origin of SVG: https://www.svgrepo.com/svg/489502/location-pin\n * License: PD License\n * Author: Dariush Habibpour\n * Author website: https://redl.ink/dariush/links?ref=svgrepo.com\n * */\nfunction LocationPinIcon({ strokeColor }) {\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(\"svg\", { className: \"sx__event-icon\", viewBox: \"0 0 24 24\", fill: \"none\", xmlns: \"http://www.w3.org/2000/svg\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"g\", { id: \"SVGRepo_bgCarrier\", \"stroke-width\": \"0\" }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"g\", { id: \"SVGRepo_tracerCarrier\", \"stroke-linecap\": \"round\", \"stroke-linejoin\": \"round\" }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(\"g\", { id: \"SVGRepo_iconCarrier\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(\"g\", { \"clip-path\": \"url(#clip0_429_11046)\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"rect\", { x: \"12\", y: \"11\", width: \"0.01\", height: \"0.01\", stroke: strokeColor, \"stroke-width\": \"2\", \"stroke-linejoin\": \"round\" }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"path\", { d: \"M12 22L17.5 16.5C20.5376 13.4624 20.5376 8.53757 17.5 5.5C14.4624 2.46244 9.53757 2.46244 6.5 5.5C3.46244 8.53757 3.46244 13.4624 6.5 16.5L12 22Z\", stroke: strokeColor, \"stroke-width\": \"2\", \"stroke-linejoin\": \"round\" })] }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"defs\", { children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"clipPath\", { id: \"clip0_429_11046\", children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"rect\", { width: \"24\", height: \"24\", fill: \"white\" }) }) })] })] }) }));\n}\n\n/**\n * Origin of SVG: https://www.svgrepo.com/svg/506838/list\n * License: PD License\n * Author: Salah Elimam\n * Author website: https://www.figma.com/@salahelimam\n * */\nfunction DescriptionIcon({ strokeColor }) {\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(\"svg\", { className: \"sx__event-icon\", viewBox: \"0 0 24 24\", fill: \"none\", xmlns: \"http://www.w3.org/2000/svg\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"g\", { id: \"SVGRepo_bgCarrier\", \"stroke-width\": \"0\" }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"g\", { id: \"SVGRepo_tracerCarrier\", \"stroke-linecap\": \"round\", \"stroke-linejoin\": \"round\" }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(\"g\", { id: \"SVGRepo_iconCarrier\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"rect\", { x: \"4\", y: \"4\", width: \"16\", height: \"16\", rx: \"3\", stroke: strokeColor, \"stroke-width\": \"2\" }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"path\", { d: \"M16 10L8 10\", stroke: strokeColor, \"stroke-width\": \"2\", \"stroke-linecap\": \"round\" }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"path\", { d: \"M16 14L8 14\", stroke: strokeColor, \"stroke-width\": \"2\", \"stroke-linecap\": \"round\" })] })] }) }));\n}\n\nconst toIntegers = (dateTimeSpecification) => {\n    const hours = dateTimeSpecification.slice(11, 13), minutes = dateTimeSpecification.slice(14, 16);\n    return {\n        year: Number(dateTimeSpecification.slice(0, 4)),\n        month: Number(dateTimeSpecification.slice(5, 7)) - 1,\n        date: Number(dateTimeSpecification.slice(8, 10)),\n        hours: hours !== '' ? Number(hours) : undefined,\n        minutes: minutes !== '' ? Number(minutes) : undefined,\n    };\n};\n\nconst dateFn = (dateTime, locale) => {\n    return dateTime.toLocaleString(locale, {\n        day: 'numeric',\n        month: 'long',\n        year: 'numeric',\n    });\n};\nconst timeFn = (dateTime, locale) => {\n    const dateTimeString = dateTime.toString();\n    const { year, month, date, hours, minutes } = toIntegers(dateTimeString);\n    return new Date(year, month, date, hours, minutes).toLocaleTimeString(locale, {\n        hour: 'numeric',\n        minute: 'numeric',\n    });\n};\nconst getTimeStamp = (calendarEvent, // to facilitate testing. In reality, we will always have a full CalendarEventInternal\nlocale, delimiter = '\\u2013') => {\n    var _a, _b, _c, _d;\n    const eventTime = { start: calendarEvent.start, end: calendarEvent.end };\n    if (calendarEvent._isSingleDayFullDay) {\n        return dateFn(eventTime.start, locale);\n    }\n    if (calendarEvent._isMultiDayFullDay) {\n        return `${dateFn(eventTime.start, locale)} ${delimiter} ${dateFn(eventTime.end, locale)}`;\n    }\n    if (calendarEvent._isSingleDayTimed &&\n        ((_a = eventTime.start) === null || _a === void 0 ? void 0 : _a.toString()) !== ((_b = eventTime.end) === null || _b === void 0 ? void 0 : _b.toString())) {\n        return `${dateFn(eventTime.start, locale)} <span aria-hidden=\"true\"></span> ${timeFn(eventTime.start, locale)} ${delimiter} ${timeFn(eventTime.end, locale)}`;\n    }\n    if (calendarEvent._isSingleDayTimed &&\n        ((_c = calendarEvent.start) === null || _c === void 0 ? void 0 : _c.toString()) === ((_d = calendarEvent.end) === null || _d === void 0 ? void 0 : _d.toString())) {\n        return `${dateFn(eventTime.start, locale)}, ${timeFn(eventTime.start, locale)}`;\n    }\n    return `${dateFn(eventTime.start, locale)}, ${timeFn(eventTime.start, locale)} ${delimiter} ${dateFn(eventTime.end, locale)}, ${timeFn(eventTime.end, locale)}`;\n};\n\nconst useIconColors = ($app) => {\n    const ICON_COLOR_LIGHT_MODE = 'var(--sx-internal-color-text)';\n    const ICON_COLOR_DARK_MODE = 'var(--sx-color-neutral-variant)';\n    const iconColor = (0,_preact_signals__WEBPACK_IMPORTED_MODULE_2__.signal)($app.calendarState.isDark.value\n        ? ICON_COLOR_DARK_MODE\n        : ICON_COLOR_LIGHT_MODE);\n    (0,_preact_signals__WEBPACK_IMPORTED_MODULE_2__.effect)(() => {\n        if ($app.calendarState.isDark.value)\n            iconColor.value = ICON_COLOR_DARK_MODE;\n        else\n            iconColor.value = ICON_COLOR_LIGHT_MODE;\n    });\n    return iconColor;\n};\n\nconst isScrollable = (el) => {\n    if (el) {\n        const hasScrollableContent = el.scrollHeight > el.clientHeight;\n        const overflowYStyle = window.getComputedStyle(el).overflowY;\n        const isOverflowHidden = overflowYStyle.indexOf('hidden') !== -1;\n        return hasScrollableContent && !isOverflowHidden;\n    }\n    return true;\n};\nconst getScrollableParents = (el, acc = []) => {\n    if (!el ||\n        el === document.body ||\n        el.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n        acc.push(window);\n        return acc;\n    }\n    if (isScrollable(el)) {\n        acc.push(el);\n    }\n    return getScrollableParents((el.assignedSlot\n        ? el.assignedSlot.parentNode\n        : el.parentNode), acc);\n};\n\n/**\n * Push a task to the end of the current call stack\n * */\nconst nextTick = (cb) => {\n    setTimeout(() => {\n        cb();\n    });\n};\n\nfunction EventModal({ $app }) {\n    const [modalId] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_1__.useState)(randomStringId());\n    const { value: calendarEvent } = $app.config.plugins.eventModal.calendarEvent;\n    const [isDisplayed, setIsDisplayed] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const customComponent = $app.config._customComponentFns.eventModal;\n    const [eventWrapperStyle, setEventWrapperStyle] = (0,preact_hooks__WEBPACK_IMPORTED_MODULE_1__.useState)('sx__event-modal');\n    const callSetPosition = () => {\n        var _a, _b, _c;\n        setPosition((_a = $app.elements.calendarWrapper) === null || _a === void 0 ? void 0 : _a.getBoundingClientRect(), (_b = $app.config.plugins.eventModal) === null || _b === void 0 ? void 0 : _b.calendarEventDOMRect.value, ((_c = $app.elements.calendarWrapper) === null || _c === void 0 ? void 0 : _c.querySelector('.sx__event-modal')).clientHeight);\n    };\n    const scrollListener = () => {\n        var _a, _b;\n        $app.config.plugins.eventModal.calendarEventDOMRect.value =\n            (_b = (_a = $app.config.plugins.eventModal) === null || _a === void 0 ? void 0 : _a.calendarEventElement.value) === null || _b === void 0 ? void 0 : _b.getBoundingClientRect();\n        callSetPosition();\n    };\n    (0,preact_hooks__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n        var _a;\n        if (customComponent) {\n            customComponent(document.querySelector(`[data-ccid=${modalId}]`), {\n                calendarEvent: calendarEvent === null || calendarEvent === void 0 ? void 0 : calendarEvent._getExternalEvent(),\n            });\n        }\n        else {\n            setEventWrapperStyle(eventWrapperStyle.concat(' sx__event-modal-default'));\n        }\n        nextTick(() => {\n            callSetPosition();\n        });\n        setIsDisplayed(true);\n        const clickOutsideListener = createClickOutsideListener($app, modalId);\n        const scrollableAncestors = getScrollableParents(((_a = $app.config.plugins.eventModal) === null || _a === void 0 ? void 0 : _a.calendarEventElement.value) || null);\n        scrollableAncestors.forEach((el) => el.addEventListener('scroll', scrollListener));\n        document.addEventListener('click', clickOutsideListener);\n        return () => {\n            document.removeEventListener('click', clickOutsideListener);\n            scrollableAncestors.forEach((el) => el.removeEventListener('scroll', scrollListener));\n        };\n    }, []);\n    const iconColor = useIconColors($app);\n    return ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: calendarEvent && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"div\", { id: modalId, tabIndex: 0, \"data-ccid\": modalId, className: `${eventWrapperStyle}${isDisplayed ? ' is-open' : ''}`, children: !customComponent && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(\"div\", { className: \"sx__has-icon sx__event-modal__title\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"div\", { style: {\n                                    backgroundColor: `var(--sx-color-${calendarEvent._color}-container)`,\n                                }, className: \"sx__event-modal__color-icon sx__event-icon\" }), calendarEvent.title] }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(\"div\", { className: \"sx__has-icon sx__event-modal__time\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(TimeIcon, { strokeColor: iconColor.value }), (0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"div\", { dangerouslySetInnerHTML: {\n                                    __html: getTimeStamp(calendarEvent, $app.config.locale.value),\n                                } })] }), calendarEvent.people && calendarEvent.people.length && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(\"div\", { className: \"sx__has-icon sx__event-modal__people\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(UserIcon, { strokeColor: iconColor.value }), concatenatePeople(calendarEvent.people)] })), calendarEvent.location && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(\"div\", { className: \"sx__has-icon sx__event-modal__location\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(LocationPinIcon, { strokeColor: iconColor.value }), calendarEvent.location] })), calendarEvent.description && ((0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(\"div\", { className: \"sx__has-icon sx__event-modal__description\", children: [(0,preact_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(DescriptionIcon, { strokeColor: iconColor.value }), calendarEvent.description] }))] })) })) }));\n}\n\nconst definePlugin = (name, definition) => {\n    definition.name = name;\n    return definition;\n};\n\nclass EventModalPluginImpl {\n    constructor() {\n        Object.defineProperty(this, \"name\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: PluginName.EventModal\n        });\n        Object.defineProperty(this, \"calendarEvent\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: (0,_preact_signals__WEBPACK_IMPORTED_MODULE_2__.signal)(null)\n        });\n        Object.defineProperty(this, \"calendarEventDOMRect\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: (0,_preact_signals__WEBPACK_IMPORTED_MODULE_2__.signal)(null)\n        });\n        Object.defineProperty(this, \"calendarEventElement\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: (0,_preact_signals__WEBPACK_IMPORTED_MODULE_2__.signal)(null)\n        });\n        Object.defineProperty(this, \"ComponentFn\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: EventModal\n        });\n    }\n    setCalendarEvent(event, eventTargetDOMRect) {\n        (0,_preact_signals__WEBPACK_IMPORTED_MODULE_2__.batch)(() => {\n            this.calendarEvent.value = event;\n            this.calendarEventDOMRect.value = eventTargetDOMRect;\n        });\n    }\n    close() {\n        (0,_preact_signals__WEBPACK_IMPORTED_MODULE_2__.batch)(() => {\n            this.calendarEvent.value = null;\n            this.calendarEventDOMRect.value = null;\n        });\n    }\n}\nconst createEventModalPlugin = () => {\n    return definePlugin('eventModal', new EventModalPluginImpl());\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNjaGVkdWxlLXgvZXZlbnQtbW9kYWwvZGlzdC9jb3JlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBeUQ7QUFDTjtBQUNLOztBQUV4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLGdDQUFnQzs7QUFFakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLFFBQVE7QUFDekM7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBFQUEwRSxJQUFJO0FBQzlFLDJFQUEyRSxLQUFLO0FBQ2hGOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixhQUFhO0FBQ2pDLFlBQVksdURBQUcsQ0FBQyx3REFBUSxJQUFJLFVBQVUsd0RBQUksVUFBVSxpSEFBaUgsdURBQUcsUUFBUSw4Q0FBOEMsR0FBRyx1REFBRyxRQUFRLG9GQUFvRixHQUFHLHdEQUFJLFFBQVEsc0NBQXNDLHVEQUFHLFdBQVcsMEZBQTBGLEdBQUcsdURBQUcsYUFBYSxzRUFBc0UsSUFBSSxJQUFJLEdBQUc7QUFDamtCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixhQUFhO0FBQ2pDLFlBQVksdURBQUcsQ0FBQyx3REFBUSxJQUFJLFVBQVUsd0RBQUksVUFBVSxpSEFBaUgsdURBQUcsUUFBUSw4Q0FBOEMsR0FBRyx1REFBRyxRQUFRLG9GQUFvRixHQUFHLHdEQUFJLFFBQVEsc0NBQXNDLHVEQUFHLFdBQVcsK0pB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a0NBQWtDLHdEQUFJLENBQUMsd0RBQVEsSUFBSSxXQUFXLHdEQUFJLFVBQVUsNkRBQTZELHVEQUFHLFVBQVU7QUFDM1UsdUVBQXVFLHFCQUFxQjtBQUM1RixpQ0FBaUMsMkRBQTJELHlCQUF5QixHQUFHLHdEQUFJLFVBQVUsNERBQTRELHVEQUFHLGFBQWEsOEJBQThCLEdBQUcsdURBQUcsVUFBVTtBQUNoUTtBQUNBLG1DQUFtQyxJQUFJLDJEQUEyRCx3REFBSSxVQUFVLDhEQUE4RCx1REFBRyxhQUFhLDhCQUE4Qiw2Q0FBNkMsK0JBQStCLHdEQUFJLFVBQVUsZ0VBQWdFLHVEQUFHLG9CQUFvQiw4QkFBOEIsNEJBQTRCLGtDQUFrQyx3REFBSSxVQUFVLG1FQUFtRSx1REFBRyxvQkFBb0IsOEJBQThCLCtCQUErQixLQUFLLElBQUksSUFBSTtBQUMzcEI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsdURBQU07QUFDekIsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLHVEQUFNO0FBQ3pCLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQix1REFBTTtBQUN6QixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsUUFBUSxzREFBSztBQUNiO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFFBQVEsc0RBQUs7QUFDYjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRWtDIiwic291cmNlcyI6WyIvVXNlcnMvbmlraXRhL0Rlc2t0b3AvZm9jdXNwaGVyZS9ub2RlX21vZHVsZXMvQHNjaGVkdWxlLXgvZXZlbnQtbW9kYWwvZGlzdC9jb3JlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGpzeCwgRnJhZ21lbnQsIGpzeHMgfSBmcm9tICdwcmVhY3QvanN4LXJ1bnRpbWUnO1xuaW1wb3J0IHsgdXNlU3RhdGUsIHVzZUVmZmVjdCB9IGZyb20gJ3ByZWFjdC9ob29rcyc7XG5pbXBvcnQgeyBzaWduYWwsIGVmZmVjdCwgYmF0Y2ggfSBmcm9tICdAcHJlYWN0L3NpZ25hbHMnO1xuXG52YXIgUGx1Z2luTmFtZTtcbihmdW5jdGlvbiAoUGx1Z2luTmFtZSkge1xuICAgIFBsdWdpbk5hbWVbXCJEcmFnQW5kRHJvcFwiXSA9IFwiZHJhZ0FuZERyb3BcIjtcbiAgICBQbHVnaW5OYW1lW1wiRXZlbnRNb2RhbFwiXSA9IFwiZXZlbnRNb2RhbFwiO1xuICAgIFBsdWdpbk5hbWVbXCJTY3JvbGxDb250cm9sbGVyXCJdID0gXCJzY3JvbGxDb250cm9sbGVyXCI7XG4gICAgUGx1Z2luTmFtZVtcIkV2ZW50UmVjdXJyZW5jZVwiXSA9IFwiZXZlbnRSZWN1cnJlbmNlXCI7XG4gICAgUGx1Z2luTmFtZVtcIlJlc2l6ZVwiXSA9IFwicmVzaXplXCI7XG4gICAgUGx1Z2luTmFtZVtcIkNhbGVuZGFyQ29udHJvbHNcIl0gPSBcImNhbGVuZGFyQ29udHJvbHNcIjtcbiAgICBQbHVnaW5OYW1lW1wiQ3VycmVudFRpbWVcIl0gPSBcImN1cnJlbnRUaW1lXCI7XG59KShQbHVnaW5OYW1lIHx8IChQbHVnaW5OYW1lID0ge30pKTtcblxuLyoqXG4gKiBDYW4gYmUgdXNlZCBmb3IgZ2VuZXJhdGluZyBhIHJhbmRvbSBpZCBmb3IgYW4gZW50aXR5XG4gKiBTaG91bGQsIGhvd2V2ZXIsIG5ldmVyIGJlIHVzZWQgaW4gcG90ZW50aWFsbHkgcmVzb3VyY2UgaW50ZW5zZSBsb29wcyxcbiAqIHNpbmNlIHRoZSBwZXJmb3JtYW5jZSBjb3N0IG9mIHRoaXMgY29tcGFyZWQgdG8gbmV3IERhdGUoKS5nZXRUaW1lKCkgaXMgY2EgeDQgaW4gdjhcbiAqICovXG5jb25zdCByYW5kb21TdHJpbmdJZCA9ICgpID0+ICdzJyArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZygyLCAxMSk7XG5cbmNvbnN0IGNyZWF0ZUNsaWNrT3V0c2lkZUxpc3RlbmVyID0gKCRhcHAsIG1vZGFsSWQpID0+IHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKCEoZS50YXJnZXQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGlmIChlLnRhcmdldC5jbG9zZXN0KGAjJHttb2RhbElkfWApKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAkYXBwLmNvbmZpZy5wbHVnaW5zLmV2ZW50TW9kYWwuY2xvc2UoKTtcbiAgICB9O1xufTtcblxuY29uc3Qgc2V0UG9zaXRpb24gPSAoYXBwRE9NUmVjdCwgZXZlbnRET01SZWN0LCBtb2RhbEhlaWdodCA9IDI1MCkgPT4ge1xuICAgIGNvbnN0IE1PREFMX1dJRFRIID0gNDAwO1xuICAgIGNvbnN0IElOTElORV9TUEFDRV9CRVRXRUVOX01PREFMX0FORF9FVkVOVCA9IDEwO1xuICAgIGNvbnN0IFdJRFRIX05FRURFRCA9IE1PREFMX1dJRFRIICsgSU5MSU5FX1NQQUNFX0JFVFdFRU5fTU9EQUxfQU5EX0VWRU5UO1xuICAgIGNvbnN0IGhhc1NwYWNlVG9wID0gZXZlbnRET01SZWN0LmJvdHRvbSAtIGFwcERPTVJlY3QudG9wID4gbW9kYWxIZWlnaHQ7XG4gICAgY29uc3QgZXZlbnRCb3R0b21MZXNzVGhhbkFwcEJvdHRvbSA9IGV2ZW50RE9NUmVjdC5ib3R0b20gPCBhcHBET01SZWN0LmJvdHRvbTtcbiAgICBjb25zdCBldmVudFRvcExlc3NUaGFuQXBwVG9wID0gZXZlbnRET01SZWN0LnRvcCA8IGFwcERPTVJlY3QudG9wO1xuICAgIGxldCB0b3AgPSAwO1xuICAgIGxldCBsZWZ0ID0gMDtcbiAgICBsZXQgYW5pbWF0aW9uU3RhcnQgPSAnMCUnO1xuICAgIGlmIChhcHBET01SZWN0LmJvdHRvbSAtIGV2ZW50RE9NUmVjdC50b3AgPiBtb2RhbEhlaWdodCAmJlxuICAgICAgICAhZXZlbnRUb3BMZXNzVGhhbkFwcFRvcCkge1xuICAgICAgICB0b3AgPSBldmVudERPTVJlY3QudG9wO1xuICAgIH1cbiAgICBlbHNlIGlmIChoYXNTcGFjZVRvcCAmJiBldmVudEJvdHRvbUxlc3NUaGFuQXBwQm90dG9tKSB7XG4gICAgICAgIHRvcCA9IGV2ZW50RE9NUmVjdC5ib3R0b20gLSBtb2RhbEhlaWdodDtcbiAgICB9XG4gICAgZWxzZSBpZiAoaGFzU3BhY2VUb3AgJiYgIWV2ZW50Qm90dG9tTGVzc1RoYW5BcHBCb3R0b20pIHtcbiAgICAgICAgdG9wID0gYXBwRE9NUmVjdC5ib3R0b20gLSBtb2RhbEhlaWdodDtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRvcCA9IGFwcERPTVJlY3QudG9wO1xuICAgIH1cbiAgICBpZiAoYXBwRE9NUmVjdC5yaWdodCAtIGV2ZW50RE9NUmVjdC5yaWdodCA+IFdJRFRIX05FRURFRCkge1xuICAgICAgICBsZWZ0ID0gZXZlbnRET01SZWN0LnJpZ2h0ICsgSU5MSU5FX1NQQUNFX0JFVFdFRU5fTU9EQUxfQU5EX0VWRU5UO1xuICAgICAgICBhbmltYXRpb25TdGFydCA9ICctMTAlJztcbiAgICB9XG4gICAgZWxzZSBpZiAoZXZlbnRET01SZWN0LmxlZnQgLSBhcHBET01SZWN0LmxlZnQgPiBXSURUSF9ORUVERUQpIHtcbiAgICAgICAgbGVmdCA9IGV2ZW50RE9NUmVjdC5sZWZ0IC0gV0lEVEhfTkVFREVEO1xuICAgICAgICBhbmltYXRpb25TdGFydCA9ICcxMCUnO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgbGVmdCA9IGFwcERPTVJlY3QubGVmdDtcbiAgICB9XG4gICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KCctLXN4LWV2ZW50LW1vZGFsLWFuaW1hdGlvbi1zdGFydCcsIGFuaW1hdGlvblN0YXJ0KTtcbiAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuc2V0UHJvcGVydHkoJy0tc3gtZXZlbnQtbW9kYWwtdG9wJywgYCR7dG9wfXB4YCk7XG4gICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KCctLXN4LWV2ZW50LW1vZGFsLWxlZnQnLCBgJHtsZWZ0fXB4YCk7XG59O1xuXG4vKipcbiAqIE9yaWdpbiBvZiBTVkc6IGh0dHBzOi8vd3d3LnN2Z3JlcG8uY29tL3N2Zy81MDY3NzEvdGltZVxuICogTGljZW5zZTogUEQgTGljZW5zZVxuICogQXV0aG9yIFNhbGFoIEVsaW1hbVxuICogQXV0aG9yIHdlYnNpdGU6IGh0dHBzOi8vd3d3LmZpZ21hLmNvbS9Ac2FsYWhlbGltYW1cbiAqICovXG5mdW5jdGlvbiBUaW1lSWNvbih7IHN0cm9rZUNvbG9yIH0pIHtcbiAgICByZXR1cm4gKGpzeChGcmFnbWVudCwgeyBjaGlsZHJlbjoganN4cyhcInN2Z1wiLCB7IGNsYXNzTmFtZTogXCJzeF9fZXZlbnQtaWNvblwiLCB2aWV3Qm94OiBcIjAgMCAyNCAyNFwiLCBmaWxsOiBcIm5vbmVcIiwgeG1sbnM6IFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiwgY2hpbGRyZW46IFtqc3goXCJnXCIsIHsgaWQ6IFwiU1ZHUmVwb19iZ0NhcnJpZXJcIiwgXCJzdHJva2Utd2lkdGhcIjogXCIwXCIgfSksIGpzeChcImdcIiwgeyBpZDogXCJTVkdSZXBvX3RyYWNlckNhcnJpZXJcIiwgXCJzdHJva2UtbGluZWNhcFwiOiBcInJvdW5kXCIsIFwic3Ryb2tlLWxpbmVqb2luXCI6IFwicm91bmRcIiB9KSwganN4cyhcImdcIiwgeyBpZDogXCJTVkdSZXBvX2ljb25DYXJyaWVyXCIsIGNoaWxkcmVuOiBbanN4KFwicGF0aFwiLCB7IGQ6IFwiTTEyIDhWMTJMMTUgMTVcIiwgc3Ryb2tlOiBzdHJva2VDb2xvciwgXCJzdHJva2Utd2lkdGhcIjogXCIyXCIsIFwic3Ryb2tlLWxpbmVjYXBcIjogXCJyb3VuZFwiIH0pLCBqc3goXCJjaXJjbGVcIiwgeyBjeDogXCIxMlwiLCBjeTogXCIxMlwiLCByOiBcIjlcIiwgc3Ryb2tlOiBzdHJva2VDb2xvciwgXCJzdHJva2Utd2lkdGhcIjogXCIyXCIgfSldIH0pXSB9KSB9KSk7XG59XG5cbi8qKlxuICogT3JpZ2luIG9mIFNWRzogaHR0cHM6Ly93d3cuc3ZncmVwby5jb20vc3ZnLzUwNjc3Mi91c2VyXG4gKiBMaWNlbnNlOiBQRCBMaWNlbnNlXG4gKiBBdXRob3IgU2FsYWggRWxpbWFtXG4gKiBBdXRob3Igd2Vic2l0ZTogaHR0cHM6Ly93d3cuZmlnbWEuY29tL0BzYWxhaGVsaW1hbVxuICogKi9cbmZ1bmN0aW9uIFVzZXJJY29uKHsgc3Ryb2tlQ29sb3IgfSkge1xuICAgIHJldHVybiAoanN4KEZyYWdtZW50LCB7IGNoaWxkcmVuOiBqc3hzKFwic3ZnXCIsIHsgY2xhc3NOYW1lOiBcInN4X19ldmVudC1pY29uXCIsIHZpZXdCb3g6IFwiMCAwIDI0IDI0XCIsIGZpbGw6IFwibm9uZVwiLCB4bWxuczogXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiLCBjaGlsZHJlbjogW2pzeChcImdcIiwgeyBpZDogXCJTVkdSZXBvX2JnQ2FycmllclwiLCBcInN0cm9rZS13aWR0aFwiOiBcIjBcIiB9KSwganN4KFwiZ1wiLCB7IGlkOiBcIlNWR1JlcG9fdHJhY2VyQ2FycmllclwiLCBcInN0cm9rZS1saW5lY2FwXCI6IFwicm91bmRcIiwgXCJzdHJva2UtbGluZWpvaW5cIjogXCJyb3VuZFwiIH0pLCBqc3hzKFwiZ1wiLCB7IGlkOiBcIlNWR1JlcG9faWNvbkNhcnJpZXJcIiwgY2hpbGRyZW46IFtqc3goXCJwYXRoXCIsIHsgZDogXCJNMTUgN0MxNSA4LjY1Njg1IDEzLjY1NjkgMTAgMTIgMTBDMTAuMzQzMSAxMCA5IDguNjU2ODUgOSA3QzkgNS4zNDMxNSAxMC4zNDMxIDQgMTIgNEMxMy42NTY5IDQgMTUgNS4zNDMxNSAxNSA3WlwiLCBzdHJva2U6IHN0cm9rZUNvbG9yLCBcInN0cm9rZS13aWR0aFwiOiBcIjJcIiB9KSwganN4KFwicGF0aFwiLCB7IGQ6IFwiTTUgMTkuNUM1IDE1LjkxMDEgNy45MTAxNSAxMyAxMS41IDEzSDEyLjVDMTYuMDg5OSAxMyAxOSAxNS45MTAxIDE5IDE5LjVWMjBDMTkgMjAuNTUyMyAxOC41NTIzIDIxIDE4IDIxSDZDNS40NDc3MiAyMSA1IDIwLjU1MjMgNSAyMFYxOS41WlwiLCBzdHJva2U6IHN0cm9rZUNvbG9yLCBcInN0cm9rZS13aWR0aFwiOiBcIjJcIiB9KV0gfSldIH0pIH0pKTtcbn1cblxuY29uc3QgY29uY2F0ZW5hdGVQZW9wbGUgPSAocGVvcGxlKSA9PiB7XG4gICAgcmV0dXJuIHBlb3BsZS5yZWR1Y2UoKGFjYywgcGVyc29uLCBpbmRleCkgPT4ge1xuICAgICAgICBpZiAoaW5kZXggPT09IDApXG4gICAgICAgICAgICByZXR1cm4gcGVyc29uO1xuICAgICAgICBpZiAoaW5kZXggPT09IHBlb3BsZS5sZW5ndGggLSAxKVxuICAgICAgICAgICAgcmV0dXJuIGAke2FjY30gJiAke3BlcnNvbn1gO1xuICAgICAgICByZXR1cm4gYCR7YWNjfSwgJHtwZXJzb259YDtcbiAgICB9LCAnJyk7XG59O1xuXG4vKipcbiAqIE9yaWdpbiBvZiBTVkc6IGh0dHBzOi8vd3d3LnN2Z3JlcG8uY29tL3N2Zy80ODk1MDIvbG9jYXRpb24tcGluXG4gKiBMaWNlbnNlOiBQRCBMaWNlbnNlXG4gKiBBdXRob3I6IERhcml1c2ggSGFiaWJwb3VyXG4gKiBBdXRob3Igd2Vic2l0ZTogaHR0cHM6Ly9yZWRsLmluay9kYXJpdXNoL2xpbmtzP3JlZj1zdmdyZXBvLmNvbVxuICogKi9cbmZ1bmN0aW9uIExvY2F0aW9uUGluSWNvbih7IHN0cm9rZUNvbG9yIH0pIHtcbiAgICByZXR1cm4gKGpzeChGcmFnbWVudCwgeyBjaGlsZHJlbjoganN4cyhcInN2Z1wiLCB7IGNsYXNzTmFtZTogXCJzeF9fZXZlbnQtaWNvblwiLCB2aWV3Qm94OiBcIjAgMCAyNCAyNFwiLCBmaWxsOiBcIm5vbmVcIiwgeG1sbnM6IFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiwgY2hpbGRyZW46IFtqc3goXCJnXCIsIHsgaWQ6IFwiU1ZHUmVwb19iZ0NhcnJpZXJcIiwgXCJzdHJva2Utd2lkdGhcIjogXCIwXCIgfSksIGpzeChcImdcIiwgeyBpZDogXCJTVkdSZXBvX3RyYWNlckNhcnJpZXJcIiwgXCJzdHJva2UtbGluZWNhcFwiOiBcInJvdW5kXCIsIFwic3Ryb2tlLWxpbmVqb2luXCI6IFwicm91bmRcIiB9KSwganN4cyhcImdcIiwgeyBpZDogXCJTVkdSZXBvX2ljb25DYXJyaWVyXCIsIGNoaWxkcmVuOiBbanN4cyhcImdcIiwgeyBcImNsaXAtcGF0aFwiOiBcInVybCgjY2xpcDBfNDI5XzExMDQ2KVwiLCBjaGlsZHJlbjogW2pzeChcInJlY3RcIiwgeyB4OiBcIjEyXCIsIHk6IFwiMTFcIiwgd2lkdGg6IFwiMC4wMVwiLCBoZWlnaHQ6IFwiMC4wMVwiLCBzdHJva2U6IHN0cm9rZUNvbG9yLCBcInN0cm9rZS13aWR0aFwiOiBcIjJcIiwgXCJzdHJva2UtbGluZWpvaW5cIjogXCJyb3VuZFwiIH0pLCBqc3goXCJwYXRoXCIsIHsgZDogXCJNMTIgMjJMMTcuNSAxNi41QzIwLjUzNzYgMTMuNDYyNCAyMC41Mzc2IDguNTM3NTcgMTcuNSA1LjVDMTQuNDYyNCAyLjQ2MjQ0IDkuNTM3NTcgMi40NjI0NCA2LjUgNS41QzMuNDYyNDQgOC41Mzc1NyAzLjQ2MjQ0IDEzLjQ2MjQgNi41IDE2LjVMMTIgMjJaXCIsIHN0cm9rZTogc3Ryb2tlQ29sb3IsIFwic3Ryb2tlLXdpZHRoXCI6IFwiMlwiLCBcInN0cm9rZS1saW5lam9pblwiOiBcInJvdW5kXCIgfSldIH0pLCBqc3goXCJkZWZzXCIsIHsgY2hpbGRyZW46IGpzeChcImNsaXBQYXRoXCIsIHsgaWQ6IFwiY2xpcDBfNDI5XzExMDQ2XCIsIGNoaWxkcmVuOiBqc3goXCJyZWN0XCIsIHsgd2lkdGg6IFwiMjRcIiwgaGVpZ2h0OiBcIjI0XCIsIGZpbGw6IFwid2hpdGVcIiB9KSB9KSB9KV0gfSldIH0pIH0pKTtcbn1cblxuLyoqXG4gKiBPcmlnaW4gb2YgU1ZHOiBodHRwczovL3d3dy5zdmdyZXBvLmNvbS9zdmcvNTA2ODM4L2xpc3RcbiAqIExpY2Vuc2U6IFBEIExpY2Vuc2VcbiAqIEF1dGhvcjogU2FsYWggRWxpbWFtXG4gKiBBdXRob3Igd2Vic2l0ZTogaHR0cHM6Ly93d3cuZmlnbWEuY29tL0BzYWxhaGVsaW1hbVxuICogKi9cbmZ1bmN0aW9uIERlc2NyaXB0aW9uSWNvbih7IHN0cm9rZUNvbG9yIH0pIHtcbiAgICByZXR1cm4gKGpzeChGcmFnbWVudCwgeyBjaGlsZHJlbjoganN4cyhcInN2Z1wiLCB7IGNsYXNzTmFtZTogXCJzeF9fZXZlbnQtaWNvblwiLCB2aWV3Qm94OiBcIjAgMCAyNCAyNFwiLCBmaWxsOiBcIm5vbmVcIiwgeG1sbnM6IFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiwgY2hpbGRyZW46IFtqc3goXCJnXCIsIHsgaWQ6IFwiU1ZHUmVwb19iZ0NhcnJpZXJcIiwgXCJzdHJva2Utd2lkdGhcIjogXCIwXCIgfSksIGpzeChcImdcIiwgeyBpZDogXCJTVkdSZXBvX3RyYWNlckNhcnJpZXJcIiwgXCJzdHJva2UtbGluZWNhcFwiOiBcInJvdW5kXCIsIFwic3Ryb2tlLWxpbmVqb2luXCI6IFwicm91bmRcIiB9KSwganN4cyhcImdcIiwgeyBpZDogXCJTVkdSZXBvX2ljb25DYXJyaWVyXCIsIGNoaWxkcmVuOiBbanN4KFwicmVjdFwiLCB7IHg6IFwiNFwiLCB5OiBcIjRcIiwgd2lkdGg6IFwiMTZcIiwgaGVpZ2h0OiBcIjE2XCIsIHJ4OiBcIjNcIiwgc3Ryb2tlOiBzdHJva2VDb2xvciwgXCJzdHJva2Utd2lkdGhcIjogXCIyXCIgfSksIGpzeChcInBhdGhcIiwgeyBkOiBcIk0xNiAxMEw4IDEwXCIsIHN0cm9rZTogc3Ryb2tlQ29sb3IsIFwic3Ryb2tlLXdpZHRoXCI6IFwiMlwiLCBcInN0cm9rZS1saW5lY2FwXCI6IFwicm91bmRcIiB9KSwganN4KFwicGF0aFwiLCB7IGQ6IFwiTTE2IDE0TDggMTRcIiwgc3Ryb2tlOiBzdHJva2VDb2xvciwgXCJzdHJva2Utd2lkdGhcIjogXCIyXCIsIFwic3Ryb2tlLWxpbmVjYXBcIjogXCJyb3VuZFwiIH0pXSB9KV0gfSkgfSkpO1xufVxuXG5jb25zdCB0b0ludGVnZXJzID0gKGRhdGVUaW1lU3BlY2lmaWNhdGlvbikgPT4ge1xuICAgIGNvbnN0IGhvdXJzID0gZGF0ZVRpbWVTcGVjaWZpY2F0aW9uLnNsaWNlKDExLCAxMyksIG1pbnV0ZXMgPSBkYXRlVGltZVNwZWNpZmljYXRpb24uc2xpY2UoMTQsIDE2KTtcbiAgICByZXR1cm4ge1xuICAgICAgICB5ZWFyOiBOdW1iZXIoZGF0ZVRpbWVTcGVjaWZpY2F0aW9uLnNsaWNlKDAsIDQpKSxcbiAgICAgICAgbW9udGg6IE51bWJlcihkYXRlVGltZVNwZWNpZmljYXRpb24uc2xpY2UoNSwgNykpIC0gMSxcbiAgICAgICAgZGF0ZTogTnVtYmVyKGRhdGVUaW1lU3BlY2lmaWNhdGlvbi5zbGljZSg4LCAxMCkpLFxuICAgICAgICBob3VyczogaG91cnMgIT09ICcnID8gTnVtYmVyKGhvdXJzKSA6IHVuZGVmaW5lZCxcbiAgICAgICAgbWludXRlczogbWludXRlcyAhPT0gJycgPyBOdW1iZXIobWludXRlcykgOiB1bmRlZmluZWQsXG4gICAgfTtcbn07XG5cbmNvbnN0IGRhdGVGbiA9IChkYXRlVGltZSwgbG9jYWxlKSA9PiB7XG4gICAgcmV0dXJuIGRhdGVUaW1lLnRvTG9jYWxlU3RyaW5nKGxvY2FsZSwge1xuICAgICAgICBkYXk6ICdudW1lcmljJyxcbiAgICAgICAgbW9udGg6ICdsb25nJyxcbiAgICAgICAgeWVhcjogJ251bWVyaWMnLFxuICAgIH0pO1xufTtcbmNvbnN0IHRpbWVGbiA9IChkYXRlVGltZSwgbG9jYWxlKSA9PiB7XG4gICAgY29uc3QgZGF0ZVRpbWVTdHJpbmcgPSBkYXRlVGltZS50b1N0cmluZygpO1xuICAgIGNvbnN0IHsgeWVhciwgbW9udGgsIGRhdGUsIGhvdXJzLCBtaW51dGVzIH0gPSB0b0ludGVnZXJzKGRhdGVUaW1lU3RyaW5nKTtcbiAgICByZXR1cm4gbmV3IERhdGUoeWVhciwgbW9udGgsIGRhdGUsIGhvdXJzLCBtaW51dGVzKS50b0xvY2FsZVRpbWVTdHJpbmcobG9jYWxlLCB7XG4gICAgICAgIGhvdXI6ICdudW1lcmljJyxcbiAgICAgICAgbWludXRlOiAnbnVtZXJpYycsXG4gICAgfSk7XG59O1xuY29uc3QgZ2V0VGltZVN0YW1wID0gKGNhbGVuZGFyRXZlbnQsIC8vIHRvIGZhY2lsaXRhdGUgdGVzdGluZy4gSW4gcmVhbGl0eSwgd2Ugd2lsbCBhbHdheXMgaGF2ZSBhIGZ1bGwgQ2FsZW5kYXJFdmVudEludGVybmFsXG5sb2NhbGUsIGRlbGltaXRlciA9ICdcXHUyMDEzJykgPT4ge1xuICAgIHZhciBfYSwgX2IsIF9jLCBfZDtcbiAgICBjb25zdCBldmVudFRpbWUgPSB7IHN0YXJ0OiBjYWxlbmRhckV2ZW50LnN0YXJ0LCBlbmQ6IGNhbGVuZGFyRXZlbnQuZW5kIH07XG4gICAgaWYgKGNhbGVuZGFyRXZlbnQuX2lzU2luZ2xlRGF5RnVsbERheSkge1xuICAgICAgICByZXR1cm4gZGF0ZUZuKGV2ZW50VGltZS5zdGFydCwgbG9jYWxlKTtcbiAgICB9XG4gICAgaWYgKGNhbGVuZGFyRXZlbnQuX2lzTXVsdGlEYXlGdWxsRGF5KSB7XG4gICAgICAgIHJldHVybiBgJHtkYXRlRm4oZXZlbnRUaW1lLnN0YXJ0LCBsb2NhbGUpfSAke2RlbGltaXRlcn0gJHtkYXRlRm4oZXZlbnRUaW1lLmVuZCwgbG9jYWxlKX1gO1xuICAgIH1cbiAgICBpZiAoY2FsZW5kYXJFdmVudC5faXNTaW5nbGVEYXlUaW1lZCAmJlxuICAgICAgICAoKF9hID0gZXZlbnRUaW1lLnN0YXJ0KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EudG9TdHJpbmcoKSkgIT09ICgoX2IgPSBldmVudFRpbWUuZW5kKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IudG9TdHJpbmcoKSkpIHtcbiAgICAgICAgcmV0dXJuIGAke2RhdGVGbihldmVudFRpbWUuc3RhcnQsIGxvY2FsZSl9IDxzcGFuIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPuKLhTwvc3Bhbj4gJHt0aW1lRm4oZXZlbnRUaW1lLnN0YXJ0LCBsb2NhbGUpfSAke2RlbGltaXRlcn0gJHt0aW1lRm4oZXZlbnRUaW1lLmVuZCwgbG9jYWxlKX1gO1xuICAgIH1cbiAgICBpZiAoY2FsZW5kYXJFdmVudC5faXNTaW5nbGVEYXlUaW1lZCAmJlxuICAgICAgICAoKF9jID0gY2FsZW5kYXJFdmVudC5zdGFydCkgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLnRvU3RyaW5nKCkpID09PSAoKF9kID0gY2FsZW5kYXJFdmVudC5lbmQpID09PSBudWxsIHx8IF9kID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZC50b1N0cmluZygpKSkge1xuICAgICAgICByZXR1cm4gYCR7ZGF0ZUZuKGV2ZW50VGltZS5zdGFydCwgbG9jYWxlKX0sICR7dGltZUZuKGV2ZW50VGltZS5zdGFydCwgbG9jYWxlKX1gO1xuICAgIH1cbiAgICByZXR1cm4gYCR7ZGF0ZUZuKGV2ZW50VGltZS5zdGFydCwgbG9jYWxlKX0sICR7dGltZUZuKGV2ZW50VGltZS5zdGFydCwgbG9jYWxlKX0gJHtkZWxpbWl0ZXJ9ICR7ZGF0ZUZuKGV2ZW50VGltZS5lbmQsIGxvY2FsZSl9LCAke3RpbWVGbihldmVudFRpbWUuZW5kLCBsb2NhbGUpfWA7XG59O1xuXG5jb25zdCB1c2VJY29uQ29sb3JzID0gKCRhcHApID0+IHtcbiAgICBjb25zdCBJQ09OX0NPTE9SX0xJR0hUX01PREUgPSAndmFyKC0tc3gtaW50ZXJuYWwtY29sb3ItdGV4dCknO1xuICAgIGNvbnN0IElDT05fQ09MT1JfREFSS19NT0RFID0gJ3ZhcigtLXN4LWNvbG9yLW5ldXRyYWwtdmFyaWFudCknO1xuICAgIGNvbnN0IGljb25Db2xvciA9IHNpZ25hbCgkYXBwLmNhbGVuZGFyU3RhdGUuaXNEYXJrLnZhbHVlXG4gICAgICAgID8gSUNPTl9DT0xPUl9EQVJLX01PREVcbiAgICAgICAgOiBJQ09OX0NPTE9SX0xJR0hUX01PREUpO1xuICAgIGVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGlmICgkYXBwLmNhbGVuZGFyU3RhdGUuaXNEYXJrLnZhbHVlKVxuICAgICAgICAgICAgaWNvbkNvbG9yLnZhbHVlID0gSUNPTl9DT0xPUl9EQVJLX01PREU7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGljb25Db2xvci52YWx1ZSA9IElDT05fQ09MT1JfTElHSFRfTU9ERTtcbiAgICB9KTtcbiAgICByZXR1cm4gaWNvbkNvbG9yO1xufTtcblxuY29uc3QgaXNTY3JvbGxhYmxlID0gKGVsKSA9PiB7XG4gICAgaWYgKGVsKSB7XG4gICAgICAgIGNvbnN0IGhhc1Njcm9sbGFibGVDb250ZW50ID0gZWwuc2Nyb2xsSGVpZ2h0ID4gZWwuY2xpZW50SGVpZ2h0O1xuICAgICAgICBjb25zdCBvdmVyZmxvd1lTdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsKS5vdmVyZmxvd1k7XG4gICAgICAgIGNvbnN0IGlzT3ZlcmZsb3dIaWRkZW4gPSBvdmVyZmxvd1lTdHlsZS5pbmRleE9mKCdoaWRkZW4nKSAhPT0gLTE7XG4gICAgICAgIHJldHVybiBoYXNTY3JvbGxhYmxlQ29udGVudCAmJiAhaXNPdmVyZmxvd0hpZGRlbjtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59O1xuY29uc3QgZ2V0U2Nyb2xsYWJsZVBhcmVudHMgPSAoZWwsIGFjYyA9IFtdKSA9PiB7XG4gICAgaWYgKCFlbCB8fFxuICAgICAgICBlbCA9PT0gZG9jdW1lbnQuYm9keSB8fFxuICAgICAgICBlbC5ub2RlVHlwZSA9PT0gTm9kZS5ET0NVTUVOVF9GUkFHTUVOVF9OT0RFKSB7XG4gICAgICAgIGFjYy5wdXNoKHdpbmRvdyk7XG4gICAgICAgIHJldHVybiBhY2M7XG4gICAgfVxuICAgIGlmIChpc1Njcm9sbGFibGUoZWwpKSB7XG4gICAgICAgIGFjYy5wdXNoKGVsKTtcbiAgICB9XG4gICAgcmV0dXJuIGdldFNjcm9sbGFibGVQYXJlbnRzKChlbC5hc3NpZ25lZFNsb3RcbiAgICAgICAgPyBlbC5hc3NpZ25lZFNsb3QucGFyZW50Tm9kZVxuICAgICAgICA6IGVsLnBhcmVudE5vZGUpLCBhY2MpO1xufTtcblxuLyoqXG4gKiBQdXNoIGEgdGFzayB0byB0aGUgZW5kIG9mIHRoZSBjdXJyZW50IGNhbGwgc3RhY2tcbiAqICovXG5jb25zdCBuZXh0VGljayA9IChjYikgPT4ge1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBjYigpO1xuICAgIH0pO1xufTtcblxuZnVuY3Rpb24gRXZlbnRNb2RhbCh7ICRhcHAgfSkge1xuICAgIGNvbnN0IFttb2RhbElkXSA9IHVzZVN0YXRlKHJhbmRvbVN0cmluZ0lkKCkpO1xuICAgIGNvbnN0IHsgdmFsdWU6IGNhbGVuZGFyRXZlbnQgfSA9ICRhcHAuY29uZmlnLnBsdWdpbnMuZXZlbnRNb2RhbC5jYWxlbmRhckV2ZW50O1xuICAgIGNvbnN0IFtpc0Rpc3BsYXllZCwgc2V0SXNEaXNwbGF5ZWRdID0gdXNlU3RhdGUoZmFsc2UpO1xuICAgIGNvbnN0IGN1c3RvbUNvbXBvbmVudCA9ICRhcHAuY29uZmlnLl9jdXN0b21Db21wb25lbnRGbnMuZXZlbnRNb2RhbDtcbiAgICBjb25zdCBbZXZlbnRXcmFwcGVyU3R5bGUsIHNldEV2ZW50V3JhcHBlclN0eWxlXSA9IHVzZVN0YXRlKCdzeF9fZXZlbnQtbW9kYWwnKTtcbiAgICBjb25zdCBjYWxsU2V0UG9zaXRpb24gPSAoKSA9PiB7XG4gICAgICAgIHZhciBfYSwgX2IsIF9jO1xuICAgICAgICBzZXRQb3NpdGlvbigoX2EgPSAkYXBwLmVsZW1lbnRzLmNhbGVuZGFyV3JhcHBlcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLCAoX2IgPSAkYXBwLmNvbmZpZy5wbHVnaW5zLmV2ZW50TW9kYWwpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5jYWxlbmRhckV2ZW50RE9NUmVjdC52YWx1ZSwgKChfYyA9ICRhcHAuZWxlbWVudHMuY2FsZW5kYXJXcmFwcGVyKSA9PT0gbnVsbCB8fCBfYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2MucXVlcnlTZWxlY3RvcignLnN4X19ldmVudC1tb2RhbCcpKS5jbGllbnRIZWlnaHQpO1xuICAgIH07XG4gICAgY29uc3Qgc2Nyb2xsTGlzdGVuZXIgPSAoKSA9PiB7XG4gICAgICAgIHZhciBfYSwgX2I7XG4gICAgICAgICRhcHAuY29uZmlnLnBsdWdpbnMuZXZlbnRNb2RhbC5jYWxlbmRhckV2ZW50RE9NUmVjdC52YWx1ZSA9XG4gICAgICAgICAgICAoX2IgPSAoX2EgPSAkYXBwLmNvbmZpZy5wbHVnaW5zLmV2ZW50TW9kYWwpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5jYWxlbmRhckV2ZW50RWxlbWVudC52YWx1ZSkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICBjYWxsU2V0UG9zaXRpb24oKTtcbiAgICB9O1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgaWYgKGN1c3RvbUNvbXBvbmVudCkge1xuICAgICAgICAgICAgY3VzdG9tQ29tcG9uZW50KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLWNjaWQ9JHttb2RhbElkfV1gKSwge1xuICAgICAgICAgICAgICAgIGNhbGVuZGFyRXZlbnQ6IGNhbGVuZGFyRXZlbnQgPT09IG51bGwgfHwgY2FsZW5kYXJFdmVudCA9PT0gdm9pZCAwID8gdm9pZCAwIDogY2FsZW5kYXJFdmVudC5fZ2V0RXh0ZXJuYWxFdmVudCgpLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzZXRFdmVudFdyYXBwZXJTdHlsZShldmVudFdyYXBwZXJTdHlsZS5jb25jYXQoJyBzeF9fZXZlbnQtbW9kYWwtZGVmYXVsdCcpKTtcbiAgICAgICAgfVxuICAgICAgICBuZXh0VGljaygoKSA9PiB7XG4gICAgICAgICAgICBjYWxsU2V0UG9zaXRpb24oKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHNldElzRGlzcGxheWVkKHRydWUpO1xuICAgICAgICBjb25zdCBjbGlja091dHNpZGVMaXN0ZW5lciA9IGNyZWF0ZUNsaWNrT3V0c2lkZUxpc3RlbmVyKCRhcHAsIG1vZGFsSWQpO1xuICAgICAgICBjb25zdCBzY3JvbGxhYmxlQW5jZXN0b3JzID0gZ2V0U2Nyb2xsYWJsZVBhcmVudHMoKChfYSA9ICRhcHAuY29uZmlnLnBsdWdpbnMuZXZlbnRNb2RhbCkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmNhbGVuZGFyRXZlbnRFbGVtZW50LnZhbHVlKSB8fCBudWxsKTtcbiAgICAgICAgc2Nyb2xsYWJsZUFuY2VzdG9ycy5mb3JFYWNoKChlbCkgPT4gZWwuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgc2Nyb2xsTGlzdGVuZXIpKTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbGlja091dHNpZGVMaXN0ZW5lcik7XG4gICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIGNsaWNrT3V0c2lkZUxpc3RlbmVyKTtcbiAgICAgICAgICAgIHNjcm9sbGFibGVBbmNlc3RvcnMuZm9yRWFjaCgoZWwpID0+IGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHNjcm9sbExpc3RlbmVyKSk7XG4gICAgICAgIH07XG4gICAgfSwgW10pO1xuICAgIGNvbnN0IGljb25Db2xvciA9IHVzZUljb25Db2xvcnMoJGFwcCk7XG4gICAgcmV0dXJuIChqc3goRnJhZ21lbnQsIHsgY2hpbGRyZW46IGNhbGVuZGFyRXZlbnQgJiYgKGpzeChcImRpdlwiLCB7IGlkOiBtb2RhbElkLCB0YWJJbmRleDogMCwgXCJkYXRhLWNjaWRcIjogbW9kYWxJZCwgY2xhc3NOYW1lOiBgJHtldmVudFdyYXBwZXJTdHlsZX0ke2lzRGlzcGxheWVkID8gJyBpcy1vcGVuJyA6ICcnfWAsIGNoaWxkcmVuOiAhY3VzdG9tQ29tcG9uZW50ICYmIChqc3hzKEZyYWdtZW50LCB7IGNoaWxkcmVuOiBbanN4cyhcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJzeF9faGFzLWljb24gc3hfX2V2ZW50LW1vZGFsX190aXRsZVwiLCBjaGlsZHJlbjogW2pzeChcImRpdlwiLCB7IHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IGB2YXIoLS1zeC1jb2xvci0ke2NhbGVuZGFyRXZlbnQuX2NvbG9yfS1jb250YWluZXIpYCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgY2xhc3NOYW1lOiBcInN4X19ldmVudC1tb2RhbF9fY29sb3ItaWNvbiBzeF9fZXZlbnQtaWNvblwiIH0pLCBjYWxlbmRhckV2ZW50LnRpdGxlXSB9KSwganN4cyhcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJzeF9faGFzLWljb24gc3hfX2V2ZW50LW1vZGFsX190aW1lXCIsIGNoaWxkcmVuOiBbanN4KFRpbWVJY29uLCB7IHN0cm9rZUNvbG9yOiBpY29uQ29sb3IudmFsdWUgfSksIGpzeChcImRpdlwiLCB7IGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX2h0bWw6IGdldFRpbWVTdGFtcChjYWxlbmRhckV2ZW50LCAkYXBwLmNvbmZpZy5sb2NhbGUudmFsdWUpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IH0pXSB9KSwgY2FsZW5kYXJFdmVudC5wZW9wbGUgJiYgY2FsZW5kYXJFdmVudC5wZW9wbGUubGVuZ3RoICYmIChqc3hzKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X19oYXMtaWNvbiBzeF9fZXZlbnQtbW9kYWxfX3Blb3BsZVwiLCBjaGlsZHJlbjogW2pzeChVc2VySWNvbiwgeyBzdHJva2VDb2xvcjogaWNvbkNvbG9yLnZhbHVlIH0pLCBjb25jYXRlbmF0ZVBlb3BsZShjYWxlbmRhckV2ZW50LnBlb3BsZSldIH0pKSwgY2FsZW5kYXJFdmVudC5sb2NhdGlvbiAmJiAoanN4cyhcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJzeF9faGFzLWljb24gc3hfX2V2ZW50LW1vZGFsX19sb2NhdGlvblwiLCBjaGlsZHJlbjogW2pzeChMb2NhdGlvblBpbkljb24sIHsgc3Ryb2tlQ29sb3I6IGljb25Db2xvci52YWx1ZSB9KSwgY2FsZW5kYXJFdmVudC5sb2NhdGlvbl0gfSkpLCBjYWxlbmRhckV2ZW50LmRlc2NyaXB0aW9uICYmIChqc3hzKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4X19oYXMtaWNvbiBzeF9fZXZlbnQtbW9kYWxfX2Rlc2NyaXB0aW9uXCIsIGNoaWxkcmVuOiBbanN4KERlc2NyaXB0aW9uSWNvbiwgeyBzdHJva2VDb2xvcjogaWNvbkNvbG9yLnZhbHVlIH0pLCBjYWxlbmRhckV2ZW50LmRlc2NyaXB0aW9uXSB9KSldIH0pKSB9KSkgfSkpO1xufVxuXG5jb25zdCBkZWZpbmVQbHVnaW4gPSAobmFtZSwgZGVmaW5pdGlvbikgPT4ge1xuICAgIGRlZmluaXRpb24ubmFtZSA9IG5hbWU7XG4gICAgcmV0dXJuIGRlZmluaXRpb247XG59O1xuXG5jbGFzcyBFdmVudE1vZGFsUGx1Z2luSW1wbCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm5hbWVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IFBsdWdpbk5hbWUuRXZlbnRNb2RhbFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiY2FsZW5kYXJFdmVudFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogc2lnbmFsKG51bGwpXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJjYWxlbmRhckV2ZW50RE9NUmVjdFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogc2lnbmFsKG51bGwpXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJjYWxlbmRhckV2ZW50RWxlbWVudFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogc2lnbmFsKG51bGwpXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJDb21wb25lbnRGblwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogRXZlbnRNb2RhbFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgc2V0Q2FsZW5kYXJFdmVudChldmVudCwgZXZlbnRUYXJnZXRET01SZWN0KSB7XG4gICAgICAgIGJhdGNoKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY2FsZW5kYXJFdmVudC52YWx1ZSA9IGV2ZW50O1xuICAgICAgICAgICAgdGhpcy5jYWxlbmRhckV2ZW50RE9NUmVjdC52YWx1ZSA9IGV2ZW50VGFyZ2V0RE9NUmVjdDtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGNsb3NlKCkge1xuICAgICAgICBiYXRjaCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNhbGVuZGFyRXZlbnQudmFsdWUgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5jYWxlbmRhckV2ZW50RE9NUmVjdC52YWx1ZSA9IG51bGw7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbmNvbnN0IGNyZWF0ZUV2ZW50TW9kYWxQbHVnaW4gPSAoKSA9PiB7XG4gICAgcmV0dXJuIGRlZmluZVBsdWdpbignZXZlbnRNb2RhbCcsIG5ldyBFdmVudE1vZGFsUGx1Z2luSW1wbCgpKTtcbn07XG5cbmV4cG9ydCB7IGNyZWF0ZUV2ZW50TW9kYWxQbHVnaW4gfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@schedule-x/event-modal/dist/core.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@schedule-x/events-service/dist/core.js":
/*!**************************************************************!*\
  !*** ./node_modules/@schedule-x/events-service/dist/core.js ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createEventsServicePlugin: () => (/* binding */ createEventsServicePlugin)\n/* harmony export */ });\nclass NumberRangeError extends Error {\n    constructor(min, max) {\n        super(`Number must be between ${min} and ${max}.`);\n        Object.defineProperty(this, \"min\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: min\n        });\n        Object.defineProperty(this, \"max\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: max\n        });\n    }\n}\n\nconst doubleDigit = (number) => {\n    if (number < 0 || number > 99)\n        throw new NumberRangeError(0, 99);\n    return String(number).padStart(2, '0');\n};\n\nconst toDateString = (date) => {\n    return `${date.year}-${doubleDigit(date.month)}-${doubleDigit(date.day)}`;\n};\n\nclass InvalidTimeStringError extends Error {\n    constructor(timeString) {\n        super(`Invalid time string: ${timeString}`);\n    }\n}\n\n// regex for strings between 00:00 and 23:59\nconst timeStringRegex = /^(0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]/;\n\nconst minuteTimePointMultiplier = 1.6666666666666667; // 100 / 60\nconst timePointsFromString = (timeString) => {\n    if (!timeStringRegex.test(timeString) && timeString !== '24:00')\n        throw new InvalidTimeStringError(timeString);\n    const [hoursInt, minutesInt] = timeString\n        .split(':')\n        .map((time) => parseInt(time, 10));\n    let minutePoints = (minutesInt * minuteTimePointMultiplier).toString();\n    if (minutePoints.split('.')[0].length < 2)\n        minutePoints = `0${minutePoints}`;\n    return Number(hoursInt + minutePoints);\n};\n\nconst dateFromDateTime = (dateTime) => {\n    return dateTime.slice(0, 10);\n};\nconst timeFromDateTime = (dateTime) => {\n    return dateTime.slice(11);\n};\n\nvar WeekDay;\n(function (WeekDay) {\n    WeekDay[WeekDay[\"MONDAY\"] = 1] = \"MONDAY\";\n    WeekDay[WeekDay[\"TUESDAY\"] = 2] = \"TUESDAY\";\n    WeekDay[WeekDay[\"WEDNESDAY\"] = 3] = \"WEDNESDAY\";\n    WeekDay[WeekDay[\"THURSDAY\"] = 4] = \"THURSDAY\";\n    WeekDay[WeekDay[\"FRIDAY\"] = 5] = \"FRIDAY\";\n    WeekDay[WeekDay[\"SATURDAY\"] = 6] = \"SATURDAY\";\n    WeekDay[WeekDay[\"SUNDAY\"] = 7] = \"SUNDAY\";\n})(WeekDay || (WeekDay = {}));\n\nWeekDay.MONDAY;\nconst DEFAULT_EVENT_COLOR_NAME = 'primary';\n\nclass CalendarEventImpl {\n    constructor(_config, id, _start, _end, title, people, location, description, calendarId, _options = undefined, _customContent = {}, _foreignProperties = {}) {\n        Object.defineProperty(this, \"_config\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: _config\n        });\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: id\n        });\n        Object.defineProperty(this, \"_start\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: _start\n        });\n        Object.defineProperty(this, \"_end\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: _end\n        });\n        Object.defineProperty(this, \"title\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: title\n        });\n        Object.defineProperty(this, \"people\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: people\n        });\n        Object.defineProperty(this, \"location\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: location\n        });\n        Object.defineProperty(this, \"description\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: description\n        });\n        Object.defineProperty(this, \"calendarId\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: calendarId\n        });\n        Object.defineProperty(this, \"_options\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: _options\n        });\n        Object.defineProperty(this, \"_customContent\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: _customContent\n        });\n        Object.defineProperty(this, \"_foreignProperties\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: _foreignProperties\n        });\n        Object.defineProperty(this, \"_previousConcurrentEvents\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_totalConcurrentEvents\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_maxConcurrentEvents\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_nDaysInGrid\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_createdAt\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_originalTimezone\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_eventFragments\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: {}\n        });\n        this._originalTimezone =\n            this._start instanceof Temporal.ZonedDateTime\n                ? this._start.timeZoneId\n                : undefined;\n    }\n    get start() {\n        if (this._start instanceof Temporal.PlainDate) {\n            return this._start;\n        }\n        return this._start.withTimeZone(this._config.timezone.value);\n    }\n    set start(value) {\n        this._start =\n            value instanceof Temporal.ZonedDateTime\n                ? value.withTimeZone(this._originalTimezone)\n                : value;\n    }\n    get end() {\n        if (this._end instanceof Temporal.PlainDate) {\n            return this._end;\n        }\n        return this._end.withTimeZone(this._config.timezone.value);\n    }\n    set end(value) {\n        this._end =\n            value instanceof Temporal.ZonedDateTime\n                ? value.withTimeZone(this._originalTimezone)\n                : value;\n    }\n    get _isSingleDayTimed() {\n        if (this.start instanceof Temporal.PlainDate ||\n            this.end instanceof Temporal.PlainDate)\n            return false;\n        const localStartDate = dateFromDateTime(this.start.toString());\n        const localEndDate = dateFromDateTime(this.end.toString());\n        return localStartDate === localEndDate;\n    }\n    get _isSingleDayFullDay() {\n        const startDate = dateFromDateTime(this.start.toString());\n        const endDate = dateFromDateTime(this.end.toString());\n        return (startDate === endDate &&\n            this.start instanceof Temporal.PlainDate &&\n            this.end instanceof Temporal.PlainDate);\n    }\n    get _isMultiDayTimed() {\n        if (this.start instanceof Temporal.PlainDate ||\n            this.end instanceof Temporal.PlainDate)\n            return false;\n        const startDate = dateFromDateTime(this.start.toString());\n        const endDate = dateFromDateTime(this.end.toString());\n        return startDate !== endDate;\n    }\n    get _isMultiDayFullDay() {\n        const startDate = dateFromDateTime(this.start.toString());\n        const endDate = dateFromDateTime(this.end.toString());\n        return (this.start instanceof Temporal.PlainDate &&\n            this.end instanceof Temporal.PlainDate &&\n            startDate !== endDate);\n    }\n    get _isSingleHybridDayTimed() {\n        if (!this._config.isHybridDay)\n            return false;\n        if (this.start instanceof Temporal.PlainDate ||\n            this.end instanceof Temporal.PlainDate)\n            return false;\n        const startDate = dateFromDateTime(this.start.toString());\n        const endDate = dateFromDateTime(this.end.toString());\n        const endDateMinusOneDay = toDateString(Temporal.PlainDate.from(endDate).subtract({ days: 1 }));\n        if (startDate !== endDate && startDate !== endDateMinusOneDay)\n            return false;\n        const dayBoundaries = this._config.dayBoundaries.value;\n        const eventStartTimePoints = timePointsFromString(timeFromDateTime(this.start.toString()));\n        const eventEndTimePoints = timePointsFromString(timeFromDateTime(this.end.toString()));\n        const eventIsFullyInFirstDayOfBoundary = eventEndTimePoints > eventStartTimePoints && startDate === endDate;\n        return ((eventStartTimePoints >= dayBoundaries.start &&\n            (eventEndTimePoints <= dayBoundaries.end ||\n                eventIsFullyInFirstDayOfBoundary)) ||\n            (eventStartTimePoints < dayBoundaries.end &&\n                eventEndTimePoints <= dayBoundaries.end));\n    }\n    get _color() {\n        if (this.calendarId &&\n            this._config.calendars.value &&\n            this.calendarId in this._config.calendars.value) {\n            return this._config.calendars.value[this.calendarId].colorName;\n        }\n        return DEFAULT_EVENT_COLOR_NAME;\n    }\n    _getForeignProperties() {\n        return this._foreignProperties;\n    }\n    _getExternalEvent() {\n        return {\n            id: this.id,\n            start: this._start,\n            end: this._end,\n            title: this.title,\n            people: this.people,\n            location: this.location,\n            description: this.description,\n            calendarId: this.calendarId,\n            _options: this._options,\n            ...this._getForeignProperties(),\n        };\n    }\n}\n\nclass CalendarEventBuilder {\n    constructor(_config, id, start, end) {\n        Object.defineProperty(this, \"_config\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: _config\n        });\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: id\n        });\n        Object.defineProperty(this, \"start\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: start\n        });\n        Object.defineProperty(this, \"end\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: end\n        });\n        Object.defineProperty(this, \"people\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"location\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"description\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"title\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"calendarId\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"_foreignProperties\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: {}\n        });\n        Object.defineProperty(this, \"_options\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: undefined\n        });\n        Object.defineProperty(this, \"_customContent\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: {}\n        });\n    }\n    build() {\n        return new CalendarEventImpl(this._config, this.id, this.start, this.end, this.title, this.people, this.location, this.description, this.calendarId, this._options, this._customContent, this._foreignProperties);\n    }\n    withTitle(title) {\n        this.title = title;\n        return this;\n    }\n    withPeople(people) {\n        this.people = people;\n        return this;\n    }\n    withLocation(location) {\n        this.location = location;\n        return this;\n    }\n    withDescription(description) {\n        this.description = description;\n        return this;\n    }\n    withForeignProperties(foreignProperties) {\n        this._foreignProperties = foreignProperties;\n        return this;\n    }\n    withCalendarId(calendarId) {\n        this.calendarId = calendarId;\n        return this;\n    }\n    withOptions(options) {\n        this._options = options;\n        return this;\n    }\n    withCustomContent(customContent) {\n        this._customContent = customContent;\n        return this;\n    }\n}\n\nconst externalEventToInternal = (event, config) => {\n    const { id, start, end, title, description, location, people, _options, ...foreignProperties } = event;\n    return new CalendarEventBuilder(config, id, start, end)\n        .withTitle(title)\n        .withDescription(description)\n        .withLocation(location)\n        .withPeople(people)\n        .withCalendarId(event.calendarId)\n        .withOptions(_options)\n        .withForeignProperties(foreignProperties)\n        .withCustomContent(event._customContent)\n        .build();\n};\n\nclass EventsFacadeImpl {\n    constructor($app) {\n        Object.defineProperty(this, \"$app\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: $app\n        });\n    }\n    set(events) {\n        this.$app.calendarEvents.list.value = events.map((event) => externalEventToInternal(event, this.$app.config));\n    }\n    add(event) {\n        const newEvent = externalEventToInternal(event, this.$app.config);\n        newEvent._createdAt = new Date();\n        const copiedEvents = [...this.$app.calendarEvents.list.value];\n        copiedEvents.push(newEvent);\n        this.$app.calendarEvents.list.value = copiedEvents;\n    }\n    get(id) {\n        var _a;\n        return (_a = this.$app.calendarEvents.list.value\n            .find((event) => event.id === id)) === null || _a === void 0 ? void 0 : _a._getExternalEvent();\n    }\n    getAll() {\n        return this.$app.calendarEvents.list.value.map((event) => event._getExternalEvent());\n    }\n    remove(id) {\n        const index = this.$app.calendarEvents.list.value.findIndex((event) => event.id === id);\n        const copiedEvents = [...this.$app.calendarEvents.list.value];\n        copiedEvents.splice(index, 1);\n        this.$app.calendarEvents.list.value = copiedEvents;\n    }\n    update(event) {\n        const index = this.$app.calendarEvents.list.value.findIndex((e) => e.id === event.id);\n        const copiedEvents = [...this.$app.calendarEvents.list.value];\n        copiedEvents.splice(index, 1, externalEventToInternal(event, this.$app.config));\n        this.$app.calendarEvents.list.value = copiedEvents;\n    }\n}\n\nconst definePlugin = (name, definition) => {\n    definition.name = name;\n    return definition;\n};\n\nconst validateEvents = (events = []) => {\n    events === null || events === void 0 ? void 0 : events.forEach((event) => {\n        if (!(event.start instanceof Temporal.ZonedDateTime) &&\n            !(event.start instanceof Temporal.PlainDate)) {\n            throw new Error(`[Schedule-X error]: Event start time needs to be a Temporal.ZonedDateTime or Temporal.PlainDate.`);\n        }\n        if (!(event.end instanceof Temporal.ZonedDateTime) &&\n            !(event.end instanceof Temporal.PlainDate)) {\n            throw new Error(`[Schedule-X error]: Event end time needs to be a Temporal.ZonedDateTime or Temporal.PlainDate.`);\n        }\n        const isIdDecimalNumber = typeof event.id === 'number' && event.id % 1 !== 0;\n        if (isIdDecimalNumber) {\n            throw new Error(`[Schedule-X error]: Event id ${event.id} is not a valid id. Only non-unicode characters that can be used by document.querySelector is allowed, see: https://developer.mozilla.org/en-US/docs/Web/CSS/ident. We recommend using uuids or integers.`);\n        }\n        // only allow non-unicode characters that can be used by document.querySelector: https://developer.mozilla.org/en-US/docs/Web/CSS/ident\n        if (typeof event.id === 'string' && !/^[a-zA-Z0-9_-]*$/.test(event.id)) {\n            throw new Error(`[Schedule-X error]: Event id ${event.id} is not a valid id. Only non-unicode characters that can be used by document.querySelector is allowed, see: https://developer.mozilla.org/en-US/docs/Web/CSS/ident. We recommend using uuids or integers.`);\n        }\n        if (typeof event.id !== 'string' && typeof event.id !== 'number') {\n            throw new Error(`[Schedule-X error]: Event id ${event.id} is not a valid id. Only non-unicode characters that can be used by document.querySelector is allowed, see: https://developer.mozilla.org/en-US/docs/Web/CSS/ident. We recommend using uuids or integers.`);\n        }\n    });\n};\n\nclass EventsServicePluginImpl {\n    constructor() {\n        Object.defineProperty(this, \"name\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 'EventsServicePlugin'\n        });\n        Object.defineProperty(this, \"$app\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"eventsFacade\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n    }\n    beforeRender($app) {\n        this.$app = $app;\n        // TODO v3: move methods from events facade to here, and remove events facade\n        this.eventsFacade = new EventsFacadeImpl($app);\n    }\n    update(event) {\n        validateEvents([event]);\n        this.eventsFacade.update(event);\n    }\n    add(event) {\n        validateEvents([event]);\n        this.eventsFacade.add(event);\n    }\n    remove(id) {\n        this.eventsFacade.remove(id);\n    }\n    get(id) {\n        return this.eventsFacade.get(id);\n    }\n    getAll() {\n        return this.eventsFacade.getAll();\n    }\n    set(events) {\n        validateEvents(events);\n        this.eventsFacade.set(events);\n    }\n    setBackgroundEvents(backgroundEvents) {\n        this.$app.calendarEvents.backgroundEvents.value = backgroundEvents;\n    }\n}\nconst createEventsServicePlugin = () => {\n    return definePlugin('eventsService', new EventsServicePluginImpl());\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNjaGVkdWxlLXgvZXZlbnRzLXNlcnZpY2UvZGlzdC9jb3JlLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0Esd0NBQXdDLEtBQUssTUFBTSxJQUFJO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxjQUFjLFVBQVUsR0FBRyx3QkFBd0IsR0FBRyxzQkFBc0I7QUFDNUU7O0FBRUE7QUFDQTtBQUNBLHNDQUFzQyxXQUFXO0FBQ2pEO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxzREFBc0Q7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixhQUFhO0FBQ3hDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsMEJBQTBCOztBQUUzQjtBQUNBOztBQUVBO0FBQ0Esc0lBQXNJLHlCQUF5QjtBQUMvSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEZBQTRGLFNBQVM7QUFDckc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxZQUFZLHVGQUF1RjtBQUNuRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNERBQTRELFVBQVU7QUFDdEU7QUFDQTtBQUNBO0FBQ0EsNERBQTRELFVBQVU7QUFDdEU7QUFDQTtBQUNBLDREQUE0RCxVQUFVO0FBQ3RFO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFcUMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9uaWtpdGEvRGVza3RvcC9mb2N1c3BoZXJlL25vZGVfbW9kdWxlcy9Ac2NoZWR1bGUteC9ldmVudHMtc2VydmljZS9kaXN0L2NvcmUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgTnVtYmVyUmFuZ2VFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgICBjb25zdHJ1Y3RvcihtaW4sIG1heCkge1xuICAgICAgICBzdXBlcihgTnVtYmVyIG11c3QgYmUgYmV0d2VlbiAke21pbn0gYW5kICR7bWF4fS5gKTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwibWluXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBtaW5cbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm1heFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogbWF4XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuY29uc3QgZG91YmxlRGlnaXQgPSAobnVtYmVyKSA9PiB7XG4gICAgaWYgKG51bWJlciA8IDAgfHwgbnVtYmVyID4gOTkpXG4gICAgICAgIHRocm93IG5ldyBOdW1iZXJSYW5nZUVycm9yKDAsIDk5KTtcbiAgICByZXR1cm4gU3RyaW5nKG51bWJlcikucGFkU3RhcnQoMiwgJzAnKTtcbn07XG5cbmNvbnN0IHRvRGF0ZVN0cmluZyA9IChkYXRlKSA9PiB7XG4gICAgcmV0dXJuIGAke2RhdGUueWVhcn0tJHtkb3VibGVEaWdpdChkYXRlLm1vbnRoKX0tJHtkb3VibGVEaWdpdChkYXRlLmRheSl9YDtcbn07XG5cbmNsYXNzIEludmFsaWRUaW1lU3RyaW5nRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IodGltZVN0cmluZykge1xuICAgICAgICBzdXBlcihgSW52YWxpZCB0aW1lIHN0cmluZzogJHt0aW1lU3RyaW5nfWApO1xuICAgIH1cbn1cblxuLy8gcmVnZXggZm9yIHN0cmluZ3MgYmV0d2VlbiAwMDowMCBhbmQgMjM6NTlcbmNvbnN0IHRpbWVTdHJpbmdSZWdleCA9IC9eKDBbMC05XXwxWzAtOV18MlswLTNdKTpbMC01XVswLTldLztcblxuY29uc3QgbWludXRlVGltZVBvaW50TXVsdGlwbGllciA9IDEuNjY2NjY2NjY2NjY2NjY2NzsgLy8gMTAwIC8gNjBcbmNvbnN0IHRpbWVQb2ludHNGcm9tU3RyaW5nID0gKHRpbWVTdHJpbmcpID0+IHtcbiAgICBpZiAoIXRpbWVTdHJpbmdSZWdleC50ZXN0KHRpbWVTdHJpbmcpICYmIHRpbWVTdHJpbmcgIT09ICcyNDowMCcpXG4gICAgICAgIHRocm93IG5ldyBJbnZhbGlkVGltZVN0cmluZ0Vycm9yKHRpbWVTdHJpbmcpO1xuICAgIGNvbnN0IFtob3Vyc0ludCwgbWludXRlc0ludF0gPSB0aW1lU3RyaW5nXG4gICAgICAgIC5zcGxpdCgnOicpXG4gICAgICAgIC5tYXAoKHRpbWUpID0+IHBhcnNlSW50KHRpbWUsIDEwKSk7XG4gICAgbGV0IG1pbnV0ZVBvaW50cyA9IChtaW51dGVzSW50ICogbWludXRlVGltZVBvaW50TXVsdGlwbGllcikudG9TdHJpbmcoKTtcbiAgICBpZiAobWludXRlUG9pbnRzLnNwbGl0KCcuJylbMF0ubGVuZ3RoIDwgMilcbiAgICAgICAgbWludXRlUG9pbnRzID0gYDAke21pbnV0ZVBvaW50c31gO1xuICAgIHJldHVybiBOdW1iZXIoaG91cnNJbnQgKyBtaW51dGVQb2ludHMpO1xufTtcblxuY29uc3QgZGF0ZUZyb21EYXRlVGltZSA9IChkYXRlVGltZSkgPT4ge1xuICAgIHJldHVybiBkYXRlVGltZS5zbGljZSgwLCAxMCk7XG59O1xuY29uc3QgdGltZUZyb21EYXRlVGltZSA9IChkYXRlVGltZSkgPT4ge1xuICAgIHJldHVybiBkYXRlVGltZS5zbGljZSgxMSk7XG59O1xuXG52YXIgV2Vla0RheTtcbihmdW5jdGlvbiAoV2Vla0RheSkge1xuICAgIFdlZWtEYXlbV2Vla0RheVtcIk1PTkRBWVwiXSA9IDFdID0gXCJNT05EQVlcIjtcbiAgICBXZWVrRGF5W1dlZWtEYXlbXCJUVUVTREFZXCJdID0gMl0gPSBcIlRVRVNEQVlcIjtcbiAgICBXZWVrRGF5W1dlZWtEYXlbXCJXRURORVNEQVlcIl0gPSAzXSA9IFwiV0VETkVTREFZXCI7XG4gICAgV2Vla0RheVtXZWVrRGF5W1wiVEhVUlNEQVlcIl0gPSA0XSA9IFwiVEhVUlNEQVlcIjtcbiAgICBXZWVrRGF5W1dlZWtEYXlbXCJGUklEQVlcIl0gPSA1XSA9IFwiRlJJREFZXCI7XG4gICAgV2Vla0RheVtXZWVrRGF5W1wiU0FUVVJEQVlcIl0gPSA2XSA9IFwiU0FUVVJEQVlcIjtcbiAgICBXZWVrRGF5W1dlZWtEYXlbXCJTVU5EQVlcIl0gPSA3XSA9IFwiU1VOREFZXCI7XG59KShXZWVrRGF5IHx8IChXZWVrRGF5ID0ge30pKTtcblxuV2Vla0RheS5NT05EQVk7XG5jb25zdCBERUZBVUxUX0VWRU5UX0NPTE9SX05BTUUgPSAncHJpbWFyeSc7XG5cbmNsYXNzIENhbGVuZGFyRXZlbnRJbXBsIHtcbiAgICBjb25zdHJ1Y3RvcihfY29uZmlnLCBpZCwgX3N0YXJ0LCBfZW5kLCB0aXRsZSwgcGVvcGxlLCBsb2NhdGlvbiwgZGVzY3JpcHRpb24sIGNhbGVuZGFySWQsIF9vcHRpb25zID0gdW5kZWZpbmVkLCBfY3VzdG9tQ29udGVudCA9IHt9LCBfZm9yZWlnblByb3BlcnRpZXMgPSB7fSkge1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJfY29uZmlnXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBfY29uZmlnXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJpZFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogaWRcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl9zdGFydFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogX3N0YXJ0XG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJfZW5kXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBfZW5kXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJ0aXRsZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdGl0bGVcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInBlb3BsZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogcGVvcGxlXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJsb2NhdGlvblwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogbG9jYXRpb25cbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImRlc2NyaXB0aW9uXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBkZXNjcmlwdGlvblxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiY2FsZW5kYXJJZFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogY2FsZW5kYXJJZFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiX29wdGlvbnNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IF9vcHRpb25zXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJfY3VzdG9tQ29udGVudFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogX2N1c3RvbUNvbnRlbnRcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl9mb3JlaWduUHJvcGVydGllc1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogX2ZvcmVpZ25Qcm9wZXJ0aWVzXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJfcHJldmlvdXNDb25jdXJyZW50RXZlbnRzXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl90b3RhbENvbmN1cnJlbnRFdmVudHNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiX21heENvbmN1cnJlbnRFdmVudHNcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiX25EYXlzSW5HcmlkXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl9jcmVhdGVkQXRcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiX29yaWdpbmFsVGltZXpvbmVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiX2V2ZW50RnJhZ21lbnRzXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB7fVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fb3JpZ2luYWxUaW1lem9uZSA9XG4gICAgICAgICAgICB0aGlzLl9zdGFydCBpbnN0YW5jZW9mIFRlbXBvcmFsLlpvbmVkRGF0ZVRpbWVcbiAgICAgICAgICAgICAgICA/IHRoaXMuX3N0YXJ0LnRpbWVab25lSWRcbiAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgZ2V0IHN0YXJ0KCkge1xuICAgICAgICBpZiAodGhpcy5fc3RhcnQgaW5zdGFuY2VvZiBUZW1wb3JhbC5QbGFpbkRhdGUpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zdGFydDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fc3RhcnQud2l0aFRpbWVab25lKHRoaXMuX2NvbmZpZy50aW1lem9uZS52YWx1ZSk7XG4gICAgfVxuICAgIHNldCBzdGFydCh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9zdGFydCA9XG4gICAgICAgICAgICB2YWx1ZSBpbnN0YW5jZW9mIFRlbXBvcmFsLlpvbmVkRGF0ZVRpbWVcbiAgICAgICAgICAgICAgICA/IHZhbHVlLndpdGhUaW1lWm9uZSh0aGlzLl9vcmlnaW5hbFRpbWV6b25lKVxuICAgICAgICAgICAgICAgIDogdmFsdWU7XG4gICAgfVxuICAgIGdldCBlbmQoKSB7XG4gICAgICAgIGlmICh0aGlzLl9lbmQgaW5zdGFuY2VvZiBUZW1wb3JhbC5QbGFpbkRhdGUpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9lbmQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX2VuZC53aXRoVGltZVpvbmUodGhpcy5fY29uZmlnLnRpbWV6b25lLnZhbHVlKTtcbiAgICB9XG4gICAgc2V0IGVuZCh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9lbmQgPVxuICAgICAgICAgICAgdmFsdWUgaW5zdGFuY2VvZiBUZW1wb3JhbC5ab25lZERhdGVUaW1lXG4gICAgICAgICAgICAgICAgPyB2YWx1ZS53aXRoVGltZVpvbmUodGhpcy5fb3JpZ2luYWxUaW1lem9uZSlcbiAgICAgICAgICAgICAgICA6IHZhbHVlO1xuICAgIH1cbiAgICBnZXQgX2lzU2luZ2xlRGF5VGltZWQoKSB7XG4gICAgICAgIGlmICh0aGlzLnN0YXJ0IGluc3RhbmNlb2YgVGVtcG9yYWwuUGxhaW5EYXRlIHx8XG4gICAgICAgICAgICB0aGlzLmVuZCBpbnN0YW5jZW9mIFRlbXBvcmFsLlBsYWluRGF0ZSlcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgY29uc3QgbG9jYWxTdGFydERhdGUgPSBkYXRlRnJvbURhdGVUaW1lKHRoaXMuc3RhcnQudG9TdHJpbmcoKSk7XG4gICAgICAgIGNvbnN0IGxvY2FsRW5kRGF0ZSA9IGRhdGVGcm9tRGF0ZVRpbWUodGhpcy5lbmQudG9TdHJpbmcoKSk7XG4gICAgICAgIHJldHVybiBsb2NhbFN0YXJ0RGF0ZSA9PT0gbG9jYWxFbmREYXRlO1xuICAgIH1cbiAgICBnZXQgX2lzU2luZ2xlRGF5RnVsbERheSgpIHtcbiAgICAgICAgY29uc3Qgc3RhcnREYXRlID0gZGF0ZUZyb21EYXRlVGltZSh0aGlzLnN0YXJ0LnRvU3RyaW5nKCkpO1xuICAgICAgICBjb25zdCBlbmREYXRlID0gZGF0ZUZyb21EYXRlVGltZSh0aGlzLmVuZC50b1N0cmluZygpKTtcbiAgICAgICAgcmV0dXJuIChzdGFydERhdGUgPT09IGVuZERhdGUgJiZcbiAgICAgICAgICAgIHRoaXMuc3RhcnQgaW5zdGFuY2VvZiBUZW1wb3JhbC5QbGFpbkRhdGUgJiZcbiAgICAgICAgICAgIHRoaXMuZW5kIGluc3RhbmNlb2YgVGVtcG9yYWwuUGxhaW5EYXRlKTtcbiAgICB9XG4gICAgZ2V0IF9pc011bHRpRGF5VGltZWQoKSB7XG4gICAgICAgIGlmICh0aGlzLnN0YXJ0IGluc3RhbmNlb2YgVGVtcG9yYWwuUGxhaW5EYXRlIHx8XG4gICAgICAgICAgICB0aGlzLmVuZCBpbnN0YW5jZW9mIFRlbXBvcmFsLlBsYWluRGF0ZSlcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgY29uc3Qgc3RhcnREYXRlID0gZGF0ZUZyb21EYXRlVGltZSh0aGlzLnN0YXJ0LnRvU3RyaW5nKCkpO1xuICAgICAgICBjb25zdCBlbmREYXRlID0gZGF0ZUZyb21EYXRlVGltZSh0aGlzLmVuZC50b1N0cmluZygpKTtcbiAgICAgICAgcmV0dXJuIHN0YXJ0RGF0ZSAhPT0gZW5kRGF0ZTtcbiAgICB9XG4gICAgZ2V0IF9pc011bHRpRGF5RnVsbERheSgpIHtcbiAgICAgICAgY29uc3Qgc3RhcnREYXRlID0gZGF0ZUZyb21EYXRlVGltZSh0aGlzLnN0YXJ0LnRvU3RyaW5nKCkpO1xuICAgICAgICBjb25zdCBlbmREYXRlID0gZGF0ZUZyb21EYXRlVGltZSh0aGlzLmVuZC50b1N0cmluZygpKTtcbiAgICAgICAgcmV0dXJuICh0aGlzLnN0YXJ0IGluc3RhbmNlb2YgVGVtcG9yYWwuUGxhaW5EYXRlICYmXG4gICAgICAgICAgICB0aGlzLmVuZCBpbnN0YW5jZW9mIFRlbXBvcmFsLlBsYWluRGF0ZSAmJlxuICAgICAgICAgICAgc3RhcnREYXRlICE9PSBlbmREYXRlKTtcbiAgICB9XG4gICAgZ2V0IF9pc1NpbmdsZUh5YnJpZERheVRpbWVkKCkge1xuICAgICAgICBpZiAoIXRoaXMuX2NvbmZpZy5pc0h5YnJpZERheSlcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgaWYgKHRoaXMuc3RhcnQgaW5zdGFuY2VvZiBUZW1wb3JhbC5QbGFpbkRhdGUgfHxcbiAgICAgICAgICAgIHRoaXMuZW5kIGluc3RhbmNlb2YgVGVtcG9yYWwuUGxhaW5EYXRlKVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICBjb25zdCBzdGFydERhdGUgPSBkYXRlRnJvbURhdGVUaW1lKHRoaXMuc3RhcnQudG9TdHJpbmcoKSk7XG4gICAgICAgIGNvbnN0IGVuZERhdGUgPSBkYXRlRnJvbURhdGVUaW1lKHRoaXMuZW5kLnRvU3RyaW5nKCkpO1xuICAgICAgICBjb25zdCBlbmREYXRlTWludXNPbmVEYXkgPSB0b0RhdGVTdHJpbmcoVGVtcG9yYWwuUGxhaW5EYXRlLmZyb20oZW5kRGF0ZSkuc3VidHJhY3QoeyBkYXlzOiAxIH0pKTtcbiAgICAgICAgaWYgKHN0YXJ0RGF0ZSAhPT0gZW5kRGF0ZSAmJiBzdGFydERhdGUgIT09IGVuZERhdGVNaW51c09uZURheSlcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgY29uc3QgZGF5Qm91bmRhcmllcyA9IHRoaXMuX2NvbmZpZy5kYXlCb3VuZGFyaWVzLnZhbHVlO1xuICAgICAgICBjb25zdCBldmVudFN0YXJ0VGltZVBvaW50cyA9IHRpbWVQb2ludHNGcm9tU3RyaW5nKHRpbWVGcm9tRGF0ZVRpbWUodGhpcy5zdGFydC50b1N0cmluZygpKSk7XG4gICAgICAgIGNvbnN0IGV2ZW50RW5kVGltZVBvaW50cyA9IHRpbWVQb2ludHNGcm9tU3RyaW5nKHRpbWVGcm9tRGF0ZVRpbWUodGhpcy5lbmQudG9TdHJpbmcoKSkpO1xuICAgICAgICBjb25zdCBldmVudElzRnVsbHlJbkZpcnN0RGF5T2ZCb3VuZGFyeSA9IGV2ZW50RW5kVGltZVBvaW50cyA+IGV2ZW50U3RhcnRUaW1lUG9pbnRzICYmIHN0YXJ0RGF0ZSA9PT0gZW5kRGF0ZTtcbiAgICAgICAgcmV0dXJuICgoZXZlbnRTdGFydFRpbWVQb2ludHMgPj0gZGF5Qm91bmRhcmllcy5zdGFydCAmJlxuICAgICAgICAgICAgKGV2ZW50RW5kVGltZVBvaW50cyA8PSBkYXlCb3VuZGFyaWVzLmVuZCB8fFxuICAgICAgICAgICAgICAgIGV2ZW50SXNGdWxseUluRmlyc3REYXlPZkJvdW5kYXJ5KSkgfHxcbiAgICAgICAgICAgIChldmVudFN0YXJ0VGltZVBvaW50cyA8IGRheUJvdW5kYXJpZXMuZW5kICYmXG4gICAgICAgICAgICAgICAgZXZlbnRFbmRUaW1lUG9pbnRzIDw9IGRheUJvdW5kYXJpZXMuZW5kKSk7XG4gICAgfVxuICAgIGdldCBfY29sb3IoKSB7XG4gICAgICAgIGlmICh0aGlzLmNhbGVuZGFySWQgJiZcbiAgICAgICAgICAgIHRoaXMuX2NvbmZpZy5jYWxlbmRhcnMudmFsdWUgJiZcbiAgICAgICAgICAgIHRoaXMuY2FsZW5kYXJJZCBpbiB0aGlzLl9jb25maWcuY2FsZW5kYXJzLnZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY29uZmlnLmNhbGVuZGFycy52YWx1ZVt0aGlzLmNhbGVuZGFySWRdLmNvbG9yTmFtZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gREVGQVVMVF9FVkVOVF9DT0xPUl9OQU1FO1xuICAgIH1cbiAgICBfZ2V0Rm9yZWlnblByb3BlcnRpZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9mb3JlaWduUHJvcGVydGllcztcbiAgICB9XG4gICAgX2dldEV4dGVybmFsRXZlbnQoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpZDogdGhpcy5pZCxcbiAgICAgICAgICAgIHN0YXJ0OiB0aGlzLl9zdGFydCxcbiAgICAgICAgICAgIGVuZDogdGhpcy5fZW5kLFxuICAgICAgICAgICAgdGl0bGU6IHRoaXMudGl0bGUsXG4gICAgICAgICAgICBwZW9wbGU6IHRoaXMucGVvcGxlLFxuICAgICAgICAgICAgbG9jYXRpb246IHRoaXMubG9jYXRpb24sXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogdGhpcy5kZXNjcmlwdGlvbixcbiAgICAgICAgICAgIGNhbGVuZGFySWQ6IHRoaXMuY2FsZW5kYXJJZCxcbiAgICAgICAgICAgIF9vcHRpb25zOiB0aGlzLl9vcHRpb25zLFxuICAgICAgICAgICAgLi4udGhpcy5fZ2V0Rm9yZWlnblByb3BlcnRpZXMoKSxcbiAgICAgICAgfTtcbiAgICB9XG59XG5cbmNsYXNzIENhbGVuZGFyRXZlbnRCdWlsZGVyIHtcbiAgICBjb25zdHJ1Y3RvcihfY29uZmlnLCBpZCwgc3RhcnQsIGVuZCkge1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJfY29uZmlnXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBfY29uZmlnXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJpZFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogaWRcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInN0YXJ0XCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBzdGFydFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiZW5kXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBlbmRcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInBlb3BsZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJsb2NhdGlvblwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJkZXNjcmlwdGlvblwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJ0aXRsZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJjYWxlbmRhcklkXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl9mb3JlaWduUHJvcGVydGllc1wiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZToge31cbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl9vcHRpb25zXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB1bmRlZmluZWRcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl9jdXN0b21Db250ZW50XCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB7fVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgYnVpbGQoKSB7XG4gICAgICAgIHJldHVybiBuZXcgQ2FsZW5kYXJFdmVudEltcGwodGhpcy5fY29uZmlnLCB0aGlzLmlkLCB0aGlzLnN0YXJ0LCB0aGlzLmVuZCwgdGhpcy50aXRsZSwgdGhpcy5wZW9wbGUsIHRoaXMubG9jYXRpb24sIHRoaXMuZGVzY3JpcHRpb24sIHRoaXMuY2FsZW5kYXJJZCwgdGhpcy5fb3B0aW9ucywgdGhpcy5fY3VzdG9tQ29udGVudCwgdGhpcy5fZm9yZWlnblByb3BlcnRpZXMpO1xuICAgIH1cbiAgICB3aXRoVGl0bGUodGl0bGUpIHtcbiAgICAgICAgdGhpcy50aXRsZSA9IHRpdGxlO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgd2l0aFBlb3BsZShwZW9wbGUpIHtcbiAgICAgICAgdGhpcy5wZW9wbGUgPSBwZW9wbGU7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICB3aXRoTG9jYXRpb24obG9jYXRpb24pIHtcbiAgICAgICAgdGhpcy5sb2NhdGlvbiA9IGxvY2F0aW9uO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgd2l0aERlc2NyaXB0aW9uKGRlc2NyaXB0aW9uKSB7XG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHdpdGhGb3JlaWduUHJvcGVydGllcyhmb3JlaWduUHJvcGVydGllcykge1xuICAgICAgICB0aGlzLl9mb3JlaWduUHJvcGVydGllcyA9IGZvcmVpZ25Qcm9wZXJ0aWVzO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgd2l0aENhbGVuZGFySWQoY2FsZW5kYXJJZCkge1xuICAgICAgICB0aGlzLmNhbGVuZGFySWQgPSBjYWxlbmRhcklkO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgd2l0aE9wdGlvbnMob3B0aW9ucykge1xuICAgICAgICB0aGlzLl9vcHRpb25zID0gb3B0aW9ucztcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHdpdGhDdXN0b21Db250ZW50KGN1c3RvbUNvbnRlbnQpIHtcbiAgICAgICAgdGhpcy5fY3VzdG9tQ29udGVudCA9IGN1c3RvbUNvbnRlbnQ7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbn1cblxuY29uc3QgZXh0ZXJuYWxFdmVudFRvSW50ZXJuYWwgPSAoZXZlbnQsIGNvbmZpZykgPT4ge1xuICAgIGNvbnN0IHsgaWQsIHN0YXJ0LCBlbmQsIHRpdGxlLCBkZXNjcmlwdGlvbiwgbG9jYXRpb24sIHBlb3BsZSwgX29wdGlvbnMsIC4uLmZvcmVpZ25Qcm9wZXJ0aWVzIH0gPSBldmVudDtcbiAgICByZXR1cm4gbmV3IENhbGVuZGFyRXZlbnRCdWlsZGVyKGNvbmZpZywgaWQsIHN0YXJ0LCBlbmQpXG4gICAgICAgIC53aXRoVGl0bGUodGl0bGUpXG4gICAgICAgIC53aXRoRGVzY3JpcHRpb24oZGVzY3JpcHRpb24pXG4gICAgICAgIC53aXRoTG9jYXRpb24obG9jYXRpb24pXG4gICAgICAgIC53aXRoUGVvcGxlKHBlb3BsZSlcbiAgICAgICAgLndpdGhDYWxlbmRhcklkKGV2ZW50LmNhbGVuZGFySWQpXG4gICAgICAgIC53aXRoT3B0aW9ucyhfb3B0aW9ucylcbiAgICAgICAgLndpdGhGb3JlaWduUHJvcGVydGllcyhmb3JlaWduUHJvcGVydGllcylcbiAgICAgICAgLndpdGhDdXN0b21Db250ZW50KGV2ZW50Ll9jdXN0b21Db250ZW50KVxuICAgICAgICAuYnVpbGQoKTtcbn07XG5cbmNsYXNzIEV2ZW50c0ZhY2FkZUltcGwge1xuICAgIGNvbnN0cnVjdG9yKCRhcHApIHtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiJGFwcFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogJGFwcFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgc2V0KGV2ZW50cykge1xuICAgICAgICB0aGlzLiRhcHAuY2FsZW5kYXJFdmVudHMubGlzdC52YWx1ZSA9IGV2ZW50cy5tYXAoKGV2ZW50KSA9PiBleHRlcm5hbEV2ZW50VG9JbnRlcm5hbChldmVudCwgdGhpcy4kYXBwLmNvbmZpZykpO1xuICAgIH1cbiAgICBhZGQoZXZlbnQpIHtcbiAgICAgICAgY29uc3QgbmV3RXZlbnQgPSBleHRlcm5hbEV2ZW50VG9JbnRlcm5hbChldmVudCwgdGhpcy4kYXBwLmNvbmZpZyk7XG4gICAgICAgIG5ld0V2ZW50Ll9jcmVhdGVkQXQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBjb25zdCBjb3BpZWRFdmVudHMgPSBbLi4udGhpcy4kYXBwLmNhbGVuZGFyRXZlbnRzLmxpc3QudmFsdWVdO1xuICAgICAgICBjb3BpZWRFdmVudHMucHVzaChuZXdFdmVudCk7XG4gICAgICAgIHRoaXMuJGFwcC5jYWxlbmRhckV2ZW50cy5saXN0LnZhbHVlID0gY29waWVkRXZlbnRzO1xuICAgIH1cbiAgICBnZXQoaWQpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICByZXR1cm4gKF9hID0gdGhpcy4kYXBwLmNhbGVuZGFyRXZlbnRzLmxpc3QudmFsdWVcbiAgICAgICAgICAgIC5maW5kKChldmVudCkgPT4gZXZlbnQuaWQgPT09IGlkKSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLl9nZXRFeHRlcm5hbEV2ZW50KCk7XG4gICAgfVxuICAgIGdldEFsbCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuJGFwcC5jYWxlbmRhckV2ZW50cy5saXN0LnZhbHVlLm1hcCgoZXZlbnQpID0+IGV2ZW50Ll9nZXRFeHRlcm5hbEV2ZW50KCkpO1xuICAgIH1cbiAgICByZW1vdmUoaWQpIHtcbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLiRhcHAuY2FsZW5kYXJFdmVudHMubGlzdC52YWx1ZS5maW5kSW5kZXgoKGV2ZW50KSA9PiBldmVudC5pZCA9PT0gaWQpO1xuICAgICAgICBjb25zdCBjb3BpZWRFdmVudHMgPSBbLi4udGhpcy4kYXBwLmNhbGVuZGFyRXZlbnRzLmxpc3QudmFsdWVdO1xuICAgICAgICBjb3BpZWRFdmVudHMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgdGhpcy4kYXBwLmNhbGVuZGFyRXZlbnRzLmxpc3QudmFsdWUgPSBjb3BpZWRFdmVudHM7XG4gICAgfVxuICAgIHVwZGF0ZShldmVudCkge1xuICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMuJGFwcC5jYWxlbmRhckV2ZW50cy5saXN0LnZhbHVlLmZpbmRJbmRleCgoZSkgPT4gZS5pZCA9PT0gZXZlbnQuaWQpO1xuICAgICAgICBjb25zdCBjb3BpZWRFdmVudHMgPSBbLi4udGhpcy4kYXBwLmNhbGVuZGFyRXZlbnRzLmxpc3QudmFsdWVdO1xuICAgICAgICBjb3BpZWRFdmVudHMuc3BsaWNlKGluZGV4LCAxLCBleHRlcm5hbEV2ZW50VG9JbnRlcm5hbChldmVudCwgdGhpcy4kYXBwLmNvbmZpZykpO1xuICAgICAgICB0aGlzLiRhcHAuY2FsZW5kYXJFdmVudHMubGlzdC52YWx1ZSA9IGNvcGllZEV2ZW50cztcbiAgICB9XG59XG5cbmNvbnN0IGRlZmluZVBsdWdpbiA9IChuYW1lLCBkZWZpbml0aW9uKSA9PiB7XG4gICAgZGVmaW5pdGlvbi5uYW1lID0gbmFtZTtcbiAgICByZXR1cm4gZGVmaW5pdGlvbjtcbn07XG5cbmNvbnN0IHZhbGlkYXRlRXZlbnRzID0gKGV2ZW50cyA9IFtdKSA9PiB7XG4gICAgZXZlbnRzID09PSBudWxsIHx8IGV2ZW50cyA9PT0gdm9pZCAwID8gdm9pZCAwIDogZXZlbnRzLmZvckVhY2goKGV2ZW50KSA9PiB7XG4gICAgICAgIGlmICghKGV2ZW50LnN0YXJ0IGluc3RhbmNlb2YgVGVtcG9yYWwuWm9uZWREYXRlVGltZSkgJiZcbiAgICAgICAgICAgICEoZXZlbnQuc3RhcnQgaW5zdGFuY2VvZiBUZW1wb3JhbC5QbGFpbkRhdGUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFtTY2hlZHVsZS1YIGVycm9yXTogRXZlbnQgc3RhcnQgdGltZSBuZWVkcyB0byBiZSBhIFRlbXBvcmFsLlpvbmVkRGF0ZVRpbWUgb3IgVGVtcG9yYWwuUGxhaW5EYXRlLmApO1xuICAgICAgICB9XG4gICAgICAgIGlmICghKGV2ZW50LmVuZCBpbnN0YW5jZW9mIFRlbXBvcmFsLlpvbmVkRGF0ZVRpbWUpICYmXG4gICAgICAgICAgICAhKGV2ZW50LmVuZCBpbnN0YW5jZW9mIFRlbXBvcmFsLlBsYWluRGF0ZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgW1NjaGVkdWxlLVggZXJyb3JdOiBFdmVudCBlbmQgdGltZSBuZWVkcyB0byBiZSBhIFRlbXBvcmFsLlpvbmVkRGF0ZVRpbWUgb3IgVGVtcG9yYWwuUGxhaW5EYXRlLmApO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGlzSWREZWNpbWFsTnVtYmVyID0gdHlwZW9mIGV2ZW50LmlkID09PSAnbnVtYmVyJyAmJiBldmVudC5pZCAlIDEgIT09IDA7XG4gICAgICAgIGlmIChpc0lkRGVjaW1hbE51bWJlcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBbU2NoZWR1bGUtWCBlcnJvcl06IEV2ZW50IGlkICR7ZXZlbnQuaWR9IGlzIG5vdCBhIHZhbGlkIGlkLiBPbmx5IG5vbi11bmljb2RlIGNoYXJhY3RlcnMgdGhhdCBjYW4gYmUgdXNlZCBieSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yIGlzIGFsbG93ZWQsIHNlZTogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQ1NTL2lkZW50LiBXZSByZWNvbW1lbmQgdXNpbmcgdXVpZHMgb3IgaW50ZWdlcnMuYCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gb25seSBhbGxvdyBub24tdW5pY29kZSBjaGFyYWN0ZXJzIHRoYXQgY2FuIGJlIHVzZWQgYnkgZG9jdW1lbnQucXVlcnlTZWxlY3RvcjogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQ1NTL2lkZW50XG4gICAgICAgIGlmICh0eXBlb2YgZXZlbnQuaWQgPT09ICdzdHJpbmcnICYmICEvXlthLXpBLVowLTlfLV0qJC8udGVzdChldmVudC5pZCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgW1NjaGVkdWxlLVggZXJyb3JdOiBFdmVudCBpZCAke2V2ZW50LmlkfSBpcyBub3QgYSB2YWxpZCBpZC4gT25seSBub24tdW5pY29kZSBjaGFyYWN0ZXJzIHRoYXQgY2FuIGJlIHVzZWQgYnkgZG9jdW1lbnQucXVlcnlTZWxlY3RvciBpcyBhbGxvd2VkLCBzZWU6IGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0NTUy9pZGVudC4gV2UgcmVjb21tZW5kIHVzaW5nIHV1aWRzIG9yIGludGVnZXJzLmApO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgZXZlbnQuaWQgIT09ICdzdHJpbmcnICYmIHR5cGVvZiBldmVudC5pZCAhPT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgW1NjaGVkdWxlLVggZXJyb3JdOiBFdmVudCBpZCAke2V2ZW50LmlkfSBpcyBub3QgYSB2YWxpZCBpZC4gT25seSBub24tdW5pY29kZSBjaGFyYWN0ZXJzIHRoYXQgY2FuIGJlIHVzZWQgYnkgZG9jdW1lbnQucXVlcnlTZWxlY3RvciBpcyBhbGxvd2VkLCBzZWU6IGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0NTUy9pZGVudC4gV2UgcmVjb21tZW5kIHVzaW5nIHV1aWRzIG9yIGludGVnZXJzLmApO1xuICAgICAgICB9XG4gICAgfSk7XG59O1xuXG5jbGFzcyBFdmVudHNTZXJ2aWNlUGx1Z2luSW1wbCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm5hbWVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6ICdFdmVudHNTZXJ2aWNlUGx1Z2luJ1xuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiJGFwcFwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdm9pZCAwXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJldmVudHNGYWNhZGVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IHZvaWQgMFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgYmVmb3JlUmVuZGVyKCRhcHApIHtcbiAgICAgICAgdGhpcy4kYXBwID0gJGFwcDtcbiAgICAgICAgLy8gVE9ETyB2MzogbW92ZSBtZXRob2RzIGZyb20gZXZlbnRzIGZhY2FkZSB0byBoZXJlLCBhbmQgcmVtb3ZlIGV2ZW50cyBmYWNhZGVcbiAgICAgICAgdGhpcy5ldmVudHNGYWNhZGUgPSBuZXcgRXZlbnRzRmFjYWRlSW1wbCgkYXBwKTtcbiAgICB9XG4gICAgdXBkYXRlKGV2ZW50KSB7XG4gICAgICAgIHZhbGlkYXRlRXZlbnRzKFtldmVudF0pO1xuICAgICAgICB0aGlzLmV2ZW50c0ZhY2FkZS51cGRhdGUoZXZlbnQpO1xuICAgIH1cbiAgICBhZGQoZXZlbnQpIHtcbiAgICAgICAgdmFsaWRhdGVFdmVudHMoW2V2ZW50XSk7XG4gICAgICAgIHRoaXMuZXZlbnRzRmFjYWRlLmFkZChldmVudCk7XG4gICAgfVxuICAgIHJlbW92ZShpZCkge1xuICAgICAgICB0aGlzLmV2ZW50c0ZhY2FkZS5yZW1vdmUoaWQpO1xuICAgIH1cbiAgICBnZXQoaWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXZlbnRzRmFjYWRlLmdldChpZCk7XG4gICAgfVxuICAgIGdldEFsbCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXZlbnRzRmFjYWRlLmdldEFsbCgpO1xuICAgIH1cbiAgICBzZXQoZXZlbnRzKSB7XG4gICAgICAgIHZhbGlkYXRlRXZlbnRzKGV2ZW50cyk7XG4gICAgICAgIHRoaXMuZXZlbnRzRmFjYWRlLnNldChldmVudHMpO1xuICAgIH1cbiAgICBzZXRCYWNrZ3JvdW5kRXZlbnRzKGJhY2tncm91bmRFdmVudHMpIHtcbiAgICAgICAgdGhpcy4kYXBwLmNhbGVuZGFyRXZlbnRzLmJhY2tncm91bmRFdmVudHMudmFsdWUgPSBiYWNrZ3JvdW5kRXZlbnRzO1xuICAgIH1cbn1cbmNvbnN0IGNyZWF0ZUV2ZW50c1NlcnZpY2VQbHVnaW4gPSAoKSA9PiB7XG4gICAgcmV0dXJuIGRlZmluZVBsdWdpbignZXZlbnRzU2VydmljZScsIG5ldyBFdmVudHNTZXJ2aWNlUGx1Z2luSW1wbCgpKTtcbn07XG5cbmV4cG9ydCB7IGNyZWF0ZUV2ZW50c1NlcnZpY2VQbHVnaW4gfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@schedule-x/events-service/dist/core.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@schedule-x/react/dist/index.js":
/*!******************************************************!*\
  !*** ./node_modules/@schedule-x/react/dist/index.js ***!
  \******************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ScheduleXCalendar: () => (/* binding */ ScheduleXCalendar),\n/* harmony export */   useCalendarApp: () => (/* binding */ useCalendarApp),\n/* harmony export */   useNextCalendarApp: () => (/* binding */ useNextCalendarApp),\n/* harmony export */   usePlugin: () => (/* binding */ usePlugin)\n/* harmony export */ });\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-runtime */ \"(ssr)/./node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-dom */ \"(ssr)/./node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react-dom.js\");\n/* harmony import */ var _schedule_x_calendar__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @schedule-x/calendar */ \"(ssr)/./node_modules/@schedule-x/calendar/dist/core.js\");\n\n\n\n\n\nconst createCustomComponentFn = (setCustomComponent, customComponent) => (wrapperElement, props) => {\n    setCustomComponent({\n        Component: (0,react__WEBPACK_IMPORTED_MODULE_1__.createElement)(customComponent, props),\n        wrapperElement,\n    });\n};\nfunction ScheduleXCalendar({ calendarApp, customComponents }) {\n    const [randomId, setRandomId] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)('');\n    const [customComponentsMeta, setCustomComponentsMeta] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]);\n    const setComponent = (component) => {\n        setCustomComponentsMeta((prev) => {\n            var _a, _b;\n            const ccid = (_b = (_a = component.wrapperElement) === null || _a === void 0 ? void 0 : _a.dataset) === null || _b === void 0 ? void 0 : _b.ccid;\n            if (!ccid)\n                return prev;\n            const newComponents = [...prev];\n            const existingComponent = newComponents.find((c) => { var _a, _b; return ((_b = (_a = c.wrapperElement) === null || _a === void 0 ? void 0 : _a.dataset) === null || _b === void 0 ? void 0 : _b.ccid) === ccid; });\n            if (existingComponent) {\n                newComponents.splice(newComponents.indexOf(existingComponent), 1);\n            }\n            return [...newComponents, component];\n        });\n    };\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n        setRandomId('sx' + Math.random().toString(36).substring(2, 11));\n    }, []);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n        if (!calendarApp)\n            return; // before useEffect runs for the first time calendarApp is null\n        for (const [componentName, Component] of Object.entries(customComponents || {})) {\n            if (!Component)\n                continue;\n            calendarApp._setCustomComponentFn(componentName, createCustomComponentFn(setComponent, Component));\n        }\n        const calendarElement = document.getElementById(randomId);\n        if (!calendarElement)\n            return;\n        calendarApp.render(calendarElement);\n        return () => {\n            calendarApp.destroy();\n        };\n    }, [calendarApp, customComponents, randomId]);\n    return ((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react__WEBPACK_IMPORTED_MODULE_1__.Fragment, { children: [(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"div\", { className: \"sx-react-calendar-wrapper\", id: randomId }), customComponentsMeta.map(({ Component, wrapperElement }) => {\n                    return (0,react_dom__WEBPACK_IMPORTED_MODULE_2__.createPortal)(Component, wrapperElement);\n                })] }) }));\n}\n\nfunction useCalendarApp(config, plugins) {\n    const [calendarApp, setCalendarApp] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n        setCalendarApp((0,_schedule_x_calendar__WEBPACK_IMPORTED_MODULE_3__.createCalendar)(config, plugins));\n    }, []);\n    return calendarApp;\n}\nfunction useNextCalendarApp(config, plugins) {\n    const [calendarApp, setCalendarApp] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n        if (typeof window !== 'undefined') {\n            setCalendarApp((0,_schedule_x_calendar__WEBPACK_IMPORTED_MODULE_3__.createCalendar)(config, plugins));\n        }\n    }, []);\n    return calendarApp;\n}\n\nconst usePlugin = (plugin) => {\n    if ('undefined' === typeof window) {\n        throw new Error('usePlugin can only be used in the browser. You need to wrap all logic for the calendar in a client side component.');\n    }\n    const [pluginInstance, setPluginInstance] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)();\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n        setPluginInstance(plugin);\n    }, []);\n    return pluginInstance;\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNjaGVkdWxlLXgvcmVhY3QvZGlzdC9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUF3RDtBQUMyQjtBQUMxQztBQUNhOztBQUV0RDtBQUNBO0FBQ0EsbUJBQW1CLG9EQUFhO0FBQ2hDO0FBQ0EsS0FBSztBQUNMO0FBQ0EsNkJBQTZCLCtCQUErQjtBQUM1RCxvQ0FBb0MsK0NBQVE7QUFDNUMsNERBQTRELCtDQUFRO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0VBQWtFLFlBQVksZ0pBQWdKO0FBQzlOO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsSUFBSSxnREFBUztBQUNiO0FBQ0EsS0FBSztBQUNMLElBQUksZ0RBQVM7QUFDYjtBQUNBLG9CQUFvQjtBQUNwQixzRkFBc0Y7QUFDdEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZLHNEQUFHLENBQUMsdURBQVEsSUFBSSxVQUFVLHVEQUFJLENBQUMsMkNBQVUsSUFBSSxXQUFXLHNEQUFHLFVBQVUsc0RBQXNELCtCQUErQiwyQkFBMkI7QUFDak0sMkJBQTJCLHVEQUFZO0FBQ3ZDLGlCQUFpQixJQUFJLEdBQUc7QUFDeEI7O0FBRUE7QUFDQSwwQ0FBMEMsK0NBQVE7QUFDbEQsSUFBSSxnREFBUztBQUNiLHVCQUF1QixvRUFBYztBQUNyQyxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsMENBQTBDLCtDQUFRO0FBQ2xELElBQUksZ0RBQVM7QUFDYjtBQUNBLDJCQUEyQixvRUFBYztBQUN6QztBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0RBQWdELCtDQUFRO0FBQ3hELElBQUksZ0RBQVM7QUFDYjtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUU0RSIsInNvdXJjZXMiOlsiL1VzZXJzL25pa2l0YS9EZXNrdG9wL2ZvY3VzcGhlcmUvbm9kZV9tb2R1bGVzL0BzY2hlZHVsZS14L3JlYWN0L2Rpc3QvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsganN4LCBGcmFnbWVudCwganN4cyB9IGZyb20gJ3JlYWN0L2pzeC1ydW50aW1lJztcbmltcG9ydCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QsIEZyYWdtZW50IGFzIEZyYWdtZW50JDEsIGNyZWF0ZUVsZW1lbnQgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBjcmVhdGVQb3J0YWwgfSBmcm9tICdyZWFjdC1kb20nO1xuaW1wb3J0IHsgY3JlYXRlQ2FsZW5kYXIgfSBmcm9tICdAc2NoZWR1bGUteC9jYWxlbmRhcic7XG5cbmNvbnN0IGNyZWF0ZUN1c3RvbUNvbXBvbmVudEZuID0gKHNldEN1c3RvbUNvbXBvbmVudCwgY3VzdG9tQ29tcG9uZW50KSA9PiAod3JhcHBlckVsZW1lbnQsIHByb3BzKSA9PiB7XG4gICAgc2V0Q3VzdG9tQ29tcG9uZW50KHtcbiAgICAgICAgQ29tcG9uZW50OiBjcmVhdGVFbGVtZW50KGN1c3RvbUNvbXBvbmVudCwgcHJvcHMpLFxuICAgICAgICB3cmFwcGVyRWxlbWVudCxcbiAgICB9KTtcbn07XG5mdW5jdGlvbiBTY2hlZHVsZVhDYWxlbmRhcih7IGNhbGVuZGFyQXBwLCBjdXN0b21Db21wb25lbnRzIH0pIHtcbiAgICBjb25zdCBbcmFuZG9tSWQsIHNldFJhbmRvbUlkXSA9IHVzZVN0YXRlKCcnKTtcbiAgICBjb25zdCBbY3VzdG9tQ29tcG9uZW50c01ldGEsIHNldEN1c3RvbUNvbXBvbmVudHNNZXRhXSA9IHVzZVN0YXRlKFtdKTtcbiAgICBjb25zdCBzZXRDb21wb25lbnQgPSAoY29tcG9uZW50KSA9PiB7XG4gICAgICAgIHNldEN1c3RvbUNvbXBvbmVudHNNZXRhKChwcmV2KSA9PiB7XG4gICAgICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICAgICAgY29uc3QgY2NpZCA9IChfYiA9IChfYSA9IGNvbXBvbmVudC53cmFwcGVyRWxlbWVudCkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmRhdGFzZXQpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5jY2lkO1xuICAgICAgICAgICAgaWYgKCFjY2lkKVxuICAgICAgICAgICAgICAgIHJldHVybiBwcmV2O1xuICAgICAgICAgICAgY29uc3QgbmV3Q29tcG9uZW50cyA9IFsuLi5wcmV2XTtcbiAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nQ29tcG9uZW50ID0gbmV3Q29tcG9uZW50cy5maW5kKChjKSA9PiB7IHZhciBfYSwgX2I7IHJldHVybiAoKF9iID0gKF9hID0gYy53cmFwcGVyRWxlbWVudCkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmRhdGFzZXQpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5jY2lkKSA9PT0gY2NpZDsgfSk7XG4gICAgICAgICAgICBpZiAoZXhpc3RpbmdDb21wb25lbnQpIHtcbiAgICAgICAgICAgICAgICBuZXdDb21wb25lbnRzLnNwbGljZShuZXdDb21wb25lbnRzLmluZGV4T2YoZXhpc3RpbmdDb21wb25lbnQpLCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBbLi4ubmV3Q29tcG9uZW50cywgY29tcG9uZW50XTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBzZXRSYW5kb21JZCgnc3gnICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDIsIDExKSk7XG4gICAgfSwgW10pO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGlmICghY2FsZW5kYXJBcHApXG4gICAgICAgICAgICByZXR1cm47IC8vIGJlZm9yZSB1c2VFZmZlY3QgcnVucyBmb3IgdGhlIGZpcnN0IHRpbWUgY2FsZW5kYXJBcHAgaXMgbnVsbFxuICAgICAgICBmb3IgKGNvbnN0IFtjb21wb25lbnROYW1lLCBDb21wb25lbnRdIG9mIE9iamVjdC5lbnRyaWVzKGN1c3RvbUNvbXBvbmVudHMgfHwge30pKSB7XG4gICAgICAgICAgICBpZiAoIUNvbXBvbmVudClcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIGNhbGVuZGFyQXBwLl9zZXRDdXN0b21Db21wb25lbnRGbihjb21wb25lbnROYW1lLCBjcmVhdGVDdXN0b21Db21wb25lbnRGbihzZXRDb21wb25lbnQsIENvbXBvbmVudCkpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNhbGVuZGFyRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHJhbmRvbUlkKTtcbiAgICAgICAgaWYgKCFjYWxlbmRhckVsZW1lbnQpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGNhbGVuZGFyQXBwLnJlbmRlcihjYWxlbmRhckVsZW1lbnQpO1xuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgY2FsZW5kYXJBcHAuZGVzdHJveSgpO1xuICAgICAgICB9O1xuICAgIH0sIFtjYWxlbmRhckFwcCwgY3VzdG9tQ29tcG9uZW50cywgcmFuZG9tSWRdKTtcbiAgICByZXR1cm4gKGpzeChGcmFnbWVudCwgeyBjaGlsZHJlbjoganN4cyhGcmFnbWVudCQxLCB7IGNoaWxkcmVuOiBbanN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN4LXJlYWN0LWNhbGVuZGFyLXdyYXBwZXJcIiwgaWQ6IHJhbmRvbUlkIH0pLCBjdXN0b21Db21wb25lbnRzTWV0YS5tYXAoKHsgQ29tcG9uZW50LCB3cmFwcGVyRWxlbWVudCB9KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjcmVhdGVQb3J0YWwoQ29tcG9uZW50LCB3cmFwcGVyRWxlbWVudCk7XG4gICAgICAgICAgICAgICAgfSldIH0pIH0pKTtcbn1cblxuZnVuY3Rpb24gdXNlQ2FsZW5kYXJBcHAoY29uZmlnLCBwbHVnaW5zKSB7XG4gICAgY29uc3QgW2NhbGVuZGFyQXBwLCBzZXRDYWxlbmRhckFwcF0gPSB1c2VTdGF0ZShudWxsKTtcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBzZXRDYWxlbmRhckFwcChjcmVhdGVDYWxlbmRhcihjb25maWcsIHBsdWdpbnMpKTtcbiAgICB9LCBbXSk7XG4gICAgcmV0dXJuIGNhbGVuZGFyQXBwO1xufVxuZnVuY3Rpb24gdXNlTmV4dENhbGVuZGFyQXBwKGNvbmZpZywgcGx1Z2lucykge1xuICAgIGNvbnN0IFtjYWxlbmRhckFwcCwgc2V0Q2FsZW5kYXJBcHBdID0gdXNlU3RhdGUobnVsbCk7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICBzZXRDYWxlbmRhckFwcChjcmVhdGVDYWxlbmRhcihjb25maWcsIHBsdWdpbnMpKTtcbiAgICAgICAgfVxuICAgIH0sIFtdKTtcbiAgICByZXR1cm4gY2FsZW5kYXJBcHA7XG59XG5cbmNvbnN0IHVzZVBsdWdpbiA9IChwbHVnaW4pID0+IHtcbiAgICBpZiAoJ3VuZGVmaW5lZCcgPT09IHR5cGVvZiB3aW5kb3cpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCd1c2VQbHVnaW4gY2FuIG9ubHkgYmUgdXNlZCBpbiB0aGUgYnJvd3Nlci4gWW91IG5lZWQgdG8gd3JhcCBhbGwgbG9naWMgZm9yIHRoZSBjYWxlbmRhciBpbiBhIGNsaWVudCBzaWRlIGNvbXBvbmVudC4nKTtcbiAgICB9XG4gICAgY29uc3QgW3BsdWdpbkluc3RhbmNlLCBzZXRQbHVnaW5JbnN0YW5jZV0gPSB1c2VTdGF0ZSgpO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIHNldFBsdWdpbkluc3RhbmNlKHBsdWdpbik7XG4gICAgfSwgW10pO1xuICAgIHJldHVybiBwbHVnaW5JbnN0YW5jZTtcbn07XG5cbmV4cG9ydCB7IFNjaGVkdWxlWENhbGVuZGFyLCB1c2VDYWxlbmRhckFwcCwgdXNlTmV4dENhbGVuZGFyQXBwLCB1c2VQbHVnaW4gfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@schedule-x/react/dist/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@schedule-x/theme-default/dist/index.css":
/*!***************************************************************!*\
  !*** ./node_modules/@schedule-x/theme-default/dist/index.css ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (\"574e02267472\");\nif (false) {}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNjaGVkdWxlLXgvdGhlbWUtZGVmYXVsdC9kaXN0L2luZGV4LmNzcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUEsaUVBQWUsY0FBYztBQUM3QixJQUFJLEtBQVUsRUFBRSxFQUF1QiIsInNvdXJjZXMiOlsiL1VzZXJzL25pa2l0YS9EZXNrdG9wL2ZvY3VzcGhlcmUvbm9kZV9tb2R1bGVzL0BzY2hlZHVsZS14L3RoZW1lLWRlZmF1bHQvZGlzdC9pbmRleC5jc3MiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgXCI1NzRlMDIyNjc0NzJcIlxuaWYgKG1vZHVsZS5ob3QpIHsgbW9kdWxlLmhvdC5hY2NlcHQoKSB9XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@schedule-x/theme-default/dist/index.css\n");

/***/ })

};
;